var Dg=Object.defineProperty;var Bg=(C,E,w)=>E in C?Dg(C,E,{enumerable:!0,configurable:!0,writable:!0,value:w}):C[E]=w;var Pa=(C,E,w)=>Bg(C,typeof E!="symbol"?E+"":E,w);(function(){const E=document.createElement("link").relList;if(E&&E.supports&&E.supports("modulepreload"))return;for(const M of document.querySelectorAll('link[rel="modulepreload"]'))R(M);new MutationObserver(M=>{for(const x of M)if(x.type==="childList")for(const S of x.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&R(S)}).observe(document,{childList:!0,subtree:!0});function w(M){const x={};return M.integrity&&(x.integrity=M.integrity),M.referrerPolicy&&(x.referrerPolicy=M.referrerPolicy),M.crossOrigin==="use-credentials"?x.credentials="include":M.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function R(M){if(M.ep)return;M.ep=!0;const x=w(M);fetch(M.href,x)}})();var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var C=Symbol.for("react.transitional.element"),E=Symbol.for("react.fragment");function w(R,M,x){var S=null;if(x!==void 0&&(S=""+x),M.key!==void 0&&(S=""+M.key),"key"in M){x={};for(var T in M)T!=="key"&&(x[T]=M[T])}else x=M;return M=x.ref,{$$typeof:C,type:R,key:S,ref:M!==void 0?M:null,props:x}}return reactJsxRuntime_production.Fragment=E,reactJsxRuntime_production.jsx=w,reactJsxRuntime_production.jsxs=w,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,function(C){function E(je,Dt){var Xe=je.length;je.push(Dt);e:for(;0<Xe;){var zt=Xe-1>>>1,xe=je[zt];if(0<M(xe,Dt))je[zt]=Dt,je[Xe]=xe,Xe=zt;else break e}}function w(je){return je.length===0?null:je[0]}function R(je){if(je.length===0)return null;var Dt=je[0],Xe=je.pop();if(Xe!==Dt){je[0]=Xe;e:for(var zt=0,xe=je.length,$e=xe>>>1;zt<$e;){var We=2*(zt+1)-1,He=je[We],Je=We+1,Rt=je[Je];if(0>M(He,Xe))Je<xe&&0>M(Rt,He)?(je[zt]=Rt,je[Je]=Xe,zt=Je):(je[zt]=He,je[We]=Xe,zt=We);else if(Je<xe&&0>M(Rt,Xe))je[zt]=Rt,je[Je]=Xe,zt=Je;else break e}}return Dt}function M(je,Dt){var Xe=je.sortIndex-Dt.sortIndex;return Xe!==0?Xe:je.id-Dt.id}if(C.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var x=performance;C.unstable_now=function(){return x.now()}}else{var S=Date,T=S.now();C.unstable_now=function(){return S.now()-T}}var _=[],D=[],Y=1,ee=null,ie=3,ne=!1,re=!1,oe=!1,ae=typeof setTimeout=="function"?setTimeout:null,le=typeof clearTimeout=="function"?clearTimeout:null,de=typeof setImmediate<"u"?setImmediate:null;function me(je){for(var Dt=w(D);Dt!==null;){if(Dt.callback===null)R(D);else if(Dt.startTime<=je)R(D),Dt.sortIndex=Dt.expirationTime,E(_,Dt);else break;Dt=w(D)}}function fe(je){if(oe=!1,me(je),!re)if(w(_)!==null)re=!0,Qe();else{var Dt=w(D);Dt!==null&&Pe(fe,Dt.startTime-je)}}var ge=!1,he=-1,ve=5,be=-1;function Se(){return!(C.unstable_now()-be<ve)}function Re(){if(ge){var je=C.unstable_now();be=je;var Dt=!0;try{e:{re=!1,oe&&(oe=!1,le(he),he=-1),ne=!0;var Xe=ie;try{t:{for(me(je),ee=w(_);ee!==null&&!(ee.expirationTime>je&&Se());){var zt=ee.callback;if(typeof zt=="function"){ee.callback=null,ie=ee.priorityLevel;var xe=zt(ee.expirationTime<=je);if(je=C.unstable_now(),typeof xe=="function"){ee.callback=xe,me(je),Dt=!0;break t}ee===w(_)&&R(_),me(je)}else R(_);ee=w(_)}if(ee!==null)Dt=!0;else{var $e=w(D);$e!==null&&Pe(fe,$e.startTime-je),Dt=!1}}break e}finally{ee=null,ie=Xe,ne=!1}Dt=void 0}}finally{Dt?Ae():ge=!1}}}var Ae;if(typeof de=="function")Ae=function(){de(Re)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,Be=Me.port2;Me.port1.onmessage=Re,Ae=function(){Be.postMessage(null)}}else Ae=function(){ae(Re,0)};function Qe(){ge||(ge=!0,Ae())}function Pe(je,Dt){he=ae(function(){je(C.unstable_now())},Dt)}C.unstable_IdlePriority=5,C.unstable_ImmediatePriority=1,C.unstable_LowPriority=4,C.unstable_NormalPriority=3,C.unstable_Profiling=null,C.unstable_UserBlockingPriority=2,C.unstable_cancelCallback=function(je){je.callback=null},C.unstable_continueExecution=function(){re||ne||(re=!0,Qe())},C.unstable_forceFrameRate=function(je){0>je||125<je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ve=0<je?Math.floor(1e3/je):5},C.unstable_getCurrentPriorityLevel=function(){return ie},C.unstable_getFirstCallbackNode=function(){return w(_)},C.unstable_next=function(je){switch(ie){case 1:case 2:case 3:var Dt=3;break;default:Dt=ie}var Xe=ie;ie=Dt;try{return je()}finally{ie=Xe}},C.unstable_pauseExecution=function(){},C.unstable_requestPaint=function(){},C.unstable_runWithPriority=function(je,Dt){switch(je){case 1:case 2:case 3:case 4:case 5:break;default:je=3}var Xe=ie;ie=je;try{return Dt()}finally{ie=Xe}},C.unstable_scheduleCallback=function(je,Dt,Xe){var zt=C.unstable_now();switch(typeof Xe=="object"&&Xe!==null?(Xe=Xe.delay,Xe=typeof Xe=="number"&&0<Xe?zt+Xe:zt):Xe=zt,je){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=Xe+xe,je={id:Y++,callback:Dt,priorityLevel:je,startTime:Xe,expirationTime:xe,sortIndex:-1},Xe>zt?(je.sortIndex=Xe,E(D,je),w(_)===null&&je===w(D)&&(oe?(le(he),he=-1):oe=!0,Pe(fe,Xe-zt))):(je.sortIndex=xe,E(_,je),re||ne||(re=!0,Qe())),je},C.unstable_shouldYield=Se,C.unstable_wrapCallback=function(je){var Dt=ie;return function(){var Xe=ie;ie=Dt;try{return je.apply(this,arguments)}finally{ie=Xe}}}}(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var C=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),S=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),D=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),ee=Symbol.iterator;function ie(xe){return xe===null||typeof xe!="object"?null:(xe=ee&&xe[ee]||xe["@@iterator"],typeof xe=="function"?xe:null)}var ne={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},re=Object.assign,oe={};function ae(xe,$e,We){this.props=xe,this.context=$e,this.refs=oe,this.updater=We||ne}ae.prototype.isReactComponent={},ae.prototype.setState=function(xe,$e){if(typeof xe!="object"&&typeof xe!="function"&&xe!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,xe,$e,"setState")},ae.prototype.forceUpdate=function(xe){this.updater.enqueueForceUpdate(this,xe,"forceUpdate")};function le(){}le.prototype=ae.prototype;function de(xe,$e,We){this.props=xe,this.context=$e,this.refs=oe,this.updater=We||ne}var me=de.prototype=new le;me.constructor=de,re(me,ae.prototype),me.isPureReactComponent=!0;var fe=Array.isArray,ge={H:null,A:null,T:null,S:null},he=Object.prototype.hasOwnProperty;function ve(xe,$e,We,He,Je,Rt){return We=Rt.ref,{$$typeof:C,type:xe,key:$e,ref:We!==void 0?We:null,props:Rt}}function be(xe,$e){return ve(xe.type,$e,void 0,void 0,void 0,xe.props)}function Se(xe){return typeof xe=="object"&&xe!==null&&xe.$$typeof===C}function Re(xe){var $e={"=":"=0",":":"=2"};return"$"+xe.replace(/[=:]/g,function(We){return $e[We]})}var Ae=/\/+/g;function Me(xe,$e){return typeof xe=="object"&&xe!==null&&xe.key!=null?Re(""+xe.key):$e.toString(36)}function Be(){}function Qe(xe){switch(xe.status){case"fulfilled":return xe.value;case"rejected":throw xe.reason;default:switch(typeof xe.status=="string"?xe.then(Be,Be):(xe.status="pending",xe.then(function($e){xe.status==="pending"&&(xe.status="fulfilled",xe.value=$e)},function($e){xe.status==="pending"&&(xe.status="rejected",xe.reason=$e)})),xe.status){case"fulfilled":return xe.value;case"rejected":throw xe.reason}}throw xe}function Pe(xe,$e,We,He,Je){var Rt=typeof xe;(Rt==="undefined"||Rt==="boolean")&&(xe=null);var jt=!1;if(xe===null)jt=!0;else switch(Rt){case"bigint":case"string":case"number":jt=!0;break;case"object":switch(xe.$$typeof){case C:case E:jt=!0;break;case Y:return jt=xe._init,Pe(jt(xe._payload),$e,We,He,Je)}}if(jt)return Je=Je(xe),jt=He===""?"."+Me(xe,0):He,fe(Je)?(We="",jt!=null&&(We=jt.replace(Ae,"$&/")+"/"),Pe(Je,$e,We,"",function(si){return si})):Je!=null&&(Se(Je)&&(Je=be(Je,We+(Je.key==null||xe&&xe.key===Je.key?"":(""+Je.key).replace(Ae,"$&/")+"/")+jt)),$e.push(Je)),1;jt=0;var hi=He===""?".":He+":";if(fe(xe))for(var Jt=0;Jt<xe.length;Jt++)He=xe[Jt],Rt=hi+Me(He,Jt),jt+=Pe(He,$e,We,Rt,Je);else if(Jt=ie(xe),typeof Jt=="function")for(xe=Jt.call(xe),Jt=0;!(He=xe.next()).done;)He=He.value,Rt=hi+Me(He,Jt++),jt+=Pe(He,$e,We,Rt,Je);else if(Rt==="object"){if(typeof xe.then=="function")return Pe(Qe(xe),$e,We,He,Je);throw $e=String(xe),Error("Objects are not valid as a React child (found: "+($e==="[object Object]"?"object with keys {"+Object.keys(xe).join(", ")+"}":$e)+"). If you meant to render a collection of children, use an array instead.")}return jt}function je(xe,$e,We){if(xe==null)return xe;var He=[],Je=0;return Pe(xe,He,"","",function(Rt){return $e.call(We,Rt,Je++)}),He}function Dt(xe){if(xe._status===-1){var $e=xe._result;$e=$e(),$e.then(function(We){(xe._status===0||xe._status===-1)&&(xe._status=1,xe._result=We)},function(We){(xe._status===0||xe._status===-1)&&(xe._status=2,xe._result=We)}),xe._status===-1&&(xe._status=0,xe._result=$e)}if(xe._status===1)return xe._result.default;throw xe._result}var Xe=typeof reportError=="function"?reportError:function(xe){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof xe=="object"&&xe!==null&&typeof xe.message=="string"?String(xe.message):String(xe),error:xe});if(!window.dispatchEvent($e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",xe);return}console.error(xe)};function zt(){}return react_production.Children={map:je,forEach:function(xe,$e,We){je(xe,function(){$e.apply(this,arguments)},We)},count:function(xe){var $e=0;return je(xe,function(){$e++}),$e},toArray:function(xe){return je(xe,function($e){return $e})||[]},only:function(xe){if(!Se(xe))throw Error("React.Children.only expected to receive a single React element child.");return xe}},react_production.Component=ae,react_production.Fragment=w,react_production.Profiler=M,react_production.PureComponent=de,react_production.StrictMode=R,react_production.Suspense=_,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ge,react_production.act=function(){throw Error("act(...) is not supported in production builds of React.")},react_production.cache=function(xe){return function(){return xe.apply(null,arguments)}},react_production.cloneElement=function(xe,$e,We){if(xe==null)throw Error("The argument must be a React element, but you passed "+xe+".");var He=re({},xe.props),Je=xe.key,Rt=void 0;if($e!=null)for(jt in $e.ref!==void 0&&(Rt=void 0),$e.key!==void 0&&(Je=""+$e.key),$e)!he.call($e,jt)||jt==="key"||jt==="__self"||jt==="__source"||jt==="ref"&&$e.ref===void 0||(He[jt]=$e[jt]);var jt=arguments.length-2;if(jt===1)He.children=We;else if(1<jt){for(var hi=Array(jt),Jt=0;Jt<jt;Jt++)hi[Jt]=arguments[Jt+2];He.children=hi}return ve(xe.type,Je,void 0,void 0,Rt,He)},react_production.createContext=function(xe){return xe={$$typeof:S,_currentValue:xe,_currentValue2:xe,_threadCount:0,Provider:null,Consumer:null},xe.Provider=xe,xe.Consumer={$$typeof:x,_context:xe},xe},react_production.createElement=function(xe,$e,We){var He,Je={},Rt=null;if($e!=null)for(He in $e.key!==void 0&&(Rt=""+$e.key),$e)he.call($e,He)&&He!=="key"&&He!=="__self"&&He!=="__source"&&(Je[He]=$e[He]);var jt=arguments.length-2;if(jt===1)Je.children=We;else if(1<jt){for(var hi=Array(jt),Jt=0;Jt<jt;Jt++)hi[Jt]=arguments[Jt+2];Je.children=hi}if(xe&&xe.defaultProps)for(He in jt=xe.defaultProps,jt)Je[He]===void 0&&(Je[He]=jt[He]);return ve(xe,Rt,void 0,void 0,null,Je)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(xe){return{$$typeof:T,render:xe}},react_production.isValidElement=Se,react_production.lazy=function(xe){return{$$typeof:Y,_payload:{_status:-1,_result:xe},_init:Dt}},react_production.memo=function(xe,$e){return{$$typeof:D,type:xe,compare:$e===void 0?null:$e}},react_production.startTransition=function(xe){var $e=ge.T,We={};ge.T=We;try{var He=xe(),Je=ge.S;Je!==null&&Je(We,He),typeof He=="object"&&He!==null&&typeof He.then=="function"&&He.then(zt,Xe)}catch(Rt){Xe(Rt)}finally{ge.T=$e}},react_production.unstable_useCacheRefresh=function(){return ge.H.useCacheRefresh()},react_production.use=function(xe){return ge.H.use(xe)},react_production.useActionState=function(xe,$e,We){return ge.H.useActionState(xe,$e,We)},react_production.useCallback=function(xe,$e){return ge.H.useCallback(xe,$e)},react_production.useContext=function(xe){return ge.H.useContext(xe)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(xe,$e){return ge.H.useDeferredValue(xe,$e)},react_production.useEffect=function(xe,$e){return ge.H.useEffect(xe,$e)},react_production.useId=function(){return ge.H.useId()},react_production.useImperativeHandle=function(xe,$e,We){return ge.H.useImperativeHandle(xe,$e,We)},react_production.useInsertionEffect=function(xe,$e){return ge.H.useInsertionEffect(xe,$e)},react_production.useLayoutEffect=function(xe,$e){return ge.H.useLayoutEffect(xe,$e)},react_production.useMemo=function(xe,$e){return ge.H.useMemo(xe,$e)},react_production.useOptimistic=function(xe,$e){return ge.H.useOptimistic(xe,$e)},react_production.useReducer=function(xe,$e,We){return ge.H.useReducer(xe,$e,We)},react_production.useRef=function(xe){return ge.H.useRef(xe)},react_production.useState=function(xe){return ge.H.useState(xe)},react_production.useSyncExternalStore=function(xe,$e,We){return ge.H.useSyncExternalStore(xe,$e,We)},react_production.useTransition=function(){return ge.H.useTransition()},react_production.version="19.0.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var C=requireReact();function E(_){var D="https://react.dev/errors/"+_;if(1<arguments.length){D+="?args[]="+encodeURIComponent(arguments[1]);for(var Y=2;Y<arguments.length;Y++)D+="&args[]="+encodeURIComponent(arguments[Y])}return"Minified React error #"+_+"; visit "+D+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function w(){}var R={d:{f:w,r:function(){throw Error(E(522))},D:w,C:w,L:w,m:w,X:w,S:w,M:w},p:0,findDOMNode:null},M=Symbol.for("react.portal");function x(_,D,Y){var ee=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:ee==null?null:""+ee,children:_,containerInfo:D,implementation:Y}}var S=C.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function T(_,D){if(_==="font")return"";if(typeof D=="string")return D==="use-credentials"?D:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,reactDom_production.createPortal=function(_,D){var Y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!D||D.nodeType!==1&&D.nodeType!==9&&D.nodeType!==11)throw Error(E(299));return x(_,D,null,Y)},reactDom_production.flushSync=function(_){var D=S.T,Y=R.p;try{if(S.T=null,R.p=2,_)return _()}finally{S.T=D,R.p=Y,R.d.f()}},reactDom_production.preconnect=function(_,D){typeof _=="string"&&(D?(D=D.crossOrigin,D=typeof D=="string"?D==="use-credentials"?D:"":void 0):D=null,R.d.C(_,D))},reactDom_production.prefetchDNS=function(_){typeof _=="string"&&R.d.D(_)},reactDom_production.preinit=function(_,D){if(typeof _=="string"&&D&&typeof D.as=="string"){var Y=D.as,ee=T(Y,D.crossOrigin),ie=typeof D.integrity=="string"?D.integrity:void 0,ne=typeof D.fetchPriority=="string"?D.fetchPriority:void 0;Y==="style"?R.d.S(_,typeof D.precedence=="string"?D.precedence:void 0,{crossOrigin:ee,integrity:ie,fetchPriority:ne}):Y==="script"&&R.d.X(_,{crossOrigin:ee,integrity:ie,fetchPriority:ne,nonce:typeof D.nonce=="string"?D.nonce:void 0})}},reactDom_production.preinitModule=function(_,D){if(typeof _=="string")if(typeof D=="object"&&D!==null){if(D.as==null||D.as==="script"){var Y=T(D.as,D.crossOrigin);R.d.M(_,{crossOrigin:Y,integrity:typeof D.integrity=="string"?D.integrity:void 0,nonce:typeof D.nonce=="string"?D.nonce:void 0})}}else D==null&&R.d.M(_)},reactDom_production.preload=function(_,D){if(typeof _=="string"&&typeof D=="object"&&D!==null&&typeof D.as=="string"){var Y=D.as,ee=T(Y,D.crossOrigin);R.d.L(_,Y,{crossOrigin:ee,integrity:typeof D.integrity=="string"?D.integrity:void 0,nonce:typeof D.nonce=="string"?D.nonce:void 0,type:typeof D.type=="string"?D.type:void 0,fetchPriority:typeof D.fetchPriority=="string"?D.fetchPriority:void 0,referrerPolicy:typeof D.referrerPolicy=="string"?D.referrerPolicy:void 0,imageSrcSet:typeof D.imageSrcSet=="string"?D.imageSrcSet:void 0,imageSizes:typeof D.imageSizes=="string"?D.imageSizes:void 0,media:typeof D.media=="string"?D.media:void 0})}},reactDom_production.preloadModule=function(_,D){if(typeof _=="string")if(D){var Y=T(D.as,D.crossOrigin);R.d.m(_,{as:typeof D.as=="string"&&D.as!=="script"?D.as:void 0,crossOrigin:Y,integrity:typeof D.integrity=="string"?D.integrity:void 0})}else R.d.m(_)},reactDom_production.requestFormReset=function(_){R.d.r(_)},reactDom_production.unstable_batchedUpdates=function(_,D){return _(D)},reactDom_production.useFormState=function(_,D,Y){return S.H.useFormState(_,D,Y)},reactDom_production.useFormStatus=function(){return S.H.useHostTransitionStatus()},reactDom_production.version="19.0.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function C(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(C)}catch(E){console.error(E)}}return C(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var C=requireScheduler(),E=requireReact(),w=requireReactDom();function R(A){var O="https://react.dev/errors/"+A;if(1<arguments.length){O+="?args[]="+encodeURIComponent(arguments[1]);for(var H=2;H<arguments.length;H++)O+="&args[]="+encodeURIComponent(arguments[H])}return"Minified React error #"+A+"; visit "+O+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function M(A){return!(!A||A.nodeType!==1&&A.nodeType!==9&&A.nodeType!==11)}var x=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),ee=Symbol.for("react.provider"),ie=Symbol.for("react.consumer"),ne=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),le=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),me=Symbol.for("react.offscreen"),fe=Symbol.for("react.memo_cache_sentinel"),ge=Symbol.iterator;function he(A){return A===null||typeof A!="object"?null:(A=ge&&A[ge]||A["@@iterator"],typeof A=="function"?A:null)}var ve=Symbol.for("react.client.reference");function be(A){if(A==null)return null;if(typeof A=="function")return A.$$typeof===ve?null:A.displayName||A.name||null;if(typeof A=="string")return A;switch(A){case _:return"Fragment";case T:return"Portal";case Y:return"Profiler";case D:return"StrictMode";case oe:return"Suspense";case ae:return"SuspenseList"}if(typeof A=="object")switch(A.$$typeof){case ne:return(A.displayName||"Context")+".Provider";case ie:return(A._context.displayName||"Context")+".Consumer";case re:var O=A.render;return A=A.displayName,A||(A=O.displayName||O.name||"",A=A!==""?"ForwardRef("+A+")":"ForwardRef"),A;case le:return O=A.displayName||null,O!==null?O:be(A.type)||"Memo";case de:O=A._payload,A=A._init;try{return be(A(O))}catch{}}return null}var Se=E.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re=Object.assign,Ae,Me;function Be(A){if(Ae===void 0)try{throw Error()}catch(H){var O=H.stack.trim().match(/\n( *(at )?)/);Ae=O&&O[1]||"",Me=-1<H.stack.indexOf(`
    at`)?" (<anonymous>)":-1<H.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ae+A+Me}var Qe=!1;function Pe(A,O){if(!A||Qe)return"";Qe=!0;var H=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var te={DetermineComponentFrameRoot:function(){try{if(O){var Ht=function(){throw Error()};if(Object.defineProperty(Ht.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ht,[])}catch(ot){var Ke=ot}Reflect.construct(A,[],Ht)}else{try{Ht.call()}catch(ot){Ke=ot}A.call(Ht.prototype)}}else{try{throw Error()}catch(ot){Ke=ot}(Ht=A())&&typeof Ht.catch=="function"&&Ht.catch(function(){})}}catch(ot){if(ot&&Ke&&typeof ot.stack=="string")return[ot.stack,Ke.stack]}return[null,null]}};te.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var se=Object.getOwnPropertyDescriptor(te.DetermineComponentFrameRoot,"name");se&&se.configurable&&Object.defineProperty(te.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ue=te.DetermineComponentFrameRoot(),ye=ue[0],Te=ue[1];if(ye&&Te){var _e=ye.split(`
`),De=Te.split(`
`);for(se=te=0;te<_e.length&&!_e[te].includes("DetermineComponentFrameRoot");)te++;for(;se<De.length&&!De[se].includes("DetermineComponentFrameRoot");)se++;if(te===_e.length||se===De.length)for(te=_e.length-1,se=De.length-1;1<=te&&0<=se&&_e[te]!==De[se];)se--;for(;1<=te&&0<=se;te--,se--)if(_e[te]!==De[se]){if(te!==1||se!==1)do if(te--,se--,0>se||_e[te]!==De[se]){var ut=`
`+_e[te].replace(" at new "," at ");return A.displayName&&ut.includes("<anonymous>")&&(ut=ut.replace("<anonymous>",A.displayName)),ut}while(1<=te&&0<=se);break}}}finally{Qe=!1,Error.prepareStackTrace=H}return(H=A?A.displayName||A.name:"")?Be(H):""}function je(A){switch(A.tag){case 26:case 27:case 5:return Be(A.type);case 16:return Be("Lazy");case 13:return Be("Suspense");case 19:return Be("SuspenseList");case 0:case 15:return A=Pe(A.type,!1),A;case 11:return A=Pe(A.type.render,!1),A;case 1:return A=Pe(A.type,!0),A;default:return""}}function Dt(A){try{var O="";do O+=je(A),A=A.return;while(A);return O}catch(H){return`
Error generating stack: `+H.message+`
`+H.stack}}function Xe(A){var O=A,H=A;if(A.alternate)for(;O.return;)O=O.return;else{A=O;do O=A,O.flags&4098&&(H=O.return),A=O.return;while(A)}return O.tag===3?H:null}function zt(A){if(A.tag===13){var O=A.memoizedState;if(O===null&&(A=A.alternate,A!==null&&(O=A.memoizedState)),O!==null)return O.dehydrated}return null}function xe(A){if(Xe(A)!==A)throw Error(R(188))}function $e(A){var O=A.alternate;if(!O){if(O=Xe(A),O===null)throw Error(R(188));return O!==A?null:A}for(var H=A,te=O;;){var se=H.return;if(se===null)break;var ue=se.alternate;if(ue===null){if(te=se.return,te!==null){H=te;continue}break}if(se.child===ue.child){for(ue=se.child;ue;){if(ue===H)return xe(se),A;if(ue===te)return xe(se),O;ue=ue.sibling}throw Error(R(188))}if(H.return!==te.return)H=se,te=ue;else{for(var ye=!1,Te=se.child;Te;){if(Te===H){ye=!0,H=se,te=ue;break}if(Te===te){ye=!0,te=se,H=ue;break}Te=Te.sibling}if(!ye){for(Te=ue.child;Te;){if(Te===H){ye=!0,H=ue,te=se;break}if(Te===te){ye=!0,te=ue,H=se;break}Te=Te.sibling}if(!ye)throw Error(R(189))}}if(H.alternate!==te)throw Error(R(190))}if(H.tag!==3)throw Error(R(188));return H.stateNode.current===H?A:O}function We(A){var O=A.tag;if(O===5||O===26||O===27||O===6)return A;for(A=A.child;A!==null;){if(O=We(A),O!==null)return O;A=A.sibling}return null}var He=Array.isArray,Je=w.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Rt={pending:!1,data:null,method:null,action:null},jt=[],hi=-1;function Jt(A){return{current:A}}function si(A){0>hi||(A.current=jt[hi],jt[hi]=null,hi--)}function ri(A,O){hi++,jt[hi]=A.current,A.current=O}var ni=Jt(null),Pi=Jt(null),Ci=Jt(null),qi=Jt(null);function vi(A,O){switch(ri(Ci,O),ri(Pi,A),ri(ni,null),A=O.nodeType,A){case 9:case 11:O=(O=O.documentElement)&&(O=O.namespaceURI)?Cp(O):0;break;default:if(A=A===8?O.parentNode:O,O=A.tagName,A=A.namespaceURI)A=Cp(A),O=Ep(A,O);else switch(O){case"svg":O=1;break;case"math":O=2;break;default:O=0}}si(ni),ri(ni,O)}function Ki(){si(ni),si(Pi),si(Ci)}function Vi(A){A.memoizedState!==null&&ri(qi,A);var O=ni.current,H=Ep(O,A.type);O!==H&&(ri(Pi,A),ri(ni,H))}function zi(A){Pi.current===A&&(si(ni),si(Pi)),qi.current===A&&(si(qi),Ms._currentValue=Rt)}var xi=Object.prototype.hasOwnProperty,Di=C.unstable_scheduleCallback,bi=C.unstable_cancelCallback,mi=C.unstable_shouldYield,Oi=C.unstable_requestPaint,Bi=C.unstable_now,Ji=C.unstable_getCurrentPriorityLevel,Bt=C.unstable_ImmediatePriority,it=C.unstable_UserBlockingPriority,ti=C.unstable_NormalPriority,Ee=C.unstable_LowPriority,ct=C.unstable_IdlePriority,dt=C.log,St=C.unstable_setDisableYieldValue,ft=null,Ie=null;function Ye(A){if(Ie&&typeof Ie.onCommitFiberRoot=="function")try{Ie.onCommitFiberRoot(ft,A,void 0,(A.current.flags&128)===128)}catch{}}function Ce(A){if(typeof dt=="function"&&St(A),Ie&&typeof Ie.setStrictMode=="function")try{Ie.setStrictMode(ft,A)}catch{}}var ke=Math.clz32?Math.clz32:ai,Ne=Math.log,Le=Math.LN2;function ai(A){return A>>>=0,A===0?32:31-(Ne(A)/Le|0)|0}var et=128,Kt=4194304;function qe(A){var O=A&42;if(O!==0)return O;switch(A&-A){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return A&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return A&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return A}}function Ge(A,O){var H=A.pendingLanes;if(H===0)return 0;var te=0,se=A.suspendedLanes,ue=A.pingedLanes,ye=A.warmLanes;A=A.finishedLanes!==0;var Te=H&134217727;return Te!==0?(H=Te&~se,H!==0?te=qe(H):(ue&=Te,ue!==0?te=qe(ue):A||(ye=Te&~ye,ye!==0&&(te=qe(ye))))):(Te=H&~se,Te!==0?te=qe(Te):ue!==0?te=qe(ue):A||(ye=H&~ye,ye!==0&&(te=qe(ye)))),te===0?0:O!==0&&O!==te&&!(O&se)&&(se=te&-te,ye=O&-O,se>=ye||se===32&&(ye&4194176)!==0)?O:te}function pe(A,O){return(A.pendingLanes&~(A.suspendedLanes&~A.pingedLanes)&O)===0}function Ve(A,O){switch(A){case 1:case 2:case 4:case 8:return O+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return O+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function we(){var A=et;return et<<=1,!(et&4194176)&&(et=128),A}function ze(){var A=Kt;return Kt<<=1,!(Kt&62914560)&&(Kt=4194304),A}function Ze(A){for(var O=[],H=0;31>H;H++)O.push(A);return O}function $t(A,O){A.pendingLanes|=O,O!==268435456&&(A.suspendedLanes=0,A.pingedLanes=0,A.warmLanes=0)}function ii(A,O,H,te,se,ue){var ye=A.pendingLanes;A.pendingLanes=H,A.suspendedLanes=0,A.pingedLanes=0,A.warmLanes=0,A.expiredLanes&=H,A.entangledLanes&=H,A.errorRecoveryDisabledLanes&=H,A.shellSuspendCounter=0;var Te=A.entanglements,_e=A.expirationTimes,De=A.hiddenUpdates;for(H=ye&~H;0<H;){var ut=31-ke(H),Ht=1<<ut;Te[ut]=0,_e[ut]=-1;var Ke=De[ut];if(Ke!==null)for(De[ut]=null,ut=0;ut<Ke.length;ut++){var ot=Ke[ut];ot!==null&&(ot.lane&=-536870913)}H&=~Ht}te!==0&&Yt(A,te,0),ue!==0&&se===0&&A.tag!==0&&(A.suspendedLanes|=ue&~(ye&~O))}function Yt(A,O,H){A.pendingLanes|=O,A.suspendedLanes&=~O;var te=31-ke(O);A.entangledLanes|=O,A.entanglements[te]=A.entanglements[te]|1073741824|H&4194218}function Ni(A,O){var H=A.entangledLanes|=O;for(A=A.entanglements;H;){var te=31-ke(H),se=1<<te;se&O|A[te]&O&&(A[te]|=O),H&=~se}}function pi(A){return A&=-A,2<A?8<A?A&134217727?32:268435456:8:2}function qn(){var A=Je.p;return A!==0?A:(A=window.event,A===void 0?32:qp(A.type))}function Jn(A,O){var H=Je.p;try{return Je.p=A,O()}finally{Je.p=H}}var Ti=Math.random().toString(36).slice(2),_i="__reactFiber$"+Ti,Ei="__reactProps$"+Ti,un="__reactContainer$"+Ti,gn="__reactEvents$"+Ti,Na="__reactListeners$"+Ti,gu="__reactHandles$"+Ti,Ls="__reactResources$"+Ti,ia="__reactMarker$"+Ti;function Do(A){delete A[_i],delete A[Ei],delete A[gn],delete A[Na],delete A[gu]}function ar(A){var O=A[_i];if(O)return O;for(var H=A.parentNode;H;){if(O=H[un]||H[_i]){if(H=O.alternate,O.child!==null||H!==null&&H.child!==null)for(A=Rp(A);A!==null;){if(H=A[_i])return H;A=Rp(A)}return O}A=H,H=A.parentNode}return null}function Tr(A){if(A=A[_i]||A[un]){var O=A.tag;if(O===5||O===6||O===13||O===26||O===27||O===3)return A}return null}function na(A){var O=A.tag;if(O===5||O===26||O===27||O===6)return A.stateNode;throw Error(R(33))}function Rr(A){var O=A[Ls];return O||(O=A[Ls]={hoistableStyles:new Map,hoistableScripts:new Map}),O}function tn(A){A[ia]=!0}var Fs=new Set,js={};function or(A,O){kr(A,O),kr(A+"Capture",O)}function kr(A,O){for(js[A]=O,A=0;A<O.length;A++)Fs.add(O[A])}var Un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qs={},Us={};function bu(A){return xi.call(Us,A)?!0:xi.call(qs,A)?!1:vu.test(A)?Us[A]=!0:(qs[A]=!0,!1)}function La(A,O,H){if(bu(O))if(H===null)A.removeAttribute(O);else{switch(typeof H){case"undefined":case"function":case"symbol":A.removeAttribute(O);return;case"boolean":var te=O.toLowerCase().slice(0,5);if(te!=="data-"&&te!=="aria-"){A.removeAttribute(O);return}}A.setAttribute(O,""+H)}}function Fa(A,O,H){if(H===null)A.removeAttribute(O);else{switch(typeof H){case"undefined":case"function":case"symbol":case"boolean":A.removeAttribute(O);return}A.setAttribute(O,""+H)}}function Hn(A,O,H,te){if(te===null)A.removeAttribute(H);else{switch(typeof te){case"undefined":case"function":case"symbol":case"boolean":A.removeAttribute(H);return}A.setAttributeNS(O,H,""+te)}}function Cn(A){switch(typeof A){case"bigint":case"boolean":case"number":case"string":case"undefined":return A;case"object":return A;default:return""}}function Hs(A){var O=A.type;return(A=A.nodeName)&&A.toLowerCase()==="input"&&(O==="checkbox"||O==="radio")}function yu(A){var O=Hs(A)?"checked":"value",H=Object.getOwnPropertyDescriptor(A.constructor.prototype,O),te=""+A[O];if(!A.hasOwnProperty(O)&&typeof H<"u"&&typeof H.get=="function"&&typeof H.set=="function"){var se=H.get,ue=H.set;return Object.defineProperty(A,O,{configurable:!0,get:function(){return se.call(this)},set:function(ye){te=""+ye,ue.call(this,ye)}}),Object.defineProperty(A,O,{enumerable:H.enumerable}),{getValue:function(){return te},setValue:function(ye){te=""+ye},stopTracking:function(){A._valueTracker=null,delete A[O]}}}}function ja(A){A._valueTracker||(A._valueTracker=yu(A))}function zs(A){if(!A)return!1;var O=A._valueTracker;if(!O)return!0;var H=O.getValue(),te="";return A&&(te=Hs(A)?A.checked?"true":"false":A.value),A=te,A!==H?(O.setValue(A),!0):!1}function qa(A){if(A=A||(typeof document<"u"?document:void 0),typeof A>"u")return null;try{return A.activeElement||A.body}catch{return A.body}}var Su=/[\n"\\]/g;function En(A){return A.replace(Su,function(O){return"\\"+O.charCodeAt(0).toString(16)+" "})}function Bo(A,O,H,te,se,ue,ye,Te){A.name="",ye!=null&&typeof ye!="function"&&typeof ye!="symbol"&&typeof ye!="boolean"?A.type=ye:A.removeAttribute("type"),O!=null?ye==="number"?(O===0&&A.value===""||A.value!=O)&&(A.value=""+Cn(O)):A.value!==""+Cn(O)&&(A.value=""+Cn(O)):ye!=="submit"&&ye!=="reset"||A.removeAttribute("value"),O!=null?Vo(A,ye,Cn(O)):H!=null?Vo(A,ye,Cn(H)):te!=null&&A.removeAttribute("value"),se==null&&ue!=null&&(A.defaultChecked=!!ue),se!=null&&(A.checked=se&&typeof se!="function"&&typeof se!="symbol"),Te!=null&&typeof Te!="function"&&typeof Te!="symbol"&&typeof Te!="boolean"?A.name=""+Cn(Te):A.removeAttribute("name")}function $s(A,O,H,te,se,ue,ye,Te){if(ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"&&(A.type=ue),O!=null||H!=null){if(!(ue!=="submit"&&ue!=="reset"||O!=null))return;H=H!=null?""+Cn(H):"",O=O!=null?""+Cn(O):H,Te||O===A.value||(A.value=O),A.defaultValue=O}te=te??se,te=typeof te!="function"&&typeof te!="symbol"&&!!te,A.checked=Te?A.checked:!!te,A.defaultChecked=!!te,ye!=null&&typeof ye!="function"&&typeof ye!="symbol"&&typeof ye!="boolean"&&(A.name=ye)}function Vo(A,O,H){O==="number"&&qa(A.ownerDocument)===A||A.defaultValue===""+H||(A.defaultValue=""+H)}function xr(A,O,H,te){if(A=A.options,O){O={};for(var se=0;se<H.length;se++)O["$"+H[se]]=!0;for(H=0;H<A.length;H++)se=O.hasOwnProperty("$"+A[H].value),A[H].selected!==se&&(A[H].selected=se),se&&te&&(A[H].defaultSelected=!0)}else{for(H=""+Cn(H),O=null,se=0;se<A.length;se++){if(A[se].value===H){A[se].selected=!0,te&&(A[se].defaultSelected=!0);return}O!==null||A[se].disabled||(O=A[se])}O!==null&&(O.selected=!0)}}function Gs(A,O,H){if(O!=null&&(O=""+Cn(O),O!==A.value&&(A.value=O),H==null)){A.defaultValue!==O&&(A.defaultValue=O);return}A.defaultValue=H!=null?""+Cn(H):""}function Ws(A,O,H,te){if(O==null){if(te!=null){if(H!=null)throw Error(R(92));if(He(te)){if(1<te.length)throw Error(R(93));te=te[0]}H=te}H==null&&(H=""),O=H}H=Cn(O),A.defaultValue=H,te=A.textContent,te===H&&te!==""&&te!==null&&(A.value=te)}function _r(A,O){if(O){var H=A.firstChild;if(H&&H===A.lastChild&&H.nodeType===3){H.nodeValue=O;return}}A.textContent=O}var Cu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ks(A,O,H){var te=O.indexOf("--")===0;H==null||typeof H=="boolean"||H===""?te?A.setProperty(O,""):O==="float"?A.cssFloat="":A[O]="":te?A.setProperty(O,H):typeof H!="number"||H===0||Cu.has(O)?O==="float"?A.cssFloat=H:A[O]=(""+H).trim():A[O]=H+"px"}function Js(A,O,H){if(O!=null&&typeof O!="object")throw Error(R(62));if(A=A.style,H!=null){for(var te in H)!H.hasOwnProperty(te)||O!=null&&O.hasOwnProperty(te)||(te.indexOf("--")===0?A.setProperty(te,""):te==="float"?A.cssFloat="":A[te]="");for(var se in O)te=O[se],O.hasOwnProperty(se)&&H[se]!==te&&Ks(A,se,te)}else for(var ue in O)O.hasOwnProperty(ue)&&Ks(A,ue,O[ue])}function No(A){if(A.indexOf("-")===-1)return!1;switch(A){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ua(A){return wu.test(""+A)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":A}var Lo=null;function Fo(A){return A=A.target||A.srcElement||window,A.correspondingUseElement&&(A=A.correspondingUseElement),A.nodeType===3?A.parentNode:A}var Ar=null,Mr=null;function Xs(A){var O=Tr(A);if(O&&(A=O.stateNode)){var H=A[Ei]||null;e:switch(A=O.stateNode,O.type){case"input":if(Bo(A,H.value,H.defaultValue,H.defaultValue,H.checked,H.defaultChecked,H.type,H.name),O=H.name,H.type==="radio"&&O!=null){for(H=A;H.parentNode;)H=H.parentNode;for(H=H.querySelectorAll('input[name="'+En(""+O)+'"][type="radio"]'),O=0;O<H.length;O++){var te=H[O];if(te!==A&&te.form===A.form){var se=te[Ei]||null;if(!se)throw Error(R(90));Bo(te,se.value,se.defaultValue,se.defaultValue,se.checked,se.defaultChecked,se.type,se.name)}}for(O=0;O<H.length;O++)te=H[O],te.form===A.form&&zs(te)}break e;case"textarea":Gs(A,H.value,H.defaultValue);break e;case"select":O=H.value,O!=null&&xr(A,!!H.multiple,O,!1)}}}var jo=!1;function Ys(A,O,H){if(jo)return A(O,H);jo=!0;try{var te=A(O);return te}finally{if(jo=!1,(Ar!==null||Mr!==null)&&(zl(),Ar&&(O=Ar,A=Mr,Mr=Ar=null,Xs(O),A)))for(O=0;O<A.length;O++)Xs(A[O])}}function ra(A,O){var H=A.stateNode;if(H===null)return null;var te=H[Ei]||null;if(te===null)return null;H=te[O];e:switch(O){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(te=!te.disabled)||(A=A.type,te=!(A==="button"||A==="input"||A==="select"||A==="textarea")),A=!te;break e;default:A=!1}if(A)return null;if(H&&typeof H!="function")throw Error(R(231,O,typeof H));return H}var qo=!1;if(Un)try{var aa={};Object.defineProperty(aa,"passive",{get:function(){qo=!0}}),window.addEventListener("test",aa,aa),window.removeEventListener("test",aa,aa)}catch{qo=!1}var Xn=null,Uo=null,Ha=null;function Zs(){if(Ha)return Ha;var A,O=Uo,H=O.length,te,se="value"in Xn?Xn.value:Xn.textContent,ue=se.length;for(A=0;A<H&&O[A]===se[A];A++);var ye=H-A;for(te=1;te<=ye&&O[H-te]===se[ue-te];te++);return Ha=se.slice(A,1<te?1-te:void 0)}function za(A){var O=A.keyCode;return"charCode"in A?(A=A.charCode,A===0&&O===13&&(A=13)):A=O,A===10&&(A=13),32<=A||A===13?A:0}function $a(){return!0}function Qs(){return!1}function vn(A){function O(H,te,se,ue,ye){this._reactName=H,this._targetInst=se,this.type=te,this.nativeEvent=ue,this.target=ye,this.currentTarget=null;for(var Te in A)A.hasOwnProperty(Te)&&(H=A[Te],this[Te]=H?H(ue):ue[Te]);return this.isDefaultPrevented=(ue.defaultPrevented!=null?ue.defaultPrevented:ue.returnValue===!1)?$a:Qs,this.isPropagationStopped=Qs,this}return Re(O.prototype,{preventDefault:function(){this.defaultPrevented=!0;var H=this.nativeEvent;H&&(H.preventDefault?H.preventDefault():typeof H.returnValue!="unknown"&&(H.returnValue=!1),this.isDefaultPrevented=$a)},stopPropagation:function(){var H=this.nativeEvent;H&&(H.stopPropagation?H.stopPropagation():typeof H.cancelBubble!="unknown"&&(H.cancelBubble=!0),this.isPropagationStopped=$a)},persist:function(){},isPersistent:$a}),O}var sr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(A){return A.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ga=vn(sr),oa=Re({},sr,{view:0,detail:0}),Tu=vn(oa),Ho,zo,sa,Wa=Re({},oa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Go,button:0,buttons:0,relatedTarget:function(A){return A.relatedTarget===void 0?A.fromElement===A.srcElement?A.toElement:A.fromElement:A.relatedTarget},movementX:function(A){return"movementX"in A?A.movementX:(A!==sa&&(sa&&A.type==="mousemove"?(Ho=A.screenX-sa.screenX,zo=A.screenY-sa.screenY):zo=Ho=0,sa=A),Ho)},movementY:function(A){return"movementY"in A?A.movementY:zo}}),el=vn(Wa),Ru=Re({},Wa,{dataTransfer:0}),ku=vn(Ru),xu=Re({},oa,{relatedTarget:0}),$o=vn(xu),_u=Re({},sr,{animationName:0,elapsedTime:0,pseudoElement:0}),Au=vn(_u),Mu=Re({},sr,{clipboardData:function(A){return"clipboardData"in A?A.clipboardData:window.clipboardData}}),Iu=vn(Mu),Pu=Re({},sr,{data:0}),tl=vn(Pu),Ou={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Du={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vu(A){var O=this.nativeEvent;return O.getModifierState?O.getModifierState(A):(A=Bu[A])?!!O[A]:!1}function Go(){return Vu}var Nu=Re({},oa,{key:function(A){if(A.key){var O=Ou[A.key]||A.key;if(O!=="Unidentified")return O}return A.type==="keypress"?(A=za(A),A===13?"Enter":String.fromCharCode(A)):A.type==="keydown"||A.type==="keyup"?Du[A.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Go,charCode:function(A){return A.type==="keypress"?za(A):0},keyCode:function(A){return A.type==="keydown"||A.type==="keyup"?A.keyCode:0},which:function(A){return A.type==="keypress"?za(A):A.type==="keydown"||A.type==="keyup"?A.keyCode:0}}),Lu=vn(Nu),Fu=Re({},Wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),il=vn(Fu),ju=Re({},oa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Go}),qu=vn(ju),Uu=Re({},sr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hu=vn(Uu),zu=Re({},Wa,{deltaX:function(A){return"deltaX"in A?A.deltaX:"wheelDeltaX"in A?-A.wheelDeltaX:0},deltaY:function(A){return"deltaY"in A?A.deltaY:"wheelDeltaY"in A?-A.wheelDeltaY:"wheelDelta"in A?-A.wheelDelta:0},deltaZ:0,deltaMode:0}),$u=vn(zu),Gu=Re({},sr,{newState:0,oldState:0}),Wu=vn(Gu),Ku=[9,13,27,32],Wo=Un&&"CompositionEvent"in window,la=null;Un&&"documentMode"in document&&(la=document.documentMode);var Ju=Un&&"TextEvent"in window&&!la,nl=Un&&(!Wo||la&&8<la&&11>=la),rl=" ",al=!1;function ol(A,O){switch(A){case"keyup":return Ku.indexOf(O.keyCode)!==-1;case"keydown":return O.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sl(A){return A=A.detail,typeof A=="object"&&"data"in A?A.data:null}var Ir=!1;function Xu(A,O){switch(A){case"compositionend":return sl(O);case"keypress":return O.which!==32?null:(al=!0,rl);case"textInput":return A=O.data,A===rl&&al?null:A;default:return null}}function Yu(A,O){if(Ir)return A==="compositionend"||!Wo&&ol(A,O)?(A=Zs(),Ha=Uo=Xn=null,Ir=!1,A):null;switch(A){case"paste":return null;case"keypress":if(!(O.ctrlKey||O.altKey||O.metaKey)||O.ctrlKey&&O.altKey){if(O.char&&1<O.char.length)return O.char;if(O.which)return String.fromCharCode(O.which)}return null;case"compositionend":return nl&&O.locale!=="ko"?null:O.data;default:return null}}var Zu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ll(A){var O=A&&A.nodeName&&A.nodeName.toLowerCase();return O==="input"?!!Zu[A.type]:O==="textarea"}function ul(A,O,H,te){Ar?Mr?Mr.push(te):Mr=[te]:Ar=te,O=Jl(O,"onChange"),0<O.length&&(H=new Ga("onChange","change",null,H,te),A.push({event:H,listeners:O}))}var ua=null,ca=null;function Qu(A){gp(A,0)}function Ka(A){var O=na(A);if(zs(O))return A}function cl(A,O){if(A==="change")return O}var dl=!1;if(Un){var da;if(Un){var Ko="oninput"in document;if(!Ko){var hl=document.createElement("div");hl.setAttribute("oninput","return;"),Ko=typeof hl.oninput=="function"}da=Ko}else da=!1;dl=da&&(!document.documentMode||9<document.documentMode)}function fl(){ua&&(ua.detachEvent("onpropertychange",ha),ca=ua=null)}function ha(A){if(A.propertyName==="value"&&Ka(ca)){var O=[];ul(O,ca,A,Fo(A)),Ys(Qu,O)}}function cm(A,O,H){A==="focusin"?(fl(),ua=O,ca=H,ua.attachEvent("onpropertychange",ha)):A==="focusout"&&fl()}function dm(A){if(A==="selectionchange"||A==="keyup"||A==="keydown")return Ka(ca)}function hm(A,O){if(A==="click")return Ka(O)}function fm(A,O){if(A==="input"||A==="change")return Ka(O)}function pm(A,O){return A===O&&(A!==0||1/A===1/O)||A!==A&&O!==O}var Tn=typeof Object.is=="function"?Object.is:pm;function Jo(A,O){if(Tn(A,O))return!0;if(typeof A!="object"||A===null||typeof O!="object"||O===null)return!1;var H=Object.keys(A),te=Object.keys(O);if(H.length!==te.length)return!1;for(te=0;te<H.length;te++){var se=H[te];if(!xi.call(O,se)||!Tn(A[se],O[se]))return!1}return!0}function Jd(A){for(;A&&A.firstChild;)A=A.firstChild;return A}function Xd(A,O){var H=Jd(A);A=0;for(var te;H;){if(H.nodeType===3){if(te=A+H.textContent.length,A<=O&&te>=O)return{node:H,offset:O-A};A=te}e:{for(;H;){if(H.nextSibling){H=H.nextSibling;break e}H=H.parentNode}H=void 0}H=Jd(H)}}function Yd(A,O){return A&&O?A===O?!0:A&&A.nodeType===3?!1:O&&O.nodeType===3?Yd(A,O.parentNode):"contains"in A?A.contains(O):A.compareDocumentPosition?!!(A.compareDocumentPosition(O)&16):!1:!1}function Zd(A){A=A!=null&&A.ownerDocument!=null&&A.ownerDocument.defaultView!=null?A.ownerDocument.defaultView:window;for(var O=qa(A.document);O instanceof A.HTMLIFrameElement;){try{var H=typeof O.contentWindow.location.href=="string"}catch{H=!1}if(H)A=O.contentWindow;else break;O=qa(A.document)}return O}function ec(A){var O=A&&A.nodeName&&A.nodeName.toLowerCase();return O&&(O==="input"&&(A.type==="text"||A.type==="search"||A.type==="tel"||A.type==="url"||A.type==="password")||O==="textarea"||A.contentEditable==="true")}function mm(A,O){var H=Zd(O);O=A.focusedElem;var te=A.selectionRange;if(H!==O&&O&&O.ownerDocument&&Yd(O.ownerDocument.documentElement,O)){if(te!==null&&ec(O)){if(A=te.start,H=te.end,H===void 0&&(H=A),"selectionStart"in O)O.selectionStart=A,O.selectionEnd=Math.min(H,O.value.length);else if(H=(A=O.ownerDocument||document)&&A.defaultView||window,H.getSelection){H=H.getSelection();var se=O.textContent.length,ue=Math.min(te.start,se);te=te.end===void 0?ue:Math.min(te.end,se),!H.extend&&ue>te&&(se=te,te=ue,ue=se),se=Xd(O,ue);var ye=Xd(O,te);se&&ye&&(H.rangeCount!==1||H.anchorNode!==se.node||H.anchorOffset!==se.offset||H.focusNode!==ye.node||H.focusOffset!==ye.offset)&&(A=A.createRange(),A.setStart(se.node,se.offset),H.removeAllRanges(),ue>te?(H.addRange(A),H.extend(ye.node,ye.offset)):(A.setEnd(ye.node,ye.offset),H.addRange(A)))}}for(A=[],H=O;H=H.parentNode;)H.nodeType===1&&A.push({element:H,left:H.scrollLeft,top:H.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<A.length;O++)H=A[O],H.element.scrollLeft=H.left,H.element.scrollTop=H.top}}var gm=Un&&"documentMode"in document&&11>=document.documentMode,Ja=null,tc=null,Xo=null,ic=!1;function Qd(A,O,H){var te=H.window===H?H.document:H.nodeType===9?H:H.ownerDocument;ic||Ja==null||Ja!==qa(te)||(te=Ja,"selectionStart"in te&&ec(te)?te={start:te.selectionStart,end:te.selectionEnd}:(te=(te.ownerDocument&&te.ownerDocument.defaultView||window).getSelection(),te={anchorNode:te.anchorNode,anchorOffset:te.anchorOffset,focusNode:te.focusNode,focusOffset:te.focusOffset}),Xo&&Jo(Xo,te)||(Xo=te,te=Jl(tc,"onSelect"),0<te.length&&(O=new Ga("onSelect","select",null,O,H),A.push({event:O,listeners:te}),O.target=Ja)))}function fa(A,O){var H={};return H[A.toLowerCase()]=O.toLowerCase(),H["Webkit"+A]="webkit"+O,H["Moz"+A]="moz"+O,H}var Xa={animationend:fa("Animation","AnimationEnd"),animationiteration:fa("Animation","AnimationIteration"),animationstart:fa("Animation","AnimationStart"),transitionrun:fa("Transition","TransitionRun"),transitionstart:fa("Transition","TransitionStart"),transitioncancel:fa("Transition","TransitionCancel"),transitionend:fa("Transition","TransitionEnd")},nc={},eh={};Un&&(eh=document.createElement("div").style,"AnimationEvent"in window||(delete Xa.animationend.animation,delete Xa.animationiteration.animation,delete Xa.animationstart.animation),"TransitionEvent"in window||delete Xa.transitionend.transition);function pa(A){if(nc[A])return nc[A];if(!Xa[A])return A;var O=Xa[A],H;for(H in O)if(O.hasOwnProperty(H)&&H in eh)return nc[A]=O[H];return A}var th=pa("animationend"),ih=pa("animationiteration"),nh=pa("animationstart"),vm=pa("transitionrun"),bm=pa("transitionstart"),ym=pa("transitioncancel"),rh=pa("transitionend"),ah=new Map,oh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function zn(A,O){ah.set(A,O),or(O,[A])}var An=[],Ya=0,rc=0;function pl(){for(var A=Ya,O=rc=Ya=0;O<A;){var H=An[O];An[O++]=null;var te=An[O];An[O++]=null;var se=An[O];An[O++]=null;var ue=An[O];if(An[O++]=null,te!==null&&se!==null){var ye=te.pending;ye===null?se.next=se:(se.next=ye.next,ye.next=se),te.pending=se}ue!==0&&sh(H,se,ue)}}function ml(A,O,H,te){An[Ya++]=A,An[Ya++]=O,An[Ya++]=H,An[Ya++]=te,rc|=te,A.lanes|=te,A=A.alternate,A!==null&&(A.lanes|=te)}function ac(A,O,H,te){return ml(A,O,H,te),gl(A)}function Pr(A,O){return ml(A,null,null,O),gl(A)}function sh(A,O,H){A.lanes|=H;var te=A.alternate;te!==null&&(te.lanes|=H);for(var se=!1,ue=A.return;ue!==null;)ue.childLanes|=H,te=ue.alternate,te!==null&&(te.childLanes|=H),ue.tag===22&&(A=ue.stateNode,A===null||A._visibility&1||(se=!0)),A=ue,ue=ue.return;se&&O!==null&&A.tag===3&&(ue=A.stateNode,se=31-ke(H),ue=ue.hiddenUpdates,A=ue[se],A===null?ue[se]=[O]:A.push(O),O.lane=H|536870912)}function gl(A){if(50<Es)throw Es=0,dd=null,Error(R(185));for(var O=A.return;O!==null;)A=O,O=A.return;return A.tag===3?A.stateNode:null}var Za={},lh=new WeakMap;function Mn(A,O){if(typeof A=="object"&&A!==null){var H=lh.get(A);return H!==void 0?H:(O={value:A,source:O,stack:Dt(O)},lh.set(A,O),O)}return{value:A,source:O,stack:Dt(O)}}var Qa=[],eo=0,vl=null,bl=0,In=[],Pn=0,ma=null,lr=1,ur="";function ga(A,O){Qa[eo++]=bl,Qa[eo++]=vl,vl=A,bl=O}function uh(A,O,H){In[Pn++]=lr,In[Pn++]=ur,In[Pn++]=ma,ma=A;var te=lr;A=ur;var se=32-ke(te)-1;te&=~(1<<se),H+=1;var ue=32-ke(O)+se;if(30<ue){var ye=se-se%5;ue=(te&(1<<ye)-1).toString(32),te>>=ye,se-=ye,lr=1<<32-ke(O)+se|H<<se|te,ur=ue+A}else lr=1<<ue|H<<se|te,ur=A}function oc(A){A.return!==null&&(ga(A,1),uh(A,1,0))}function sc(A){for(;A===vl;)vl=Qa[--eo],Qa[eo]=null,bl=Qa[--eo],Qa[eo]=null;for(;A===ma;)ma=In[--Pn],In[Pn]=null,ur=In[--Pn],In[Pn]=null,lr=In[--Pn],In[Pn]=null}var yn=null,fn=null,Mi=!1,$n=null,Yn=!1,lc=Error(R(519));function va(A){var O=Error(R(418,""));throw Qo(Mn(O,A)),lc}function ch(A){var O=A.stateNode,H=A.type,te=A.memoizedProps;switch(O[_i]=A,O[Ei]=te,H){case"dialog":Ri("cancel",O),Ri("close",O);break;case"iframe":case"object":case"embed":Ri("load",O);break;case"video":case"audio":for(H=0;H<Ts.length;H++)Ri(Ts[H],O);break;case"source":Ri("error",O);break;case"img":case"image":case"link":Ri("error",O),Ri("load",O);break;case"details":Ri("toggle",O);break;case"input":Ri("invalid",O),$s(O,te.value,te.defaultValue,te.checked,te.defaultChecked,te.type,te.name,!0),ja(O);break;case"select":Ri("invalid",O);break;case"textarea":Ri("invalid",O),Ws(O,te.value,te.defaultValue,te.children),ja(O)}H=te.children,typeof H!="string"&&typeof H!="number"&&typeof H!="bigint"||O.textContent===""+H||te.suppressHydrationWarning===!0||Sp(O.textContent,H)?(te.popover!=null&&(Ri("beforetoggle",O),Ri("toggle",O)),te.onScroll!=null&&Ri("scroll",O),te.onScrollEnd!=null&&Ri("scrollend",O),te.onClick!=null&&(O.onclick=Xl),O=!0):O=!1,O||va(A)}function dh(A){for(yn=A.return;yn;)switch(yn.tag){case 3:case 27:Yn=!0;return;case 5:case 13:Yn=!1;return;default:yn=yn.return}}function Yo(A){if(A!==yn)return!1;if(!Mi)return dh(A),Mi=!0,!1;var O=!1,H;if((H=A.tag!==3&&A.tag!==27)&&((H=A.tag===5)&&(H=A.type,H=!(H!=="form"&&H!=="button")||_d(A.type,A.memoizedProps)),H=!H),H&&(O=!0),O&&fn&&va(A),dh(A),A.tag===13){if(A=A.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(R(317));e:{for(A=A.nextSibling,O=0;A;){if(A.nodeType===8)if(H=A.data,H==="/$"){if(O===0){fn=Wn(A.nextSibling);break e}O--}else H!=="$"&&H!=="$!"&&H!=="$?"||O++;A=A.nextSibling}fn=null}}else fn=yn?Wn(A.stateNode.nextSibling):null;return!0}function Zo(){fn=yn=null,Mi=!1}function Qo(A){$n===null?$n=[A]:$n.push(A)}var ts=Error(R(460)),hh=Error(R(474)),uc={then:function(){}};function fh(A){return A=A.status,A==="fulfilled"||A==="rejected"}function yl(){}function ph(A,O,H){switch(H=A[H],H===void 0?A.push(O):H!==O&&(O.then(yl,yl),O=H),O.status){case"fulfilled":return O.value;case"rejected":throw A=O.reason,A===ts?Error(R(483)):A;default:if(typeof O.status=="string")O.then(yl,yl);else{if(A=Ui,A!==null&&100<A.shellSuspendCounter)throw Error(R(482));A=O,A.status="pending",A.then(function(te){if(O.status==="pending"){var se=O;se.status="fulfilled",se.value=te}},function(te){if(O.status==="pending"){var se=O;se.status="rejected",se.reason=te}})}switch(O.status){case"fulfilled":return O.value;case"rejected":throw A=O.reason,A===ts?Error(R(483)):A}throw is=O,ts}}var is=null;function mh(){if(is===null)throw Error(R(459));var A=is;return is=null,A}var to=null,ns=0;function Sl(A){var O=ns;return ns+=1,to===null&&(to=[]),ph(to,A,O)}function rs(A,O){O=O.props.ref,A.ref=O!==void 0?O:null}function Cl(A,O){throw O.$$typeof===x?Error(R(525)):(A=Object.prototype.toString.call(O),Error(R(31,A==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":A)))}function gh(A){var O=A._init;return O(A._payload)}function vh(A){function O(Fe,Oe){if(A){var Ue=Fe.deletions;Ue===null?(Fe.deletions=[Oe],Fe.flags|=16):Ue.push(Oe)}}function H(Fe,Oe){if(!A)return null;for(;Oe!==null;)O(Fe,Oe),Oe=Oe.sibling;return null}function te(Fe){for(var Oe=new Map;Fe!==null;)Fe.key!==null?Oe.set(Fe.key,Fe):Oe.set(Fe.index,Fe),Fe=Fe.sibling;return Oe}function se(Fe,Oe){return Fe=Gr(Fe,Oe),Fe.index=0,Fe.sibling=null,Fe}function ue(Fe,Oe,Ue){return Fe.index=Ue,A?(Ue=Fe.alternate,Ue!==null?(Ue=Ue.index,Ue<Oe?(Fe.flags|=33554434,Oe):Ue):(Fe.flags|=33554434,Oe)):(Fe.flags|=1048576,Oe)}function ye(Fe){return A&&Fe.alternate===null&&(Fe.flags|=33554434),Fe}function Te(Fe,Oe,Ue,kt){return Oe===null||Oe.tag!==6?(Oe=nd(Ue,Fe.mode,kt),Oe.return=Fe,Oe):(Oe=se(Oe,Ue),Oe.return=Fe,Oe)}function _e(Fe,Oe,Ue,kt){var oi=Ue.type;return oi===_?ut(Fe,Oe,Ue.props.children,kt,Ue.key):Oe!==null&&(Oe.elementType===oi||typeof oi=="object"&&oi!==null&&oi.$$typeof===de&&gh(oi)===Oe.type)?(Oe=se(Oe,Ue.props),rs(Oe,Ue),Oe.return=Fe,Oe):(Oe=Fl(Ue.type,Ue.key,Ue.props,null,Fe.mode,kt),rs(Oe,Ue),Oe.return=Fe,Oe)}function De(Fe,Oe,Ue,kt){return Oe===null||Oe.tag!==4||Oe.stateNode.containerInfo!==Ue.containerInfo||Oe.stateNode.implementation!==Ue.implementation?(Oe=rd(Ue,Fe.mode,kt),Oe.return=Fe,Oe):(Oe=se(Oe,Ue.children||[]),Oe.return=Fe,Oe)}function ut(Fe,Oe,Ue,kt,oi){return Oe===null||Oe.tag!==7?(Oe=xa(Ue,Fe.mode,kt,oi),Oe.return=Fe,Oe):(Oe=se(Oe,Ue),Oe.return=Fe,Oe)}function Ht(Fe,Oe,Ue){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Oe=nd(""+Oe,Fe.mode,Ue),Oe.return=Fe,Oe;if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case S:return Ue=Fl(Oe.type,Oe.key,Oe.props,null,Fe.mode,Ue),rs(Ue,Oe),Ue.return=Fe,Ue;case T:return Oe=rd(Oe,Fe.mode,Ue),Oe.return=Fe,Oe;case de:var kt=Oe._init;return Oe=kt(Oe._payload),Ht(Fe,Oe,Ue)}if(He(Oe)||he(Oe))return Oe=xa(Oe,Fe.mode,Ue,null),Oe.return=Fe,Oe;if(typeof Oe.then=="function")return Ht(Fe,Sl(Oe),Ue);if(Oe.$$typeof===ne)return Ht(Fe,Vl(Fe,Oe),Ue);Cl(Fe,Oe)}return null}function Ke(Fe,Oe,Ue,kt){var oi=Oe!==null?Oe.key:null;if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return oi!==null?null:Te(Fe,Oe,""+Ue,kt);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case S:return Ue.key===oi?_e(Fe,Oe,Ue,kt):null;case T:return Ue.key===oi?De(Fe,Oe,Ue,kt):null;case de:return oi=Ue._init,Ue=oi(Ue._payload),Ke(Fe,Oe,Ue,kt)}if(He(Ue)||he(Ue))return oi!==null?null:ut(Fe,Oe,Ue,kt,null);if(typeof Ue.then=="function")return Ke(Fe,Oe,Sl(Ue),kt);if(Ue.$$typeof===ne)return Ke(Fe,Oe,Vl(Fe,Ue),kt);Cl(Fe,Ue)}return null}function ot(Fe,Oe,Ue,kt,oi){if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return Fe=Fe.get(Ue)||null,Te(Oe,Fe,""+kt,oi);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case S:return Fe=Fe.get(kt.key===null?Ue:kt.key)||null,_e(Oe,Fe,kt,oi);case T:return Fe=Fe.get(kt.key===null?Ue:kt.key)||null,De(Oe,Fe,kt,oi);case de:var Si=kt._init;return kt=Si(kt._payload),ot(Fe,Oe,Ue,kt,oi)}if(He(kt)||he(kt))return Fe=Fe.get(Ue)||null,ut(Oe,Fe,kt,oi,null);if(typeof kt.then=="function")return ot(Fe,Oe,Ue,Sl(kt),oi);if(kt.$$typeof===ne)return ot(Fe,Oe,Ue,Vl(Oe,kt),oi);Cl(Oe,kt)}return null}function ui(Fe,Oe,Ue,kt){for(var oi=null,Si=null,di=Oe,fi=Oe=0,hn=null;di!==null&&fi<Ue.length;fi++){di.index>fi?(hn=di,di=null):hn=di.sibling;var Ii=Ke(Fe,di,Ue[fi],kt);if(Ii===null){di===null&&(di=hn);break}A&&di&&Ii.alternate===null&&O(Fe,di),Oe=ue(Ii,Oe,fi),Si===null?oi=Ii:Si.sibling=Ii,Si=Ii,di=hn}if(fi===Ue.length)return H(Fe,di),Mi&&ga(Fe,fi),oi;if(di===null){for(;fi<Ue.length;fi++)di=Ht(Fe,Ue[fi],kt),di!==null&&(Oe=ue(di,Oe,fi),Si===null?oi=di:Si.sibling=di,Si=di);return Mi&&ga(Fe,fi),oi}for(di=te(di);fi<Ue.length;fi++)hn=ot(di,Fe,fi,Ue[fi],kt),hn!==null&&(A&&hn.alternate!==null&&di.delete(hn.key===null?fi:hn.key),Oe=ue(hn,Oe,fi),Si===null?oi=hn:Si.sibling=hn,Si=hn);return A&&di.forEach(function(Qr){return O(Fe,Qr)}),Mi&&ga(Fe,fi),oi}function gi(Fe,Oe,Ue,kt){if(Ue==null)throw Error(R(151));for(var oi=null,Si=null,di=Oe,fi=Oe=0,hn=null,Ii=Ue.next();di!==null&&!Ii.done;fi++,Ii=Ue.next()){di.index>fi?(hn=di,di=null):hn=di.sibling;var Qr=Ke(Fe,di,Ii.value,kt);if(Qr===null){di===null&&(di=hn);break}A&&di&&Qr.alternate===null&&O(Fe,di),Oe=ue(Qr,Oe,fi),Si===null?oi=Qr:Si.sibling=Qr,Si=Qr,di=hn}if(Ii.done)return H(Fe,di),Mi&&ga(Fe,fi),oi;if(di===null){for(;!Ii.done;fi++,Ii=Ue.next())Ii=Ht(Fe,Ii.value,kt),Ii!==null&&(Oe=ue(Ii,Oe,fi),Si===null?oi=Ii:Si.sibling=Ii,Si=Ii);return Mi&&ga(Fe,fi),oi}for(di=te(di);!Ii.done;fi++,Ii=Ue.next())Ii=ot(di,Fe,fi,Ii.value,kt),Ii!==null&&(A&&Ii.alternate!==null&&di.delete(Ii.key===null?fi:Ii.key),Oe=ue(Ii,Oe,fi),Si===null?oi=Ii:Si.sibling=Ii,Si=Ii);return A&&di.forEach(function(Og){return O(Fe,Og)}),Mi&&ga(Fe,fi),oi}function Zi(Fe,Oe,Ue,kt){if(typeof Ue=="object"&&Ue!==null&&Ue.type===_&&Ue.key===null&&(Ue=Ue.props.children),typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case S:e:{for(var oi=Ue.key;Oe!==null;){if(Oe.key===oi){if(oi=Ue.type,oi===_){if(Oe.tag===7){H(Fe,Oe.sibling),kt=se(Oe,Ue.props.children),kt.return=Fe,Fe=kt;break e}}else if(Oe.elementType===oi||typeof oi=="object"&&oi!==null&&oi.$$typeof===de&&gh(oi)===Oe.type){H(Fe,Oe.sibling),kt=se(Oe,Ue.props),rs(kt,Ue),kt.return=Fe,Fe=kt;break e}H(Fe,Oe);break}else O(Fe,Oe);Oe=Oe.sibling}Ue.type===_?(kt=xa(Ue.props.children,Fe.mode,kt,Ue.key),kt.return=Fe,Fe=kt):(kt=Fl(Ue.type,Ue.key,Ue.props,null,Fe.mode,kt),rs(kt,Ue),kt.return=Fe,Fe=kt)}return ye(Fe);case T:e:{for(oi=Ue.key;Oe!==null;){if(Oe.key===oi)if(Oe.tag===4&&Oe.stateNode.containerInfo===Ue.containerInfo&&Oe.stateNode.implementation===Ue.implementation){H(Fe,Oe.sibling),kt=se(Oe,Ue.children||[]),kt.return=Fe,Fe=kt;break e}else{H(Fe,Oe);break}else O(Fe,Oe);Oe=Oe.sibling}kt=rd(Ue,Fe.mode,kt),kt.return=Fe,Fe=kt}return ye(Fe);case de:return oi=Ue._init,Ue=oi(Ue._payload),Zi(Fe,Oe,Ue,kt)}if(He(Ue))return ui(Fe,Oe,Ue,kt);if(he(Ue)){if(oi=he(Ue),typeof oi!="function")throw Error(R(150));return Ue=oi.call(Ue),gi(Fe,Oe,Ue,kt)}if(typeof Ue.then=="function")return Zi(Fe,Oe,Sl(Ue),kt);if(Ue.$$typeof===ne)return Zi(Fe,Oe,Vl(Fe,Ue),kt);Cl(Fe,Ue)}return typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint"?(Ue=""+Ue,Oe!==null&&Oe.tag===6?(H(Fe,Oe.sibling),kt=se(Oe,Ue),kt.return=Fe,Fe=kt):(H(Fe,Oe),kt=nd(Ue,Fe.mode,kt),kt.return=Fe,Fe=kt),ye(Fe)):H(Fe,Oe)}return function(Fe,Oe,Ue,kt){try{ns=0;var oi=Zi(Fe,Oe,Ue,kt);return to=null,oi}catch(di){if(di===ts)throw di;var Si=Vn(29,di,null,Fe.mode);return Si.lanes=kt,Si.return=Fe,Si}finally{}}}var ba=vh(!0),bh=vh(!1),oo=Jt(null),El=Jt(0);function yh(A,O){A=Sr,ri(El,A),ri(oo,O),Sr=A|O.baseLanes}function cc(){ri(El,Sr),ri(oo,oo.current)}function dc(){Sr=El.current,si(oo),si(El)}var On=Jt(null),Zn=null;function Or(A){var O=A.alternate;ri(sn,sn.current&1),ri(On,A),Zn===null&&(O===null||oo.current!==null||O.memoizedState!==null)&&(Zn=A)}function Sh(A){if(A.tag===22){if(ri(sn,sn.current),ri(On,A),Zn===null){var O=A.alternate;O!==null&&O.memoizedState!==null&&(Zn=A)}}else Dr()}function Dr(){ri(sn,sn.current),ri(On,On.current)}function cr(A){si(On),Zn===A&&(Zn=null),si(sn)}var sn=Jt(0);function wl(A){for(var O=A;O!==null;){if(O.tag===13){var H=O.memoizedState;if(H!==null&&(H=H.dehydrated,H===null||H.data==="$?"||H.data==="$!"))return O}else if(O.tag===19&&O.memoizedProps.revealOrder!==void 0){if(O.flags&128)return O}else if(O.child!==null){O.child.return=O,O=O.child;continue}if(O===A)break;for(;O.sibling===null;){if(O.return===null||O.return===A)return null;O=O.return}O.sibling.return=O.return,O=O.sibling}return null}var Sm=typeof AbortController<"u"?AbortController:function(){var A=[],O=this.signal={aborted:!1,addEventListener:function(H,te){A.push(te)}};this.abort=function(){O.aborted=!0,A.forEach(function(H){return H()})}},Cm=C.unstable_scheduleCallback,Em=C.unstable_NormalPriority,ln={$$typeof:ne,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hc(){return{controller:new Sm,data:new Map,refCount:0}}function as(A){A.refCount--,A.refCount===0&&Cm(Em,function(){A.controller.abort()})}var os=null,fc=0,uo=0,co=null;function wm(A,O){if(os===null){var H=os=[];fc=0,uo=yd(),co={status:"pending",value:void 0,then:function(te){H.push(te)}}}return fc++,O.then(Ch,Ch),O}function Ch(){if(--fc===0&&os!==null){co!==null&&(co.status="fulfilled");var A=os;os=null,uo=0,co=null;for(var O=0;O<A.length;O++)(0,A[O])()}}function Tm(A,O){var H=[],te={status:"pending",value:null,reason:null,then:function(se){H.push(se)}};return A.then(function(){te.status="fulfilled",te.value=O;for(var se=0;se<H.length;se++)(0,H[se])(O)},function(se){for(te.status="rejected",te.reason=se,se=0;se<H.length;se++)(0,H[se])(void 0)}),te}var Eh=Se.S;Se.S=function(A,O){typeof O=="object"&&O!==null&&typeof O.then=="function"&&wm(A,O),Eh!==null&&Eh(A,O)};var ya=Jt(null);function pc(){var A=ya.current;return A!==null?A:Ui.pooledCache}function Tl(A,O){O===null?ri(ya,ya.current):ri(ya,O.pool)}function wh(){var A=pc();return A===null?null:{parent:ln._currentValue,pool:A}}var Br=0,yi=null,Li=null,nn=null,Rl=!1,ho=!1,Sa=!1,kl=0,ss=0,fo=null,Rm=0;function Qi(){throw Error(R(321))}function mc(A,O){if(O===null)return!1;for(var H=0;H<O.length&&H<A.length;H++)if(!Tn(A[H],O[H]))return!1;return!0}function gc(A,O,H,te,se,ue){return Br=ue,yi=O,O.memoizedState=null,O.updateQueue=null,O.lanes=0,Se.H=A===null||A.memoizedState===null?Ca:Vr,Sa=!1,ue=H(te,se),Sa=!1,ho&&(ue=Rh(O,H,te,se)),Th(A),ue}function Th(A){Se.H=Qn;var O=Li!==null&&Li.next!==null;if(Br=0,nn=Li=yi=null,Rl=!1,ss=0,fo=null,O)throw Error(R(300));A===null||cn||(A=A.dependencies,A!==null&&Bl(A)&&(cn=!0))}function Rh(A,O,H,te){yi=A;var se=0;do{if(ho&&(fo=null),ss=0,ho=!1,25<=se)throw Error(R(301));if(se+=1,nn=Li=null,A.updateQueue!=null){var ue=A.updateQueue;ue.lastEffect=null,ue.events=null,ue.stores=null,ue.memoCache!=null&&(ue.memoCache.index=0)}Se.H=Ea,ue=O(H,te)}while(ho);return ue}function km(){var A=Se.H,O=A.useState()[0];return O=typeof O.then=="function"?ls(O):O,A=A.useState()[0],(Li!==null?Li.memoizedState:null)!==A&&(yi.flags|=1024),O}function vc(){var A=kl!==0;return kl=0,A}function bc(A,O,H){O.updateQueue=A.updateQueue,O.flags&=-2053,A.lanes&=~H}function yc(A){if(Rl){for(A=A.memoizedState;A!==null;){var O=A.queue;O!==null&&(O.pending=null),A=A.next}Rl=!1}Br=0,nn=Li=yi=null,ho=!1,ss=kl=0,fo=null}function wn(){var A={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nn===null?yi.memoizedState=nn=A:nn=nn.next=A,nn}function rn(){if(Li===null){var A=yi.alternate;A=A!==null?A.memoizedState:null}else A=Li.next;var O=nn===null?yi.memoizedState:nn.next;if(O!==null)nn=O,Li=A;else{if(A===null)throw yi.alternate===null?Error(R(467)):Error(R(310));Li=A,A={memoizedState:Li.memoizedState,baseState:Li.baseState,baseQueue:Li.baseQueue,queue:Li.queue,next:null},nn===null?yi.memoizedState=nn=A:nn=nn.next=A}return nn}var xl;xl=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function ls(A){var O=ss;return ss+=1,fo===null&&(fo=[]),A=ph(fo,A,O),O=yi,(nn===null?O.memoizedState:nn.next)===null&&(O=O.alternate,Se.H=O===null||O.memoizedState===null?Ca:Vr),A}function _l(A){if(A!==null&&typeof A=="object"){if(typeof A.then=="function")return ls(A);if(A.$$typeof===ne)return bn(A)}throw Error(R(438,String(A)))}function Sc(A){var O=null,H=yi.updateQueue;if(H!==null&&(O=H.memoCache),O==null){var te=yi.alternate;te!==null&&(te=te.updateQueue,te!==null&&(te=te.memoCache,te!=null&&(O={data:te.data.map(function(se){return se.slice()}),index:0})))}if(O==null&&(O={data:[],index:0}),H===null&&(H=xl(),yi.updateQueue=H),H.memoCache=O,H=O.data[O.index],H===void 0)for(H=O.data[O.index]=Array(A),te=0;te<A;te++)H[te]=fe;return O.index++,H}function dr(A,O){return typeof O=="function"?O(A):O}function Al(A){var O=rn();return Cc(O,Li,A)}function Cc(A,O,H){var te=A.queue;if(te===null)throw Error(R(311));te.lastRenderedReducer=H;var se=A.baseQueue,ue=te.pending;if(ue!==null){if(se!==null){var ye=se.next;se.next=ue.next,ue.next=ye}O.baseQueue=se=ue,te.pending=null}if(ue=A.baseState,se===null)A.memoizedState=ue;else{O=se.next;var Te=ye=null,_e=null,De=O,ut=!1;do{var Ht=De.lane&-536870913;if(Ht!==De.lane?(Ai&Ht)===Ht:(Br&Ht)===Ht){var Ke=De.revertLane;if(Ke===0)_e!==null&&(_e=_e.next={lane:0,revertLane:0,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null}),Ht===uo&&(ut=!0);else if((Br&Ke)===Ke){De=De.next,Ke===uo&&(ut=!0);continue}else Ht={lane:0,revertLane:De.revertLane,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null},_e===null?(Te=_e=Ht,ye=ue):_e=_e.next=Ht,yi.lanes|=Ke,Wr|=Ke;Ht=De.action,Sa&&H(ue,Ht),ue=De.hasEagerState?De.eagerState:H(ue,Ht)}else Ke={lane:Ht,revertLane:De.revertLane,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null},_e===null?(Te=_e=Ke,ye=ue):_e=_e.next=Ke,yi.lanes|=Ht,Wr|=Ht;De=De.next}while(De!==null&&De!==O);if(_e===null?ye=ue:_e.next=Te,!Tn(ue,A.memoizedState)&&(cn=!0,ut&&(H=co,H!==null)))throw H;A.memoizedState=ue,A.baseState=ye,A.baseQueue=_e,te.lastRenderedState=ue}return se===null&&(te.lanes=0),[A.memoizedState,te.dispatch]}function Ec(A){var O=rn(),H=O.queue;if(H===null)throw Error(R(311));H.lastRenderedReducer=A;var te=H.dispatch,se=H.pending,ue=O.memoizedState;if(se!==null){H.pending=null;var ye=se=se.next;do ue=A(ue,ye.action),ye=ye.next;while(ye!==se);Tn(ue,O.memoizedState)||(cn=!0),O.memoizedState=ue,O.baseQueue===null&&(O.baseState=ue),H.lastRenderedState=ue}return[ue,te]}function kh(A,O,H){var te=yi,se=rn(),ue=Mi;if(ue){if(H===void 0)throw Error(R(407));H=H()}else H=O();var ye=!Tn((Li||se).memoizedState,H);if(ye&&(se.memoizedState=H,cn=!0),se=se.queue,Rc(Ah.bind(null,te,se,A),[A]),se.getSnapshot!==O||ye||nn!==null&&nn.memoizedState.tag&1){if(te.flags|=2048,po(9,_h.bind(null,te,se,H,O),{destroy:void 0},null),Ui===null)throw Error(R(349));ue||Br&60||xh(te,O,H)}return H}function xh(A,O,H){A.flags|=16384,A={getSnapshot:O,value:H},O=yi.updateQueue,O===null?(O=xl(),yi.updateQueue=O,O.stores=[A]):(H=O.stores,H===null?O.stores=[A]:H.push(A))}function _h(A,O,H,te){O.value=H,O.getSnapshot=te,Mh(O)&&Ih(A)}function Ah(A,O,H){return H(function(){Mh(O)&&Ih(A)})}function Mh(A){var O=A.getSnapshot;A=A.value;try{var H=O();return!Tn(A,H)}catch{return!0}}function Ih(A){var O=Pr(A,2);O!==null&&Sn(O,A,2)}function wc(A){var O=wn();if(typeof A=="function"){var H=A;if(A=H(),Sa){Ce(!0);try{H()}finally{Ce(!1)}}}return O.memoizedState=O.baseState=A,O.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dr,lastRenderedState:A},O}function Ph(A,O,H,te){return A.baseState=H,Cc(A,Li,typeof te=="function"?te:dr)}function xm(A,O,H,te,se){if(Pl(A))throw Error(R(485));if(A=O.action,A!==null){var ue={payload:se,action:A,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ye){ue.listeners.push(ye)}};Se.T!==null?H(!0):ue.isTransition=!1,te(ue),H=O.pending,H===null?(ue.next=O.pending=ue,Oh(O,ue)):(ue.next=H.next,O.pending=H.next=ue)}}function Oh(A,O){var H=O.action,te=O.payload,se=A.state;if(O.isTransition){var ue=Se.T,ye={};Se.T=ye;try{var Te=H(se,te),_e=Se.S;_e!==null&&_e(ye,Te),Dh(A,O,Te)}catch(De){Tc(A,O,De)}finally{Se.T=ue}}else try{ue=H(se,te),Dh(A,O,ue)}catch(De){Tc(A,O,De)}}function Dh(A,O,H){H!==null&&typeof H=="object"&&typeof H.then=="function"?H.then(function(te){Bh(A,O,te)},function(te){return Tc(A,O,te)}):Bh(A,O,H)}function Bh(A,O,H){O.status="fulfilled",O.value=H,Vh(O),A.state=H,O=A.pending,O!==null&&(H=O.next,H===O?A.pending=null:(H=H.next,O.next=H,Oh(A,H)))}function Tc(A,O,H){var te=A.pending;if(A.pending=null,te!==null){te=te.next;do O.status="rejected",O.reason=H,Vh(O),O=O.next;while(O!==te)}A.action=null}function Vh(A){A=A.listeners;for(var O=0;O<A.length;O++)(0,A[O])()}function Nh(A,O){return O}function Lh(A,O){if(Mi){var H=Ui.formState;if(H!==null){e:{var te=yi;if(Mi){if(fn){t:{for(var se=fn,ue=Yn;se.nodeType!==8;){if(!ue){se=null;break t}if(se=Wn(se.nextSibling),se===null){se=null;break t}}ue=se.data,se=ue==="F!"||ue==="F"?se:null}if(se){fn=Wn(se.nextSibling),te=se.data==="F!";break e}}va(te)}te=!1}te&&(O=H[0])}}return H=wn(),H.memoizedState=H.baseState=O,te={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nh,lastRenderedState:O},H.queue=te,H=nf.bind(null,yi,te),te.dispatch=H,te=wc(!1),ue=Mc.bind(null,yi,!1,te.queue),te=wn(),se={state:O,dispatch:null,action:A,pending:null},te.queue=se,H=xm.bind(null,yi,se,ue,H),se.dispatch=H,te.memoizedState=A,[O,H,!1]}function Fh(A){var O=rn();return jh(O,Li,A)}function jh(A,O,H){O=Cc(A,O,Nh)[0],A=Al(dr)[0],O=typeof O=="object"&&O!==null&&typeof O.then=="function"?ls(O):O;var te=rn(),se=te.queue,ue=se.dispatch;return H!==te.memoizedState&&(yi.flags|=2048,po(9,_m.bind(null,se,H),{destroy:void 0},null)),[O,ue,A]}function _m(A,O){A.action=O}function qh(A){var O=rn(),H=Li;if(H!==null)return jh(O,H,A);rn(),O=O.memoizedState,H=rn();var te=H.queue.dispatch;return H.memoizedState=A,[O,te,!1]}function po(A,O,H,te){return A={tag:A,create:O,inst:H,deps:te,next:null},O=yi.updateQueue,O===null&&(O=xl(),yi.updateQueue=O),H=O.lastEffect,H===null?O.lastEffect=A.next=A:(te=H.next,H.next=A,A.next=te,O.lastEffect=A),A}function Uh(){return rn().memoizedState}function Ml(A,O,H,te){var se=wn();yi.flags|=A,se.memoizedState=po(1|O,H,{destroy:void 0},te===void 0?null:te)}function Il(A,O,H,te){var se=rn();te=te===void 0?null:te;var ue=se.memoizedState.inst;Li!==null&&te!==null&&mc(te,Li.memoizedState.deps)?se.memoizedState=po(O,H,ue,te):(yi.flags|=A,se.memoizedState=po(1|O,H,ue,te))}function Hh(A,O){Ml(8390656,8,A,O)}function Rc(A,O){Il(2048,8,A,O)}function zh(A,O){return Il(4,2,A,O)}function $h(A,O){return Il(4,4,A,O)}function Gh(A,O){if(typeof O=="function"){A=A();var H=O(A);return function(){typeof H=="function"?H():O(null)}}if(O!=null)return A=A(),O.current=A,function(){O.current=null}}function Wh(A,O,H){H=H!=null?H.concat([A]):null,Il(4,4,Gh.bind(null,O,A),H)}function kc(){}function Kh(A,O){var H=rn();O=O===void 0?null:O;var te=H.memoizedState;return O!==null&&mc(O,te[1])?te[0]:(H.memoizedState=[A,O],A)}function Jh(A,O){var H=rn();O=O===void 0?null:O;var te=H.memoizedState;if(O!==null&&mc(O,te[1]))return te[0];if(te=A(),Sa){Ce(!0);try{A()}finally{Ce(!1)}}return H.memoizedState=[te,O],te}function xc(A,O,H){return H===void 0||Br&1073741824?A.memoizedState=O:(A.memoizedState=H,A=Zf(),yi.lanes|=A,Wr|=A,H)}function Xh(A,O,H,te){return Tn(H,O)?H:oo.current!==null?(A=xc(A,H,te),Tn(A,O)||(cn=!0),A):Br&42?(A=Zf(),yi.lanes|=A,Wr|=A,O):(cn=!0,A.memoizedState=H)}function Yh(A,O,H,te,se){var ue=Je.p;Je.p=ue!==0&&8>ue?ue:8;var ye=Se.T,Te={};Se.T=Te,Mc(A,!1,O,H);try{var _e=se(),De=Se.S;if(De!==null&&De(Te,_e),_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var ut=Tm(_e,te);us(A,O,ut,_n(A))}else us(A,O,te,_n(A))}catch(Ht){us(A,O,{then:function(){},status:"rejected",reason:Ht},_n())}finally{Je.p=ue,Se.T=ye}}function Am(){}function _c(A,O,H,te){if(A.tag!==5)throw Error(R(476));var se=Zh(A).queue;Yh(A,se,O,Rt,H===null?Am:function(){return Qh(A),H(te)})}function Zh(A){var O=A.memoizedState;if(O!==null)return O;O={memoizedState:Rt,baseState:Rt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:dr,lastRenderedState:Rt},next:null};var H={};return O.next={memoizedState:H,baseState:H,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:dr,lastRenderedState:H},next:null},A.memoizedState=O,A=A.alternate,A!==null&&(A.memoizedState=O),O}function Qh(A){var O=Zh(A).next.queue;us(A,O,{},_n())}function Ac(){return bn(Ms)}function ef(){return rn().memoizedState}function tf(){return rn().memoizedState}function Mm(A){for(var O=A.return;O!==null;){switch(O.tag){case 24:case 3:var H=_n();A=Fr(H);var te=jr(O,A,H);te!==null&&(Sn(te,O,H),hs(te,O,H)),O={cache:hc()},A.payload=O;return}O=O.return}}function Im(A,O,H){var te=_n();H={lane:te,revertLane:0,action:H,hasEagerState:!1,eagerState:null,next:null},Pl(A)?rf(O,H):(H=ac(A,O,H,te),H!==null&&(Sn(H,A,te),af(H,O,te)))}function nf(A,O,H){var te=_n();us(A,O,H,te)}function us(A,O,H,te){var se={lane:te,revertLane:0,action:H,hasEagerState:!1,eagerState:null,next:null};if(Pl(A))rf(O,se);else{var ue=A.alternate;if(A.lanes===0&&(ue===null||ue.lanes===0)&&(ue=O.lastRenderedReducer,ue!==null))try{var ye=O.lastRenderedState,Te=ue(ye,H);if(se.hasEagerState=!0,se.eagerState=Te,Tn(Te,ye))return ml(A,O,se,0),Ui===null&&pl(),!1}catch{}finally{}if(H=ac(A,O,se,te),H!==null)return Sn(H,A,te),af(H,O,te),!0}return!1}function Mc(A,O,H,te){if(te={lane:2,revertLane:yd(),action:te,hasEagerState:!1,eagerState:null,next:null},Pl(A)){if(O)throw Error(R(479))}else O=ac(A,H,te,2),O!==null&&Sn(O,A,2)}function Pl(A){var O=A.alternate;return A===yi||O!==null&&O===yi}function rf(A,O){ho=Rl=!0;var H=A.pending;H===null?O.next=O:(O.next=H.next,H.next=O),A.pending=O}function af(A,O,H){if(H&4194176){var te=O.lanes;te&=A.pendingLanes,H|=te,O.lanes=H,Ni(A,H)}}var Qn={readContext:bn,use:_l,useCallback:Qi,useContext:Qi,useEffect:Qi,useImperativeHandle:Qi,useLayoutEffect:Qi,useInsertionEffect:Qi,useMemo:Qi,useReducer:Qi,useRef:Qi,useState:Qi,useDebugValue:Qi,useDeferredValue:Qi,useTransition:Qi,useSyncExternalStore:Qi,useId:Qi};Qn.useCacheRefresh=Qi,Qn.useMemoCache=Qi,Qn.useHostTransitionStatus=Qi,Qn.useFormState=Qi,Qn.useActionState=Qi,Qn.useOptimistic=Qi;var Ca={readContext:bn,use:_l,useCallback:function(A,O){return wn().memoizedState=[A,O===void 0?null:O],A},useContext:bn,useEffect:Hh,useImperativeHandle:function(A,O,H){H=H!=null?H.concat([A]):null,Ml(4194308,4,Gh.bind(null,O,A),H)},useLayoutEffect:function(A,O){return Ml(4194308,4,A,O)},useInsertionEffect:function(A,O){Ml(4,2,A,O)},useMemo:function(A,O){var H=wn();O=O===void 0?null:O;var te=A();if(Sa){Ce(!0);try{A()}finally{Ce(!1)}}return H.memoizedState=[te,O],te},useReducer:function(A,O,H){var te=wn();if(H!==void 0){var se=H(O);if(Sa){Ce(!0);try{H(O)}finally{Ce(!1)}}}else se=O;return te.memoizedState=te.baseState=se,A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:A,lastRenderedState:se},te.queue=A,A=A.dispatch=Im.bind(null,yi,A),[te.memoizedState,A]},useRef:function(A){var O=wn();return A={current:A},O.memoizedState=A},useState:function(A){A=wc(A);var O=A.queue,H=nf.bind(null,yi,O);return O.dispatch=H,[A.memoizedState,H]},useDebugValue:kc,useDeferredValue:function(A,O){var H=wn();return xc(H,A,O)},useTransition:function(){var A=wc(!1);return A=Yh.bind(null,yi,A.queue,!0,!1),wn().memoizedState=A,[!1,A]},useSyncExternalStore:function(A,O,H){var te=yi,se=wn();if(Mi){if(H===void 0)throw Error(R(407));H=H()}else{if(H=O(),Ui===null)throw Error(R(349));Ai&60||xh(te,O,H)}se.memoizedState=H;var ue={value:H,getSnapshot:O};return se.queue=ue,Hh(Ah.bind(null,te,ue,A),[A]),te.flags|=2048,po(9,_h.bind(null,te,ue,H,O),{destroy:void 0},null),H},useId:function(){var A=wn(),O=Ui.identifierPrefix;if(Mi){var H=ur,te=lr;H=(te&~(1<<32-ke(te)-1)).toString(32)+H,O=":"+O+"R"+H,H=kl++,0<H&&(O+="H"+H.toString(32)),O+=":"}else H=Rm++,O=":"+O+"r"+H.toString(32)+":";return A.memoizedState=O},useCacheRefresh:function(){return wn().memoizedState=Mm.bind(null,yi)}};Ca.useMemoCache=Sc,Ca.useHostTransitionStatus=Ac,Ca.useFormState=Lh,Ca.useActionState=Lh,Ca.useOptimistic=function(A){var O=wn();O.memoizedState=O.baseState=A;var H={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return O.queue=H,O=Mc.bind(null,yi,!0,H),H.dispatch=O,[A,O]};var Vr={readContext:bn,use:_l,useCallback:Kh,useContext:bn,useEffect:Rc,useImperativeHandle:Wh,useInsertionEffect:zh,useLayoutEffect:$h,useMemo:Jh,useReducer:Al,useRef:Uh,useState:function(){return Al(dr)},useDebugValue:kc,useDeferredValue:function(A,O){var H=rn();return Xh(H,Li.memoizedState,A,O)},useTransition:function(){var A=Al(dr)[0],O=rn().memoizedState;return[typeof A=="boolean"?A:ls(A),O]},useSyncExternalStore:kh,useId:ef};Vr.useCacheRefresh=tf,Vr.useMemoCache=Sc,Vr.useHostTransitionStatus=Ac,Vr.useFormState=Fh,Vr.useActionState=Fh,Vr.useOptimistic=function(A,O){var H=rn();return Ph(H,Li,A,O)};var Ea={readContext:bn,use:_l,useCallback:Kh,useContext:bn,useEffect:Rc,useImperativeHandle:Wh,useInsertionEffect:zh,useLayoutEffect:$h,useMemo:Jh,useReducer:Ec,useRef:Uh,useState:function(){return Ec(dr)},useDebugValue:kc,useDeferredValue:function(A,O){var H=rn();return Li===null?xc(H,A,O):Xh(H,Li.memoizedState,A,O)},useTransition:function(){var A=Ec(dr)[0],O=rn().memoizedState;return[typeof A=="boolean"?A:ls(A),O]},useSyncExternalStore:kh,useId:ef};Ea.useCacheRefresh=tf,Ea.useMemoCache=Sc,Ea.useHostTransitionStatus=Ac,Ea.useFormState=qh,Ea.useActionState=qh,Ea.useOptimistic=function(A,O){var H=rn();return Li!==null?Ph(H,Li,A,O):(H.baseState=A,[A,H.queue.dispatch])};function Ic(A,O,H,te){O=A.memoizedState,H=H(te,O),H=H==null?O:Re({},O,H),A.memoizedState=H,A.lanes===0&&(A.updateQueue.baseState=H)}var Pc={isMounted:function(A){return(A=A._reactInternals)?Xe(A)===A:!1},enqueueSetState:function(A,O,H){A=A._reactInternals;var te=_n(),se=Fr(te);se.payload=O,H!=null&&(se.callback=H),O=jr(A,se,te),O!==null&&(Sn(O,A,te),hs(O,A,te))},enqueueReplaceState:function(A,O,H){A=A._reactInternals;var te=_n(),se=Fr(te);se.tag=1,se.payload=O,H!=null&&(se.callback=H),O=jr(A,se,te),O!==null&&(Sn(O,A,te),hs(O,A,te))},enqueueForceUpdate:function(A,O){A=A._reactInternals;var H=_n(),te=Fr(H);te.tag=2,O!=null&&(te.callback=O),O=jr(A,te,H),O!==null&&(Sn(O,A,H),hs(O,A,H))}};function of(A,O,H,te,se,ue,ye){return A=A.stateNode,typeof A.shouldComponentUpdate=="function"?A.shouldComponentUpdate(te,ue,ye):O.prototype&&O.prototype.isPureReactComponent?!Jo(H,te)||!Jo(se,ue):!0}function sf(A,O,H,te){A=O.state,typeof O.componentWillReceiveProps=="function"&&O.componentWillReceiveProps(H,te),typeof O.UNSAFE_componentWillReceiveProps=="function"&&O.UNSAFE_componentWillReceiveProps(H,te),O.state!==A&&Pc.enqueueReplaceState(O,O.state,null)}function wa(A,O){var H=O;if("ref"in O){H={};for(var te in O)te!=="ref"&&(H[te]=O[te])}if(A=A.defaultProps){H===O&&(H=Re({},H));for(var se in A)H[se]===void 0&&(H[se]=A[se])}return H}var Ol=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function lf(A){Ol(A)}function uf(A){console.error(A)}function cf(A){Ol(A)}function Dl(A,O){try{var H=A.onUncaughtError;H(O.value,{componentStack:O.stack})}catch(te){setTimeout(function(){throw te})}}function df(A,O,H){try{var te=A.onCaughtError;te(H.value,{componentStack:H.stack,errorBoundary:O.tag===1?O.stateNode:null})}catch(se){setTimeout(function(){throw se})}}function Oc(A,O,H){return H=Fr(H),H.tag=3,H.payload={element:null},H.callback=function(){Dl(A,O)},H}function hf(A){return A=Fr(A),A.tag=3,A}function ff(A,O,H,te){var se=H.type.getDerivedStateFromError;if(typeof se=="function"){var ue=te.value;A.payload=function(){return se(ue)},A.callback=function(){df(O,H,te)}}var ye=H.stateNode;ye!==null&&typeof ye.componentDidCatch=="function"&&(A.callback=function(){df(O,H,te),typeof se!="function"&&(Kr===null?Kr=new Set([this]):Kr.add(this));var Te=te.stack;this.componentDidCatch(te.value,{componentStack:Te!==null?Te:""})})}function Pm(A,O,H,te,se){if(H.flags|=32768,te!==null&&typeof te=="object"&&typeof te.then=="function"){if(O=H.alternate,O!==null&&ds(O,H,se,!0),H=On.current,H!==null){switch(H.tag){case 13:return Zn===null?pd():H.alternate===null&&Yi===0&&(Yi=3),H.flags&=-257,H.flags|=65536,H.lanes=se,te===uc?H.flags|=16384:(O=H.updateQueue,O===null?H.updateQueue=new Set([te]):O.add(te),gd(A,te,se)),!1;case 22:return H.flags|=65536,te===uc?H.flags|=16384:(O=H.updateQueue,O===null?(O={transitions:null,markerInstances:null,retryQueue:new Set([te])},H.updateQueue=O):(H=O.retryQueue,H===null?O.retryQueue=new Set([te]):H.add(te)),gd(A,te,se)),!1}throw Error(R(435,H.tag))}return gd(A,te,se),pd(),!1}if(Mi)return O=On.current,O!==null?(!(O.flags&65536)&&(O.flags|=256),O.flags|=65536,O.lanes=se,te!==lc&&(A=Error(R(422),{cause:te}),Qo(Mn(A,H)))):(te!==lc&&(O=Error(R(423),{cause:te}),Qo(Mn(O,H))),A=A.current.alternate,A.flags|=65536,se&=-se,A.lanes|=se,te=Mn(te,H),se=Oc(A.stateNode,te,se),Kc(A,se),Yi!==4&&(Yi=2)),!1;var ue=Error(R(520),{cause:te});if(ue=Mn(ue,H),Ss===null?Ss=[ue]:Ss.push(ue),Yi!==4&&(Yi=2),O===null)return!0;te=Mn(te,H),H=O;do{switch(H.tag){case 3:return H.flags|=65536,A=se&-se,H.lanes|=A,A=Oc(H.stateNode,te,A),Kc(H,A),!1;case 1:if(O=H.type,ue=H.stateNode,(H.flags&128)===0&&(typeof O.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(Kr===null||!Kr.has(ue))))return H.flags|=65536,se&=-se,H.lanes|=se,se=hf(se),ff(se,A,H,te),Kc(H,se),!1}H=H.return}while(H!==null);return!1}var pf=Error(R(461)),cn=!1;function pn(A,O,H,te){O.child=A===null?bh(O,null,H,te):ba(O,A.child,H,te)}function mf(A,O,H,te,se){H=H.render;var ue=O.ref;if("ref"in te){var ye={};for(var Te in te)Te!=="ref"&&(ye[Te]=te[Te])}else ye=te;return Ra(O),te=gc(A,O,H,ye,ue,se),Te=vc(),A!==null&&!cn?(bc(A,O,se),hr(A,O,se)):(Mi&&Te&&oc(O),O.flags|=1,pn(A,O,te,se),O.child)}function gf(A,O,H,te,se){if(A===null){var ue=H.type;return typeof ue=="function"&&!id(ue)&&ue.defaultProps===void 0&&H.compare===null?(O.tag=15,O.type=ue,vf(A,O,ue,te,se)):(A=Fl(H.type,null,te,O,O.mode,se),A.ref=O.ref,A.return=O,O.child=A)}if(ue=A.child,!Uc(A,se)){var ye=ue.memoizedProps;if(H=H.compare,H=H!==null?H:Jo,H(ye,te)&&A.ref===O.ref)return hr(A,O,se)}return O.flags|=1,A=Gr(ue,te),A.ref=O.ref,A.return=O,O.child=A}function vf(A,O,H,te,se){if(A!==null){var ue=A.memoizedProps;if(Jo(ue,te)&&A.ref===O.ref)if(cn=!1,O.pendingProps=te=ue,Uc(A,se))A.flags&131072&&(cn=!0);else return O.lanes=A.lanes,hr(A,O,se)}return Dc(A,O,H,te,se)}function bf(A,O,H){var te=O.pendingProps,se=te.children,ue=(O.stateNode._pendingVisibility&2)!==0,ye=A!==null?A.memoizedState:null;if(cs(A,O),te.mode==="hidden"||ue){if(O.flags&128){if(te=ye!==null?ye.baseLanes|H:H,A!==null){for(se=O.child=A.child,ue=0;se!==null;)ue=ue|se.lanes|se.childLanes,se=se.sibling;O.childLanes=ue&~te}else O.childLanes=0,O.child=null;return yf(A,O,te,H)}if(H&536870912)O.memoizedState={baseLanes:0,cachePool:null},A!==null&&Tl(O,ye!==null?ye.cachePool:null),ye!==null?yh(O,ye):cc(),Sh(O);else return O.lanes=O.childLanes=536870912,yf(A,O,ye!==null?ye.baseLanes|H:H,H)}else ye!==null?(Tl(O,ye.cachePool),yh(O,ye),Dr(),O.memoizedState=null):(A!==null&&Tl(O,null),cc(),Dr());return pn(A,O,se,H),O.child}function yf(A,O,H,te){var se=pc();return se=se===null?null:{parent:ln._currentValue,pool:se},O.memoizedState={baseLanes:H,cachePool:se},A!==null&&Tl(O,null),cc(),Sh(O),A!==null&&ds(A,O,te,!0),null}function cs(A,O){var H=O.ref;if(H===null)A!==null&&A.ref!==null&&(O.flags|=2097664);else{if(typeof H!="function"&&typeof H!="object")throw Error(R(284));(A===null||A.ref!==H)&&(O.flags|=2097664)}}function Dc(A,O,H,te,se){return Ra(O),H=gc(A,O,H,te,void 0,se),te=vc(),A!==null&&!cn?(bc(A,O,se),hr(A,O,se)):(Mi&&te&&oc(O),O.flags|=1,pn(A,O,H,se),O.child)}function Sf(A,O,H,te,se,ue){return Ra(O),O.updateQueue=null,H=Rh(O,te,H,se),Th(A),te=vc(),A!==null&&!cn?(bc(A,O,ue),hr(A,O,ue)):(Mi&&te&&oc(O),O.flags|=1,pn(A,O,H,ue),O.child)}function Cf(A,O,H,te,se){if(Ra(O),O.stateNode===null){var ue=Za,ye=H.contextType;typeof ye=="object"&&ye!==null&&(ue=bn(ye)),ue=new H(te,ue),O.memoizedState=ue.state!==null&&ue.state!==void 0?ue.state:null,ue.updater=Pc,O.stateNode=ue,ue._reactInternals=O,ue=O.stateNode,ue.props=te,ue.state=O.memoizedState,ue.refs={},Gc(O),ye=H.contextType,ue.context=typeof ye=="object"&&ye!==null?bn(ye):Za,ue.state=O.memoizedState,ye=H.getDerivedStateFromProps,typeof ye=="function"&&(Ic(O,H,ye,te),ue.state=O.memoizedState),typeof H.getDerivedStateFromProps=="function"||typeof ue.getSnapshotBeforeUpdate=="function"||typeof ue.UNSAFE_componentWillMount!="function"&&typeof ue.componentWillMount!="function"||(ye=ue.state,typeof ue.componentWillMount=="function"&&ue.componentWillMount(),typeof ue.UNSAFE_componentWillMount=="function"&&ue.UNSAFE_componentWillMount(),ye!==ue.state&&Pc.enqueueReplaceState(ue,ue.state,null),ps(O,te,ue,se),fs(),ue.state=O.memoizedState),typeof ue.componentDidMount=="function"&&(O.flags|=4194308),te=!0}else if(A===null){ue=O.stateNode;var Te=O.memoizedProps,_e=wa(H,Te);ue.props=_e;var De=ue.context,ut=H.contextType;ye=Za,typeof ut=="object"&&ut!==null&&(ye=bn(ut));var Ht=H.getDerivedStateFromProps;ut=typeof Ht=="function"||typeof ue.getSnapshotBeforeUpdate=="function",Te=O.pendingProps!==Te,ut||typeof ue.UNSAFE_componentWillReceiveProps!="function"&&typeof ue.componentWillReceiveProps!="function"||(Te||De!==ye)&&sf(O,ue,te,ye),Lr=!1;var Ke=O.memoizedState;ue.state=Ke,ps(O,te,ue,se),fs(),De=O.memoizedState,Te||Ke!==De||Lr?(typeof Ht=="function"&&(Ic(O,H,Ht,te),De=O.memoizedState),(_e=Lr||of(O,H,_e,te,Ke,De,ye))?(ut||typeof ue.UNSAFE_componentWillMount!="function"&&typeof ue.componentWillMount!="function"||(typeof ue.componentWillMount=="function"&&ue.componentWillMount(),typeof ue.UNSAFE_componentWillMount=="function"&&ue.UNSAFE_componentWillMount()),typeof ue.componentDidMount=="function"&&(O.flags|=4194308)):(typeof ue.componentDidMount=="function"&&(O.flags|=4194308),O.memoizedProps=te,O.memoizedState=De),ue.props=te,ue.state=De,ue.context=ye,te=_e):(typeof ue.componentDidMount=="function"&&(O.flags|=4194308),te=!1)}else{ue=O.stateNode,Wc(A,O),ye=O.memoizedProps,ut=wa(H,ye),ue.props=ut,Ht=O.pendingProps,Ke=ue.context,De=H.contextType,_e=Za,typeof De=="object"&&De!==null&&(_e=bn(De)),Te=H.getDerivedStateFromProps,(De=typeof Te=="function"||typeof ue.getSnapshotBeforeUpdate=="function")||typeof ue.UNSAFE_componentWillReceiveProps!="function"&&typeof ue.componentWillReceiveProps!="function"||(ye!==Ht||Ke!==_e)&&sf(O,ue,te,_e),Lr=!1,Ke=O.memoizedState,ue.state=Ke,ps(O,te,ue,se),fs();var ot=O.memoizedState;ye!==Ht||Ke!==ot||Lr||A!==null&&A.dependencies!==null&&Bl(A.dependencies)?(typeof Te=="function"&&(Ic(O,H,Te,te),ot=O.memoizedState),(ut=Lr||of(O,H,ut,te,Ke,ot,_e)||A!==null&&A.dependencies!==null&&Bl(A.dependencies))?(De||typeof ue.UNSAFE_componentWillUpdate!="function"&&typeof ue.componentWillUpdate!="function"||(typeof ue.componentWillUpdate=="function"&&ue.componentWillUpdate(te,ot,_e),typeof ue.UNSAFE_componentWillUpdate=="function"&&ue.UNSAFE_componentWillUpdate(te,ot,_e)),typeof ue.componentDidUpdate=="function"&&(O.flags|=4),typeof ue.getSnapshotBeforeUpdate=="function"&&(O.flags|=1024)):(typeof ue.componentDidUpdate!="function"||ye===A.memoizedProps&&Ke===A.memoizedState||(O.flags|=4),typeof ue.getSnapshotBeforeUpdate!="function"||ye===A.memoizedProps&&Ke===A.memoizedState||(O.flags|=1024),O.memoizedProps=te,O.memoizedState=ot),ue.props=te,ue.state=ot,ue.context=_e,te=ut):(typeof ue.componentDidUpdate!="function"||ye===A.memoizedProps&&Ke===A.memoizedState||(O.flags|=4),typeof ue.getSnapshotBeforeUpdate!="function"||ye===A.memoizedProps&&Ke===A.memoizedState||(O.flags|=1024),te=!1)}return ue=te,cs(A,O),te=(O.flags&128)!==0,ue||te?(ue=O.stateNode,H=te&&typeof H.getDerivedStateFromError!="function"?null:ue.render(),O.flags|=1,A!==null&&te?(O.child=ba(O,A.child,null,se),O.child=ba(O,null,H,se)):pn(A,O,H,se),O.memoizedState=ue.state,A=O.child):A=hr(A,O,se),A}function Ef(A,O,H,te){return Zo(),O.flags|=256,pn(A,O,H,te),O.child}var Bc={dehydrated:null,treeContext:null,retryLane:0};function Vc(A){return{baseLanes:A,cachePool:wh()}}function Nc(A,O,H){return A=A!==null?A.childLanes&~H:0,O&&(A|=Nn),A}function wf(A,O,H){var te=O.pendingProps,se=!1,ue=(O.flags&128)!==0,ye;if((ye=ue)||(ye=A!==null&&A.memoizedState===null?!1:(sn.current&2)!==0),ye&&(se=!0,O.flags&=-129),ye=(O.flags&32)!==0,O.flags&=-33,A===null){if(Mi){if(se?Or(O):Dr(),Mi){var Te=fn,_e;if(_e=Te){e:{for(_e=Te,Te=Yn;_e.nodeType!==8;){if(!Te){Te=null;break e}if(_e=Wn(_e.nextSibling),_e===null){Te=null;break e}}Te=_e}Te!==null?(O.memoizedState={dehydrated:Te,treeContext:ma!==null?{id:lr,overflow:ur}:null,retryLane:536870912},_e=Vn(18,null,null,0),_e.stateNode=Te,_e.return=O,O.child=_e,yn=O,fn=null,_e=!0):_e=!1}_e||va(O)}if(Te=O.memoizedState,Te!==null&&(Te=Te.dehydrated,Te!==null))return Te.data==="$!"?O.lanes=16:O.lanes=536870912,null;cr(O)}return Te=te.children,te=te.fallback,se?(Dr(),se=O.mode,Te=Fc({mode:"hidden",children:Te},se),te=xa(te,se,H,null),Te.return=O,te.return=O,Te.sibling=te,O.child=Te,se=O.child,se.memoizedState=Vc(H),se.childLanes=Nc(A,ye,H),O.memoizedState=Bc,te):(Or(O),Lc(O,Te))}if(_e=A.memoizedState,_e!==null&&(Te=_e.dehydrated,Te!==null)){if(ue)O.flags&256?(Or(O),O.flags&=-257,O=jc(A,O,H)):O.memoizedState!==null?(Dr(),O.child=A.child,O.flags|=128,O=null):(Dr(),se=te.fallback,Te=O.mode,te=Fc({mode:"visible",children:te.children},Te),se=xa(se,Te,H,null),se.flags|=2,te.return=O,se.return=O,te.sibling=se,O.child=te,ba(O,A.child,null,H),te=O.child,te.memoizedState=Vc(H),te.childLanes=Nc(A,ye,H),O.memoizedState=Bc,O=se);else if(Or(O),Te.data==="$!"){if(ye=Te.nextSibling&&Te.nextSibling.dataset,ye)var De=ye.dgst;ye=De,te=Error(R(419)),te.stack="",te.digest=ye,Qo({value:te,source:null,stack:null}),O=jc(A,O,H)}else if(cn||ds(A,O,H,!1),ye=(H&A.childLanes)!==0,cn||ye){if(ye=Ui,ye!==null){if(te=H&-H,te&42)te=1;else switch(te){case 2:te=1;break;case 8:te=4;break;case 32:te=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:te=64;break;case 268435456:te=134217728;break;default:te=0}if(te=te&(ye.suspendedLanes|H)?0:te,te!==0&&te!==_e.retryLane)throw _e.retryLane=te,Pr(A,te),Sn(ye,A,te),pf}Te.data==="$?"||pd(),O=jc(A,O,H)}else Te.data==="$?"?(O.flags|=128,O.child=A.child,O=Wm.bind(null,A),Te._reactRetry=O,O=null):(A=_e.treeContext,fn=Wn(Te.nextSibling),yn=O,Mi=!0,$n=null,Yn=!1,A!==null&&(In[Pn++]=lr,In[Pn++]=ur,In[Pn++]=ma,lr=A.id,ur=A.overflow,ma=O),O=Lc(O,te.children),O.flags|=4096);return O}return se?(Dr(),se=te.fallback,Te=O.mode,_e=A.child,De=_e.sibling,te=Gr(_e,{mode:"hidden",children:te.children}),te.subtreeFlags=_e.subtreeFlags&31457280,De!==null?se=Gr(De,se):(se=xa(se,Te,H,null),se.flags|=2),se.return=O,te.return=O,te.sibling=se,O.child=te,te=se,se=O.child,Te=A.child.memoizedState,Te===null?Te=Vc(H):(_e=Te.cachePool,_e!==null?(De=ln._currentValue,_e=_e.parent!==De?{parent:De,pool:De}:_e):_e=wh(),Te={baseLanes:Te.baseLanes|H,cachePool:_e}),se.memoizedState=Te,se.childLanes=Nc(A,ye,H),O.memoizedState=Bc,te):(Or(O),H=A.child,A=H.sibling,H=Gr(H,{mode:"visible",children:te.children}),H.return=O,H.sibling=null,A!==null&&(ye=O.deletions,ye===null?(O.deletions=[A],O.flags|=16):ye.push(A)),O.child=H,O.memoizedState=null,H)}function Lc(A,O){return O=Fc({mode:"visible",children:O},A.mode),O.return=A,A.child=O}function Fc(A,O){return Jf(A,O,0,null)}function jc(A,O,H){return ba(O,A.child,null,H),A=Lc(O,O.pendingProps.children),A.flags|=2,O.memoizedState=null,A}function Tf(A,O,H){A.lanes|=O;var te=A.alternate;te!==null&&(te.lanes|=O),zc(A.return,O,H)}function qc(A,O,H,te,se){var ue=A.memoizedState;ue===null?A.memoizedState={isBackwards:O,rendering:null,renderingStartTime:0,last:te,tail:H,tailMode:se}:(ue.isBackwards=O,ue.rendering=null,ue.renderingStartTime=0,ue.last=te,ue.tail=H,ue.tailMode=se)}function Rf(A,O,H){var te=O.pendingProps,se=te.revealOrder,ue=te.tail;if(pn(A,O,te.children,H),te=sn.current,te&2)te=te&1|2,O.flags|=128;else{if(A!==null&&A.flags&128)e:for(A=O.child;A!==null;){if(A.tag===13)A.memoizedState!==null&&Tf(A,H,O);else if(A.tag===19)Tf(A,H,O);else if(A.child!==null){A.child.return=A,A=A.child;continue}if(A===O)break e;for(;A.sibling===null;){if(A.return===null||A.return===O)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}te&=1}switch(ri(sn,te),se){case"forwards":for(H=O.child,se=null;H!==null;)A=H.alternate,A!==null&&wl(A)===null&&(se=H),H=H.sibling;H=se,H===null?(se=O.child,O.child=null):(se=H.sibling,H.sibling=null),qc(O,!1,se,H,ue);break;case"backwards":for(H=null,se=O.child,O.child=null;se!==null;){if(A=se.alternate,A!==null&&wl(A)===null){O.child=se;break}A=se.sibling,se.sibling=H,H=se,se=A}qc(O,!0,H,null,ue);break;case"together":qc(O,!1,null,null,void 0);break;default:O.memoizedState=null}return O.child}function hr(A,O,H){if(A!==null&&(O.dependencies=A.dependencies),Wr|=O.lanes,!(H&O.childLanes))if(A!==null){if(ds(A,O,H,!1),(H&O.childLanes)===0)return null}else return null;if(A!==null&&O.child!==A.child)throw Error(R(153));if(O.child!==null){for(A=O.child,H=Gr(A,A.pendingProps),O.child=H,H.return=O;A.sibling!==null;)A=A.sibling,H=H.sibling=Gr(A,A.pendingProps),H.return=O;H.sibling=null}return O.child}function Uc(A,O){return A.lanes&O?!0:(A=A.dependencies,!!(A!==null&&Bl(A)))}function Om(A,O,H){switch(O.tag){case 3:vi(O,O.stateNode.containerInfo),Nr(O,ln,A.memoizedState.cache),Zo();break;case 27:case 5:Vi(O);break;case 4:vi(O,O.stateNode.containerInfo);break;case 10:Nr(O,O.type,O.memoizedProps.value);break;case 13:var te=O.memoizedState;if(te!==null)return te.dehydrated!==null?(Or(O),O.flags|=128,null):H&O.child.childLanes?wf(A,O,H):(Or(O),A=hr(A,O,H),A!==null?A.sibling:null);Or(O);break;case 19:var se=(A.flags&128)!==0;if(te=(H&O.childLanes)!==0,te||(ds(A,O,H,!1),te=(H&O.childLanes)!==0),se){if(te)return Rf(A,O,H);O.flags|=128}if(se=O.memoizedState,se!==null&&(se.rendering=null,se.tail=null,se.lastEffect=null),ri(sn,sn.current),te)break;return null;case 22:case 23:return O.lanes=0,bf(A,O,H);case 24:Nr(O,ln,A.memoizedState.cache)}return hr(A,O,H)}function kf(A,O,H){if(A!==null)if(A.memoizedProps!==O.pendingProps)cn=!0;else{if(!Uc(A,H)&&!(O.flags&128))return cn=!1,Om(A,O,H);cn=!!(A.flags&131072)}else cn=!1,Mi&&O.flags&1048576&&uh(O,bl,O.index);switch(O.lanes=0,O.tag){case 16:e:{A=O.pendingProps;var te=O.elementType,se=te._init;if(te=se(te._payload),O.type=te,typeof te=="function")id(te)?(A=wa(te,A),O.tag=1,O=Cf(null,O,te,A,H)):(O.tag=0,O=Dc(null,O,te,A,H));else{if(te!=null){if(se=te.$$typeof,se===re){O.tag=11,O=mf(null,O,te,A,H);break e}else if(se===le){O.tag=14,O=gf(null,O,te,A,H);break e}}throw O=be(te)||te,Error(R(306,O,""))}}return O;case 0:return Dc(A,O,O.type,O.pendingProps,H);case 1:return te=O.type,se=wa(te,O.pendingProps),Cf(A,O,te,se,H);case 3:e:{if(vi(O,O.stateNode.containerInfo),A===null)throw Error(R(387));var ue=O.pendingProps;se=O.memoizedState,te=se.element,Wc(A,O),ps(O,ue,null,H);var ye=O.memoizedState;if(ue=ye.cache,Nr(O,ln,ue),ue!==se.cache&&$c(O,[ln],H,!0),fs(),ue=ye.element,se.isDehydrated)if(se={element:ue,isDehydrated:!1,cache:ye.cache},O.updateQueue.baseState=se,O.memoizedState=se,O.flags&256){O=Ef(A,O,ue,H);break e}else if(ue!==te){te=Mn(Error(R(424)),O),Qo(te),O=Ef(A,O,ue,H);break e}else for(fn=Wn(O.stateNode.containerInfo.firstChild),yn=O,Mi=!0,$n=null,Yn=!0,H=bh(O,null,ue,H),O.child=H;H;)H.flags=H.flags&-3|4096,H=H.sibling;else{if(Zo(),ue===te){O=hr(A,O,H);break e}pn(A,O,ue,H)}O=O.child}return O;case 26:return cs(A,O),A===null?(H=Mp(O.type,null,O.pendingProps,null))?O.memoizedState=H:Mi||(H=O.type,A=O.pendingProps,te=Yl(Ci.current).createElement(H),te[_i]=O,te[Ei]=A,mn(te,H,A),tn(te),O.stateNode=te):O.memoizedState=Mp(O.type,A.memoizedProps,O.pendingProps,A.memoizedState),null;case 27:return Vi(O),A===null&&Mi&&(te=O.stateNode=kp(O.type,O.pendingProps,Ci.current),yn=O,Yn=!0,fn=Wn(te.firstChild)),te=O.pendingProps.children,A!==null||Mi?pn(A,O,te,H):O.child=ba(O,null,te,H),cs(A,O),O.child;case 5:return A===null&&Mi&&((se=te=fn)&&(te=ug(te,O.type,O.pendingProps,Yn),te!==null?(O.stateNode=te,yn=O,fn=Wn(te.firstChild),Yn=!1,se=!0):se=!1),se||va(O)),Vi(O),se=O.type,ue=O.pendingProps,ye=A!==null?A.memoizedProps:null,te=ue.children,_d(se,ue)?te=null:ye!==null&&_d(se,ye)&&(O.flags|=32),O.memoizedState!==null&&(se=gc(A,O,km,null,null,H),Ms._currentValue=se),cs(A,O),pn(A,O,te,H),O.child;case 6:return A===null&&Mi&&((A=H=fn)&&(H=cg(H,O.pendingProps,Yn),H!==null?(O.stateNode=H,yn=O,fn=null,A=!0):A=!1),A||va(O)),null;case 13:return wf(A,O,H);case 4:return vi(O,O.stateNode.containerInfo),te=O.pendingProps,A===null?O.child=ba(O,null,te,H):pn(A,O,te,H),O.child;case 11:return mf(A,O,O.type,O.pendingProps,H);case 7:return pn(A,O,O.pendingProps,H),O.child;case 8:return pn(A,O,O.pendingProps.children,H),O.child;case 12:return pn(A,O,O.pendingProps.children,H),O.child;case 10:return te=O.pendingProps,Nr(O,O.type,te.value),pn(A,O,te.children,H),O.child;case 9:return se=O.type._context,te=O.pendingProps.children,Ra(O),se=bn(se),te=te(se),O.flags|=1,pn(A,O,te,H),O.child;case 14:return gf(A,O,O.type,O.pendingProps,H);case 15:return vf(A,O,O.type,O.pendingProps,H);case 19:return Rf(A,O,H);case 22:return bf(A,O,H);case 24:return Ra(O),te=bn(ln),A===null?(se=pc(),se===null&&(se=Ui,ue=hc(),se.pooledCache=ue,ue.refCount++,ue!==null&&(se.pooledCacheLanes|=H),se=ue),O.memoizedState={parent:te,cache:se},Gc(O),Nr(O,ln,se)):(A.lanes&H&&(Wc(A,O),ps(O,null,null,H),fs()),se=A.memoizedState,ue=O.memoizedState,se.parent!==te?(se={parent:te,cache:te},O.memoizedState=se,O.lanes===0&&(O.memoizedState=O.updateQueue.baseState=se),Nr(O,ln,te)):(te=ue.cache,Nr(O,ln,te),te!==se.cache&&$c(O,[ln],H,!0))),pn(A,O,O.pendingProps.children,H),O.child;case 29:throw O.pendingProps}throw Error(R(156,O.tag))}var Hc=Jt(null),Ta=null,fr=null;function Nr(A,O,H){ri(Hc,O._currentValue),O._currentValue=H}function pr(A){A._currentValue=Hc.current,si(Hc)}function zc(A,O,H){for(;A!==null;){var te=A.alternate;if((A.childLanes&O)!==O?(A.childLanes|=O,te!==null&&(te.childLanes|=O)):te!==null&&(te.childLanes&O)!==O&&(te.childLanes|=O),A===H)break;A=A.return}}function $c(A,O,H,te){var se=A.child;for(se!==null&&(se.return=A);se!==null;){var ue=se.dependencies;if(ue!==null){var ye=se.child;ue=ue.firstContext;e:for(;ue!==null;){var Te=ue;ue=se;for(var _e=0;_e<O.length;_e++)if(Te.context===O[_e]){ue.lanes|=H,Te=ue.alternate,Te!==null&&(Te.lanes|=H),zc(ue.return,H,A),te||(ye=null);break e}ue=Te.next}}else if(se.tag===18){if(ye=se.return,ye===null)throw Error(R(341));ye.lanes|=H,ue=ye.alternate,ue!==null&&(ue.lanes|=H),zc(ye,H,A),ye=null}else ye=se.child;if(ye!==null)ye.return=se;else for(ye=se;ye!==null;){if(ye===A){ye=null;break}if(se=ye.sibling,se!==null){se.return=ye.return,ye=se;break}ye=ye.return}se=ye}}function ds(A,O,H,te){A=null;for(var se=O,ue=!1;se!==null;){if(!ue){if(se.flags&524288)ue=!0;else if(se.flags&262144)break}if(se.tag===10){var ye=se.alternate;if(ye===null)throw Error(R(387));if(ye=ye.memoizedProps,ye!==null){var Te=se.type;Tn(se.pendingProps.value,ye.value)||(A!==null?A.push(Te):A=[Te])}}else if(se===qi.current){if(ye=se.alternate,ye===null)throw Error(R(387));ye.memoizedState.memoizedState!==se.memoizedState.memoizedState&&(A!==null?A.push(Ms):A=[Ms])}se=se.return}A!==null&&$c(O,A,H,te),O.flags|=262144}function Bl(A){for(A=A.firstContext;A!==null;){if(!Tn(A.context._currentValue,A.memoizedValue))return!0;A=A.next}return!1}function Ra(A){Ta=A,fr=null,A=A.dependencies,A!==null&&(A.firstContext=null)}function bn(A){return xf(Ta,A)}function Vl(A,O){return Ta===null&&Ra(A),xf(A,O)}function xf(A,O){var H=O._currentValue;if(O={context:O,memoizedValue:H,next:null},fr===null){if(A===null)throw Error(R(308));fr=O,A.dependencies={lanes:0,firstContext:O},A.flags|=524288}else fr=fr.next=O;return H}var Lr=!1;function Gc(A){A.updateQueue={baseState:A.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wc(A,O){A=A.updateQueue,O.updateQueue===A&&(O.updateQueue={baseState:A.baseState,firstBaseUpdate:A.firstBaseUpdate,lastBaseUpdate:A.lastBaseUpdate,shared:A.shared,callbacks:null})}function Fr(A){return{lane:A,tag:0,payload:null,callback:null,next:null}}function jr(A,O,H){var te=A.updateQueue;if(te===null)return null;if(te=te.shared,Gi&2){var se=te.pending;return se===null?O.next=O:(O.next=se.next,se.next=O),te.pending=O,O=gl(A),sh(A,null,H),O}return ml(A,te,O,H),gl(A)}function hs(A,O,H){if(O=O.updateQueue,O!==null&&(O=O.shared,(H&4194176)!==0)){var te=O.lanes;te&=A.pendingLanes,H|=te,O.lanes=H,Ni(A,H)}}function Kc(A,O){var H=A.updateQueue,te=A.alternate;if(te!==null&&(te=te.updateQueue,H===te)){var se=null,ue=null;if(H=H.firstBaseUpdate,H!==null){do{var ye={lane:H.lane,tag:H.tag,payload:H.payload,callback:null,next:null};ue===null?se=ue=ye:ue=ue.next=ye,H=H.next}while(H!==null);ue===null?se=ue=O:ue=ue.next=O}else se=ue=O;H={baseState:te.baseState,firstBaseUpdate:se,lastBaseUpdate:ue,shared:te.shared,callbacks:te.callbacks},A.updateQueue=H;return}A=H.lastBaseUpdate,A===null?H.firstBaseUpdate=O:A.next=O,H.lastBaseUpdate=O}var Jc=!1;function fs(){if(Jc){var A=co;if(A!==null)throw A}}function ps(A,O,H,te){Jc=!1;var se=A.updateQueue;Lr=!1;var ue=se.firstBaseUpdate,ye=se.lastBaseUpdate,Te=se.shared.pending;if(Te!==null){se.shared.pending=null;var _e=Te,De=_e.next;_e.next=null,ye===null?ue=De:ye.next=De,ye=_e;var ut=A.alternate;ut!==null&&(ut=ut.updateQueue,Te=ut.lastBaseUpdate,Te!==ye&&(Te===null?ut.firstBaseUpdate=De:Te.next=De,ut.lastBaseUpdate=_e))}if(ue!==null){var Ht=se.baseState;ye=0,ut=De=_e=null,Te=ue;do{var Ke=Te.lane&-536870913,ot=Ke!==Te.lane;if(ot?(Ai&Ke)===Ke:(te&Ke)===Ke){Ke!==0&&Ke===uo&&(Jc=!0),ut!==null&&(ut=ut.next={lane:0,tag:Te.tag,payload:Te.payload,callback:null,next:null});e:{var ui=A,gi=Te;Ke=O;var Zi=H;switch(gi.tag){case 1:if(ui=gi.payload,typeof ui=="function"){Ht=ui.call(Zi,Ht,Ke);break e}Ht=ui;break e;case 3:ui.flags=ui.flags&-65537|128;case 0:if(ui=gi.payload,Ke=typeof ui=="function"?ui.call(Zi,Ht,Ke):ui,Ke==null)break e;Ht=Re({},Ht,Ke);break e;case 2:Lr=!0}}Ke=Te.callback,Ke!==null&&(A.flags|=64,ot&&(A.flags|=8192),ot=se.callbacks,ot===null?se.callbacks=[Ke]:ot.push(Ke))}else ot={lane:Ke,tag:Te.tag,payload:Te.payload,callback:Te.callback,next:null},ut===null?(De=ut=ot,_e=Ht):ut=ut.next=ot,ye|=Ke;if(Te=Te.next,Te===null){if(Te=se.shared.pending,Te===null)break;ot=Te,Te=ot.next,ot.next=null,se.lastBaseUpdate=ot,se.shared.pending=null}}while(!0);ut===null&&(_e=Ht),se.baseState=_e,se.firstBaseUpdate=De,se.lastBaseUpdate=ut,ue===null&&(se.shared.lanes=0),Wr|=ye,A.lanes=ye,A.memoizedState=Ht}}function _f(A,O){if(typeof A!="function")throw Error(R(191,A));A.call(O)}function Af(A,O){var H=A.callbacks;if(H!==null)for(A.callbacks=null,A=0;A<H.length;A++)_f(H[A],O)}function ms(A,O){try{var H=O.updateQueue,te=H!==null?H.lastEffect:null;if(te!==null){var se=te.next;H=se;do{if((H.tag&A)===A){te=void 0;var ue=H.create,ye=H.inst;te=ue(),ye.destroy=te}H=H.next}while(H!==se)}}catch(Te){ji(O,O.return,Te)}}function qr(A,O,H){try{var te=O.updateQueue,se=te!==null?te.lastEffect:null;if(se!==null){var ue=se.next;te=ue;do{if((te.tag&A)===A){var ye=te.inst,Te=ye.destroy;if(Te!==void 0){ye.destroy=void 0,se=O;var _e=H;try{Te()}catch(De){ji(se,_e,De)}}}te=te.next}while(te!==ue)}}catch(De){ji(O,O.return,De)}}function Mf(A){var O=A.updateQueue;if(O!==null){var H=A.stateNode;try{Af(O,H)}catch(te){ji(A,A.return,te)}}}function If(A,O,H){H.props=wa(A.type,A.memoizedProps),H.state=A.memoizedState;try{H.componentWillUnmount()}catch(te){ji(A,O,te)}}function ka(A,O){try{var H=A.ref;if(H!==null){var te=A.stateNode;switch(A.tag){case 26:case 27:case 5:var se=te;break;default:se=te}typeof H=="function"?A.refCleanup=H(se):H.current=se}}catch(ue){ji(A,O,ue)}}function Rn(A,O){var H=A.ref,te=A.refCleanup;if(H!==null)if(typeof te=="function")try{te()}catch(se){ji(A,O,se)}finally{A.refCleanup=null,A=A.alternate,A!=null&&(A.refCleanup=null)}else if(typeof H=="function")try{H(null)}catch(se){ji(A,O,se)}else H.current=null}function Pf(A){var O=A.type,H=A.memoizedProps,te=A.stateNode;try{e:switch(O){case"button":case"input":case"select":case"textarea":H.autoFocus&&te.focus();break e;case"img":H.src?te.src=H.src:H.srcSet&&(te.srcset=H.srcSet)}}catch(se){ji(A,A.return,se)}}function Of(A,O,H){try{var te=A.stateNode;rg(te,A.type,H,O),te[Ei]=O}catch(se){ji(A,A.return,se)}}function Df(A){return A.tag===5||A.tag===3||A.tag===26||A.tag===27||A.tag===4}function Xc(A){e:for(;;){for(;A.sibling===null;){if(A.return===null||Df(A.return))return null;A=A.return}for(A.sibling.return=A.return,A=A.sibling;A.tag!==5&&A.tag!==6&&A.tag!==27&&A.tag!==18;){if(A.flags&2||A.child===null||A.tag===4)continue e;A.child.return=A,A=A.child}if(!(A.flags&2))return A.stateNode}}function Yc(A,O,H){var te=A.tag;if(te===5||te===6)A=A.stateNode,O?H.nodeType===8?H.parentNode.insertBefore(A,O):H.insertBefore(A,O):(H.nodeType===8?(O=H.parentNode,O.insertBefore(A,H)):(O=H,O.appendChild(A)),H=H._reactRootContainer,H!=null||O.onclick!==null||(O.onclick=Xl));else if(te!==4&&te!==27&&(A=A.child,A!==null))for(Yc(A,O,H),A=A.sibling;A!==null;)Yc(A,O,H),A=A.sibling}function Nl(A,O,H){var te=A.tag;if(te===5||te===6)A=A.stateNode,O?H.insertBefore(A,O):H.appendChild(A);else if(te!==4&&te!==27&&(A=A.child,A!==null))for(Nl(A,O,H),A=A.sibling;A!==null;)Nl(A,O,H),A=A.sibling}var mr=!1,Xi=!1,Zc=!1,Bf=typeof WeakSet=="function"?WeakSet:Set,dn=null,Vf=!1;function Dm(A,O){if(A=A.containerInfo,kd=nu,A=Zd(A),ec(A)){if("selectionStart"in A)var H={start:A.selectionStart,end:A.selectionEnd};else e:{H=(H=A.ownerDocument)&&H.defaultView||window;var te=H.getSelection&&H.getSelection();if(te&&te.rangeCount!==0){H=te.anchorNode;var se=te.anchorOffset,ue=te.focusNode;te=te.focusOffset;try{H.nodeType,ue.nodeType}catch{H=null;break e}var ye=0,Te=-1,_e=-1,De=0,ut=0,Ht=A,Ke=null;t:for(;;){for(var ot;Ht!==H||se!==0&&Ht.nodeType!==3||(Te=ye+se),Ht!==ue||te!==0&&Ht.nodeType!==3||(_e=ye+te),Ht.nodeType===3&&(ye+=Ht.nodeValue.length),(ot=Ht.firstChild)!==null;)Ke=Ht,Ht=ot;for(;;){if(Ht===A)break t;if(Ke===H&&++De===se&&(Te=ye),Ke===ue&&++ut===te&&(_e=ye),(ot=Ht.nextSibling)!==null)break;Ht=Ke,Ke=Ht.parentNode}Ht=ot}H=Te===-1||_e===-1?null:{start:Te,end:_e}}else H=null}H=H||{start:0,end:0}}else H=null;for(xd={focusedElem:A,selectionRange:H},nu=!1,dn=O;dn!==null;)if(O=dn,A=O.child,(O.subtreeFlags&1028)!==0&&A!==null)A.return=O,dn=A;else for(;dn!==null;){switch(O=dn,ue=O.alternate,A=O.flags,O.tag){case 0:break;case 11:case 15:break;case 1:if(A&1024&&ue!==null){A=void 0,H=O,se=ue.memoizedProps,ue=ue.memoizedState,te=H.stateNode;try{var ui=wa(H.type,se,H.elementType===H.type);A=te.getSnapshotBeforeUpdate(ui,ue),te.__reactInternalSnapshotBeforeUpdate=A}catch(gi){ji(H,H.return,gi)}}break;case 3:if(A&1024){if(A=O.stateNode.containerInfo,H=A.nodeType,H===9)Id(A);else if(H===1)switch(A.nodeName){case"HEAD":case"HTML":case"BODY":Id(A);break;default:A.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(A&1024)throw Error(R(163))}if(A=O.sibling,A!==null){A.return=O.return,dn=A;break}dn=O.return}return ui=Vf,Vf=!1,ui}function Nf(A,O,H){var te=H.flags;switch(H.tag){case 0:case 11:case 15:vr(A,H),te&4&&ms(5,H);break;case 1:if(vr(A,H),te&4)if(A=H.stateNode,O===null)try{A.componentDidMount()}catch(Te){ji(H,H.return,Te)}else{var se=wa(H.type,O.memoizedProps);O=O.memoizedState;try{A.componentDidUpdate(se,O,A.__reactInternalSnapshotBeforeUpdate)}catch(Te){ji(H,H.return,Te)}}te&64&&Mf(H),te&512&&ka(H,H.return);break;case 3:if(vr(A,H),te&64&&(te=H.updateQueue,te!==null)){if(A=null,H.child!==null)switch(H.child.tag){case 27:case 5:A=H.child.stateNode;break;case 1:A=H.child.stateNode}try{Af(te,A)}catch(Te){ji(H,H.return,Te)}}break;case 26:vr(A,H),te&512&&ka(H,H.return);break;case 27:case 5:vr(A,H),O===null&&te&4&&Pf(H),te&512&&ka(H,H.return);break;case 12:vr(A,H);break;case 13:vr(A,H),te&4&&jf(A,H);break;case 22:if(se=H.memoizedState!==null||mr,!se){O=O!==null&&O.memoizedState!==null||Xi;var ue=mr,ye=Xi;mr=se,(Xi=O)&&!ye?zr(A,H,(H.subtreeFlags&8772)!==0):vr(A,H),mr=ue,Xi=ye}te&512&&(H.memoizedProps.mode==="manual"?ka(H,H.return):Rn(H,H.return));break;default:vr(A,H)}}function Lf(A){var O=A.alternate;O!==null&&(A.alternate=null,Lf(O)),A.child=null,A.deletions=null,A.sibling=null,A.tag===5&&(O=A.stateNode,O!==null&&Do(O)),A.stateNode=null,A.return=null,A.dependencies=null,A.memoizedProps=null,A.memoizedState=null,A.pendingProps=null,A.stateNode=null,A.updateQueue=null}var an=null,kn=!1;function gr(A,O,H){for(H=H.child;H!==null;)Ff(A,O,H),H=H.sibling}function Ff(A,O,H){if(Ie&&typeof Ie.onCommitFiberUnmount=="function")try{Ie.onCommitFiberUnmount(ft,H)}catch{}switch(H.tag){case 26:Xi||Rn(H,O),gr(A,O,H),H.memoizedState?H.memoizedState.count--:H.stateNode&&(H=H.stateNode,H.parentNode.removeChild(H));break;case 27:Xi||Rn(H,O);var te=an,se=kn;for(an=H.stateNode,gr(A,O,H),H=H.stateNode,O=H.attributes;O.length;)H.removeAttributeNode(O[0]);Do(H),an=te,kn=se;break;case 5:Xi||Rn(H,O);case 6:se=an;var ue=kn;if(an=null,gr(A,O,H),an=se,kn=ue,an!==null)if(kn)try{A=an,te=H.stateNode,A.nodeType===8?A.parentNode.removeChild(te):A.removeChild(te)}catch(ye){ji(H,O,ye)}else try{an.removeChild(H.stateNode)}catch(ye){ji(H,O,ye)}break;case 18:an!==null&&(kn?(O=an,H=H.stateNode,O.nodeType===8?Md(O.parentNode,H):O.nodeType===1&&Md(O,H),Ds(O)):Md(an,H.stateNode));break;case 4:te=an,se=kn,an=H.stateNode.containerInfo,kn=!0,gr(A,O,H),an=te,kn=se;break;case 0:case 11:case 14:case 15:Xi||qr(2,H,O),Xi||qr(4,H,O),gr(A,O,H);break;case 1:Xi||(Rn(H,O),te=H.stateNode,typeof te.componentWillUnmount=="function"&&If(H,O,te)),gr(A,O,H);break;case 21:gr(A,O,H);break;case 22:Xi||Rn(H,O),Xi=(te=Xi)||H.memoizedState!==null,gr(A,O,H),Xi=te;break;default:gr(A,O,H)}}function jf(A,O){if(O.memoizedState===null&&(A=O.alternate,A!==null&&(A=A.memoizedState,A!==null&&(A=A.dehydrated,A!==null))))try{Ds(A)}catch(H){ji(O,O.return,H)}}function Bm(A){switch(A.tag){case 13:case 19:var O=A.stateNode;return O===null&&(O=A.stateNode=new Bf),O;case 22:return A=A.stateNode,O=A._retryCache,O===null&&(O=A._retryCache=new Bf),O;default:throw Error(R(435,A.tag))}}function Qc(A,O){var H=Bm(A);O.forEach(function(te){var se=Km.bind(null,A,te);H.has(te)||(H.add(te),te.then(se,se))})}function Dn(A,O){var H=O.deletions;if(H!==null)for(var te=0;te<H.length;te++){var se=H[te],ue=A,ye=O,Te=ye;e:for(;Te!==null;){switch(Te.tag){case 27:case 5:an=Te.stateNode,kn=!1;break e;case 3:an=Te.stateNode.containerInfo,kn=!0;break e;case 4:an=Te.stateNode.containerInfo,kn=!0;break e}Te=Te.return}if(an===null)throw Error(R(160));Ff(ue,ye,se),an=null,kn=!1,ue=se.alternate,ue!==null&&(ue.return=null),se.return=null}if(O.subtreeFlags&13878)for(O=O.child;O!==null;)qf(O,A),O=O.sibling}var Gn=null;function qf(A,O){var H=A.alternate,te=A.flags;switch(A.tag){case 0:case 11:case 14:case 15:Dn(O,A),Bn(A),te&4&&(qr(3,A,A.return),ms(3,A),qr(5,A,A.return));break;case 1:Dn(O,A),Bn(A),te&512&&(Xi||H===null||Rn(H,H.return)),te&64&&mr&&(A=A.updateQueue,A!==null&&(te=A.callbacks,te!==null&&(H=A.shared.hiddenCallbacks,A.shared.hiddenCallbacks=H===null?te:H.concat(te))));break;case 26:var se=Gn;if(Dn(O,A),Bn(A),te&512&&(Xi||H===null||Rn(H,H.return)),te&4){var ue=H!==null?H.memoizedState:null;if(te=A.memoizedState,H===null)if(te===null)if(A.stateNode===null){e:{te=A.type,H=A.memoizedProps,se=se.ownerDocument||se;t:switch(te){case"title":ue=se.getElementsByTagName("title")[0],(!ue||ue[ia]||ue[_i]||ue.namespaceURI==="http://www.w3.org/2000/svg"||ue.hasAttribute("itemprop"))&&(ue=se.createElement(te),se.head.insertBefore(ue,se.querySelector("head > title"))),mn(ue,te,H),ue[_i]=A,tn(ue),te=ue;break e;case"link":var ye=Op("link","href",se).get(te+(H.href||""));if(ye){for(var Te=0;Te<ye.length;Te++)if(ue=ye[Te],ue.getAttribute("href")===(H.href==null?null:H.href)&&ue.getAttribute("rel")===(H.rel==null?null:H.rel)&&ue.getAttribute("title")===(H.title==null?null:H.title)&&ue.getAttribute("crossorigin")===(H.crossOrigin==null?null:H.crossOrigin)){ye.splice(Te,1);break t}}ue=se.createElement(te),mn(ue,te,H),se.head.appendChild(ue);break;case"meta":if(ye=Op("meta","content",se).get(te+(H.content||""))){for(Te=0;Te<ye.length;Te++)if(ue=ye[Te],ue.getAttribute("content")===(H.content==null?null:""+H.content)&&ue.getAttribute("name")===(H.name==null?null:H.name)&&ue.getAttribute("property")===(H.property==null?null:H.property)&&ue.getAttribute("http-equiv")===(H.httpEquiv==null?null:H.httpEquiv)&&ue.getAttribute("charset")===(H.charSet==null?null:H.charSet)){ye.splice(Te,1);break t}}ue=se.createElement(te),mn(ue,te,H),se.head.appendChild(ue);break;default:throw Error(R(468,te))}ue[_i]=A,tn(ue),te=ue}A.stateNode=te}else Dp(se,A.type,A.stateNode);else A.stateNode=Pp(se,te,A.memoizedProps);else ue!==te?(ue===null?H.stateNode!==null&&(H=H.stateNode,H.parentNode.removeChild(H)):ue.count--,te===null?Dp(se,A.type,A.stateNode):Pp(se,te,A.memoizedProps)):te===null&&A.stateNode!==null&&Of(A,A.memoizedProps,H.memoizedProps)}break;case 27:if(te&4&&A.alternate===null){se=A.stateNode,ue=A.memoizedProps;try{for(var _e=se.firstChild;_e;){var De=_e.nextSibling,ut=_e.nodeName;_e[ia]||ut==="HEAD"||ut==="BODY"||ut==="SCRIPT"||ut==="STYLE"||ut==="LINK"&&_e.rel.toLowerCase()==="stylesheet"||se.removeChild(_e),_e=De}for(var Ht=A.type,Ke=se.attributes;Ke.length;)se.removeAttributeNode(Ke[0]);mn(se,Ht,ue),se[_i]=A,se[Ei]=ue}catch(ui){ji(A,A.return,ui)}}case 5:if(Dn(O,A),Bn(A),te&512&&(Xi||H===null||Rn(H,H.return)),A.flags&32){se=A.stateNode;try{_r(se,"")}catch(ui){ji(A,A.return,ui)}}te&4&&A.stateNode!=null&&(se=A.memoizedProps,Of(A,se,H!==null?H.memoizedProps:se)),te&1024&&(Zc=!0);break;case 6:if(Dn(O,A),Bn(A),te&4){if(A.stateNode===null)throw Error(R(162));te=A.memoizedProps,H=A.stateNode;try{H.nodeValue=te}catch(ui){ji(A,A.return,ui)}}break;case 3:if(eu=null,se=Gn,Gn=Zl(O.containerInfo),Dn(O,A),Gn=se,Bn(A),te&4&&H!==null&&H.memoizedState.isDehydrated)try{Ds(O.containerInfo)}catch(ui){ji(A,A.return,ui)}Zc&&(Zc=!1,Uf(A));break;case 4:te=Gn,Gn=Zl(A.stateNode.containerInfo),Dn(O,A),Bn(A),Gn=te;break;case 12:Dn(O,A),Bn(A);break;case 13:Dn(O,A),Bn(A),A.child.flags&8192&&A.memoizedState!==null!=(H!==null&&H.memoizedState!==null)&&(ld=Bi()),te&4&&(te=A.updateQueue,te!==null&&(A.updateQueue=null,Qc(A,te)));break;case 22:if(te&512&&(Xi||H===null||Rn(H,H.return)),_e=A.memoizedState!==null,De=H!==null&&H.memoizedState!==null,ut=mr,Ht=Xi,mr=ut||_e,Xi=Ht||De,Dn(O,A),Xi=Ht,mr=ut,Bn(A),O=A.stateNode,O._current=A,O._visibility&=-3,O._visibility|=O._pendingVisibility&2,te&8192&&(O._visibility=_e?O._visibility&-2:O._visibility|1,_e&&(O=mr||Xi,H===null||De||O||mo(A)),A.memoizedProps===null||A.memoizedProps.mode!=="manual"))e:for(H=null,O=A;;){if(O.tag===5||O.tag===26||O.tag===27){if(H===null){De=H=O;try{if(se=De.stateNode,_e)ue=se.style,typeof ue.setProperty=="function"?ue.setProperty("display","none","important"):ue.display="none";else{ye=De.stateNode,Te=De.memoizedProps.style;var ot=Te!=null&&Te.hasOwnProperty("display")?Te.display:null;ye.style.display=ot==null||typeof ot=="boolean"?"":(""+ot).trim()}}catch(ui){ji(De,De.return,ui)}}}else if(O.tag===6){if(H===null){De=O;try{De.stateNode.nodeValue=_e?"":De.memoizedProps}catch(ui){ji(De,De.return,ui)}}}else if((O.tag!==22&&O.tag!==23||O.memoizedState===null||O===A)&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===A)break e;for(;O.sibling===null;){if(O.return===null||O.return===A)break e;H===O&&(H=null),O=O.return}H===O&&(H=null),O.sibling.return=O.return,O=O.sibling}te&4&&(te=A.updateQueue,te!==null&&(H=te.retryQueue,H!==null&&(te.retryQueue=null,Qc(A,H))));break;case 19:Dn(O,A),Bn(A),te&4&&(te=A.updateQueue,te!==null&&(A.updateQueue=null,Qc(A,te)));break;case 21:break;default:Dn(O,A),Bn(A)}}function Bn(A){var O=A.flags;if(O&2){try{if(A.tag!==27){e:{for(var H=A.return;H!==null;){if(Df(H)){var te=H;break e}H=H.return}throw Error(R(160))}switch(te.tag){case 27:var se=te.stateNode,ue=Xc(A);Nl(A,ue,se);break;case 5:var ye=te.stateNode;te.flags&32&&(_r(ye,""),te.flags&=-33);var Te=Xc(A);Nl(A,Te,ye);break;case 3:case 4:var _e=te.stateNode.containerInfo,De=Xc(A);Yc(A,De,_e);break;default:throw Error(R(161))}}}catch(ut){ji(A,A.return,ut)}A.flags&=-3}O&4096&&(A.flags&=-4097)}function Uf(A){if(A.subtreeFlags&1024)for(A=A.child;A!==null;){var O=A;Uf(O),O.tag===5&&O.flags&1024&&O.stateNode.reset(),A=A.sibling}}function vr(A,O){if(O.subtreeFlags&8772)for(O=O.child;O!==null;)Nf(A,O.alternate,O),O=O.sibling}function mo(A){for(A=A.child;A!==null;){var O=A;switch(O.tag){case 0:case 11:case 14:case 15:qr(4,O,O.return),mo(O);break;case 1:Rn(O,O.return);var H=O.stateNode;typeof H.componentWillUnmount=="function"&&If(O,O.return,H),mo(O);break;case 26:case 27:case 5:Rn(O,O.return),mo(O);break;case 22:Rn(O,O.return),O.memoizedState===null&&mo(O);break;default:mo(O)}A=A.sibling}}function zr(A,O,H){for(H=H&&(O.subtreeFlags&8772)!==0,O=O.child;O!==null;){var te=O.alternate,se=A,ue=O,ye=ue.flags;switch(ue.tag){case 0:case 11:case 15:zr(se,ue,H),ms(4,ue);break;case 1:if(zr(se,ue,H),te=ue,se=te.stateNode,typeof se.componentDidMount=="function")try{se.componentDidMount()}catch(De){ji(te,te.return,De)}if(te=ue,se=te.updateQueue,se!==null){var Te=te.stateNode;try{var _e=se.shared.hiddenCallbacks;if(_e!==null)for(se.shared.hiddenCallbacks=null,se=0;se<_e.length;se++)_f(_e[se],Te)}catch(De){ji(te,te.return,De)}}H&&ye&64&&Mf(ue),ka(ue,ue.return);break;case 26:case 27:case 5:zr(se,ue,H),H&&te===null&&ye&4&&Pf(ue),ka(ue,ue.return);break;case 12:zr(se,ue,H);break;case 13:zr(se,ue,H),H&&ye&4&&jf(se,ue);break;case 22:ue.memoizedState===null&&zr(se,ue,H),ka(ue,ue.return);break;default:zr(se,ue,H)}O=O.sibling}}function ed(A,O){var H=null;A!==null&&A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(H=A.memoizedState.cachePool.pool),A=null,O.memoizedState!==null&&O.memoizedState.cachePool!==null&&(A=O.memoizedState.cachePool.pool),A!==H&&(A!=null&&A.refCount++,H!=null&&as(H))}function td(A,O){A=null,O.alternate!==null&&(A=O.alternate.memoizedState.cache),O=O.memoizedState.cache,O!==A&&(O.refCount++,A!=null&&as(A))}function $r(A,O,H,te){if(O.subtreeFlags&10256)for(O=O.child;O!==null;)Hf(A,O,H,te),O=O.sibling}function Hf(A,O,H,te){var se=O.flags;switch(O.tag){case 0:case 11:case 15:$r(A,O,H,te),se&2048&&ms(9,O);break;case 3:$r(A,O,H,te),se&2048&&(A=null,O.alternate!==null&&(A=O.alternate.memoizedState.cache),O=O.memoizedState.cache,O!==A&&(O.refCount++,A!=null&&as(A)));break;case 12:if(se&2048){$r(A,O,H,te),A=O.stateNode;try{var ue=O.memoizedProps,ye=ue.id,Te=ue.onPostCommit;typeof Te=="function"&&Te(ye,O.alternate===null?"mount":"update",A.passiveEffectDuration,-0)}catch(_e){ji(O,O.return,_e)}}else $r(A,O,H,te);break;case 23:break;case 22:ue=O.stateNode,O.memoizedState!==null?ue._visibility&4?$r(A,O,H,te):gs(A,O):ue._visibility&4?$r(A,O,H,te):(ue._visibility|=4,go(A,O,H,te,(O.subtreeFlags&10256)!==0)),se&2048&&ed(O.alternate,O);break;case 24:$r(A,O,H,te),se&2048&&td(O.alternate,O);break;default:$r(A,O,H,te)}}function go(A,O,H,te,se){for(se=se&&(O.subtreeFlags&10256)!==0,O=O.child;O!==null;){var ue=A,ye=O,Te=H,_e=te,De=ye.flags;switch(ye.tag){case 0:case 11:case 15:go(ue,ye,Te,_e,se),ms(8,ye);break;case 23:break;case 22:var ut=ye.stateNode;ye.memoizedState!==null?ut._visibility&4?go(ue,ye,Te,_e,se):gs(ue,ye):(ut._visibility|=4,go(ue,ye,Te,_e,se)),se&&De&2048&&ed(ye.alternate,ye);break;case 24:go(ue,ye,Te,_e,se),se&&De&2048&&td(ye.alternate,ye);break;default:go(ue,ye,Te,_e,se)}O=O.sibling}}function gs(A,O){if(O.subtreeFlags&10256)for(O=O.child;O!==null;){var H=A,te=O,se=te.flags;switch(te.tag){case 22:gs(H,te),se&2048&&ed(te.alternate,te);break;case 24:gs(H,te),se&2048&&td(te.alternate,te);break;default:gs(H,te)}O=O.sibling}}var vs=8192;function vo(A){if(A.subtreeFlags&vs)for(A=A.child;A!==null;)zf(A),A=A.sibling}function zf(A){switch(A.tag){case 26:vo(A),A.flags&vs&&A.memoizedState!==null&&wg(Gn,A.memoizedState,A.memoizedProps);break;case 5:vo(A);break;case 3:case 4:var O=Gn;Gn=Zl(A.stateNode.containerInfo),vo(A),Gn=O;break;case 22:A.memoizedState===null&&(O=A.alternate,O!==null&&O.memoizedState!==null?(O=vs,vs=16777216,vo(A),vs=O):vo(A));break;default:vo(A)}}function $f(A){var O=A.alternate;if(O!==null&&(A=O.child,A!==null)){O.child=null;do O=A.sibling,A.sibling=null,A=O;while(A!==null)}}function bs(A){var O=A.deletions;if(A.flags&16){if(O!==null)for(var H=0;H<O.length;H++){var te=O[H];dn=te,Wf(te,A)}$f(A)}if(A.subtreeFlags&10256)for(A=A.child;A!==null;)Gf(A),A=A.sibling}function Gf(A){switch(A.tag){case 0:case 11:case 15:bs(A),A.flags&2048&&qr(9,A,A.return);break;case 3:bs(A);break;case 12:bs(A);break;case 22:var O=A.stateNode;A.memoizedState!==null&&O._visibility&4&&(A.return===null||A.return.tag!==13)?(O._visibility&=-5,Ll(A)):bs(A);break;default:bs(A)}}function Ll(A){var O=A.deletions;if(A.flags&16){if(O!==null)for(var H=0;H<O.length;H++){var te=O[H];dn=te,Wf(te,A)}$f(A)}for(A=A.child;A!==null;){switch(O=A,O.tag){case 0:case 11:case 15:qr(8,O,O.return),Ll(O);break;case 22:H=O.stateNode,H._visibility&4&&(H._visibility&=-5,Ll(O));break;default:Ll(O)}A=A.sibling}}function Wf(A,O){for(;dn!==null;){var H=dn;switch(H.tag){case 0:case 11:case 15:qr(8,H,O);break;case 23:case 22:if(H.memoizedState!==null&&H.memoizedState.cachePool!==null){var te=H.memoizedState.cachePool.pool;te!=null&&te.refCount++}break;case 24:as(H.memoizedState.cache)}if(te=H.child,te!==null)te.return=H,dn=te;else e:for(H=A;dn!==null;){te=dn;var se=te.sibling,ue=te.return;if(Lf(te),te===H){dn=null;break e}if(se!==null){se.return=ue,dn=se;break e}dn=ue}}}function Vm(A,O,H,te){this.tag=A,this.key=H,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=O,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=te,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(A,O,H,te){return new Vm(A,O,H,te)}function id(A){return A=A.prototype,!(!A||!A.isReactComponent)}function Gr(A,O){var H=A.alternate;return H===null?(H=Vn(A.tag,O,A.key,A.mode),H.elementType=A.elementType,H.type=A.type,H.stateNode=A.stateNode,H.alternate=A,A.alternate=H):(H.pendingProps=O,H.type=A.type,H.flags=0,H.subtreeFlags=0,H.deletions=null),H.flags=A.flags&31457280,H.childLanes=A.childLanes,H.lanes=A.lanes,H.child=A.child,H.memoizedProps=A.memoizedProps,H.memoizedState=A.memoizedState,H.updateQueue=A.updateQueue,O=A.dependencies,H.dependencies=O===null?null:{lanes:O.lanes,firstContext:O.firstContext},H.sibling=A.sibling,H.index=A.index,H.ref=A.ref,H.refCleanup=A.refCleanup,H}function Kf(A,O){A.flags&=31457282;var H=A.alternate;return H===null?(A.childLanes=0,A.lanes=O,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=H.childLanes,A.lanes=H.lanes,A.child=H.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=H.memoizedProps,A.memoizedState=H.memoizedState,A.updateQueue=H.updateQueue,A.type=H.type,O=H.dependencies,A.dependencies=O===null?null:{lanes:O.lanes,firstContext:O.firstContext}),A}function Fl(A,O,H,te,se,ue){var ye=0;if(te=A,typeof A=="function")id(A)&&(ye=1);else if(typeof A=="string")ye=Cg(A,H,ni.current)?26:A==="html"||A==="head"||A==="body"?27:5;else e:switch(A){case _:return xa(H.children,se,ue,O);case D:ye=8,se|=24;break;case Y:return A=Vn(12,H,O,se|2),A.elementType=Y,A.lanes=ue,A;case oe:return A=Vn(13,H,O,se),A.elementType=oe,A.lanes=ue,A;case ae:return A=Vn(19,H,O,se),A.elementType=ae,A.lanes=ue,A;case me:return Jf(H,se,ue,O);default:if(typeof A=="object"&&A!==null)switch(A.$$typeof){case ee:case ne:ye=10;break e;case ie:ye=9;break e;case re:ye=11;break e;case le:ye=14;break e;case de:ye=16,te=null;break e}ye=29,H=Error(R(130,A===null?"null":typeof A,"")),te=null}return O=Vn(ye,H,O,se),O.elementType=A,O.type=te,O.lanes=ue,O}function xa(A,O,H,te){return A=Vn(7,A,te,O),A.lanes=H,A}function Jf(A,O,H,te){A=Vn(22,A,te,O),A.elementType=me,A.lanes=H;var se={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var ue=se._current;if(ue===null)throw Error(R(456));if(!(se._pendingVisibility&2)){var ye=Pr(ue,2);ye!==null&&(se._pendingVisibility|=2,Sn(ye,ue,2))}},attach:function(){var ue=se._current;if(ue===null)throw Error(R(456));if(se._pendingVisibility&2){var ye=Pr(ue,2);ye!==null&&(se._pendingVisibility&=-3,Sn(ye,ue,2))}}};return A.stateNode=se,A}function nd(A,O,H){return A=Vn(6,A,null,O),A.lanes=H,A}function rd(A,O,H){return O=Vn(4,A.children!==null?A.children:[],A.key,O),O.lanes=H,O.stateNode={containerInfo:A.containerInfo,pendingChildren:null,implementation:A.implementation},O}function br(A){A.flags|=4}function Xf(A,O){if(O.type!=="stylesheet"||O.state.loading&4)A.flags&=-16777217;else if(A.flags|=16777216,!Bp(O)){if(O=On.current,O!==null&&((Ai&4194176)===Ai?Zn!==null:(Ai&62914560)!==Ai&&!(Ai&536870912)||O!==Zn))throw is=uc,hh;A.flags|=8192}}function jl(A,O){O!==null&&(A.flags|=4),A.flags&16384&&(O=A.tag!==22?ze():536870912,A.lanes|=O,yo|=O)}function ys(A,O){if(!Mi)switch(A.tailMode){case"hidden":O=A.tail;for(var H=null;O!==null;)O.alternate!==null&&(H=O),O=O.sibling;H===null?A.tail=null:H.sibling=null;break;case"collapsed":H=A.tail;for(var te=null;H!==null;)H.alternate!==null&&(te=H),H=H.sibling;te===null?O||A.tail===null?A.tail=null:A.tail.sibling=null:te.sibling=null}}function $i(A){var O=A.alternate!==null&&A.alternate.child===A.child,H=0,te=0;if(O)for(var se=A.child;se!==null;)H|=se.lanes|se.childLanes,te|=se.subtreeFlags&31457280,te|=se.flags&31457280,se.return=A,se=se.sibling;else for(se=A.child;se!==null;)H|=se.lanes|se.childLanes,te|=se.subtreeFlags,te|=se.flags,se.return=A,se=se.sibling;return A.subtreeFlags|=te,A.childLanes=H,O}function Nm(A,O,H){var te=O.pendingProps;switch(sc(O),O.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $i(O),null;case 1:return $i(O),null;case 3:return H=O.stateNode,te=null,A!==null&&(te=A.memoizedState.cache),O.memoizedState.cache!==te&&(O.flags|=2048),pr(ln),Ki(),H.pendingContext&&(H.context=H.pendingContext,H.pendingContext=null),(A===null||A.child===null)&&(Yo(O)?br(O):A===null||A.memoizedState.isDehydrated&&!(O.flags&256)||(O.flags|=1024,$n!==null&&(hd($n),$n=null))),$i(O),null;case 26:return H=O.memoizedState,A===null?(br(O),H!==null?($i(O),Xf(O,H)):($i(O),O.flags&=-16777217)):H?H!==A.memoizedState?(br(O),$i(O),Xf(O,H)):($i(O),O.flags&=-16777217):(A.memoizedProps!==te&&br(O),$i(O),O.flags&=-16777217),null;case 27:zi(O),H=Ci.current;var se=O.type;if(A!==null&&O.stateNode!=null)A.memoizedProps!==te&&br(O);else{if(!te){if(O.stateNode===null)throw Error(R(166));return $i(O),null}A=ni.current,Yo(O)?ch(O):(A=kp(se,te,H),O.stateNode=A,br(O))}return $i(O),null;case 5:if(zi(O),H=O.type,A!==null&&O.stateNode!=null)A.memoizedProps!==te&&br(O);else{if(!te){if(O.stateNode===null)throw Error(R(166));return $i(O),null}if(A=ni.current,Yo(O))ch(O);else{switch(se=Yl(Ci.current),A){case 1:A=se.createElementNS("http://www.w3.org/2000/svg",H);break;case 2:A=se.createElementNS("http://www.w3.org/1998/Math/MathML",H);break;default:switch(H){case"svg":A=se.createElementNS("http://www.w3.org/2000/svg",H);break;case"math":A=se.createElementNS("http://www.w3.org/1998/Math/MathML",H);break;case"script":A=se.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof te.is=="string"?se.createElement("select",{is:te.is}):se.createElement("select"),te.multiple?A.multiple=!0:te.size&&(A.size=te.size);break;default:A=typeof te.is=="string"?se.createElement(H,{is:te.is}):se.createElement(H)}}A[_i]=O,A[Ei]=te;e:for(se=O.child;se!==null;){if(se.tag===5||se.tag===6)A.appendChild(se.stateNode);else if(se.tag!==4&&se.tag!==27&&se.child!==null){se.child.return=se,se=se.child;continue}if(se===O)break e;for(;se.sibling===null;){if(se.return===null||se.return===O)break e;se=se.return}se.sibling.return=se.return,se=se.sibling}O.stateNode=A;e:switch(mn(A,H,te),H){case"button":case"input":case"select":case"textarea":A=!!te.autoFocus;break e;case"img":A=!0;break e;default:A=!1}A&&br(O)}}return $i(O),O.flags&=-16777217,null;case 6:if(A&&O.stateNode!=null)A.memoizedProps!==te&&br(O);else{if(typeof te!="string"&&O.stateNode===null)throw Error(R(166));if(A=Ci.current,Yo(O)){if(A=O.stateNode,H=O.memoizedProps,te=null,se=yn,se!==null)switch(se.tag){case 27:case 5:te=se.memoizedProps}A[_i]=O,A=!!(A.nodeValue===H||te!==null&&te.suppressHydrationWarning===!0||Sp(A.nodeValue,H)),A||va(O)}else A=Yl(A).createTextNode(te),A[_i]=O,O.stateNode=A}return $i(O),null;case 13:if(te=O.memoizedState,A===null||A.memoizedState!==null&&A.memoizedState.dehydrated!==null){if(se=Yo(O),te!==null&&te.dehydrated!==null){if(A===null){if(!se)throw Error(R(318));if(se=O.memoizedState,se=se!==null?se.dehydrated:null,!se)throw Error(R(317));se[_i]=O}else Zo(),!(O.flags&128)&&(O.memoizedState=null),O.flags|=4;$i(O),se=!1}else $n!==null&&(hd($n),$n=null),se=!0;if(!se)return O.flags&256?(cr(O),O):(cr(O),null)}if(cr(O),O.flags&128)return O.lanes=H,O;if(H=te!==null,A=A!==null&&A.memoizedState!==null,H){te=O.child,se=null,te.alternate!==null&&te.alternate.memoizedState!==null&&te.alternate.memoizedState.cachePool!==null&&(se=te.alternate.memoizedState.cachePool.pool);var ue=null;te.memoizedState!==null&&te.memoizedState.cachePool!==null&&(ue=te.memoizedState.cachePool.pool),ue!==se&&(te.flags|=2048)}return H!==A&&H&&(O.child.flags|=8192),jl(O,O.updateQueue),$i(O),null;case 4:return Ki(),A===null&&wd(O.stateNode.containerInfo),$i(O),null;case 10:return pr(O.type),$i(O),null;case 19:if(si(sn),se=O.memoizedState,se===null)return $i(O),null;if(te=(O.flags&128)!==0,ue=se.rendering,ue===null)if(te)ys(se,!1);else{if(Yi!==0||A!==null&&A.flags&128)for(A=O.child;A!==null;){if(ue=wl(A),ue!==null){for(O.flags|=128,ys(se,!1),A=ue.updateQueue,O.updateQueue=A,jl(O,A),O.subtreeFlags=0,A=H,H=O.child;H!==null;)Kf(H,A),H=H.sibling;return ri(sn,sn.current&1|2),O.child}A=A.sibling}se.tail!==null&&Bi()>ql&&(O.flags|=128,te=!0,ys(se,!1),O.lanes=4194304)}else{if(!te)if(A=wl(ue),A!==null){if(O.flags|=128,te=!0,A=A.updateQueue,O.updateQueue=A,jl(O,A),ys(se,!0),se.tail===null&&se.tailMode==="hidden"&&!ue.alternate&&!Mi)return $i(O),null}else 2*Bi()-se.renderingStartTime>ql&&H!==536870912&&(O.flags|=128,te=!0,ys(se,!1),O.lanes=4194304);se.isBackwards?(ue.sibling=O.child,O.child=ue):(A=se.last,A!==null?A.sibling=ue:O.child=ue,se.last=ue)}return se.tail!==null?(O=se.tail,se.rendering=O,se.tail=O.sibling,se.renderingStartTime=Bi(),O.sibling=null,A=sn.current,ri(sn,te?A&1|2:A&1),O):($i(O),null);case 22:case 23:return cr(O),dc(),te=O.memoizedState!==null,A!==null?A.memoizedState!==null!==te&&(O.flags|=8192):te&&(O.flags|=8192),te?H&536870912&&!(O.flags&128)&&($i(O),O.subtreeFlags&6&&(O.flags|=8192)):$i(O),H=O.updateQueue,H!==null&&jl(O,H.retryQueue),H=null,A!==null&&A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(H=A.memoizedState.cachePool.pool),te=null,O.memoizedState!==null&&O.memoizedState.cachePool!==null&&(te=O.memoizedState.cachePool.pool),te!==H&&(O.flags|=2048),A!==null&&si(ya),null;case 24:return H=null,A!==null&&(H=A.memoizedState.cache),O.memoizedState.cache!==H&&(O.flags|=2048),pr(ln),$i(O),null;case 25:return null}throw Error(R(156,O.tag))}function Lm(A,O){switch(sc(O),O.tag){case 1:return A=O.flags,A&65536?(O.flags=A&-65537|128,O):null;case 3:return pr(ln),Ki(),A=O.flags,A&65536&&!(A&128)?(O.flags=A&-65537|128,O):null;case 26:case 27:case 5:return zi(O),null;case 13:if(cr(O),A=O.memoizedState,A!==null&&A.dehydrated!==null){if(O.alternate===null)throw Error(R(340));Zo()}return A=O.flags,A&65536?(O.flags=A&-65537|128,O):null;case 19:return si(sn),null;case 4:return Ki(),null;case 10:return pr(O.type),null;case 22:case 23:return cr(O),dc(),A!==null&&si(ya),A=O.flags,A&65536?(O.flags=A&-65537|128,O):null;case 24:return pr(ln),null;case 25:return null;default:return null}}function Yf(A,O){switch(sc(O),O.tag){case 3:pr(ln),Ki();break;case 26:case 27:case 5:zi(O);break;case 4:Ki();break;case 13:cr(O);break;case 19:si(sn);break;case 10:pr(O.type);break;case 22:case 23:cr(O),dc(),A!==null&&si(ya);break;case 24:pr(ln)}}var Fm={getCacheForType:function(A){var O=bn(ln),H=O.data.get(A);return H===void 0&&(H=A(),O.data.set(A,H)),H}},jm=typeof WeakMap=="function"?WeakMap:Map,Gi=0,Ui=null,wi=null,Ai=0,Hi=0,xn=null,yr=!1,bo=!1,ad=!1,Sr=0,Yi=0,Wr=0,Aa=0,od=0,Nn=0,yo=0,Ss=null,er=null,sd=!1,ld=0,ql=1/0,Ul=null,Kr=null,Hl=!1,Ma=null,Cs=0,ud=0,cd=null,Es=0,dd=null;function _n(){if(Gi&2&&Ai!==0)return Ai&-Ai;if(Se.T!==null){var A=uo;return A!==0?A:yd()}return qn()}function Zf(){Nn===0&&(Nn=!(Ai&536870912)||Mi?we():536870912);var A=On.current;return A!==null&&(A.flags|=32),Nn}function Sn(A,O,H){(A===Ui&&Hi===2||A.cancelPendingCommit!==null)&&(So(A,0),Cr(A,Ai,Nn,!1)),$t(A,H),(!(Gi&2)||A!==Ui)&&(A===Ui&&(!(Gi&2)&&(Aa|=H),Yi===4&&Cr(A,Ai,Nn,!1)),tr(A))}function Qf(A,O,H){if(Gi&6)throw Error(R(327));var te=!H&&(O&60)===0&&(O&A.expiredLanes)===0||pe(A,O),se=te?Hm(A,O):md(A,O,!0),ue=te;do{if(se===0){bo&&!te&&Cr(A,O,0,!1);break}else if(se===6)Cr(A,O,0,!yr);else{if(H=A.current.alternate,ue&&!qm(H)){se=md(A,O,!1),ue=!1;continue}if(se===2){if(ue=O,A.errorRecoveryDisabledLanes&ue)var ye=0;else ye=A.pendingLanes&-536870913,ye=ye!==0?ye:ye&536870912?536870912:0;if(ye!==0){O=ye;e:{var Te=A;se=Ss;var _e=Te.current.memoizedState.isDehydrated;if(_e&&(So(Te,ye).flags|=256),ye=md(Te,ye,!1),ye!==2){if(ad&&!_e){Te.errorRecoveryDisabledLanes|=ue,Aa|=ue,se=4;break e}ue=er,er=se,ue!==null&&hd(ue)}se=ye}if(ue=!1,se!==2)continue}}if(se===1){So(A,0),Cr(A,O,0,!0);break}e:{switch(te=A,se){case 0:case 1:throw Error(R(345));case 4:if((O&4194176)===O){Cr(te,O,Nn,!yr);break e}break;case 2:er=null;break;case 3:case 5:break;default:throw Error(R(329))}if(te.finishedWork=H,te.finishedLanes=O,(O&62914560)===O&&(ue=ld+300-Bi(),10<ue)){if(Cr(te,O,Nn,!yr),Ge(te,0)!==0)break e;te.timeoutHandle=wp(ep.bind(null,te,H,er,Ul,sd,O,Nn,Aa,yo,yr,2,-0,0),ue);break e}ep(te,H,er,Ul,sd,O,Nn,Aa,yo,yr,0,-0,0)}}break}while(!0);tr(A)}function hd(A){er===null?er=A:er.push.apply(er,A)}function ep(A,O,H,te,se,ue,ye,Te,_e,De,ut,Ht,Ke){var ot=O.subtreeFlags;if((ot&8192||(ot&16785408)===16785408)&&(As={stylesheets:null,count:0,unsuspend:Eg},zf(O),O=Tg(),O!==null)){A.cancelPendingCommit=O(sp.bind(null,A,H,te,se,ye,Te,_e,1,Ht,Ke)),Cr(A,ue,ye,!De);return}sp(A,H,te,se,ye,Te,_e,ut,Ht,Ke)}function qm(A){for(var O=A;;){var H=O.tag;if((H===0||H===11||H===15)&&O.flags&16384&&(H=O.updateQueue,H!==null&&(H=H.stores,H!==null)))for(var te=0;te<H.length;te++){var se=H[te],ue=se.getSnapshot;se=se.value;try{if(!Tn(ue(),se))return!1}catch{return!1}}if(H=O.child,O.subtreeFlags&16384&&H!==null)H.return=O,O=H;else{if(O===A)break;for(;O.sibling===null;){if(O.return===null||O.return===A)return!0;O=O.return}O.sibling.return=O.return,O=O.sibling}}return!0}function Cr(A,O,H,te){O&=~od,O&=~Aa,A.suspendedLanes|=O,A.pingedLanes&=~O,te&&(A.warmLanes|=O),te=A.expirationTimes;for(var se=O;0<se;){var ue=31-ke(se),ye=1<<ue;te[ue]=-1,se&=~ye}H!==0&&Yt(A,H,O)}function zl(){return Gi&6?!0:(ws(0),!1)}function fd(){if(wi!==null){if(Hi===0)var A=wi.return;else A=wi,fr=Ta=null,yc(A),to=null,ns=0,A=wi;for(;A!==null;)Yf(A.alternate,A),A=A.return;wi=null}}function So(A,O){A.finishedWork=null,A.finishedLanes=0;var H=A.timeoutHandle;H!==-1&&(A.timeoutHandle=-1,og(H)),H=A.cancelPendingCommit,H!==null&&(A.cancelPendingCommit=null,H()),fd(),Ui=A,wi=H=Gr(A.current,null),Ai=O,Hi=0,xn=null,yr=!1,bo=pe(A,O),ad=!1,yo=Nn=od=Aa=Wr=Yi=0,er=Ss=null,sd=!1,O&8&&(O|=O&32);var te=A.entangledLanes;if(te!==0)for(A=A.entanglements,te&=O;0<te;){var se=31-ke(te),ue=1<<se;O|=A[se],te&=~ue}return Sr=O,pl(),H}function tp(A,O){yi=null,Se.H=Qn,O===ts?(O=mh(),Hi=3):O===hh?(O=mh(),Hi=4):Hi=O===pf?8:O!==null&&typeof O=="object"&&typeof O.then=="function"?6:1,xn=O,wi===null&&(Yi=1,Dl(A,Mn(O,A.current)))}function ip(){var A=Se.H;return Se.H=Qn,A===null?Qn:A}function np(){var A=Se.A;return Se.A=Fm,A}function pd(){Yi=4,yr||(Ai&4194176)!==Ai&&On.current!==null||(bo=!0),!(Wr&134217727)&&!(Aa&134217727)||Ui===null||Cr(Ui,Ai,Nn,!1)}function md(A,O,H){var te=Gi;Gi|=2;var se=ip(),ue=np();(Ui!==A||Ai!==O)&&(Ul=null,So(A,O)),O=!1;var ye=Yi;e:do try{if(Hi!==0&&wi!==null){var Te=wi,_e=xn;switch(Hi){case 8:fd(),ye=6;break e;case 3:case 2:case 6:On.current===null&&(O=!0);var De=Hi;if(Hi=0,xn=null,Co(A,Te,_e,De),H&&bo){ye=0;break e}break;default:De=Hi,Hi=0,xn=null,Co(A,Te,_e,De)}}Um(),ye=Yi;break}catch(ut){tp(A,ut)}while(!0);return O&&A.shellSuspendCounter++,fr=Ta=null,Gi=te,Se.H=se,Se.A=ue,wi===null&&(Ui=null,Ai=0,pl()),ye}function Um(){for(;wi!==null;)rp(wi)}function Hm(A,O){var H=Gi;Gi|=2;var te=ip(),se=np();Ui!==A||Ai!==O?(Ul=null,ql=Bi()+500,So(A,O)):bo=pe(A,O);e:do try{if(Hi!==0&&wi!==null){O=wi;var ue=xn;t:switch(Hi){case 1:Hi=0,xn=null,Co(A,O,ue,1);break;case 2:if(fh(ue)){Hi=0,xn=null,ap(O);break}O=function(){Hi===2&&Ui===A&&(Hi=7),tr(A)},ue.then(O,O);break e;case 3:Hi=7;break e;case 4:Hi=5;break e;case 7:fh(ue)?(Hi=0,xn=null,ap(O)):(Hi=0,xn=null,Co(A,O,ue,7));break;case 5:var ye=null;switch(wi.tag){case 26:ye=wi.memoizedState;case 5:case 27:var Te=wi;if(!ye||Bp(ye)){Hi=0,xn=null;var _e=Te.sibling;if(_e!==null)wi=_e;else{var De=Te.return;De!==null?(wi=De,$l(De)):wi=null}break t}}Hi=0,xn=null,Co(A,O,ue,5);break;case 6:Hi=0,xn=null,Co(A,O,ue,6);break;case 8:fd(),Yi=6;break e;default:throw Error(R(462))}}zm();break}catch(ut){tp(A,ut)}while(!0);return fr=Ta=null,Se.H=te,Se.A=se,Gi=H,wi!==null?0:(Ui=null,Ai=0,pl(),Yi)}function zm(){for(;wi!==null&&!mi();)rp(wi)}function rp(A){var O=kf(A.alternate,A,Sr);A.memoizedProps=A.pendingProps,O===null?$l(A):wi=O}function ap(A){var O=A,H=O.alternate;switch(O.tag){case 15:case 0:O=Sf(H,O,O.pendingProps,O.type,void 0,Ai);break;case 11:O=Sf(H,O,O.pendingProps,O.type.render,O.ref,Ai);break;case 5:yc(O);default:Yf(H,O),O=wi=Kf(O,Sr),O=kf(H,O,Sr)}A.memoizedProps=A.pendingProps,O===null?$l(A):wi=O}function Co(A,O,H,te){fr=Ta=null,yc(O),to=null,ns=0;var se=O.return;try{if(Pm(A,se,O,H,Ai)){Yi=1,Dl(A,Mn(H,A.current)),wi=null;return}}catch(ue){if(se!==null)throw wi=se,ue;Yi=1,Dl(A,Mn(H,A.current)),wi=null;return}O.flags&32768?(Mi||te===1?A=!0:bo||Ai&536870912?A=!1:(yr=A=!0,(te===2||te===3||te===6)&&(te=On.current,te!==null&&te.tag===13&&(te.flags|=16384))),op(O,A)):$l(O)}function $l(A){var O=A;do{if(O.flags&32768){op(O,yr);return}A=O.return;var H=Nm(O.alternate,O,Sr);if(H!==null){wi=H;return}if(O=O.sibling,O!==null){wi=O;return}wi=O=A}while(O!==null);Yi===0&&(Yi=5)}function op(A,O){do{var H=Lm(A.alternate,A);if(H!==null){H.flags&=32767,wi=H;return}if(H=A.return,H!==null&&(H.flags|=32768,H.subtreeFlags=0,H.deletions=null),!O&&(A=A.sibling,A!==null)){wi=A;return}wi=A=H}while(A!==null);Yi=6,wi=null}function sp(A,O,H,te,se,ue,ye,Te,_e,De){var ut=Se.T,Ht=Je.p;try{Je.p=2,Se.T=null,$m(A,O,H,te,Ht,se,ue,ye,Te,_e,De)}finally{Se.T=ut,Je.p=Ht}}function $m(A,O,H,te,se,ue,ye,Te){do Eo();while(Ma!==null);if(Gi&6)throw Error(R(327));var _e=A.finishedWork;if(te=A.finishedLanes,_e===null)return null;if(A.finishedWork=null,A.finishedLanes=0,_e===A.current)throw Error(R(177));A.callbackNode=null,A.callbackPriority=0,A.cancelPendingCommit=null;var De=_e.lanes|_e.childLanes;if(De|=rc,ii(A,te,De,ue,ye,Te),A===Ui&&(wi=Ui=null,Ai=0),!(_e.subtreeFlags&10256)&&!(_e.flags&10256)||Hl||(Hl=!0,ud=De,cd=H,Jm(ti,function(){return Eo(),null})),H=(_e.flags&15990)!==0,_e.subtreeFlags&15990||H?(H=Se.T,Se.T=null,ue=Je.p,Je.p=2,ye=Gi,Gi|=4,Dm(A,_e),qf(_e,A),mm(xd,A.containerInfo),nu=!!kd,xd=kd=null,A.current=_e,Nf(A,_e.alternate,_e),Oi(),Gi=ye,Je.p=ue,Se.T=H):A.current=_e,Hl?(Hl=!1,Ma=A,Cs=te):lp(A,De),De=A.pendingLanes,De===0&&(Kr=null),Ye(_e.stateNode),tr(A),O!==null)for(se=A.onRecoverableError,_e=0;_e<O.length;_e++)De=O[_e],se(De.value,{componentStack:De.stack});return Cs&3&&Eo(),De=A.pendingLanes,te&4194218&&De&42?A===dd?Es++:(Es=0,dd=A):Es=0,ws(0),null}function lp(A,O){(A.pooledCacheLanes&=O)===0&&(O=A.pooledCache,O!=null&&(A.pooledCache=null,as(O)))}function Eo(){if(Ma!==null){var A=Ma,O=ud;ud=0;var H=pi(Cs),te=Se.T,se=Je.p;try{if(Je.p=32>H?32:H,Se.T=null,Ma===null)var ue=!1;else{H=cd,cd=null;var ye=Ma,Te=Cs;if(Ma=null,Cs=0,Gi&6)throw Error(R(331));var _e=Gi;if(Gi|=4,Gf(ye.current),Hf(ye,ye.current,Te,H),Gi=_e,ws(0,!1),Ie&&typeof Ie.onPostCommitFiberRoot=="function")try{Ie.onPostCommitFiberRoot(ft,ye)}catch{}ue=!0}return ue}finally{Je.p=se,Se.T=te,lp(A,O)}}return!1}function up(A,O,H){O=Mn(H,O),O=Oc(A.stateNode,O,2),A=jr(A,O,2),A!==null&&($t(A,2),tr(A))}function ji(A,O,H){if(A.tag===3)up(A,A,H);else for(;O!==null;){if(O.tag===3){up(O,A,H);break}else if(O.tag===1){var te=O.stateNode;if(typeof O.type.getDerivedStateFromError=="function"||typeof te.componentDidCatch=="function"&&(Kr===null||!Kr.has(te))){A=Mn(H,A),H=hf(2),te=jr(O,H,2),te!==null&&(ff(H,te,O,A),$t(te,2),tr(te));break}}O=O.return}}function gd(A,O,H){var te=A.pingCache;if(te===null){te=A.pingCache=new jm;var se=new Set;te.set(O,se)}else se=te.get(O),se===void 0&&(se=new Set,te.set(O,se));se.has(H)||(ad=!0,se.add(H),A=Gm.bind(null,A,O,H),O.then(A,A))}function Gm(A,O,H){var te=A.pingCache;te!==null&&te.delete(O),A.pingedLanes|=A.suspendedLanes&H,A.warmLanes&=~H,Ui===A&&(Ai&H)===H&&(Yi===4||Yi===3&&(Ai&62914560)===Ai&&300>Bi()-ld?!(Gi&2)&&So(A,0):od|=H,yo===Ai&&(yo=0)),tr(A)}function cp(A,O){O===0&&(O=ze()),A=Pr(A,O),A!==null&&($t(A,O),tr(A))}function Wm(A){var O=A.memoizedState,H=0;O!==null&&(H=O.retryLane),cp(A,H)}function Km(A,O){var H=0;switch(A.tag){case 13:var te=A.stateNode,se=A.memoizedState;se!==null&&(H=se.retryLane);break;case 19:te=A.stateNode;break;case 22:te=A.stateNode._retryCache;break;default:throw Error(R(314))}te!==null&&te.delete(O),cp(A,H)}function Jm(A,O){return Di(A,O)}var Gl=null,wo=null,vd=!1,Wl=!1,bd=!1,Ia=0;function tr(A){A!==wo&&A.next===null&&(wo===null?Gl=wo=A:wo=wo.next=A),Wl=!0,vd||(vd=!0,Ym(Xm))}function ws(A,O){if(!bd&&Wl){bd=!0;do for(var H=!1,te=Gl;te!==null;){if(A!==0){var se=te.pendingLanes;if(se===0)var ue=0;else{var ye=te.suspendedLanes,Te=te.pingedLanes;ue=(1<<31-ke(42|A)+1)-1,ue&=se&~(ye&~Te),ue=ue&201326677?ue&201326677|1:ue?ue|2:0}ue!==0&&(H=!0,fp(te,ue))}else ue=Ai,ue=Ge(te,te===Ui?ue:0),!(ue&3)||pe(te,ue)||(H=!0,fp(te,ue));te=te.next}while(H);bd=!1}}function Xm(){Wl=vd=!1;var A=0;Ia!==0&&(ag()&&(A=Ia),Ia=0);for(var O=Bi(),H=null,te=Gl;te!==null;){var se=te.next,ue=dp(te,O);ue===0?(te.next=null,H===null?Gl=se:H.next=se,se===null&&(wo=H)):(H=te,(A!==0||ue&3)&&(Wl=!0)),te=se}ws(A)}function dp(A,O){for(var H=A.suspendedLanes,te=A.pingedLanes,se=A.expirationTimes,ue=A.pendingLanes&-62914561;0<ue;){var ye=31-ke(ue),Te=1<<ye,_e=se[ye];_e===-1?(!(Te&H)||Te&te)&&(se[ye]=Ve(Te,O)):_e<=O&&(A.expiredLanes|=Te),ue&=~Te}if(O=Ui,H=Ai,H=Ge(A,A===O?H:0),te=A.callbackNode,H===0||A===O&&Hi===2||A.cancelPendingCommit!==null)return te!==null&&te!==null&&bi(te),A.callbackNode=null,A.callbackPriority=0;if(!(H&3)||pe(A,H)){if(O=H&-H,O===A.callbackPriority)return O;switch(te!==null&&bi(te),pi(H)){case 2:case 8:H=it;break;case 32:H=ti;break;case 268435456:H=ct;break;default:H=ti}return te=hp.bind(null,A),H=Di(H,te),A.callbackPriority=O,A.callbackNode=H,O}return te!==null&&te!==null&&bi(te),A.callbackPriority=2,A.callbackNode=null,2}function hp(A,O){var H=A.callbackNode;if(Eo()&&A.callbackNode!==H)return null;var te=Ai;return te=Ge(A,A===Ui?te:0),te===0?null:(Qf(A,te,O),dp(A,Bi()),A.callbackNode!=null&&A.callbackNode===H?hp.bind(null,A):null)}function fp(A,O){if(Eo())return null;Qf(A,O,!0)}function Ym(A){sg(function(){Gi&6?Di(Bt,A):A()})}function yd(){return Ia===0&&(Ia=we()),Ia}function pp(A){return A==null||typeof A=="symbol"||typeof A=="boolean"?null:typeof A=="function"?A:Ua(""+A)}function mp(A,O){var H=O.ownerDocument.createElement("input");return H.name=O.name,H.value=O.value,A.id&&H.setAttribute("form",A.id),O.parentNode.insertBefore(H,O),A=new FormData(A),H.parentNode.removeChild(H),A}function Zm(A,O,H,te,se){if(O==="submit"&&H&&H.stateNode===se){var ue=pp((se[Ei]||null).action),ye=te.submitter;ye&&(O=(O=ye[Ei]||null)?pp(O.formAction):ye.getAttribute("formAction"),O!==null&&(ue=O,ye=null));var Te=new Ga("action","action",null,te,se);A.push({event:Te,listeners:[{instance:null,listener:function(){if(te.defaultPrevented){if(Ia!==0){var _e=ye?mp(se,ye):new FormData(se);_c(H,{pending:!0,data:_e,method:se.method,action:ue},null,_e)}}else typeof ue=="function"&&(Te.preventDefault(),_e=ye?mp(se,ye):new FormData(se),_c(H,{pending:!0,data:_e,method:se.method,action:ue},ue,_e))},currentTarget:se}]})}}for(var Sd=0;Sd<oh.length;Sd++){var Cd=oh[Sd],Qm=Cd.toLowerCase(),eg=Cd[0].toUpperCase()+Cd.slice(1);zn(Qm,"on"+eg)}zn(th,"onAnimationEnd"),zn(ih,"onAnimationIteration"),zn(nh,"onAnimationStart"),zn("dblclick","onDoubleClick"),zn("focusin","onFocus"),zn("focusout","onBlur"),zn(vm,"onTransitionRun"),zn(bm,"onTransitionStart"),zn(ym,"onTransitionCancel"),zn(rh,"onTransitionEnd"),kr("onMouseEnter",["mouseout","mouseover"]),kr("onMouseLeave",["mouseout","mouseover"]),kr("onPointerEnter",["pointerout","pointerover"]),kr("onPointerLeave",["pointerout","pointerover"]),or("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),or("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),or("onBeforeInput",["compositionend","keypress","textInput","paste"]),or("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),or("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),or("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ts="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ts));function gp(A,O){O=(O&4)!==0;for(var H=0;H<A.length;H++){var te=A[H],se=te.event;te=te.listeners;e:{var ue=void 0;if(O)for(var ye=te.length-1;0<=ye;ye--){var Te=te[ye],_e=Te.instance,De=Te.currentTarget;if(Te=Te.listener,_e!==ue&&se.isPropagationStopped())break e;ue=Te,se.currentTarget=De;try{ue(se)}catch(ut){Ol(ut)}se.currentTarget=null,ue=_e}else for(ye=0;ye<te.length;ye++){if(Te=te[ye],_e=Te.instance,De=Te.currentTarget,Te=Te.listener,_e!==ue&&se.isPropagationStopped())break e;ue=Te,se.currentTarget=De;try{ue(se)}catch(ut){Ol(ut)}se.currentTarget=null,ue=_e}}}}function Ri(A,O){var H=O[gn];H===void 0&&(H=O[gn]=new Set);var te=A+"__bubble";H.has(te)||(vp(O,A,2,!1),H.add(te))}function Ed(A,O,H){var te=0;O&&(te|=4),vp(H,A,te,O)}var Kl="_reactListening"+Math.random().toString(36).slice(2);function wd(A){if(!A[Kl]){A[Kl]=!0,Fs.forEach(function(H){H!=="selectionchange"&&(tg.has(H)||Ed(H,!1,A),Ed(H,!0,A))});var O=A.nodeType===9?A:A.ownerDocument;O===null||O[Kl]||(O[Kl]=!0,Ed("selectionchange",!1,O))}}function vp(A,O,H,te){switch(qp(O)){case 2:var se=xg;break;case 8:se=_g;break;default:se=Vd}H=se.bind(null,O,H,A),se=void 0,!qo||O!=="touchstart"&&O!=="touchmove"&&O!=="wheel"||(se=!0),te?se!==void 0?A.addEventListener(O,H,{capture:!0,passive:se}):A.addEventListener(O,H,!0):se!==void 0?A.addEventListener(O,H,{passive:se}):A.addEventListener(O,H,!1)}function Td(A,O,H,te,se){var ue=te;if(!(O&1)&&!(O&2)&&te!==null)e:for(;;){if(te===null)return;var ye=te.tag;if(ye===3||ye===4){var Te=te.stateNode.containerInfo;if(Te===se||Te.nodeType===8&&Te.parentNode===se)break;if(ye===4)for(ye=te.return;ye!==null;){var _e=ye.tag;if((_e===3||_e===4)&&(_e=ye.stateNode.containerInfo,_e===se||_e.nodeType===8&&_e.parentNode===se))return;ye=ye.return}for(;Te!==null;){if(ye=ar(Te),ye===null)return;if(_e=ye.tag,_e===5||_e===6||_e===26||_e===27){te=ue=ye;continue e}Te=Te.parentNode}}te=te.return}Ys(function(){var De=ue,ut=Fo(H),Ht=[];e:{var Ke=ah.get(A);if(Ke!==void 0){var ot=Ga,ui=A;switch(A){case"keypress":if(za(H)===0)break e;case"keydown":case"keyup":ot=Lu;break;case"focusin":ui="focus",ot=$o;break;case"focusout":ui="blur",ot=$o;break;case"beforeblur":case"afterblur":ot=$o;break;case"click":if(H.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=el;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=ku;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=qu;break;case th:case ih:case nh:ot=Au;break;case rh:ot=Hu;break;case"scroll":case"scrollend":ot=Tu;break;case"wheel":ot=$u;break;case"copy":case"cut":case"paste":ot=Iu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=il;break;case"toggle":case"beforetoggle":ot=Wu}var gi=(O&4)!==0,Zi=!gi&&(A==="scroll"||A==="scrollend"),Fe=gi?Ke!==null?Ke+"Capture":null:Ke;gi=[];for(var Oe=De,Ue;Oe!==null;){var kt=Oe;if(Ue=kt.stateNode,kt=kt.tag,kt!==5&&kt!==26&&kt!==27||Ue===null||Fe===null||(kt=ra(Oe,Fe),kt!=null&&gi.push(Rs(Oe,kt,Ue))),Zi)break;Oe=Oe.return}0<gi.length&&(Ke=new ot(Ke,ui,null,H,ut),Ht.push({event:Ke,listeners:gi}))}}if(!(O&7)){e:{if(Ke=A==="mouseover"||A==="pointerover",ot=A==="mouseout"||A==="pointerout",Ke&&H!==Lo&&(ui=H.relatedTarget||H.fromElement)&&(ar(ui)||ui[un]))break e;if((ot||Ke)&&(Ke=ut.window===ut?ut:(Ke=ut.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,ot?(ui=H.relatedTarget||H.toElement,ot=De,ui=ui?ar(ui):null,ui!==null&&(Zi=Xe(ui),gi=ui.tag,ui!==Zi||gi!==5&&gi!==27&&gi!==6)&&(ui=null)):(ot=null,ui=De),ot!==ui)){if(gi=el,kt="onMouseLeave",Fe="onMouseEnter",Oe="mouse",(A==="pointerout"||A==="pointerover")&&(gi=il,kt="onPointerLeave",Fe="onPointerEnter",Oe="pointer"),Zi=ot==null?Ke:na(ot),Ue=ui==null?Ke:na(ui),Ke=new gi(kt,Oe+"leave",ot,H,ut),Ke.target=Zi,Ke.relatedTarget=Ue,kt=null,ar(ut)===De&&(gi=new gi(Fe,Oe+"enter",ui,H,ut),gi.target=Ue,gi.relatedTarget=Zi,kt=gi),Zi=kt,ot&&ui)t:{for(gi=ot,Fe=ui,Oe=0,Ue=gi;Ue;Ue=To(Ue))Oe++;for(Ue=0,kt=Fe;kt;kt=To(kt))Ue++;for(;0<Oe-Ue;)gi=To(gi),Oe--;for(;0<Ue-Oe;)Fe=To(Fe),Ue--;for(;Oe--;){if(gi===Fe||Fe!==null&&gi===Fe.alternate)break t;gi=To(gi),Fe=To(Fe)}gi=null}else gi=null;ot!==null&&bp(Ht,Ke,ot,gi,!1),ui!==null&&Zi!==null&&bp(Ht,Zi,ui,gi,!0)}}e:{if(Ke=De?na(De):window,ot=Ke.nodeName&&Ke.nodeName.toLowerCase(),ot==="select"||ot==="input"&&Ke.type==="file")var oi=cl;else if(ll(Ke))if(dl)oi=fm;else{oi=dm;var Si=cm}else ot=Ke.nodeName,!ot||ot.toLowerCase()!=="input"||Ke.type!=="checkbox"&&Ke.type!=="radio"?De&&No(De.elementType)&&(oi=cl):oi=hm;if(oi&&(oi=oi(A,De))){ul(Ht,oi,H,ut);break e}Si&&Si(A,Ke,De),A==="focusout"&&De&&Ke.type==="number"&&De.memoizedProps.value!=null&&Vo(Ke,"number",Ke.value)}switch(Si=De?na(De):window,A){case"focusin":(ll(Si)||Si.contentEditable==="true")&&(Ja=Si,tc=De,Xo=null);break;case"focusout":Xo=tc=Ja=null;break;case"mousedown":ic=!0;break;case"contextmenu":case"mouseup":case"dragend":ic=!1,Qd(Ht,H,ut);break;case"selectionchange":if(gm)break;case"keydown":case"keyup":Qd(Ht,H,ut)}var di;if(Wo)e:{switch(A){case"compositionstart":var fi="onCompositionStart";break e;case"compositionend":fi="onCompositionEnd";break e;case"compositionupdate":fi="onCompositionUpdate";break e}fi=void 0}else Ir?ol(A,H)&&(fi="onCompositionEnd"):A==="keydown"&&H.keyCode===229&&(fi="onCompositionStart");fi&&(nl&&H.locale!=="ko"&&(Ir||fi!=="onCompositionStart"?fi==="onCompositionEnd"&&Ir&&(di=Zs()):(Xn=ut,Uo="value"in Xn?Xn.value:Xn.textContent,Ir=!0)),Si=Jl(De,fi),0<Si.length&&(fi=new tl(fi,A,null,H,ut),Ht.push({event:fi,listeners:Si}),di?fi.data=di:(di=sl(H),di!==null&&(fi.data=di)))),(di=Ju?Xu(A,H):Yu(A,H))&&(fi=Jl(De,"onBeforeInput"),0<fi.length&&(Si=new tl("onBeforeInput","beforeinput",null,H,ut),Ht.push({event:Si,listeners:fi}),Si.data=di)),Zm(Ht,A,De,H,ut)}gp(Ht,O)})}function Rs(A,O,H){return{instance:A,listener:O,currentTarget:H}}function Jl(A,O){for(var H=O+"Capture",te=[];A!==null;){var se=A,ue=se.stateNode;se=se.tag,se!==5&&se!==26&&se!==27||ue===null||(se=ra(A,H),se!=null&&te.unshift(Rs(A,se,ue)),se=ra(A,O),se!=null&&te.push(Rs(A,se,ue))),A=A.return}return te}function To(A){if(A===null)return null;do A=A.return;while(A&&A.tag!==5&&A.tag!==27);return A||null}function bp(A,O,H,te,se){for(var ue=O._reactName,ye=[];H!==null&&H!==te;){var Te=H,_e=Te.alternate,De=Te.stateNode;if(Te=Te.tag,_e!==null&&_e===te)break;Te!==5&&Te!==26&&Te!==27||De===null||(_e=De,se?(De=ra(H,ue),De!=null&&ye.unshift(Rs(H,De,_e))):se||(De=ra(H,ue),De!=null&&ye.push(Rs(H,De,_e)))),H=H.return}ye.length!==0&&A.push({event:O,listeners:ye})}var ig=/\r\n?/g,ng=/\u0000|\uFFFD/g;function yp(A){return(typeof A=="string"?A:""+A).replace(ig,`
`).replace(ng,"")}function Sp(A,O){return O=yp(O),yp(A)===O}function Xl(){}function Fi(A,O,H,te,se,ue){switch(H){case"children":typeof te=="string"?O==="body"||O==="textarea"&&te===""||_r(A,te):(typeof te=="number"||typeof te=="bigint")&&O!=="body"&&_r(A,""+te);break;case"className":Fa(A,"class",te);break;case"tabIndex":Fa(A,"tabindex",te);break;case"dir":case"role":case"viewBox":case"width":case"height":Fa(A,H,te);break;case"style":Js(A,te,ue);break;case"data":if(O!=="object"){Fa(A,"data",te);break}case"src":case"href":if(te===""&&(O!=="a"||H!=="href")){A.removeAttribute(H);break}if(te==null||typeof te=="function"||typeof te=="symbol"||typeof te=="boolean"){A.removeAttribute(H);break}te=Ua(""+te),A.setAttribute(H,te);break;case"action":case"formAction":if(typeof te=="function"){A.setAttribute(H,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof ue=="function"&&(H==="formAction"?(O!=="input"&&Fi(A,O,"name",se.name,se,null),Fi(A,O,"formEncType",se.formEncType,se,null),Fi(A,O,"formMethod",se.formMethod,se,null),Fi(A,O,"formTarget",se.formTarget,se,null)):(Fi(A,O,"encType",se.encType,se,null),Fi(A,O,"method",se.method,se,null),Fi(A,O,"target",se.target,se,null)));if(te==null||typeof te=="symbol"||typeof te=="boolean"){A.removeAttribute(H);break}te=Ua(""+te),A.setAttribute(H,te);break;case"onClick":te!=null&&(A.onclick=Xl);break;case"onScroll":te!=null&&Ri("scroll",A);break;case"onScrollEnd":te!=null&&Ri("scrollend",A);break;case"dangerouslySetInnerHTML":if(te!=null){if(typeof te!="object"||!("__html"in te))throw Error(R(61));if(H=te.__html,H!=null){if(se.children!=null)throw Error(R(60));A.innerHTML=H}}break;case"multiple":A.multiple=te&&typeof te!="function"&&typeof te!="symbol";break;case"muted":A.muted=te&&typeof te!="function"&&typeof te!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(te==null||typeof te=="function"||typeof te=="boolean"||typeof te=="symbol"){A.removeAttribute("xlink:href");break}H=Ua(""+te),A.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",H);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":te!=null&&typeof te!="function"&&typeof te!="symbol"?A.setAttribute(H,""+te):A.removeAttribute(H);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":te&&typeof te!="function"&&typeof te!="symbol"?A.setAttribute(H,""):A.removeAttribute(H);break;case"capture":case"download":te===!0?A.setAttribute(H,""):te!==!1&&te!=null&&typeof te!="function"&&typeof te!="symbol"?A.setAttribute(H,te):A.removeAttribute(H);break;case"cols":case"rows":case"size":case"span":te!=null&&typeof te!="function"&&typeof te!="symbol"&&!isNaN(te)&&1<=te?A.setAttribute(H,te):A.removeAttribute(H);break;case"rowSpan":case"start":te==null||typeof te=="function"||typeof te=="symbol"||isNaN(te)?A.removeAttribute(H):A.setAttribute(H,te);break;case"popover":Ri("beforetoggle",A),Ri("toggle",A),La(A,"popover",te);break;case"xlinkActuate":Hn(A,"http://www.w3.org/1999/xlink","xlink:actuate",te);break;case"xlinkArcrole":Hn(A,"http://www.w3.org/1999/xlink","xlink:arcrole",te);break;case"xlinkRole":Hn(A,"http://www.w3.org/1999/xlink","xlink:role",te);break;case"xlinkShow":Hn(A,"http://www.w3.org/1999/xlink","xlink:show",te);break;case"xlinkTitle":Hn(A,"http://www.w3.org/1999/xlink","xlink:title",te);break;case"xlinkType":Hn(A,"http://www.w3.org/1999/xlink","xlink:type",te);break;case"xmlBase":Hn(A,"http://www.w3.org/XML/1998/namespace","xml:base",te);break;case"xmlLang":Hn(A,"http://www.w3.org/XML/1998/namespace","xml:lang",te);break;case"xmlSpace":Hn(A,"http://www.w3.org/XML/1998/namespace","xml:space",te);break;case"is":La(A,"is",te);break;case"innerText":case"textContent":break;default:(!(2<H.length)||H[0]!=="o"&&H[0]!=="O"||H[1]!=="n"&&H[1]!=="N")&&(H=Eu.get(H)||H,La(A,H,te))}}function Rd(A,O,H,te,se,ue){switch(H){case"style":Js(A,te,ue);break;case"dangerouslySetInnerHTML":if(te!=null){if(typeof te!="object"||!("__html"in te))throw Error(R(61));if(H=te.__html,H!=null){if(se.children!=null)throw Error(R(60));A.innerHTML=H}}break;case"children":typeof te=="string"?_r(A,te):(typeof te=="number"||typeof te=="bigint")&&_r(A,""+te);break;case"onScroll":te!=null&&Ri("scroll",A);break;case"onScrollEnd":te!=null&&Ri("scrollend",A);break;case"onClick":te!=null&&(A.onclick=Xl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!js.hasOwnProperty(H))e:{if(H[0]==="o"&&H[1]==="n"&&(se=H.endsWith("Capture"),O=H.slice(2,se?H.length-7:void 0),ue=A[Ei]||null,ue=ue!=null?ue[H]:null,typeof ue=="function"&&A.removeEventListener(O,ue,se),typeof te=="function")){typeof ue!="function"&&ue!==null&&(H in A?A[H]=null:A.hasAttribute(H)&&A.removeAttribute(H)),A.addEventListener(O,te,se);break e}H in A?A[H]=te:te===!0?A.setAttribute(H,""):La(A,H,te)}}}function mn(A,O,H){switch(O){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ri("error",A),Ri("load",A);var te=!1,se=!1,ue;for(ue in H)if(H.hasOwnProperty(ue)){var ye=H[ue];if(ye!=null)switch(ue){case"src":te=!0;break;case"srcSet":se=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(R(137,O));default:Fi(A,O,ue,ye,H,null)}}se&&Fi(A,O,"srcSet",H.srcSet,H,null),te&&Fi(A,O,"src",H.src,H,null);return;case"input":Ri("invalid",A);var Te=ue=ye=se=null,_e=null,De=null;for(te in H)if(H.hasOwnProperty(te)){var ut=H[te];if(ut!=null)switch(te){case"name":se=ut;break;case"type":ye=ut;break;case"checked":_e=ut;break;case"defaultChecked":De=ut;break;case"value":ue=ut;break;case"defaultValue":Te=ut;break;case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(R(137,O));break;default:Fi(A,O,te,ut,H,null)}}$s(A,ue,Te,_e,De,ye,se,!1),ja(A);return;case"select":Ri("invalid",A),te=ye=ue=null;for(se in H)if(H.hasOwnProperty(se)&&(Te=H[se],Te!=null))switch(se){case"value":ue=Te;break;case"defaultValue":ye=Te;break;case"multiple":te=Te;default:Fi(A,O,se,Te,H,null)}O=ue,H=ye,A.multiple=!!te,O!=null?xr(A,!!te,O,!1):H!=null&&xr(A,!!te,H,!0);return;case"textarea":Ri("invalid",A),ue=se=te=null;for(ye in H)if(H.hasOwnProperty(ye)&&(Te=H[ye],Te!=null))switch(ye){case"value":te=Te;break;case"defaultValue":se=Te;break;case"children":ue=Te;break;case"dangerouslySetInnerHTML":if(Te!=null)throw Error(R(91));break;default:Fi(A,O,ye,Te,H,null)}Ws(A,te,se,ue),ja(A);return;case"option":for(_e in H)if(H.hasOwnProperty(_e)&&(te=H[_e],te!=null))switch(_e){case"selected":A.selected=te&&typeof te!="function"&&typeof te!="symbol";break;default:Fi(A,O,_e,te,H,null)}return;case"dialog":Ri("cancel",A),Ri("close",A);break;case"iframe":case"object":Ri("load",A);break;case"video":case"audio":for(te=0;te<Ts.length;te++)Ri(Ts[te],A);break;case"image":Ri("error",A),Ri("load",A);break;case"details":Ri("toggle",A);break;case"embed":case"source":case"link":Ri("error",A),Ri("load",A);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(De in H)if(H.hasOwnProperty(De)&&(te=H[De],te!=null))switch(De){case"children":case"dangerouslySetInnerHTML":throw Error(R(137,O));default:Fi(A,O,De,te,H,null)}return;default:if(No(O)){for(ut in H)H.hasOwnProperty(ut)&&(te=H[ut],te!==void 0&&Rd(A,O,ut,te,H,void 0));return}}for(Te in H)H.hasOwnProperty(Te)&&(te=H[Te],te!=null&&Fi(A,O,Te,te,H,null))}function rg(A,O,H,te){switch(O){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var se=null,ue=null,ye=null,Te=null,_e=null,De=null,ut=null;for(ot in H){var Ht=H[ot];if(H.hasOwnProperty(ot)&&Ht!=null)switch(ot){case"checked":break;case"value":break;case"defaultValue":_e=Ht;default:te.hasOwnProperty(ot)||Fi(A,O,ot,null,te,Ht)}}for(var Ke in te){var ot=te[Ke];if(Ht=H[Ke],te.hasOwnProperty(Ke)&&(ot!=null||Ht!=null))switch(Ke){case"type":ue=ot;break;case"name":se=ot;break;case"checked":De=ot;break;case"defaultChecked":ut=ot;break;case"value":ye=ot;break;case"defaultValue":Te=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(R(137,O));break;default:ot!==Ht&&Fi(A,O,Ke,ot,te,Ht)}}Bo(A,ye,Te,_e,De,ut,ue,se);return;case"select":ot=ye=Te=Ke=null;for(ue in H)if(_e=H[ue],H.hasOwnProperty(ue)&&_e!=null)switch(ue){case"value":break;case"multiple":ot=_e;default:te.hasOwnProperty(ue)||Fi(A,O,ue,null,te,_e)}for(se in te)if(ue=te[se],_e=H[se],te.hasOwnProperty(se)&&(ue!=null||_e!=null))switch(se){case"value":Ke=ue;break;case"defaultValue":Te=ue;break;case"multiple":ye=ue;default:ue!==_e&&Fi(A,O,se,ue,te,_e)}O=Te,H=ye,te=ot,Ke!=null?xr(A,!!H,Ke,!1):!!te!=!!H&&(O!=null?xr(A,!!H,O,!0):xr(A,!!H,H?[]:"",!1));return;case"textarea":ot=Ke=null;for(Te in H)if(se=H[Te],H.hasOwnProperty(Te)&&se!=null&&!te.hasOwnProperty(Te))switch(Te){case"value":break;case"children":break;default:Fi(A,O,Te,null,te,se)}for(ye in te)if(se=te[ye],ue=H[ye],te.hasOwnProperty(ye)&&(se!=null||ue!=null))switch(ye){case"value":Ke=se;break;case"defaultValue":ot=se;break;case"children":break;case"dangerouslySetInnerHTML":if(se!=null)throw Error(R(91));break;default:se!==ue&&Fi(A,O,ye,se,te,ue)}Gs(A,Ke,ot);return;case"option":for(var ui in H)if(Ke=H[ui],H.hasOwnProperty(ui)&&Ke!=null&&!te.hasOwnProperty(ui))switch(ui){case"selected":A.selected=!1;break;default:Fi(A,O,ui,null,te,Ke)}for(_e in te)if(Ke=te[_e],ot=H[_e],te.hasOwnProperty(_e)&&Ke!==ot&&(Ke!=null||ot!=null))switch(_e){case"selected":A.selected=Ke&&typeof Ke!="function"&&typeof Ke!="symbol";break;default:Fi(A,O,_e,Ke,te,ot)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var gi in H)Ke=H[gi],H.hasOwnProperty(gi)&&Ke!=null&&!te.hasOwnProperty(gi)&&Fi(A,O,gi,null,te,Ke);for(De in te)if(Ke=te[De],ot=H[De],te.hasOwnProperty(De)&&Ke!==ot&&(Ke!=null||ot!=null))switch(De){case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(R(137,O));break;default:Fi(A,O,De,Ke,te,ot)}return;default:if(No(O)){for(var Zi in H)Ke=H[Zi],H.hasOwnProperty(Zi)&&Ke!==void 0&&!te.hasOwnProperty(Zi)&&Rd(A,O,Zi,void 0,te,Ke);for(ut in te)Ke=te[ut],ot=H[ut],!te.hasOwnProperty(ut)||Ke===ot||Ke===void 0&&ot===void 0||Rd(A,O,ut,Ke,te,ot);return}}for(var Fe in H)Ke=H[Fe],H.hasOwnProperty(Fe)&&Ke!=null&&!te.hasOwnProperty(Fe)&&Fi(A,O,Fe,null,te,Ke);for(Ht in te)Ke=te[Ht],ot=H[Ht],!te.hasOwnProperty(Ht)||Ke===ot||Ke==null&&ot==null||Fi(A,O,Ht,Ke,te,ot)}var kd=null,xd=null;function Yl(A){return A.nodeType===9?A:A.ownerDocument}function Cp(A){switch(A){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ep(A,O){if(A===0)switch(O){case"svg":return 1;case"math":return 2;default:return 0}return A===1&&O==="foreignObject"?0:A}function _d(A,O){return A==="textarea"||A==="noscript"||typeof O.children=="string"||typeof O.children=="number"||typeof O.children=="bigint"||typeof O.dangerouslySetInnerHTML=="object"&&O.dangerouslySetInnerHTML!==null&&O.dangerouslySetInnerHTML.__html!=null}var Ad=null;function ag(){var A=window.event;return A&&A.type==="popstate"?A===Ad?!1:(Ad=A,!0):(Ad=null,!1)}var wp=typeof setTimeout=="function"?setTimeout:void 0,og=typeof clearTimeout=="function"?clearTimeout:void 0,Tp=typeof Promise=="function"?Promise:void 0,sg=typeof queueMicrotask=="function"?queueMicrotask:typeof Tp<"u"?function(A){return Tp.resolve(null).then(A).catch(lg)}:wp;function lg(A){setTimeout(function(){throw A})}function Md(A,O){var H=O,te=0;do{var se=H.nextSibling;if(A.removeChild(H),se&&se.nodeType===8)if(H=se.data,H==="/$"){if(te===0){A.removeChild(se),Ds(O);return}te--}else H!=="$"&&H!=="$?"&&H!=="$!"||te++;H=se}while(H);Ds(O)}function Id(A){var O=A.firstChild;for(O&&O.nodeType===10&&(O=O.nextSibling);O;){var H=O;switch(O=O.nextSibling,H.nodeName){case"HTML":case"HEAD":case"BODY":Id(H),Do(H);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(H.rel.toLowerCase()==="stylesheet")continue}A.removeChild(H)}}function ug(A,O,H,te){for(;A.nodeType===1;){var se=H;if(A.nodeName.toLowerCase()!==O.toLowerCase()){if(!te&&(A.nodeName!=="INPUT"||A.type!=="hidden"))break}else if(te){if(!A[ia])switch(O){case"meta":if(!A.hasAttribute("itemprop"))break;return A;case"link":if(ue=A.getAttribute("rel"),ue==="stylesheet"&&A.hasAttribute("data-precedence"))break;if(ue!==se.rel||A.getAttribute("href")!==(se.href==null?null:se.href)||A.getAttribute("crossorigin")!==(se.crossOrigin==null?null:se.crossOrigin)||A.getAttribute("title")!==(se.title==null?null:se.title))break;return A;case"style":if(A.hasAttribute("data-precedence"))break;return A;case"script":if(ue=A.getAttribute("src"),(ue!==(se.src==null?null:se.src)||A.getAttribute("type")!==(se.type==null?null:se.type)||A.getAttribute("crossorigin")!==(se.crossOrigin==null?null:se.crossOrigin))&&ue&&A.hasAttribute("async")&&!A.hasAttribute("itemprop"))break;return A;default:return A}}else if(O==="input"&&A.type==="hidden"){var ue=se.name==null?null:""+se.name;if(se.type==="hidden"&&A.getAttribute("name")===ue)return A}else return A;if(A=Wn(A.nextSibling),A===null)break}return null}function cg(A,O,H){if(O==="")return null;for(;A.nodeType!==3;)if((A.nodeType!==1||A.nodeName!=="INPUT"||A.type!=="hidden")&&!H||(A=Wn(A.nextSibling),A===null))return null;return A}function Wn(A){for(;A!=null;A=A.nextSibling){var O=A.nodeType;if(O===1||O===3)break;if(O===8){if(O=A.data,O==="$"||O==="$!"||O==="$?"||O==="F!"||O==="F")break;if(O==="/$")return null}}return A}function Rp(A){A=A.previousSibling;for(var O=0;A;){if(A.nodeType===8){var H=A.data;if(H==="$"||H==="$!"||H==="$?"){if(O===0)return A;O--}else H==="/$"&&O++}A=A.previousSibling}return null}function kp(A,O,H){switch(O=Yl(H),A){case"html":if(A=O.documentElement,!A)throw Error(R(452));return A;case"head":if(A=O.head,!A)throw Error(R(453));return A;case"body":if(A=O.body,!A)throw Error(R(454));return A;default:throw Error(R(451))}}var Ln=new Map,xp=new Set;function Zl(A){return typeof A.getRootNode=="function"?A.getRootNode():A.ownerDocument}var Er=Je.d;Je.d={f:dg,r:hg,D:fg,C:pg,L:mg,m:gg,X:bg,S:vg,M:yg};function dg(){var A=Er.f(),O=zl();return A||O}function hg(A){var O=Tr(A);O!==null&&O.tag===5&&O.type==="form"?Qh(O):Er.r(A)}var Ro=typeof document>"u"?null:document;function Ap(A,O,H){var te=Ro;if(te&&typeof O=="string"&&O){var se=En(O);se='link[rel="'+A+'"][href="'+se+'"]',typeof H=="string"&&(se+='[crossorigin="'+H+'"]'),xp.has(se)||(xp.add(se),A={rel:A,crossOrigin:H,href:O},te.querySelector(se)===null&&(O=te.createElement("link"),mn(O,"link",A),tn(O),te.head.appendChild(O)))}}function fg(A){Er.D(A),Ap("dns-prefetch",A,null)}function pg(A,O){Er.C(A,O),Ap("preconnect",A,O)}function mg(A,O,H){Er.L(A,O,H);var te=Ro;if(te&&A&&O){var se='link[rel="preload"][as="'+En(O)+'"]';O==="image"&&H&&H.imageSrcSet?(se+='[imagesrcset="'+En(H.imageSrcSet)+'"]',typeof H.imageSizes=="string"&&(se+='[imagesizes="'+En(H.imageSizes)+'"]')):se+='[href="'+En(A)+'"]';var ue=se;switch(O){case"style":ue=ko(A);break;case"script":ue=xo(A)}Ln.has(ue)||(A=Re({rel:"preload",href:O==="image"&&H&&H.imageSrcSet?void 0:A,as:O},H),Ln.set(ue,A),te.querySelector(se)!==null||O==="style"&&te.querySelector(ks(ue))||O==="script"&&te.querySelector(xs(ue))||(O=te.createElement("link"),mn(O,"link",A),tn(O),te.head.appendChild(O)))}}function gg(A,O){Er.m(A,O);var H=Ro;if(H&&A){var te=O&&typeof O.as=="string"?O.as:"script",se='link[rel="modulepreload"][as="'+En(te)+'"][href="'+En(A)+'"]',ue=se;switch(te){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":ue=xo(A)}if(!Ln.has(ue)&&(A=Re({rel:"modulepreload",href:A},O),Ln.set(ue,A),H.querySelector(se)===null)){switch(te){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(H.querySelector(xs(ue)))return}te=H.createElement("link"),mn(te,"link",A),tn(te),H.head.appendChild(te)}}}function vg(A,O,H){Er.S(A,O,H);var te=Ro;if(te&&A){var se=Rr(te).hoistableStyles,ue=ko(A);O=O||"default";var ye=se.get(ue);if(!ye){var Te={loading:0,preload:null};if(ye=te.querySelector(ks(ue)))Te.loading=5;else{A=Re({rel:"stylesheet",href:A,"data-precedence":O},H),(H=Ln.get(ue))&&Pd(A,H);var _e=ye=te.createElement("link");tn(_e),mn(_e,"link",A),_e._p=new Promise(function(De,ut){_e.onload=De,_e.onerror=ut}),_e.addEventListener("load",function(){Te.loading|=1}),_e.addEventListener("error",function(){Te.loading|=2}),Te.loading|=4,Ql(ye,O,te)}ye={type:"stylesheet",instance:ye,count:1,state:Te},se.set(ue,ye)}}}function bg(A,O){Er.X(A,O);var H=Ro;if(H&&A){var te=Rr(H).hoistableScripts,se=xo(A),ue=te.get(se);ue||(ue=H.querySelector(xs(se)),ue||(A=Re({src:A,async:!0},O),(O=Ln.get(se))&&Od(A,O),ue=H.createElement("script"),tn(ue),mn(ue,"link",A),H.head.appendChild(ue)),ue={type:"script",instance:ue,count:1,state:null},te.set(se,ue))}}function yg(A,O){Er.M(A,O);var H=Ro;if(H&&A){var te=Rr(H).hoistableScripts,se=xo(A),ue=te.get(se);ue||(ue=H.querySelector(xs(se)),ue||(A=Re({src:A,async:!0,type:"module"},O),(O=Ln.get(se))&&Od(A,O),ue=H.createElement("script"),tn(ue),mn(ue,"link",A),H.head.appendChild(ue)),ue={type:"script",instance:ue,count:1,state:null},te.set(se,ue))}}function Mp(A,O,H,te){var se=(se=Ci.current)?Zl(se):null;if(!se)throw Error(R(446));switch(A){case"meta":case"title":return null;case"style":return typeof H.precedence=="string"&&typeof H.href=="string"?(O=ko(H.href),H=Rr(se).hoistableStyles,te=H.get(O),te||(te={type:"style",instance:null,count:0,state:null},H.set(O,te)),te):{type:"void",instance:null,count:0,state:null};case"link":if(H.rel==="stylesheet"&&typeof H.href=="string"&&typeof H.precedence=="string"){A=ko(H.href);var ue=Rr(se).hoistableStyles,ye=ue.get(A);if(ye||(se=se.ownerDocument||se,ye={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},ue.set(A,ye),(ue=se.querySelector(ks(A)))&&!ue._p&&(ye.instance=ue,ye.state.loading=5),Ln.has(A)||(H={rel:"preload",as:"style",href:H.href,crossOrigin:H.crossOrigin,integrity:H.integrity,media:H.media,hrefLang:H.hrefLang,referrerPolicy:H.referrerPolicy},Ln.set(A,H),ue||Sg(se,A,H,ye.state))),O&&te===null)throw Error(R(528,""));return ye}if(O&&te!==null)throw Error(R(529,""));return null;case"script":return O=H.async,H=H.src,typeof H=="string"&&O&&typeof O!="function"&&typeof O!="symbol"?(O=xo(H),H=Rr(se).hoistableScripts,te=H.get(O),te||(te={type:"script",instance:null,count:0,state:null},H.set(O,te)),te):{type:"void",instance:null,count:0,state:null};default:throw Error(R(444,A))}}function ko(A){return'href="'+En(A)+'"'}function ks(A){return'link[rel="stylesheet"]['+A+"]"}function Ip(A){return Re({},A,{"data-precedence":A.precedence,precedence:null})}function Sg(A,O,H,te){A.querySelector('link[rel="preload"][as="style"]['+O+"]")?te.loading=1:(O=A.createElement("link"),te.preload=O,O.addEventListener("load",function(){return te.loading|=1}),O.addEventListener("error",function(){return te.loading|=2}),mn(O,"link",H),tn(O),A.head.appendChild(O))}function xo(A){return'[src="'+En(A)+'"]'}function xs(A){return"script[async]"+A}function Pp(A,O,H){if(O.count++,O.instance===null)switch(O.type){case"style":var te=A.querySelector('style[data-href~="'+En(H.href)+'"]');if(te)return O.instance=te,tn(te),te;var se=Re({},H,{"data-href":H.href,"data-precedence":H.precedence,href:null,precedence:null});return te=(A.ownerDocument||A).createElement("style"),tn(te),mn(te,"style",se),Ql(te,H.precedence,A),O.instance=te;case"stylesheet":se=ko(H.href);var ue=A.querySelector(ks(se));if(ue)return O.state.loading|=4,O.instance=ue,tn(ue),ue;te=Ip(H),(se=Ln.get(se))&&Pd(te,se),ue=(A.ownerDocument||A).createElement("link"),tn(ue);var ye=ue;return ye._p=new Promise(function(Te,_e){ye.onload=Te,ye.onerror=_e}),mn(ue,"link",te),O.state.loading|=4,Ql(ue,H.precedence,A),O.instance=ue;case"script":return ue=xo(H.src),(se=A.querySelector(xs(ue)))?(O.instance=se,tn(se),se):(te=H,(se=Ln.get(ue))&&(te=Re({},H),Od(te,se)),A=A.ownerDocument||A,se=A.createElement("script"),tn(se),mn(se,"link",te),A.head.appendChild(se),O.instance=se);case"void":return null;default:throw Error(R(443,O.type))}else O.type==="stylesheet"&&!(O.state.loading&4)&&(te=O.instance,O.state.loading|=4,Ql(te,H.precedence,A));return O.instance}function Ql(A,O,H){for(var te=H.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),se=te.length?te[te.length-1]:null,ue=se,ye=0;ye<te.length;ye++){var Te=te[ye];if(Te.dataset.precedence===O)ue=Te;else if(ue!==se)break}ue?ue.parentNode.insertBefore(A,ue.nextSibling):(O=H.nodeType===9?H.head:H,O.insertBefore(A,O.firstChild))}function Pd(A,O){A.crossOrigin==null&&(A.crossOrigin=O.crossOrigin),A.referrerPolicy==null&&(A.referrerPolicy=O.referrerPolicy),A.title==null&&(A.title=O.title)}function Od(A,O){A.crossOrigin==null&&(A.crossOrigin=O.crossOrigin),A.referrerPolicy==null&&(A.referrerPolicy=O.referrerPolicy),A.integrity==null&&(A.integrity=O.integrity)}var eu=null;function Op(A,O,H){if(eu===null){var te=new Map,se=eu=new Map;se.set(H,te)}else se=eu,te=se.get(H),te||(te=new Map,se.set(H,te));if(te.has(A))return te;for(te.set(A,null),H=H.getElementsByTagName(A),se=0;se<H.length;se++){var ue=H[se];if(!(ue[ia]||ue[_i]||A==="link"&&ue.getAttribute("rel")==="stylesheet")&&ue.namespaceURI!=="http://www.w3.org/2000/svg"){var ye=ue.getAttribute(O)||"";ye=A+ye;var Te=te.get(ye);Te?Te.push(ue):te.set(ye,[ue])}}return te}function Dp(A,O,H){A=A.ownerDocument||A,A.head.insertBefore(H,O==="title"?A.querySelector("head > title"):null)}function Cg(A,O,H){if(H===1||O.itemProp!=null)return!1;switch(A){case"meta":case"title":return!0;case"style":if(typeof O.precedence!="string"||typeof O.href!="string"||O.href==="")break;return!0;case"link":if(typeof O.rel!="string"||typeof O.href!="string"||O.href===""||O.onLoad||O.onError)break;switch(O.rel){case"stylesheet":return A=O.disabled,typeof O.precedence=="string"&&A==null;default:return!0}case"script":if(O.async&&typeof O.async!="function"&&typeof O.async!="symbol"&&!O.onLoad&&!O.onError&&O.src&&typeof O.src=="string")return!0}return!1}function Bp(A){return!(A.type==="stylesheet"&&!(A.state.loading&3))}var As=null;function Eg(){}function wg(A,O,H){if(As===null)throw Error(R(475));var te=As;if(O.type==="stylesheet"&&(typeof H.media!="string"||matchMedia(H.media).matches!==!1)&&!(O.state.loading&4)){if(O.instance===null){var se=ko(H.href),ue=A.querySelector(ks(se));if(ue){A=ue._p,A!==null&&typeof A=="object"&&typeof A.then=="function"&&(te.count++,te=tu.bind(te),A.then(te,te)),O.state.loading|=4,O.instance=ue,tn(ue);return}ue=A.ownerDocument||A,H=Ip(H),(se=Ln.get(se))&&Pd(H,se),ue=ue.createElement("link"),tn(ue);var ye=ue;ye._p=new Promise(function(Te,_e){ye.onload=Te,ye.onerror=_e}),mn(ue,"link",H),O.instance=ue}te.stylesheets===null&&(te.stylesheets=new Map),te.stylesheets.set(O,A),(A=O.state.preload)&&!(O.state.loading&3)&&(te.count++,O=tu.bind(te),A.addEventListener("load",O),A.addEventListener("error",O))}}function Tg(){if(As===null)throw Error(R(475));var A=As;return A.stylesheets&&A.count===0&&Dd(A,A.stylesheets),0<A.count?function(O){var H=setTimeout(function(){if(A.stylesheets&&Dd(A,A.stylesheets),A.unsuspend){var te=A.unsuspend;A.unsuspend=null,te()}},6e4);return A.unsuspend=O,function(){A.unsuspend=null,clearTimeout(H)}}:null}function tu(){if(this.count--,this.count===0){if(this.stylesheets)Dd(this,this.stylesheets);else if(this.unsuspend){var A=this.unsuspend;this.unsuspend=null,A()}}}var iu=null;function Dd(A,O){A.stylesheets=null,A.unsuspend!==null&&(A.count++,iu=new Map,O.forEach(Rg,A),iu=null,tu.call(A))}function Rg(A,O){if(!(O.state.loading&4)){var H=iu.get(A);if(H)var te=H.get(null);else{H=new Map,iu.set(A,H);for(var se=A.querySelectorAll("link[data-precedence],style[data-precedence]"),ue=0;ue<se.length;ue++){var ye=se[ue];(ye.nodeName==="LINK"||ye.getAttribute("media")!=="not all")&&(H.set(ye.dataset.precedence,ye),te=ye)}te&&H.set(null,te)}se=O.instance,ye=se.getAttribute("data-precedence"),ue=H.get(ye)||te,ue===te&&H.set(null,se),H.set(ye,se),this.count++,te=tu.bind(this),se.addEventListener("load",te),se.addEventListener("error",te),ue?ue.parentNode.insertBefore(se,ue.nextSibling):(A=A.nodeType===9?A.head:A,A.insertBefore(se,A.firstChild)),O.state.loading|=4}}var Ms={$$typeof:ne,Provider:null,Consumer:null,_currentValue:Rt,_currentValue2:Rt,_threadCount:0};function kg(A,O,H,te,se,ue,ye,Te){this.tag=1,this.containerInfo=A,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ze(0),this.hiddenUpdates=Ze(null),this.identifierPrefix=te,this.onUncaughtError=se,this.onCaughtError=ue,this.onRecoverableError=ye,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Te,this.incompleteTransitions=new Map}function Vp(A,O,H,te,se,ue,ye,Te,_e,De,ut,Ht){return A=new kg(A,O,H,ye,Te,_e,De,Ht),O=1,ue===!0&&(O|=24),ue=Vn(3,null,null,O),A.current=ue,ue.stateNode=A,O=hc(),O.refCount++,A.pooledCache=O,O.refCount++,ue.memoizedState={element:te,isDehydrated:H,cache:O},Gc(ue),A}function Np(A){return A?(A=Za,A):Za}function Lp(A,O,H,te,se,ue){se=Np(se),te.context===null?te.context=se:te.pendingContext=se,te=Fr(O),te.payload={element:H},ue=ue===void 0?null:ue,ue!==null&&(te.callback=ue),H=jr(A,te,O),H!==null&&(Sn(H,A,O),hs(H,A,O))}function Fp(A,O){if(A=A.memoizedState,A!==null&&A.dehydrated!==null){var H=A.retryLane;A.retryLane=H!==0&&H<O?H:O}}function Bd(A,O){Fp(A,O),(A=A.alternate)&&Fp(A,O)}function jp(A){if(A.tag===13){var O=Pr(A,67108864);O!==null&&Sn(O,A,67108864),Bd(A,67108864)}}var nu=!0;function xg(A,O,H,te){var se=Se.T;Se.T=null;var ue=Je.p;try{Je.p=2,Vd(A,O,H,te)}finally{Je.p=ue,Se.T=se}}function _g(A,O,H,te){var se=Se.T;Se.T=null;var ue=Je.p;try{Je.p=8,Vd(A,O,H,te)}finally{Je.p=ue,Se.T=se}}function Vd(A,O,H,te){if(nu){var se=Nd(te);if(se===null)Td(A,O,te,ru,H),Up(A,te);else if(Mg(se,A,O,H,te))te.stopPropagation();else if(Up(A,te),O&4&&-1<Ag.indexOf(A)){for(;se!==null;){var ue=Tr(se);if(ue!==null)switch(ue.tag){case 3:if(ue=ue.stateNode,ue.current.memoizedState.isDehydrated){var ye=qe(ue.pendingLanes);if(ye!==0){var Te=ue;for(Te.pendingLanes|=2,Te.entangledLanes|=2;ye;){var _e=1<<31-ke(ye);Te.entanglements[1]|=_e,ye&=~_e}tr(ue),!(Gi&6)&&(ql=Bi()+500,ws(0))}}break;case 13:Te=Pr(ue,2),Te!==null&&Sn(Te,ue,2),zl(),Bd(ue,2)}if(ue=Nd(te),ue===null&&Td(A,O,te,ru,H),ue===se)break;se=ue}se!==null&&te.stopPropagation()}else Td(A,O,te,null,H)}}function Nd(A){return A=Fo(A),Ld(A)}var ru=null;function Ld(A){if(ru=null,A=ar(A),A!==null){var O=Xe(A);if(O===null)A=null;else{var H=O.tag;if(H===13){if(A=zt(O),A!==null)return A;A=null}else if(H===3){if(O.stateNode.current.memoizedState.isDehydrated)return O.tag===3?O.stateNode.containerInfo:null;A=null}else O!==A&&(A=null)}}return ru=A,null}function qp(A){switch(A){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ji()){case Bt:return 2;case it:return 8;case ti:case Ee:return 32;case ct:return 268435456;default:return 32}default:return 32}}var Fd=!1,Jr=null,Xr=null,Yr=null,Is=new Map,Ps=new Map,Zr=[],Ag="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Up(A,O){switch(A){case"focusin":case"focusout":Jr=null;break;case"dragenter":case"dragleave":Xr=null;break;case"mouseover":case"mouseout":Yr=null;break;case"pointerover":case"pointerout":Is.delete(O.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ps.delete(O.pointerId)}}function Os(A,O,H,te,se,ue){return A===null||A.nativeEvent!==ue?(A={blockedOn:O,domEventName:H,eventSystemFlags:te,nativeEvent:ue,targetContainers:[se]},O!==null&&(O=Tr(O),O!==null&&jp(O)),A):(A.eventSystemFlags|=te,O=A.targetContainers,se!==null&&O.indexOf(se)===-1&&O.push(se),A)}function Mg(A,O,H,te,se){switch(O){case"focusin":return Jr=Os(Jr,A,O,H,te,se),!0;case"dragenter":return Xr=Os(Xr,A,O,H,te,se),!0;case"mouseover":return Yr=Os(Yr,A,O,H,te,se),!0;case"pointerover":var ue=se.pointerId;return Is.set(ue,Os(Is.get(ue)||null,A,O,H,te,se)),!0;case"gotpointercapture":return ue=se.pointerId,Ps.set(ue,Os(Ps.get(ue)||null,A,O,H,te,se)),!0}return!1}function Hp(A){var O=ar(A.target);if(O!==null){var H=Xe(O);if(H!==null){if(O=H.tag,O===13){if(O=zt(H),O!==null){A.blockedOn=O,Jn(A.priority,function(){if(H.tag===13){var te=_n(),se=Pr(H,te);se!==null&&Sn(se,H,te),Bd(H,te)}});return}}else if(O===3&&H.stateNode.current.memoizedState.isDehydrated){A.blockedOn=H.tag===3?H.stateNode.containerInfo:null;return}}}A.blockedOn=null}function au(A){if(A.blockedOn!==null)return!1;for(var O=A.targetContainers;0<O.length;){var H=Nd(A.nativeEvent);if(H===null){H=A.nativeEvent;var te=new H.constructor(H.type,H);Lo=te,H.target.dispatchEvent(te),Lo=null}else return O=Tr(H),O!==null&&jp(O),A.blockedOn=H,!1;O.shift()}return!0}function zp(A,O,H){au(A)&&H.delete(O)}function Ig(){Fd=!1,Jr!==null&&au(Jr)&&(Jr=null),Xr!==null&&au(Xr)&&(Xr=null),Yr!==null&&au(Yr)&&(Yr=null),Is.forEach(zp),Ps.forEach(zp)}function ou(A,O){A.blockedOn===O&&(A.blockedOn=null,Fd||(Fd=!0,C.unstable_scheduleCallback(C.unstable_NormalPriority,Ig)))}var su=null;function $p(A){su!==A&&(su=A,C.unstable_scheduleCallback(C.unstable_NormalPriority,function(){su===A&&(su=null);for(var O=0;O<A.length;O+=3){var H=A[O],te=A[O+1],se=A[O+2];if(typeof te!="function"){if(Ld(te||H)===null)continue;break}var ue=Tr(H);ue!==null&&(A.splice(O,3),O-=3,_c(ue,{pending:!0,data:se,method:H.method,action:te},te,se))}}))}function Ds(A){function O(_e){return ou(_e,A)}Jr!==null&&ou(Jr,A),Xr!==null&&ou(Xr,A),Yr!==null&&ou(Yr,A),Is.forEach(O),Ps.forEach(O);for(var H=0;H<Zr.length;H++){var te=Zr[H];te.blockedOn===A&&(te.blockedOn=null)}for(;0<Zr.length&&(H=Zr[0],H.blockedOn===null);)Hp(H),H.blockedOn===null&&Zr.shift();if(H=(A.ownerDocument||A).$$reactFormReplay,H!=null)for(te=0;te<H.length;te+=3){var se=H[te],ue=H[te+1],ye=se[Ei]||null;if(typeof ue=="function")ye||$p(H);else if(ye){var Te=null;if(ue&&ue.hasAttribute("formAction")){if(se=ue,ye=ue[Ei]||null)Te=ye.formAction;else if(Ld(se)!==null)continue}else Te=ye.action;typeof Te=="function"?H[te+1]=Te:(H.splice(te,3),te-=3),$p(H)}}}function jd(A){this._internalRoot=A}lu.prototype.render=jd.prototype.render=function(A){var O=this._internalRoot;if(O===null)throw Error(R(409));var H=O.current,te=_n();Lp(H,te,A,O,null,null)},lu.prototype.unmount=jd.prototype.unmount=function(){var A=this._internalRoot;if(A!==null){this._internalRoot=null;var O=A.containerInfo;A.tag===0&&Eo(),Lp(A.current,2,null,A,null,null),zl(),O[un]=null}};function lu(A){this._internalRoot=A}lu.prototype.unstable_scheduleHydration=function(A){if(A){var O=qn();A={blockedOn:null,target:A,priority:O};for(var H=0;H<Zr.length&&O!==0&&O<Zr[H].priority;H++);Zr.splice(H,0,A),H===0&&Hp(A)}};var Gp=E.version;if(Gp!=="19.0.0")throw Error(R(527,Gp,"19.0.0"));Je.findDOMNode=function(A){var O=A._reactInternals;if(O===void 0)throw typeof A.render=="function"?Error(R(188)):(A=Object.keys(A).join(","),Error(R(268,A)));return A=$e(O),A=A!==null?We(A):null,A=A===null?null:A.stateNode,A};var Pg={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Se,findFiberByHostInstance:ar,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uu.isDisabled&&uu.supportsFiber)try{ft=uu.inject(Pg),Ie=uu}catch{}}return reactDomClient_production.createRoot=function(A,O){if(!M(A))throw Error(R(299));var H=!1,te="",se=lf,ue=uf,ye=cf,Te=null;return O!=null&&(O.unstable_strictMode===!0&&(H=!0),O.identifierPrefix!==void 0&&(te=O.identifierPrefix),O.onUncaughtError!==void 0&&(se=O.onUncaughtError),O.onCaughtError!==void 0&&(ue=O.onCaughtError),O.onRecoverableError!==void 0&&(ye=O.onRecoverableError),O.unstable_transitionCallbacks!==void 0&&(Te=O.unstable_transitionCallbacks)),O=Vp(A,1,!1,null,null,H,te,se,ue,ye,Te,null),A[un]=O.current,wd(A.nodeType===8?A.parentNode:A),new jd(O)},reactDomClient_production.hydrateRoot=function(A,O,H){if(!M(A))throw Error(R(299));var te=!1,se="",ue=lf,ye=uf,Te=cf,_e=null,De=null;return H!=null&&(H.unstable_strictMode===!0&&(te=!0),H.identifierPrefix!==void 0&&(se=H.identifierPrefix),H.onUncaughtError!==void 0&&(ue=H.onUncaughtError),H.onCaughtError!==void 0&&(ye=H.onCaughtError),H.onRecoverableError!==void 0&&(Te=H.onRecoverableError),H.unstable_transitionCallbacks!==void 0&&(_e=H.unstable_transitionCallbacks),H.formState!==void 0&&(De=H.formState)),O=Vp(A,1,!0,O,H??null,te,se,ue,ye,Te,_e,De),O.context=Np(null),H=O.current,te=_n(),se=Fr(te),se.callback=null,jr(H,se,te),O.current.lanes=te,$t(O,te),tr(O),A[un]=O.current,wd(A),new lu(O)},reactDomClient_production.version="19.0.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function C(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(C)}catch(E){console.error(E)}}return C(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var rr;let Logger$1=(rr=class{constructor(){Pa(this,"LEVEL",Object.freeze({DEBUG:1,INFO:2,WARN:3,ERROR:4}));Pa(this,"level",this.LEVEL.DEBUG);Pa(this,"logs",[]);Pa(this,"maxLogSize",5e3);Pa(this,"getCallerInfo",()=>{const M=(new Error().stack||"").split(`
`)[4]||"",S=/\((.*):(\d+):(\d+)\)/.exec(M);return S&&S.length===4?`${S[1]}:${S[2]}`:"unknown"})}static getLogger(){return rr.instance||(rr.instance=new rr),rr.instance}debug(...E){this.level>this.LEVEL.DEBUG||this.logWithLevel("debug",E)}info(...E){this.level>this.LEVEL.INFO||this.logWithLevel("info",E)}warn(...E){this.level>this.LEVEL.WARN||this.logWithLevel("warn",E)}error(...E){this.level>this.LEVEL.ERROR||this.logWithLevel("error",E)}getLogs(){return this.logs}logWithLevel(E,w){const R=new Date().toISOString(),M=this.getCallerInfo();w.unshift(`[${R}]`),console[E].apply(console,w),this.addLogEntry({timestamp:R,level:E,message:w,callerInfo:M})}addLogEntry(E){this.logs.length>=this.maxLogSize&&this.logs.shift(),this.logs.push(E)}},Pa(rr,"instance"),rr);const useAudioConfig=C=>{const[E,w]=reactExports.useState(null),[R,M]=reactExports.useState([]),[x,S]=reactExports.useState([]),T=reactExports.useRef(!1);reactExports.useEffect(()=>{const Y=()=>{if(T.current==!0)return;T.current=!0;const re=new URL(window.location.href).searchParams.get("sample_rate")||null;let oe;re?re=="default"?(Logger$1.getLogger().info("Sample rate: default"),oe=new AudioContext):(Logger$1.getLogger().info(`Sample rate: ${re}`),oe=new AudioContext({sampleRate:Number(re)})):(Logger$1.getLogger().info("Sample rate: default(48000)"),oe=new AudioContext({sampleRate:48e3})),Logger$1.getLogger().info(oe),w(oe),document.removeEventListener("touchstart",ee),document.removeEventListener("mousedown",ee)},ee=()=>{setTimeout(()=>{Y()},C.createAudioContextDelay)};document.addEventListener("touchstart",ee,!1),document.addEventListener("mousedown",ee,!1)},[]),reactExports.useEffect(()=>{E!=null&&_()},[E]);const _=async()=>{if(E===null)return;try{(await navigator.mediaDevices.getUserMedia({video:!1,audio:!0})).getTracks().forEach(re=>{re.stop()})}catch(ne){console.warn("Enumerate device error::",ne)}const Y=await navigator.mediaDevices.enumerateDevices(),ee=Y.filter(ne=>ne.kind=="audioinput");ee.push({deviceId:"none",groupId:"none",kind:"audioinput",label:"none",toJSON:()=>{}}),M(ee);const ie=Y.filter(ne=>ne.kind=="audiooutput");ie.push({deviceId:"none",groupId:"none",kind:"audiooutput",label:"none",toJSON:()=>{}}),S(ie)};return{audioContext:E,audioInputs:R,audioOutputs:x,reloadDeviceInfo:_}},useAppGuiSetting=()=>{const[C,E]=reactExports.useState(!1),[w,R]=reactExports.useState(null),[M,x]=reactExports.useState(null),[S,T]=reactExports.useState(null),[_,D]=reactExports.useState(null);return reactExports.useEffect(()=>{(async()=>{const ie=await(await fetch("/assets/gui_settings/GUI.json",{method:"GET"})).json();R(ie)})()},[]),reactExports.useEffect(()=>{(async()=>{const ie=await(await fetch("/assets/gui_settings/version.txt",{method:"GET"})).text();x(ie)})()},[]),reactExports.useEffect(()=>{(async()=>{const ie=await(await fetch("/assets/gui_settings/edition.txt",{method:"GET"})).text();T(ie)})()},[]),reactExports.useEffect(()=>{(async()=>{const ie=await(await fetch("/assets/gui_settings/edition_vc.txt",{method:"GET"})).text();D(ie)})()},[]),reactExports.useEffect(()=>{M!==null&&S!==null&&E(!0)},[M,S]),{guiSettingLoaded:C,setting:w,version:M,edition:S,editionVc:_}};var define_process_env_default={},Ur=Object.defineProperty,li=C=>{throw TypeError(C)},Hr=(C,E,w)=>E in C?Ur(C,E,{enumerable:!0,configurable:!0,writable:!0,value:w}):C[E]=w,ce=(C,E,w)=>Hr(C,typeof E!="symbol"?E+"":E,w),ci=(C,E,w)=>E.has(C)||li("Cannot "+w),Tt=(C,E,w)=>(ci(C,E,"read from private field"),w?w.call(C):E.get(C)),ei=(C,E,w)=>E.has(C)?li("Cannot add the same private member more than once"):E instanceof WeakSet?E.add(C):E.set(C,w),Ut=(C,E,w,R)=>(ci(C,E,"write to private field"),E.set(C,w),w);const fileSelector=async C=>{const E=document.createElement("input");return E.type="file",await new Promise((w,R)=>{E.onchange=M=>{if(!(M.target instanceof HTMLInputElement))return console.log("invalid target!",M.target),R("invalid target"),null;const x=M.target;return!x.files||x.files.length==0?(R("no file selected"),null):(w(x.files[0]),null)},E.oncancel=()=>{R("cancel")},E.click()})},fileSelectorAsDataURL=async C=>{const E=await fileSelector();return E&&await new Promise(w=>{const R=new FileReader;R.onload=()=>{console.log("load data",R.result),w(R.result)},R.readAsDataURL(E)})},downloadAsWav=C=>{const E=(_,D,Y)=>{for(var ee=0;ee<Y.length;ee++)_.setUint8(D+ee,Y.charCodeAt(ee))},w=(_,D,Y)=>{for(var ee=0;ee<Y.length;ee++,D+=2){var ie=Math.max(-1,Math.min(1,Y[ee]));_.setInt16(D,ie<0?ie*32768:ie*32767,!0)}},R=new ArrayBuffer(44+C.length*2),M=new DataView(R);E(M,0,"RIFF"),M.setUint32(4,32+C.length*2,!0),E(M,8,"WAVE"),E(M,12,"fmt "),M.setUint32(16,16,!0),M.setUint16(20,1,!0),M.setUint16(22,1,!0),M.setUint32(24,48e3,!0),M.setUint32(28,96e3,!0),M.setUint16(32,2,!0),M.setUint16(34,16,!0),E(M,36,"data"),M.setUint32(40,C.length*2,!0),w(M,44,C);const x=new Blob([M],{type:"audio/wav"}),S=URL.createObjectURL(x),T=document.createElement("a");T.href=S,T.download="output.wav",document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(S)},generateAudioBlob=C=>{const E=(x,S,T)=>{for(var _=0;_<T.length;_++)x.setUint8(S+_,T.charCodeAt(_))},w=(x,S,T)=>{for(var _=0;_<T.length;_++,S+=2){var D=Math.max(-1,Math.min(1,T[_]));x.setInt16(S,D<0?D*32768:D*32767,!0)}},R=new ArrayBuffer(44+C.length*2),M=new DataView(R);return E(M,0,"RIFF"),M.setUint32(4,32+C.length*2,!0),E(M,8,"WAVE"),E(M,12,"fmt "),M.setUint32(16,16,!0),M.setUint16(20,1,!0),M.setUint16(22,1,!0),M.setUint32(24,48e3,!0),M.setUint32(28,96e3,!0),M.setUint16(32,2,!0),M.setUint16(34,16,!0),E(M,36,"data"),M.setUint32(40,C.length*2,!0),w(M,44,C),new Blob([M],{type:"audio/wav"})},instanceOfAny=(C,E)=>E.some(w=>C instanceof w);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const transactionDoneMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(C){const E=new Promise((w,R)=>{const M=()=>{C.removeEventListener("success",x),C.removeEventListener("error",S)},x=()=>{w(wrap(C.result)),M()},S=()=>{R(C.error),M()};C.addEventListener("success",x),C.addEventListener("error",S)});return reverseTransformCache.set(E,C),E}function cacheDonePromiseForTransaction(C){if(transactionDoneMap.has(C))return;const E=new Promise((w,R)=>{const M=()=>{C.removeEventListener("complete",x),C.removeEventListener("error",S),C.removeEventListener("abort",S)},x=()=>{w(),M()},S=()=>{R(C.error||new DOMException("AbortError","AbortError")),M()};C.addEventListener("complete",x),C.addEventListener("error",S),C.addEventListener("abort",S)});transactionDoneMap.set(C,E)}let idbProxyTraps={get(C,E,w){if(C instanceof IDBTransaction){if(E==="done")return transactionDoneMap.get(C);if(E==="store")return w.objectStoreNames[1]?void 0:w.objectStore(w.objectStoreNames[0])}return wrap(C[E])},set(C,E,w){return C[E]=w,!0},has(C,E){return C instanceof IDBTransaction&&(E==="done"||E==="store")?!0:E in C}};function replaceTraps(C){idbProxyTraps=C(idbProxyTraps)}function wrapFunction(C){return getCursorAdvanceMethods().includes(C)?function(...E){return C.apply(unwrap(this),E),wrap(this.request)}:function(...E){return wrap(C.apply(unwrap(this),E))}}function transformCachableValue(C){return typeof C=="function"?wrapFunction(C):(C instanceof IDBTransaction&&cacheDonePromiseForTransaction(C),instanceOfAny(C,getIdbProxyableTypes())?new Proxy(C,idbProxyTraps):C)}function wrap(C){if(C instanceof IDBRequest)return promisifyRequest(C);if(transformCache.has(C))return transformCache.get(C);const E=transformCachableValue(C);return E!==C&&(transformCache.set(C,E),reverseTransformCache.set(E,C)),E}const unwrap=C=>reverseTransformCache.get(C);function openDB(C,E,{blocked:w,upgrade:R,blocking:M,terminated:x}={}){const S=indexedDB.open(C,E),T=wrap(S);return R&&S.addEventListener("upgradeneeded",_=>{R(wrap(S.result),_.oldVersion,_.newVersion,wrap(S.transaction),_)}),w&&S.addEventListener("blocked",_=>w(_.oldVersion,_.newVersion,_)),T.then(_=>{x&&_.addEventListener("close",()=>x()),M&&_.addEventListener("versionchange",D=>M(D.oldVersion,D.newVersion,D))}).catch(()=>{}),T}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(C,E){if(!(C instanceof IDBDatabase&&!(E in C)&&typeof E=="string"))return;if(cachedMethods.get(E))return cachedMethods.get(E);const w=E.replace(/FromIndex$/,""),R=E!==w,M=writeMethods.includes(w);if(!(w in(R?IDBIndex:IDBObjectStore).prototype)||!(M||readMethods.includes(w)))return;const x=async function(S,...T){const _=this.transaction(S,M?"readwrite":"readonly");let D=_.store;return R&&(D=D.index(T.shift())),(await Promise.all([D[w](...T),M&&_.done]))[0]};return cachedMethods.set(E,x),x}replaceTraps(C=>({...C,get:(E,w,R)=>getMethod(E,w)||C.get(E,w,R),has:(E,w)=>!!getMethod(E,w)||C.has(E,w)}));const advanceMethodProps=["continue","continuePrimaryKey","advance"],methodMap={},advanceResults=new WeakMap,ittrProxiedCursorToOriginalProxy=new WeakMap,cursorIteratorTraps={get(C,E){if(!advanceMethodProps.includes(E))return C[E];let w=methodMap[E];return w||(w=methodMap[E]=function(...R){advanceResults.set(this,ittrProxiedCursorToOriginalProxy.get(this)[E](...R))}),w}};async function*iterate(...C){let E=this;if(E instanceof IDBCursor||(E=await E.openCursor(...C)),!E)return;E=E;const w=new Proxy(E,cursorIteratorTraps);for(ittrProxiedCursorToOriginalProxy.set(w,E),reverseTransformCache.set(w,unwrap(E));E;)yield w,E=await(advanceResults.get(w)||E.continue()),advanceResults.delete(w)}function isIteratorProp(C,E){return E===Symbol.asyncIterator&&instanceOfAny(C,[IDBIndex,IDBObjectStore,IDBCursor])||E==="iterate"&&instanceOfAny(C,[IDBIndex,IDBObjectStore])}replaceTraps(C=>({...C,get(E,w,R){return isIteratorProp(E,w)?iterate:C.get(E,w,R)},has(E,w){return isIteratorProp(E,w)||C.has(E,w)}}));const DB_NAME="vcclient",DB_VERSION=1,STORE_NAME="client-setting-store",initDB=async()=>{openDB(DB_NAME,DB_VERSION,{upgrade(C){C.createObjectStore(STORE_NAME)}})},setItem=async(C,E)=>(await openDB(DB_NAME,DB_VERSION)).put(STORE_NAME,E,C),getItem=async C=>(await openDB(DB_NAME,DB_VERSION)).get(STORE_NAME,C),clearStore=async()=>{const C=(await openDB(DB_NAME,DB_VERSION)).transaction(STORE_NAME,"readwrite");await C.objectStore(STORE_NAME).clear(),await C.done},MAX_SLOT_INDEX=20,MAX_VOICE_CHARACTER_SLOT_INDEX=200,VCTypes=["seed-vc"],BasicVoiceType=["anger","disgust","fear","happy","sad","surprise","other"],LanguageType=["all_zh","en","all_ja","all_yue","zh","ja","yue","auto","auto_yue"],DefaultClientSettng={voiceChangerClientSetting:{audioInput:"none",sampleRate:48e3,echoCancel:!1,noiseSuppression:!1,noiseSuppression2:!1,inputGain:1,outputGain:1,monitorGain:1,passThroughConfirmationSkip:!1},workletNodeSetting:{serverUrl:"",protocol:"rest",sendingSampleRate:48e3,sendingChunkSec:.2,sendingChunkAsBulk:!1,enableFlatPath:!1,workOnColab:!1},workletSetting:{numTrancateTreshold:100,outputBufferFactor:5}},VOICE_CHANGER_CLIENT_EXCEPTION={ERR_SIO_CONNECT_FAILED:"ERR_SIO_CONNECT_FAILED",ERR_SIO_INVALID_RESPONSE:"ERR_SIO_INVALID_RESPONSE",ERR_REST_INVALID_RESPONSE:"ERR_REST_INVALID_RESPONSE",ERR_MIC_STREAM_NOT_INITIALIZED:"ERR_MIC_STREAM_NOT_INITIALIZED",ERR_INTERNAL_AUDIO_PROCESS_CALLBACK_IS_NOT_INITIALIZED:"ERR_INTERNAL_AUDIO_PROCESS_CALLBACK_IS_NOT_INITIALIZED",ERR_HTTP_EXCEPTION:"ERR_HTTP_EXCEPTION"};var Ft;class FileUploaderClient{constructor(){ei(this,Ft),ce(this,"enableFlatPath",!1),ce(this,"setBaseUrl",E=>{E.endsWith("/")&&(E=E.slice(0,-1)),Ut(this,Ft,E)}),ce(this,"setEnableFlatPath",E=>{this.enableFlatPath=E}),ce(this,"generatePath",E=>this.enableFlatPath?E[0]+E.slice(1).replace(/\//g,"_"):E),ce(this,"uploadFile",async(E,w,R)=>{const M=Tt(this,Ft)+this.generatePath("/api/uploader/upload_file_chunk");R(0,!1);const x=1024*1024;let S=0;const T=w.size,_=E+w.name,D=Math.ceil(T/x);for(;;){const Y=[];for(let ee=0;ee<10&&!(S*x>=T);ee++){const ie=w.slice(S*x,(S+1)*x),ne=new Promise(re=>{const oe=new FormData;oe.append("file",new Blob([ie])),oe.append("filename",`${_}`),oe.append("index",`${S}`);const ae=new Request(M,{method:"POST",body:oe});fetch(ae).then(async le=>{console.log(await le.text()),re()})});S+=1,Y.push(ne)}if(await Promise.all(Y),S*x>=T)break;R(Math.floor(S/(D+1)*100),!1)}return D}),ce(this,"concatUploadedFile",async(E,w)=>{const R=Tt(this,Ft)+this.generatePath("/api/uploader/concat_uploaded_file_chunk");await new Promise(M=>{const x=new FormData;x.append("filename",E),x.append("filename_chunk_num",""+w);const S=new Request(R,{method:"POST",body:x});fetch(S).then(async T=>{console.log(await T.text()),M()})})}),Ut(this,Ft,"")}}Ft=new WeakMap;class RestResult{}class Ok extends RestResult{constructor(E){super(),this.value=E}isOk(){return!0}get(){return this.value}}class Err extends RestResult{constructor(E){super(),this.error=E}isOk(){return!1}get(){throw this.error}}var yt$1;class RestClientBase{constructor(){ei(this,yt$1),ce(this,"setBaseUrl",E=>{E.endsWith("/")&&(E=E.slice(0,-1)),Ut(this,yt$1,E)}),ce(this,"execFetch",async(E,w="json")=>new Promise(R=>{fetch(E).then(async M=>{if(M.ok){let x;w==="blob"?x=await M.blob():x=await M.json(),R(new Ok(x))}else{const x=await M.json();if(x.detail!=null){const S=JSON.parse(x.detail),T={type:"ERR_HTTP_EXCEPTION",status:M.status,statusText:M.statusText,code:S.code,reason:S.reason,action:S.action,detail:S.detail};R(new Err(T))}else{const S={type:"ERR_HTTP_EXCEPTION",status:M.status,statusText:M.statusText,code:x.code,reason:"no detail",action:"no action",detail:x.detail};R(new Err(S))}}}).catch(M=>{console.error(M);const x={type:"ERR_HTTP_EXCEPTION",status:0,statusText:"",code:-1,reason:`${M}`,action:"",detail:null};R(new Err(x))})})),ce(this,"getRequest",async(E,w="json")=>{let R=E.startsWith("/")?`${Tt(this,yt$1)}${E}`:`${Tt(this,yt$1)}/${E}`;const M=new Request(R,{method:"GET"}),x=await this.execFetch(M,w);if(!x.isOk())throw x.get();return x.get()}),ce(this,"postRequest",async(E,w,R="json")=>{let M=E.startsWith("/")?`${Tt(this,yt$1)}${E}`:`${Tt(this,yt$1)}/${E}`;const x=new Request(M,{method:"POST",body:JSON.stringify(w),headers:{"Content-Type":"application/json"}}),S=await this.execFetch(x,R);if(!S.isOk())throw S.get();return S.get()}),ce(this,"putRequest",async(E,w,R="json")=>{let M=E.startsWith("/")?`${Tt(this,yt$1)}${E}`:`${Tt(this,yt$1)}/${E}`;const x=new Request(M,{method:"PUT",body:JSON.stringify(w),headers:{"Content-Type":"application/json"}}),S=await this.execFetch(x,R);if(!S.isOk())throw S.get();return S.get()}),ce(this,"deleteRequest",async(E,w,R="json")=>{let M=E.startsWith("/")?`${Tt(this,yt$1)}${E}`:`${Tt(this,yt$1)}/${E}`,x;w!=null?x=new Request(M,{method:"DELETE",body:JSON.stringify(w),headers:{"Content-Type":"application/json"}}):x=new Request(M,{method:"DELETE"});const S=await this.execFetch(x,R);if(!S.isOk())throw S.get();return S.get()}),Ut(this,yt$1,"")}}yt$1=new WeakMap;const Mt$1=class{constructor(){ce(this,"restClient"),ce(this,"fileUploaderClient"),ce(this,"enableFlatPath",!1),ce(this,"setBaseUrl",E=>{this.restClient.setBaseUrl(E),this.fileUploaderClient.setBaseUrl(E)}),ce(this,"setEnableFlatPath",E=>{this.enableFlatPath=E,this.fileUploaderClient.setEnableFlatPath(E),console.log("setEnableFlatPath",this.enableFlatPath)}),ce(this,"generatePath",E=>this.enableFlatPath?E[0]+E.slice(1).replace(/\//g,"_"):E),ce(this,"initializeServer",async()=>{const E=this.generatePath("/api/operation/initialize");await this.restClient.postRequest(E,null)}),ce(this,"getServerConfiguration",async()=>{const E=this.generatePath("/api/configuration-manager/configuration");return await this.restClient.getRequest(E)}),ce(this,"updateServerConfiguration",async E=>{const w=this.generatePath("/api/configuration-manager/configuration");await this.restClient.putRequest(w,E)}),ce(this,"getServerGPUInfo",async()=>{const E=this.generatePath("/api/gpu-device-manager/devices");return await this.restClient.getRequest(E)}),ce(this,"getServerModuleStatus",async(E=!1)=>{let w=this.generatePath("/api/module-manager/modules");return E&&(w+="?reload=true"),await this.restClient.getRequest(w)}),ce(this,"getServerSlotInfos",async()=>{const E=this.generatePath("/api/slot-manager/slots");return await this.restClient.getRequest(E)}),ce(this,"getServerSlotInfo",async E=>{const w=this.generatePath(`/api/slot-manager/slots/${E}`);return await this.restClient.getRequest(w)}),ce(this,"uploadFile",async(E,w,R)=>{const M=await this.fileUploaderClient.uploadFile(E,w,R);await this.fileUploaderClient.concatUploadedFile(w.name,M)}),ce(this,"uploadSeedVCModelFile",async(E,w,R,M)=>{let x=2,S=0;await this.uploadFile("",w,(D,Y)=>{console.log("progress [A]",D),M(D/x,!1)}),S+=100/x,await this.uploadFile("",R,(D,Y)=>{console.log("progress [B]",D),M(D/x+S,!1)}),S+=100/x;const T=this.generatePath("/api/slot-manager/slots"),_={slot_index:E??null,vc_type:"seed-vc",name:w.name,repository_id:null,seed_vc_config_file:R.name,seed_vc_model_file:w.name};await this.restClient.postRequest(T,_)}),ce(this,"deleteServerSlotInfo",async E=>{const w=this.generatePath(`/api/slot-manager/slots/${E}`);await this.restClient.deleteRequest(w,null)}),ce(this,"updateServerSlotInfo",async E=>{const w=this.generatePath(`/api/slot-manager/slots/${E.slot_index}`);await this.restClient.putRequest(w,E)}),ce(this,"moveModel",async E=>{const w=this.generatePath("/api/slot-manager/slots/operation/move_model");await this.restClient.postRequest(w,E)}),ce(this,"uploadIconFile",async(E,w,R)=>{await this.uploadFile("",w,(S,T)=>{R(S,!1)});const M=this.generatePath(`/api/slot-manager/slots/${E}/operation/set_icon_file`),x={icon_file:w.name};await this.restClient.postRequest(M,x)}),ce(this,"generateOnnx",async E=>{const w=this.generatePath(`/api/slot-manager/slots/${E}/operation/generate_onnx`);await this.restClient.postRequest(w,null)}),ce(this,"getVoiceCharacterSlotInfos",async()=>{const E=this.generatePath("/api/voice-character-slot-manager/slots");return await this.restClient.getRequest(E)}),ce(this,"getVoiceCharacterSlotInfo",async E=>{const w=this.generatePath(`/api/voice-character-slot-manager/slots/${E}`);return await this.restClient.getRequest(w)}),ce(this,"uploadVoiceCharacterFile",async(E,w,R,M,x)=>{let S=0;M!=null&&(S+=1),M!=null&&await this.uploadFile("",M,(D,Y)=>{x(D/S,!1)});const T=this.generatePath("/api/voice-character-slot-manager/slots"),_={slot_index:E??null,vc_type:w,name:R,zip_file:(M==null?void 0:M.name)??null,terms_of_use_url:" ",icon_file:null};await this.restClient.postRequest(T,_)}),ce(this,"deleteVoiceCharacterSlotInfo",async E=>{const w=this.generatePath(`/api/voice-character-slot-manager/slots/${E}`);await this.restClient.deleteRequest(w,null)}),ce(this,"updateVoiceCharacterSlotInfo",async E=>{const w=this.generatePath(`/api/voice-character-slot-manager/slots/${E.slot_index}`);await this.restClient.putRequest(w,E)}),ce(this,"moveVoiceCharacter",async E=>{const w=this.generatePath("/api/voice-character-slot-manager/slots/operation/move_model");await this.restClient.postRequest(w,E)}),ce(this,"downloadVoiceCharacter",async E=>{const w=this.generatePath(`/api/voice-character-slot-manager/slots/${E}/voices/operation/zip_and_download`);return await this.restClient.postRequest(w,null,"blob")}),ce(this,"uploadVoiceCharacterIconFile",async(E,w,R)=>{await this.uploadFile("",w,(S,T)=>{R(S,!1)});const M=this.generatePath(`/api/voice-character-slot-manager/slots/${E}/operation/set_icon_file`),x={icon_file:w.name};await this.restClient.postRequest(M,x)}),ce(this,"addReferenceVoice",async(E,w,R,M,x)=>{await this.uploadFile("",M,(_,D)=>{x(_,!1)});const S=this.generatePath(`/api/voice-character-slot-manager/slots/${E}/voices`),T={voice_type:R,wav_file:M.name,voice_character_slot_index:E,slot_index:w};await this.restClient.postRequest(S,T)}),ce(this,"deleteReferenceVoice",async(E,w)=>{const R=this.generatePath(`/api/voice-character-slot-manager/slots/${E}/voices/${w}`);await this.restClient.deleteRequest(R,null)}),ce(this,"updateReferenceVoice",async(E,w,R)=>{const M=this.generatePath(`/api/voice-character-slot-manager/slots/${E}/voices/${w}`);await this.restClient.putRequest(M,R)}),ce(this,"getReferenceVoiceFile",async(E,w)=>{const R=this.generatePath(`/api/voice-character-slot-manager/slots/${E}/voices/${w}/file`);return await this.restClient.getRequest(R,"blob")}),ce(this,"moveReferenceVoice",async(E,w)=>{const R=this.generatePath(`/api/voice-character-slot-manager/slots/${E}/voices/operation/move_voice`);await this.restClient.postRequest(R,w)}),ce(this,"uploadReferenceVoiceIconFile",async(E,w,R,M)=>{await this.uploadFile("",R,(T,_)=>{M(T,!1)});const x=this.generatePath(`/api/voice-character-slot-manager/slots/${E}/voices/${w}/operation/set_icon_file`),S={icon_file:R.name};await this.restClient.postRequest(x,S)}),ce(this,"convertVoiceFileToFile",async E=>{const w=new FormData,R=await E.arrayBuffer();w.append("waveform",new Blob([R]),"waveform.bin"),w.append("data_type","file");const M={method:"POST",body:w,headers:{}},x=this.generatePath("/api/vc-manager/operation/convertVoice");return await(await fetch(x,M)).blob()}),ce(this,"convertVoiceBinToFile",async E=>{const w=new FormData;w.append("waveform",new Blob([E]),"waveform.bin"),w.append("data_type","bin");const R={method:"POST",body:w,headers:{}},M=this.generatePath("/api/vc-manager/operation/convertVoice");return await(await fetch(M,R)).blob()}),this.restClient=new RestClientBase,this.fileUploaderClient=new FileUploaderClient}};ce(Mt$1,"_instance",null),ce(Mt$1,"getInstance",()=>(Mt$1._instance===null&&(Mt$1._instance=new Mt$1),Mt$1._instance));let RestClient=Mt$1;class RingBuffer{constructor(E){ce(this,"size"),ce(this,"buffer"),ce(this,"head"),ce(this,"tail"),ce(this,"isFull"),this.size=E,this.buffer=new Float32Array(E),this.head=0,this.tail=0,this.isFull=!1}addSamples(E){const w=E.length,R=this.getAvailableSpace();if(w>R)throw new Error("Ring Buffer is over: not enough space to add new samples.");if(this.head>=this.tail){const M=this.size-this.head;w<=M?(this.buffer.set(E,this.head),this.head+=w,this.head===this.size&&(this.head=0)):(this.buffer.set(E.subarray(0,M),this.head),this.buffer.set(E.subarray(M),0),this.head=w-M)}else this.buffer.set(E,this.head),this.head+=w;this.isFull=this.head===this.tail}readSamples(E){if(this.head===this.tail&&!this.isFull)return new Float32Array(0);if(this.getCurrentSize()<E)throw new Error("Ring Buffer is short: not enough data to read new samples.");const w=(this.tail+E)%this.size;let R;return w>this.tail?R=new Float32Array(this.buffer.slice(this.tail,w)):R=new Float32Array([...this.buffer.slice(this.tail),...this.buffer.slice(0,w)]),this.tail=w,this.isFull=!1,R}getCurrentSize(){return this.isFull?this.size:this.head>=this.tail?this.head-this.tail:this.size-this.tail+this.head}getAvailableSpace(){return this.isFull?0:this.head>=this.tail?this.size-(this.head-this.tail):this.tail-this.head}}class VoiceChangerWorkletNode extends AudioWorkletNode{constructor(E,w,R){super(E,"voice-changer-worklet-processor"),ce(this,"role"),ce(this,"setting",DefaultClientSettng.workletNodeSetting),ce(this,"requestChunkSamples",new RingBuffer(48e3*60)),ce(this,"socket",null),ce(this,"isInputRecording",!1),ce(this,"isSendDataStopped",!1),ce(this,"recordingInputChunk",[]),ce(this,"isOutputRecording",!1),ce(this,"recordingOutputChunk",[]),ce(this,"outputNode",null),ce(this,"startPromiseResolve",null),ce(this,"stopPromiseResolve",null),ce(this,"setOutputNode",M=>{this.outputNode=M}),ce(this,"updateSetting",M=>{let x=!1;(this.setting.serverUrl!=M.serverUrl||this.setting.protocol!=M.protocol||this.setting.workOnColab!=M.workOnColab)&&(x=!0),this.setting=M,x&&this.createSocketIO()}),ce(this,"setInternalAudioProcessCallback",M=>{}),ce(this,"getSettings",()=>this.setting),ce(this,"getSocketId",()=>{var M;return(M=this.socket)==null?void 0:M.id}),ce(this,"createSocketIO",()=>{}),ce(this,"postReceivedVoice",M=>{const x={requestType:"voice",voice:M,numTrancateTreshold:0,outputBufferFactor:0};this.port.postMessage(x),this.isOutputRecording&&this.recordingOutputChunk.push(M)}),ce(this,"sendBuffer",async M=>{var x;const S=Date.now();if(this.setting.protocol==="sio"&&this.setting.workOnColab==!1)console.error("sio is not supported");else if(this.setting.protocol==="rest"||this.setting.workOnColab==!0){const T=new FormData;T.append("waveform",new Blob([M]),"waveform.bin"),T.append("data_type","bin");const _=(ne=>this.setting.enableFlatPath?ne[0]+ne.slice(1).replace(/\//g,"_"):ne)("/api/vc-manager/operation/convertVoice"),D={method:"POST",body:T,headers:{}};this.setting.enableFlatPath||(D.headers={"x-timestamp":S.toString()});const Y=await fetch(_,D),ee=(x=Y.headers.get("content-type"))==null?void 0:x.split("boundary=")[1];if(!ee)throw new Error("Boundary not found in response headers");const ie=await Y.arrayBuffer();new TextDecoder("utf-8").decode(ie).split(`--${ee}`).filter(ne=>ne.includes("Content-Type")).map(ne=>{const re=ne.indexOf(`\r
\r
`),oe=ne.slice(0,re),ae=ne.slice(re+4);console.log("header",oe);const le=oe.split(`\r
`);let de=!1;le.forEach(be=>{be.toLowerCase().startsWith("x-is-voice:")&&(de=be.split(":")[1].trim()=="True")});const me=ae.endsWith(`\r
`)?ae.slice(0,-2):ae,fe=atob(me),ge=fe.length,he=new Uint8Array(ge);for(let be=0;be<ge;be++)he[be]=fe.charCodeAt(be);const ve=new Float32Array(he.buffer);console.log("float32Array",ve.length,ve),this.outputNode!=null&&de&&this.outputNode.postReceivedVoice(ve)})}else if(this.setting.protocol=="internal")console.error("internal is not supported");else throw"unknown protocol"}),ce(this,"configureWorklet",M=>{const x={requestType:"config",voice:new Float32Array(1),numTrancateTreshold:M.numTrancateTreshold,outputBufferFactor:M.outputBufferFactor};this.port.postMessage(x)}),ce(this,"start",async()=>{const M=new Promise(S=>{this.startPromiseResolve=S}),x={requestType:"start",voice:new Float32Array(1),numTrancateTreshold:0,outputBufferFactor:0};this.port.postMessage(x),await M}),ce(this,"stop",async()=>{const M=new Promise(S=>{this.stopPromiseResolve=S}),x={requestType:"stop",voice:new Float32Array(1),numTrancateTreshold:0,outputBufferFactor:0};this.port.postMessage(x),await M}),ce(this,"trancateBuffer",()=>{const M={requestType:"trancateBuffer",voice:new Float32Array(1),numTrancateTreshold:0,outputBufferFactor:0};this.port.postMessage(M)}),ce(this,"startInputRecording",()=>{console.log("start input recording"),this.recordingInputChunk=[],this.isInputRecording=!0}),ce(this,"stopInputRecording",()=>{console.log("stop input recording"),this.isInputRecording=!1;const M=this.recordingInputChunk.reduce((T,_)=>T+_.length,0),x=new Float32Array(M);let S=0;for(let T=0;T<this.recordingInputChunk.length;T++)for(let _=0;_<this.recordingInputChunk[T].length;_++)x[S]=this.recordingInputChunk[T][_],S++;return x}),ce(this,"startOutputRecording",()=>{this.recordingOutputChunk=[],this.isOutputRecording=!0}),ce(this,"stopOutputRecording",()=>{this.isOutputRecording=!1;const M=this.recordingOutputChunk.reduce((T,_)=>T+_.length,0),x=new Float32Array(M);let S=0;for(let T=0;T<this.recordingOutputChunk.length;T++)for(let _=0;_<this.recordingOutputChunk[T].length;_++)x[S]=this.recordingOutputChunk[T][_],S++;return x}),ce(this,"stopSendData",()=>{this.isSendDataStopped=!0}),ce(this,"startSendData",()=>{this.isSendDataStopped=!1}),this.role=w,this.port.onmessage=this.handleMessage.bind(this),this.createSocketIO(),console.log(`[worklet_node][voice-changer-worklet-processor][${this.role}] created.`)}handleMessage(E){if(E.data.responseType==="start_ok")console.log(`[worklet_node][voice-changer-worklet-processor][${this.role}] start_ok`),this.startPromiseResolve&&(this.startPromiseResolve(),this.startPromiseResolve=null);else if(E.data.responseType==="stop_ok")console.log(`[worklet_node][voice-changer-worklet-processor][${this.role}] stop_ok`),this.stopPromiseResolve&&(this.stopPromiseResolve(),this.stopPromiseResolve=null);else if(E.data.responseType!=="volume")if(E.data.responseType==="inputData"){const w=E.data.inputData;if(this.isInputRecording&&this.recordingInputChunk.push(w),this.isSendDataStopped)return;this.requestChunkSamples.addSamples(w);const R=this.setting.sendingChunkSec*48e3;if(this.requestChunkSamples.getCurrentSize()<R)return;const M=this.requestChunkSamples.readSamples(R),x=new Uint8Array(M.buffer);this.sendBuffer(x)}else console.warn(`[worklet_node][voice-changer-worklet-processor][${this.role}] unknown response ${E.data.responseType}`,E.data)}}const workerjs=`var h = Object.defineProperty;
var f = (a, i, e) => i in a ? h(a, i, { enumerable: !0, configurable: !0, writable: !0, value: e }) : a[i] = e;
var r = (a, i, e) => f(a, typeof i != "symbol" ? i + "" : i, e);
const d = {
  voice: "voice",
  config: "config",
  start: "start",
  stop: "stop",
  trancateBuffer: "trancateBuffer"
}, l = {
  volume: "volume",
  inputData: "inputData",
  start_ok: "start_ok",
  stop_ok: "stop_ok"
};
class p extends AudioWorkletProcessor {
  /**
   * @constructor
   */
  constructor() {
    super();
    r(this, "BLOCK_SIZE", 128);
    r(this, "initialized", !1);
    r(this, "volume", 0);
    // private numTrancateTreshold = 100;
    // ↓何process分(BLOCK_SIZE=128)のデータまで残すかを決める数値。
    //  変換後データのブロック数(request.voice/BLOCK_SIZE)の何倍をバッファ上限とするかで設定。
    //  上限を超えるとtrancateする。
    r(this, "outputBufferFactor", 5 * 1024 * 1024);
    r(this, "isRecording", !1);
    r(this, "playBuffer", []);
    r(this, "unpushedF32Data", new Float32Array(0));
    r(this, "calcVol", (e, t) => {
      const n = e.reduce((u, o) => u + o * o, 0), s = Math.sqrt(n / e.length);
      return Math.max(s, t * 0.95);
    });
    r(this, "trancateBuffer", () => {
      for (console.log("[worklet] Buffer truncated"); this.playBuffer.length > 1; )
        this.playBuffer.shift();
    });
    r(this, "pushData", (e) => {
      const t = {
        responseType: l.inputData,
        inputData: e
      };
      this.port.postMessage(t);
    });
    console.log("[AudioWorkletProcessor] created."), this.initialized = !0, this.port.onmessage = this.handleMessage.bind(this);
  }
  handleMessage(e) {
    const t = e.data;
    if (t.requestType === "config") {
      this.outputBufferFactor = t.outputBufferFactor;
      return;
    } else if (t.requestType === "start") {
      if (this.isRecording) {
        console.warn(\`[worklet] recording is already started. \${this.isRecording}\`);
        return;
      }
      this.isRecording = !0;
      const o = {
        responseType: "start_ok"
      };
      this.port.postMessage(o);
      return;
    } else if (t.requestType === "stop") {
      if (!this.isRecording) {
        console.warn(\`[worklet] recording is not started. \${this.isRecording}\`);
        return;
      }
      this.isRecording = !1;
      const o = {
        responseType: "stop_ok"
      };
      this.port.postMessage(o);
      return;
    } else if (t.requestType === "trancateBuffer") {
      this.trancateBuffer();
      return;
    }
    const n = t.voice;
    this.playBuffer.length > n.length / this.BLOCK_SIZE * this.outputBufferFactor && (console.log(\`[worklet] Truncate \${this.playBuffer.length} > \${n.length / this.BLOCK_SIZE * this.outputBufferFactor}\`), this.trancateBuffer(), this.outputBufferFactor += 1);
    const s = new Float32Array(this.unpushedF32Data.length + n.length);
    s.set(this.unpushedF32Data), s.set(n, this.unpushedF32Data.length);
    const u = Math.floor(s.length / this.BLOCK_SIZE);
    for (let o = 0; o < u; o++) {
      const c = s.slice(o * this.BLOCK_SIZE, (o + 1) * this.BLOCK_SIZE);
      this.playBuffer.push(c);
    }
    this.unpushedF32Data = s.slice(u * this.BLOCK_SIZE);
  }
  process(e, t, n) {
    if (!this.initialized)
      return console.warn("[worklet] worklet_process not ready"), !0;
    if (this.isRecording && (e.length > 0 && e[0].length > 0 ? this.pushData(e[0][0]) : console.warn("[worklet] no input data")), this.playBuffer.length === 0)
      return !0;
    let s = this.playBuffer.shift();
    if (s) {
      this.volume = this.calcVol(s, this.volume);
      const u = {
        responseType: l.volume,
        volume: this.volume
      };
      this.port.postMessage(u), t[0][0].set(s), t[0].length == 2 && t[0][1].set(s);
    } else
      console.log("[worklet] no voice data");
    return !0;
  }
}
registerProcessor("voice-changer-worklet-processor", p);
export {
  d as RequestType,
  l as ResponseType
};
`;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getAugmentedNamespace(C){if(C.__esModule)return C;var E=C.default;if(typeof E=="function"){var w=function R(){return this instanceof R?Reflect.construct(E,arguments,this.constructor):E.apply(this,arguments)};w.prototype=E.prototype}else w={};return Object.defineProperty(w,"__esModule",{value:!0}),Object.keys(C).forEach(function(R){var M=Object.getOwnPropertyDescriptor(C,R);Object.defineProperty(w,R,M.get?M:{enumerable:!0,get:function(){return C[R]}})}),w}var build$2={},AllHighestVideoBandwidthPolicy={},DefaultVideoStreamIdSet={},hasRequiredDefaultVideoStreamIdSet;function requireDefaultVideoStreamIdSet(){if(hasRequiredDefaultVideoStreamIdSet)return DefaultVideoStreamIdSet;hasRequiredDefaultVideoStreamIdSet=1,Object.defineProperty(DefaultVideoStreamIdSet,"__esModule",{value:!0});let C=class qd{constructor(w){this.ids=new Set(w)}add(w){this.ids.add(w)}array(){return Array.from(this.ids.values()).sort((w,R)=>w-R)}contain(w){return this.ids.has(w)}forEach(w){this.ids.forEach(w)}empty(){return this.ids.size===0}size(){return this.ids.size}equal(w){if(!w)return this.ids.size===0;const R=this.array(),M=w.array();if(R.length!==M.length)return!1;for(let x=0;x<R.length;x++)if(R[x]!==M[x])return!1;return!0}clone(){return new qd(this.array())}remove(w){this.ids.delete(w)}toJSON(){return this.array()}truncate(w){const R=this.array();return new qd(R.splice(0,w))}};return DefaultVideoStreamIdSet.default=C,DefaultVideoStreamIdSet}var hasRequiredAllHighestVideoBandwidthPolicy;function requireAllHighestVideoBandwidthPolicy(){if(hasRequiredAllHighestVideoBandwidthPolicy)return AllHighestVideoBandwidthPolicy;hasRequiredAllHighestVideoBandwidthPolicy=1;var C=AllHighestVideoBandwidthPolicy&&AllHighestVideoBandwidthPolicy.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(AllHighestVideoBandwidthPolicy,"__esModule",{value:!0});const E=C(requireDefaultVideoStreamIdSet());let w=class Wp{constructor(M){this.selfAttendeeId=M,this.reset()}reset(){this.optimalReceiveSet=new E.default,this.subscribedReceiveSet=new E.default,this.videoSources=void 0}updateIndex(M){this.videoIndex=M,this.optimalReceiveSet=this.calculateOptimalReceiveSet(M)}updateMetrics(M){}wantsResubscribe(){return!this.subscribedReceiveSet.equal(this.optimalReceiveSet)}chooseSubscriptions(){return this.subscribedReceiveSet=this.optimalReceiveSet.clone(),this.subscribedReceiveSet.clone()}chooseRemoteVideoSources(M){this.videoSources=M,this.optimalReceiveSet=this.calculateOptimalReceiveSet(this.videoIndex).clone()}calculateOptimalReceiveSet(M){const x=new E.default;if(!this.videoIndex||this.videoIndex.allStreams().empty())return x;const S=M.highestQualityStreamFromEachGroupExcludingSelf(this.selfAttendeeId),T=this.videoSources?this.videoSources:this.videoIndex.allVideoSendingSourcesExcludingSelf(this.selfAttendeeId),_=this.videoIndex.remoteStreamDescriptions(),D=new Map;for(const ee of _)S.contain(ee.streamId)&&D.set(ee.attendeeId,ee);let Y=0;for(const ee of T){const ie=ee.attendee.attendeeId;if(D.has(ie)){const ne=D.get(ie);if(Y+ne.maxBitrateKbps<=Wp.maxReceiveBitrateKbps)x.add(ne.streamId),Y+=ne.maxBitrateKbps;else{console.warn("total bitrate "+(Y+ne.maxBitrateKbps)+" exceeds maximum limit (15000). Use chooseRemoteVideoSources to select a subset of participants to avoid this.");break}}}return x}};return AllHighestVideoBandwidthPolicy.default=w,w.maxReceiveBitrateKbps=15e3,AllHighestVideoBandwidthPolicy}var ApplicationMetadata={},hasRequiredApplicationMetadata;function requireApplicationMetadata(){if(hasRequiredApplicationMetadata)return ApplicationMetadata;hasRequiredApplicationMetadata=1,Object.defineProperty(ApplicationMetadata,"__esModule",{value:!0});let C=class Kp{constructor(w,R){this.appName=w,this.appVersion=R}static create(w,R){const M=/^[a-zA-Z0-9]+[a-zA-Z0-9_-]*[a-zA-Z0-9]+$/g;if(!w||w.length>32)throw new Error("appName should be a valid string and 1 to 32 characters in length");if(!M.test(w))throw new Error(`appName must satisfy ${M} regular expression`);const x=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/gm;if(!R||R.length>32)throw new Error("appVersion should be a valid string and 1 to 32 characters in length");if(!x.test(R))throw new Error("appVersion must satisfy Semantic Versioning format");return new Kp(w,R)}};return ApplicationMetadata.default=C,ApplicationMetadata}var AsyncScheduler={},TimeoutScheduler={},hasRequiredTimeoutScheduler;function requireTimeoutScheduler(){if(hasRequiredTimeoutScheduler)return TimeoutScheduler;hasRequiredTimeoutScheduler=1,Object.defineProperty(TimeoutScheduler,"__esModule",{value:!0});let C=class{constructor(E){this.timeoutMs=E,this.timer=null}start(E){this.stop(),this.timer=setTimeout(()=>{clearTimeout(this.timer),E()},this.timeoutMs)}stop(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)}};return TimeoutScheduler.default=C,TimeoutScheduler}var hasRequiredAsyncScheduler;function requireAsyncScheduler(){if(hasRequiredAsyncScheduler)return AsyncScheduler;hasRequiredAsyncScheduler=1;var C=AsyncScheduler&&AsyncScheduler.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(AsyncScheduler,"__esModule",{value:!0});const E=C(requireTimeoutScheduler());let w=class extends E.default{constructor(){super(0)}static nextTick(R){setTimeout(R,0)}};return AsyncScheduler.default=w,AsyncScheduler}var AttachMediaInputTask={},VideoLogEvent={},hasRequiredVideoLogEvent;function requireVideoLogEvent(){return hasRequiredVideoLogEvent||(hasRequiredVideoLogEvent=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.VideoLogEvent=void 0;var E;(function(w){w[w.InputAttached=0]="InputAttached",w[w.SendingFailed=1]="SendingFailed",w[w.SendingSuccess=2]="SendingSuccess"})(E=C.VideoLogEvent||(C.VideoLogEvent={})),C.default=E}(VideoLogEvent)),VideoLogEvent}var BaseTask={},OnceTask={},LogLevel={},hasRequiredLogLevel;function requireLogLevel(){return hasRequiredLogLevel||(hasRequiredLogLevel=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.LogLevel=void 0;var E;(function(w){w[w.DEBUG=0]="DEBUG",w[w.INFO=1]="INFO",w[w.WARN=2]="WARN",w[w.ERROR=3]="ERROR",w[w.OFF=4]="OFF"})(E=C.LogLevel||(C.LogLevel={})),C.default=E}(LogLevel)),LogLevel}var hasRequiredOnceTask;function requireOnceTask(){if(hasRequiredOnceTask)return OnceTask;hasRequiredOnceTask=1;var C=OnceTask&&OnceTask.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(OnceTask,"__esModule",{value:!0});const E=C(requireLogLevel()),w=C(requireAsyncScheduler());let R=class{constructor(M,x,S){this.logger=M,this.task=x,this.dependencies=S,this.canceled=!1}name(){return`${this.task.name()} (once)`}cancel(){if(!this.canceled){if(this.dependencies)for(const M of this.dependencies)M.cancel();this.logger.info(`Canceling ${this.name()}`),w.default.nextTick(()=>this.task.cancel()),this.canceled=!0,this.cancelPromise&&w.default.nextTick(()=>this.cancelPromise(new Error(`canceling ${this.name()}`)))}}logDependencies(){if(this.logger.getLogLevel()>E.default.INFO||!this.dependencies)return;const M=this.dependencies.filter(x=>x).map(x=>x.name()).join(", ");this.logger.info(`${this.task.name()} waiting for dependencies: ${M}`)}run(){if(this.promise)return this.promise;const M=this.dependencies?Promise.all(this.dependencies.map(x=>x==null?void 0:x.run())):Promise.resolve();return this.logDependencies(),this.ongoing=M.then(()=>this.task.run()),this.promise=new Promise((x,S)=>{this.cancelPromise=S,this.ongoing.then(x).catch(S)})}setParent(M){this.task.setParent(M)}};return OnceTask.default=R,OnceTask}var TaskStatus={},hasRequiredTaskStatus;function requireTaskStatus(){if(hasRequiredTaskStatus)return TaskStatus;hasRequiredTaskStatus=1,Object.defineProperty(TaskStatus,"__esModule",{value:!0});var C;return function(E){E.IDLE="IDLE",E.RUNNING="RUNNING",E.CANCELED="CANCELED",E.FINISHED="FINISHED"}(C||(C={})),TaskStatus.default=C,TaskStatus}var hasRequiredBaseTask;function requireBaseTask(){if(hasRequiredBaseTask)return BaseTask;hasRequiredBaseTask=1;var C=BaseTask&&BaseTask.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=BaseTask&&BaseTask.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(BaseTask,"__esModule",{value:!0});const w=E(requireOnceTask()),R=E(requireTaskStatus());let M=class{constructor(x){this.logger=x,this.taskName="BaseTask",this.parentTask=null,this.status=R.default.IDLE,this.run=this.baseRun.bind(this,this.run),this.cancel=this.baseCancel.bind(this,this.cancel)}once(...x){return new w.default(this.logger,this,x)}cancel(){}name(){return this.parentTask?`${this.parentTask.name()}/${this.taskName}`:this.taskName}setParent(x){this.parentTask=x}getStatus(){return this.status}logAndThrow(x){throw this.logger.info(x),new Error(x)}baseRun(x){return C(this,void 0,void 0,function*(){try{const S=Date.now();switch(this.logger.info(`running task ${this.name()}`),this.status){case R.default.RUNNING:this.logAndThrow(`${this.name()} is already running`);case R.default.CANCELED:this.logAndThrow(`${this.name()} was canceled before running`);case R.default.FINISHED:this.logAndThrow(`${this.name()} was already finished`)}this.status=R.default.RUNNING,yield x.call(this),this.logger.info(`${this.name()} took ${Math.round(Date.now()-S)} ms`)}catch(S){throw S}finally{this.status!==R.default.CANCELED&&(this.status=R.default.FINISHED)}})}baseCancel(x){if(this.status===R.default.CANCELED||this.status===R.default.FINISHED){this.logger.info(`Not canceling ${this.name()}: state is ${this.status}`);return}this.logger.info(`canceling task ${this.name()}`),this.status=R.default.CANCELED,x.call(this)}};return BaseTask.default=M,BaseTask}var hasRequiredAttachMediaInputTask;function requireAttachMediaInputTask(){if(hasRequiredAttachMediaInputTask)return AttachMediaInputTask;hasRequiredAttachMediaInputTask=1;var C=AttachMediaInputTask&&AttachMediaInputTask.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=AttachMediaInputTask&&AttachMediaInputTask.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(AttachMediaInputTask,"__esModule",{value:!0});const w=E(requireVideoLogEvent()),R=E(requireBaseTask());let M=class extends R.default{constructor(x){super(x.logger),this.context=x,this.taskName="AttachMediaInputTask"}run(){return C(this,void 0,void 0,function*(){const x=this.context.transceiverController;x.setPeer(this.context.peer),x.setupLocalTransceivers();const S=this.context.activeAudioInput;if(S){const _=S.getAudioTracks();this.context.logger.info("attaching audio track to peer connection"),yield x.setAudioInput(_.length?_[0]:null)}else yield x.setAudioInput(null),this.context.logger.info("no audio track");this.setAudioCodecPreferences();const T=this.context.activeVideoInput;if(T){const _=T.getVideoTracks(),D=_.length?_[0]:null;if(this.context.logger.info("attaching video track to peer connection"),yield x.setVideoInput(D),this.context.enableSimulcast&&this.context.videoUplinkBandwidthPolicy){const Y=this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters();x.setEncodingParameters(Y)}D&&this.context.statsCollector.logVideoEvent(w.default.InputAttached,this.context.videoDeviceInformation)}else yield x.setVideoInput(null),this.context.logger.info("no video track");this.context.videoSubscriptions=x.updateVideoTransceivers(this.context.videoStreamIndex,this.context.videosToReceive),this.context.videoStreamIndex.subscribeFrameSent()})}setAudioCodecPreferences(){const x=window.RTCRtpTransceiver&&"setCodecPreferences"in window.RTCRtpTransceiver.prototype,S=this.context.audioProfile.hasRedundancyEnabled();if(!x){this.context.logger.warn("Setting codec preferences not supported");return}const T=this.context.transceiverController.localAudioTransceiver(),{codecs:_}=RTCRtpSender.getCapabilities("audio");this.context.logger.debug(`Available audio codecs ${JSON.stringify(_,null,4)}`);const D=_.findIndex(Y=>Y.mimeType==="audio/red");if(!T){this.context.logger.error("audio transceiver is null");return}if(D>=0){const Y=_[D];_.splice(D,1),S?(_.unshift(Y),this.context.logger.info("audio/red set as preferred codec")):this.context.logger.info("audio/red removed from preferred codec"),T.setCodecPreferences(_);return}this.context.logger.info("audio/red codec not supported")}};return AttachMediaInputTask.default=M,AttachMediaInputTask}var Attendee={},hasRequiredAttendee;function requireAttendee(){if(hasRequiredAttendee)return Attendee;hasRequiredAttendee=1,Object.defineProperty(Attendee,"__esModule",{value:!0});let C=class{};return Attendee.default=C,Attendee}var AudioLogEvent={},hasRequiredAudioLogEvent;function requireAudioLogEvent(){return hasRequiredAudioLogEvent||(hasRequiredAudioLogEvent=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.AudioLogEvent=void 0;var E;(function(w){w[w.DeviceChanged=0]="DeviceChanged",w[w.MutedLocal=1]="MutedLocal",w[w.UnmutedLocal=2]="UnmutedLocal",w[w.Connected=3]="Connected",w[w.ConnectFailed=4]="ConnectFailed",w[w.RedmicStartLoss=5]="RedmicStartLoss",w[w.RedmicEndLoss=6]="RedmicEndLoss"})(E=C.AudioLogEvent||(C.AudioLogEvent={})),C.default=E}(AudioLogEvent)),AudioLogEvent}var AudioProfile={},DefaultBrowserBehavior={},__spreadArray=function(C,E,w){for(var R=0,M=E.length,x;R<M;R++)(x||!(R in E))&&(x||(x=Array.prototype.slice.call(E,0,R)),x[R]=E[R]);return C.concat(x||Array.prototype.slice.call(E))},BrowserInfo=function(){function C(E,w,R){this.name=E,this.version=w,this.os=R,this.type="browser"}return C}(),NodeInfo=function(){function C(E){this.version=E,this.type="node",this.name="node",this.os=process.platform}return C}(),SearchBotDeviceInfo=function(){function C(E,w,R,M){this.name=E,this.version=w,this.os=R,this.bot=M,this.type="bot-device"}return C}(),BotInfo=function(){function C(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return C}(),ReactNativeInfo=function(){function C(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return C}(),SEARCHBOX_UA_REGEX=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,SEARCHBOT_OS_REGEX=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,REQUIRED_VERSION_PARTS=3,userAgentRules=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",SEARCHBOX_UA_REGEX]],operatingSystemRules=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function detect(C){return C?parseUserAgent(C):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new ReactNativeInfo:typeof navigator<"u"?parseUserAgent(navigator.userAgent):getNodeVersion()}function matchUserAgent(C){return C!==""&&userAgentRules.reduce(function(E,w){var R=w[0],M=w[1];if(E)return E;var x=M.exec(C);return!!x&&[R,x]},!1)}function browserName(C){var E=matchUserAgent(C);return E?E[0]:null}function parseUserAgent(C){var E=matchUserAgent(C);if(!E)return null;var w=E[0],R=E[1];if(w==="searchbot")return new BotInfo;var M=R[1]&&R[1].split(".").join("_").split("_").slice(0,3);M?M.length<REQUIRED_VERSION_PARTS&&(M=__spreadArray(__spreadArray([],M,!0),createVersionParts(REQUIRED_VERSION_PARTS-M.length))):M=[];var x=M.join("."),S=detectOS(C),T=SEARCHBOT_OS_REGEX.exec(C);return T&&T[1]?new SearchBotDeviceInfo(w,x,S,T[1]):new BrowserInfo(w,x,S)}function detectOS(C){for(var E=0,w=operatingSystemRules.length;E<w;E++){var R=operatingSystemRules[E],M=R[0],x=R[1],S=x.exec(C);if(S)return M}return null}function getNodeVersion(){var C=typeof process<"u"&&process.version;return C?new NodeInfo(process.version.slice(1)):null}function createVersionParts(C){for(var E=[],w=0;w<C;w++)E.push("0");return E}const es=Object.freeze(Object.defineProperty({__proto__:null,BotInfo,BrowserInfo,NodeInfo,ReactNativeInfo,SearchBotDeviceInfo,browserName,detect,detectOS,getNodeVersion,parseUserAgent},Symbol.toStringTag,{value:"Module"})),require$$0$3=getAugmentedNamespace(es);var uaParser$1={exports:{}},uaParser=uaParser$1.exports,hasRequiredUaParser;function requireUaParser(){return hasRequiredUaParser||(hasRequiredUaParser=1,function(C,E){(function(w,R){var M="1.0.39",x="",S="?",T="function",_="undefined",D="object",Y="string",ee="major",ie="model",ne="name",re="type",oe="vendor",ae="version",le="architecture",de="console",me="mobile",fe="tablet",ge="smarttv",he="wearable",ve="embedded",be=500,Se="Amazon",Re="Apple",Ae="ASUS",Me="BlackBerry",Be="Browser",Qe="Chrome",Pe="Edge",je="Firefox",Dt="Google",Xe="Huawei",zt="LG",xe="Microsoft",$e="Motorola",We="Opera",He="Samsung",Je="Sharp",Rt="Sony",jt="Xiaomi",hi="Zebra",Jt="Facebook",si="Chromium OS",ri="Mac OS",ni=" Browser",Pi=function(Bt,it){var ti={};for(var Ee in Bt)it[Ee]&&it[Ee].length%2===0?ti[Ee]=it[Ee].concat(Bt[Ee]):ti[Ee]=Bt[Ee];return ti},Ci=function(Bt){for(var it={},ti=0;ti<Bt.length;ti++)it[Bt[ti].toUpperCase()]=Bt[ti];return it},qi=function(Bt,it){return typeof Bt===Y?vi(it).indexOf(vi(Bt))!==-1:!1},vi=function(Bt){return Bt.toLowerCase()},Ki=function(Bt){return typeof Bt===Y?Bt.replace(/[^\d\.]/g,x).split(".")[0]:R},Vi=function(Bt,it){if(typeof Bt===Y)return Bt=Bt.replace(/^\s\s*/,x),typeof it===_?Bt:Bt.substring(0,be)},zi=function(Bt,it){for(var ti=0,Ee,ct,dt,St,ft,Ie;ti<it.length&&!ft;){var Ye=it[ti],Ce=it[ti+1];for(Ee=ct=0;Ee<Ye.length&&!ft&&Ye[Ee];)if(ft=Ye[Ee++].exec(Bt),ft)for(dt=0;dt<Ce.length;dt++)Ie=ft[++ct],St=Ce[dt],typeof St===D&&St.length>0?St.length===2?typeof St[1]==T?this[St[0]]=St[1].call(this,Ie):this[St[0]]=St[1]:St.length===3?typeof St[1]===T&&!(St[1].exec&&St[1].test)?this[St[0]]=Ie?St[1].call(this,Ie,St[2]):R:this[St[0]]=Ie?Ie.replace(St[1],St[2]):R:St.length===4&&(this[St[0]]=Ie?St[3].call(this,Ie.replace(St[1],St[2])):R):this[St]=Ie||R;ti+=2}},xi=function(Bt,it){for(var ti in it)if(typeof it[ti]===D&&it[ti].length>0){for(var Ee=0;Ee<it[ti].length;Ee++)if(qi(it[ti][Ee],Bt))return ti===S?R:ti}else if(qi(it[ti],Bt))return ti===S?R:ti;return it.hasOwnProperty("*")?it["*"]:Bt},Di={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},bi={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},mi={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[ae,[ne,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[ae,[ne,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[ne,ae],[/opios[\/ ]+([\w\.]+)/i],[ae,[ne,We+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[ae,[ne,We+" GX"]],[/\bopr\/([\w\.]+)/i],[ae,[ne,We]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[ae,[ne,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[ne,ae],[/quark(?:pc)?\/([-\w\.]+)/i],[ae,[ne,"Quark"]],[/\bddg\/([\w\.]+)/i],[ae,[ne,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[ae,[ne,"UC"+Be]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[ae,[ne,"WeChat"]],[/konqueror\/([\w\.]+)/i],[ae,[ne,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[ae,[ne,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[ae,[ne,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[ae,[ne,"Smart Lenovo "+Be]],[/(avast|avg)\/([\w\.]+)/i],[[ne,/(.+)/,"$1 Secure "+Be],ae],[/\bfocus\/([\w\.]+)/i],[ae,[ne,je+" Focus"]],[/\bopt\/([\w\.]+)/i],[ae,[ne,We+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[ae,[ne,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[ae,[ne,"Dolphin"]],[/coast\/([\w\.]+)/i],[ae,[ne,We+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[ae,[ne,"MIUI "+Be]],[/fxios\/([-\w\.]+)/i],[ae,[ne,je]],[/\bqihu|(qi?ho?o?|360)browser/i],[[ne,"360"+ni]],[/\b(qq)\/([\w\.]+)/i],[[ne,/(.+)/,"$1Browser"],ae],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[ne,/(.+)/,"$1"+ni],ae],[/samsungbrowser\/([\w\.]+)/i],[ae,[ne,He+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[ne,/_/g," "],ae],[/metasr[\/ ]?([\d\.]+)/i],[ae,[ne,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[ne,"Sogou Mobile"],ae],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[ne,ae],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[ne],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[ne,Jt],ae],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[ne,ae],[/\bgsa\/([\w\.]+) .*safari\//i],[ae,[ne,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[ae,[ne,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[ae,[ne,Qe+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[ne,Qe+" WebView"],ae],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[ae,[ne,"Android "+Be]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[ne,ae],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[ae,[ne,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[ae,ne],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[ne,[ae,xi,Di]],[/(webkit|khtml)\/([\w\.]+)/i],[ne,ae],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[ne,"Netscape"],ae],[/(wolvic)\/([\w\.]+)/i],[ne,ae],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[ae,[ne,je+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[ne,[ae,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[ne,[ae,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[le,"amd64"]],[/(ia32(?=;))/i],[[le,vi]],[/((?:i[346]|x)86)[;\)]/i],[[le,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[le,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[le,"armhf"]],[/windows (ce|mobile); ppc;/i],[[le,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[le,/ower/,x,vi]],[/(sun4\w)[;\)]/i],[[le,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[le,vi]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[ie,[oe,He],[re,fe]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[ie,[oe,He],[re,me]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[ie,[oe,Re],[re,me]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[ie,[oe,Re],[re,fe]],[/(macintosh);/i],[ie,[oe,Re]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[ie,[oe,Je],[re,me]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[ie,[oe,Xe],[re,fe]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[ie,[oe,Xe],[re,me]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[ie,/_/g," "],[oe,jt],[re,me]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[ie,/_/g," "],[oe,jt],[re,fe]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[ie,[oe,"OPPO"],[re,me]],[/\b(opd2\d{3}a?) bui/i],[ie,[oe,"OPPO"],[re,fe]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[ie,[oe,"Vivo"],[re,me]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[ie,[oe,"Realme"],[re,me]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[ie,[oe,$e],[re,me]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[ie,[oe,$e],[re,fe]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[ie,[oe,zt],[re,fe]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[ie,[oe,zt],[re,me]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[ie,[oe,"Lenovo"],[re,fe]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[ie,/_/g," "],[oe,"Nokia"],[re,me]],[/(pixel c)\b/i],[ie,[oe,Dt],[re,fe]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[ie,[oe,Dt],[re,me]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[ie,[oe,Rt],[re,me]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[ie,"Xperia Tablet"],[oe,Rt],[re,fe]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[ie,[oe,"OnePlus"],[re,me]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[ie,[oe,Se],[re,fe]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[ie,/(.+)/g,"Fire Phone $1"],[oe,Se],[re,me]],[/(playbook);[-\w\),; ]+(rim)/i],[ie,oe,[re,fe]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[ie,[oe,Me],[re,me]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[ie,[oe,Ae],[re,fe]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[ie,[oe,Ae],[re,me]],[/(nexus 9)/i],[ie,[oe,"HTC"],[re,fe]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[oe,[ie,/_/g," "],[re,me]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[ie,[oe,"TCL"],[re,fe]],[/(itel) ((\w+))/i],[[oe,vi],ie,[re,xi,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[ie,[oe,"Acer"],[re,fe]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[ie,[oe,"Meizu"],[re,me]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[ie,[oe,"Ulefone"],[re,me]],[/droid.+; (a(?:015|06[35]|142p?))/i],[ie,[oe,"Nothing"],[re,me]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[oe,ie,[re,me]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[oe,ie,[re,fe]],[/(surface duo)/i],[ie,[oe,xe],[re,fe]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[ie,[oe,"Fairphone"],[re,me]],[/(u304aa)/i],[ie,[oe,"AT&T"],[re,me]],[/\bsie-(\w*)/i],[ie,[oe,"Siemens"],[re,me]],[/\b(rct\w+) b/i],[ie,[oe,"RCA"],[re,fe]],[/\b(venue[\d ]{2,7}) b/i],[ie,[oe,"Dell"],[re,fe]],[/\b(q(?:mv|ta)\w+) b/i],[ie,[oe,"Verizon"],[re,fe]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[ie,[oe,"Barnes & Noble"],[re,fe]],[/\b(tm\d{3}\w+) b/i],[ie,[oe,"NuVision"],[re,fe]],[/\b(k88) b/i],[ie,[oe,"ZTE"],[re,fe]],[/\b(nx\d{3}j) b/i],[ie,[oe,"ZTE"],[re,me]],[/\b(gen\d{3}) b.+49h/i],[ie,[oe,"Swiss"],[re,me]],[/\b(zur\d{3}) b/i],[ie,[oe,"Swiss"],[re,fe]],[/\b((zeki)?tb.*\b) b/i],[ie,[oe,"Zeki"],[re,fe]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[oe,"Dragon Touch"],ie,[re,fe]],[/\b(ns-?\w{0,9}) b/i],[ie,[oe,"Insignia"],[re,fe]],[/\b((nxa|next)-?\w{0,9}) b/i],[ie,[oe,"NextBook"],[re,fe]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[oe,"Voice"],ie,[re,me]],[/\b(lvtel\-)?(v1[12]) b/i],[[oe,"LvTel"],ie,[re,me]],[/\b(ph-1) /i],[ie,[oe,"Essential"],[re,me]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[ie,[oe,"Envizen"],[re,fe]],[/\b(trio[-\w\. ]+) b/i],[ie,[oe,"MachSpeed"],[re,fe]],[/\btu_(1491) b/i],[ie,[oe,"Rotor"],[re,fe]],[/(shield[\w ]+) b/i],[ie,[oe,"Nvidia"],[re,fe]],[/(sprint) (\w+)/i],[oe,ie,[re,me]],[/(kin\.[onetw]{3})/i],[[ie,/\./g," "],[oe,xe],[re,me]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[ie,[oe,hi],[re,fe]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[ie,[oe,hi],[re,me]],[/smart-tv.+(samsung)/i],[oe,[re,ge]],[/hbbtv.+maple;(\d+)/i],[[ie,/^/,"SmartTV"],[oe,He],[re,ge]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[oe,zt],[re,ge]],[/(apple) ?tv/i],[oe,[ie,Re+" TV"],[re,ge]],[/crkey/i],[[ie,Qe+"cast"],[oe,Dt],[re,ge]],[/droid.+aft(\w+)( bui|\))/i],[ie,[oe,Se],[re,ge]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[ie,[oe,Je],[re,ge]],[/(bravia[\w ]+)( bui|\))/i],[ie,[oe,Rt],[re,ge]],[/(mitv-\w{5}) bui/i],[ie,[oe,jt],[re,ge]],[/Hbbtv.*(technisat) (.*);/i],[oe,ie,[re,ge]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[oe,Vi],[ie,Vi],[re,ge]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[re,ge]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[oe,ie,[re,de]],[/droid.+; (shield) bui/i],[ie,[oe,"Nvidia"],[re,de]],[/(playstation [345portablevi]+)/i],[ie,[oe,Rt],[re,de]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[ie,[oe,xe],[re,de]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[ie,[oe,He],[re,he]],[/((pebble))app/i],[oe,ie,[re,he]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[ie,[oe,Re],[re,he]],[/droid.+; (glass) \d/i],[ie,[oe,Dt],[re,he]],[/droid.+; (wt63?0{2,3})\)/i],[ie,[oe,hi],[re,he]],[/(quest( \d| pro)?)/i],[ie,[oe,Jt],[re,he]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[oe,[re,ve]],[/(aeobc)\b/i],[ie,[oe,Se],[re,ve]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[ie,[re,me]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[ie,[re,fe]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[re,fe]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[re,me]],[/(android[-\w\. ]{0,9});.+buil/i],[ie,[oe,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[ae,[ne,Pe+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[ae,[ne,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[ne,ae],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[ae,ne]],os:[[/microsoft (windows) (vista|xp)/i],[ne,ae],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[ne,[ae,xi,bi]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[ae,xi,bi],[ne,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[ae,/_/g,"."],[ne,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[ne,ri],[ae,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[ae,ne],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[ne,ae],[/\(bb(10);/i],[ae,[ne,Me]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[ae,[ne,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[ae,[ne,je+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[ae,[ne,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[ae,[ne,"watchOS"]],[/crkey\/([\d\.]+)/i],[ae,[ne,Qe+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[ne,si],ae],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[ne,ae],[/(sunos) ?([\w\.\d]*)/i],[[ne,"Solaris"],ae],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[ne,ae]]},Oi=function(Bt,it){if(typeof Bt===D&&(it=Bt,Bt=R),!(this instanceof Oi))return new Oi(Bt,it).getResult();var ti=typeof w!==_&&w.navigator?w.navigator:R,Ee=Bt||(ti&&ti.userAgent?ti.userAgent:x),ct=ti&&ti.userAgentData?ti.userAgentData:R,dt=it?Pi(mi,it):mi,St=ti&&ti.userAgent==Ee;return this.getBrowser=function(){var ft={};return ft[ne]=R,ft[ae]=R,zi.call(ft,Ee,dt.browser),ft[ee]=Ki(ft[ae]),St&&ti&&ti.brave&&typeof ti.brave.isBrave==T&&(ft[ne]="Brave"),ft},this.getCPU=function(){var ft={};return ft[le]=R,zi.call(ft,Ee,dt.cpu),ft},this.getDevice=function(){var ft={};return ft[oe]=R,ft[ie]=R,ft[re]=R,zi.call(ft,Ee,dt.device),St&&!ft[re]&&ct&&ct.mobile&&(ft[re]=me),St&&ft[ie]=="Macintosh"&&ti&&typeof ti.standalone!==_&&ti.maxTouchPoints&&ti.maxTouchPoints>2&&(ft[ie]="iPad",ft[re]=fe),ft},this.getEngine=function(){var ft={};return ft[ne]=R,ft[ae]=R,zi.call(ft,Ee,dt.engine),ft},this.getOS=function(){var ft={};return ft[ne]=R,ft[ae]=R,zi.call(ft,Ee,dt.os),St&&!ft[ne]&&ct&&ct.platform&&ct.platform!="Unknown"&&(ft[ne]=ct.platform.replace(/chrome os/i,si).replace(/macos/i,ri)),ft},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Ee},this.setUA=function(ft){return Ee=typeof ft===Y&&ft.length>be?Vi(ft,be):ft,this},this.setUA(Ee),this};Oi.VERSION=M,Oi.BROWSER=Ci([ne,ae,ee]),Oi.CPU=Ci([le]),Oi.DEVICE=Ci([ie,oe,re,de,me,ge,fe,he,ve]),Oi.ENGINE=Oi.OS=Ci([ne,ae]),C.exports&&(E=C.exports=Oi),E.UAParser=Oi;var Bi=typeof w!==_&&(w.jQuery||w.Zepto);if(Bi&&!Bi.ua){var Ji=new Oi;Bi.ua=Ji.getResult(),Bi.ua.get=function(){return Ji.getUA()},Bi.ua.set=function(Bt){Ji.setUA(Bt);var it=Ji.getResult();for(var ti in it)Bi.ua[ti]=it[ti]}}})(typeof window=="object"?window:uaParser)}(uaParser$1,uaParser$1.exports)),uaParser$1.exports}var hasRequiredDefaultBrowserBehavior;function requireDefaultBrowserBehavior(){if(hasRequiredDefaultBrowserBehavior)return DefaultBrowserBehavior;hasRequiredDefaultBrowserBehavior=1;var C=DefaultBrowserBehavior&&DefaultBrowserBehavior.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})};Object.defineProperty(DefaultBrowserBehavior,"__esModule",{value:!0});const E=require$$0$3,w=requireUaParser();let R=class Ud{constructor(){this.FALLBACK_BROWSER={type:"browser",name:"unknown",version:"unknown",os:"unknown"},this.browser=E.detect()||this.FALLBACK_BROWSER,this.uaParserResult=navigator&&navigator.userAgent?new w.UAParser(navigator.userAgent).getResult():null,this.browserSupport={chrome:78,"edge-chromium":79,electron:7,firefox:75,ios:13,safari:13,opera:66,samsung:12,crios:86,fxios:23,"ios-webview":605,"chromium-webview":92},this.browserName={chrome:"Google Chrome","edge-chromium":"Microsoft Edge",electron:"Electron",firefox:"Mozilla Firefox",ios:"Safari iOS",safari:"Safari",opera:"Opera",samsung:"Samsung Internet",crios:"Chrome iOS",fxios:"Firefox iOS","ios-webview":"WKWebView iOS","chromium-webview":"Chrome WebView"},this.chromeLike=["chrome","edge-chromium","chromium-webview","opera","samsung"],this.webkitBrowsers=["crios","fxios","safari","ios","ios-webview","edge-ios"]}version(){return this.browser.version}majorVersion(){return this.version()!==null?parseInt(this.version().split(".")[0]):-1}osMajorVersion(){return parseInt(this.uaParserResult.os.version.split(".")[0])}engine(){return this.uaParserResult.engine.name}engineMajorVersion(){return parseInt(this.uaParserResult.engine.version.split(".")[0])}name(){return this.browser.name}hasChromiumWebRTC(){for(const x of this.chromeLike)if(x===this.browser.name)return!0;return!1}hasWebKitWebRTC(){for(const x of this.webkitBrowsers)if(x===this.browser.name)return!0;return!1}hasFirefoxWebRTC(){return this.isFirefox()}requiresPlaybackLatencyHintForAudioContext(){return navigator.userAgent.indexOf("Windows")!==-1}supportsCanvasCapturedStreamPlayback(){return!this.isIOSSafari()&&!this.isIOSChrome()&&!this.isIOSFirefox()&&!this.isIOSEdge()||this.isIOSSafari()&&this.majorVersion()>=Ud.MIN_IOS_SUPPORT_CANVAS_STREAM_PLAYBACK||this.majorVersion()>=Ud.MIN_IOS_NON_SAFARI_SUPPORT_CANVAS_STREAM_PLAYBACK}supportsBackgroundFilter(){return!(this.name()==="safari"&&this.majorVersion()===15||!this.supportsCanvasCapturedStreamPlayback())}supportsVideoLayersAllocationRtpHeaderExtension(){return this.hasChromiumWebRTC()}supportsDependencyDescriptorRtpHeaderExtension(){return this.hasChromiumWebRTC()}supportsScalableVideoCoding(){return this.hasChromiumWebRTC()&&this.engine()==="Blink"&&this.engineMajorVersion()>=111}supportsAudioRedundancy(){return this.hasChromiumWebRTC()?this.engineMajorVersion()>=107:!this.hasFirefoxWebRTC()}requiresResolutionAlignment(x,S){return this.isAndroid()&&this.isPixel3()?[Math.ceil(x/64)*64,Math.ceil(S/64)*64]:[x,S]}requiresCheckForSdpConnectionAttributes(){return!this.isIOSSafari()&&!this.isIOSChrome()&&!this.isIOSFirefox()}requiresIceCandidateGatheringTimeoutWorkaround(){return this.hasChromiumWebRTC()}requiresBundlePolicy(){return"max-bundle"}requiresNoExactMediaStreamConstraints(){return this.isSamsungInternet()}requiresGroupIdMediaStreamConstraints(){return this.isSamsungInternet()}getDisplayMediaAudioCaptureSupport(){return this.isChrome()||this.isEdge()}doesNotSupportMediaDeviceLabels(){return this.browser.name==="chromium-webview"}isSupported(){return!(!this.browserSupport[this.browser.name]||this.majorVersion()<this.browserSupport[this.browser.name]||this.browser.name==="firefox"&&this.isAndroid())}isSimulcastSupported(){return this.hasChromiumWebRTC()}supportDownlinkBandwidthEstimation(){return!this.isFirefox()}supportString(){if(this.isAndroid())return`${this.browserName.chrome} ${this.browserSupport.chrome}+, ${this.browserName.samsung} ${this.browserSupport.samsung}+`;const x=[];for(const S in this.browserSupport)x.push(`${this.browserName[S]} ${this.browserSupport[S]}+`);return x.join(", ")}supportedVideoCodecs(){return C(this,void 0,void 0,function*(){const x=new RTCPeerConnection;return x.addTransceiver("video",{direction:"inactive",streams:[]}),(yield x.createOffer({offerToReceiveVideo:!0})).sdp.split(`\r
`).filter(S=>S.includes("a=rtpmap:")).map(S=>S.replace(/.* /,"").replace(/\/.*/,"")).filter((S,T,_)=>_.indexOf(S)===T).filter(S=>S!=="rtx"&&S!=="red"&&S!=="ulpfec")})}supportsSetSinkId(){return"setSinkId"in HTMLAudioElement.prototype}disableResolutionScaleDown(){return this.isAndroid()}disable480pResolutionScaleDown(){return/( Chrome\/98\.)/i.test(navigator.userAgent)&&this.browser.os.startsWith("Windows")}requiresDisablingH264Encoding(){return(this.isIOSSafari()||this.isIOSChrome()||this.isIOSFirefox())&&(this.version()==="15.1.0"||/( OS 15_1)/i.test(navigator.userAgent))}requiresVideoPlayWorkaround(){return this.isSafari()}isVideoFxSupportedBrowser(){return this.supportsBackgroundFilter()}isIOSSafari(){return this.browser.name==="ios"||this.browser.name==="ios-webview"||this.browser.name==="safari"&&/( Mac )/i.test(navigator.userAgent)&&navigator.maxTouchPoints>1}isSafari(){return this.browser.name==="safari"||this.isIOSSafari()}isFirefox(){return this.browser.name==="firefox"}isIOSFirefox(){return this.browser.name==="fxios"}isIOSChrome(){return this.browser.name==="crios"}isChrome(){return this.browser.name==="chrome"}isEdge(){return this.browser.name==="edge-chromium"}isIOSEdge(){return this.browser.name==="edge-ios"}isSamsungInternet(){return this.browser.name==="samsung"}isAndroid(){return/(android)/i.test(navigator.userAgent)}isPixel3(){return/( pixel 3)/i.test(navigator.userAgent)}};return DefaultBrowserBehavior.default=R,R.MIN_IOS_SUPPORT_CANVAS_STREAM_PLAYBACK=16,R.MIN_IOS_NON_SAFARI_SUPPORT_CANVAS_STREAM_PLAYBACK=106,DefaultBrowserBehavior}var hasRequiredAudioProfile;function requireAudioProfile(){if(hasRequiredAudioProfile)return AudioProfile;hasRequiredAudioProfile=1;var C=AudioProfile&&AudioProfile.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(AudioProfile,"__esModule",{value:!0});const E=C(requireDefaultBrowserBehavior());let w=class cu{constructor(M=null,x=!0){this.audioBitrateBps=M,this.enableAudioRedundancy=new E.default().supportsAudioRedundancy()&&x}static fullbandSpeechMono(M=!0){return new cu(4e4,M)}static fullbandMusicMono(M=!0){return new cu(64e3,M)}static fullbandMusicStereo(M=!0){return new cu(128e3,M)}isStereo(){return this.audioBitrateBps===128e3}hasRedundancyEnabled(){return this.enableAudioRedundancy}};return AudioProfile.default=w,AudioProfile}var AudioVideoControllerState={},hasRequiredAudioVideoControllerState;function requireAudioVideoControllerState(){return hasRequiredAudioVideoControllerState||(hasRequiredAudioVideoControllerState=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT=void 0,C.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT=25;class E{constructor(){this.logger=null,this.browserBehavior=null,this.meetingSessionConfiguration=null,this.signalingClient=null,this.peer=null,this.previousSdpOffer=null,this.sdpOfferInit=null,this.audioVideoController=null,this.realtimeController=null,this.videoTileController=null,this.mediaStreamBroker=null,this.activeAudioInput=void 0,this.activeVideoInput=void 0,this.audioMixController=null,this.transceiverController=null,this.indexFrame=null,this.iceCandidates=[],this.iceCandidateHandler=null,this.iceGatheringStateEventHandler=null,this.sdpAnswer=null,this.turnCredentials=null,this.reconnectController=null,this.removableObservers=[],this.audioProfile=null,this.videoStreamIndex=null,this.videoDownlinkBandwidthPolicy=null,this.videoUplinkBandwidthPolicy=null,this.lastKnownVideoAvailability=null,this.videoCaptureAndEncodeParameter=null,this.videosToReceive=null,this.lastVideosToReceive=null,this.videoSubscriptions=null,this.lastVideoSubscriptionConfiguration=new Map,this.videoSubscriptionLimit=C.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT,this.previousSdpAnswerAsString="",this.serverSupportsCompression=!1,this.videoSendCodecPreferences=[],this.currentVideoSendCodec=void 0,this.meetingSupportedVideoSendCodecPreferences=void 0,this.prioritizedSendVideoCodecCapabilities=[],this.degradedVideoSendCodecs=[],this.videosPaused=null,this.videoDuplexMode=null,this.volumeIndicatorAdapter=null,this.statsCollector=null,this.connectionMonitor=null,this.videoInputAttachedTimestampMs=0,this.audioDeviceInformation={},this.videoDeviceInformation={},this.enableSimulcast=!1,this.enableSVC=!1,this.eventController=null,this.signalingOpenDurationMs=null,this.iceGatheringDurationMs=null,this.startAudioVideoTimestamp=null,this.attendeePresenceDurationMs=null,this.meetingStartDurationMs=null,this.poorConnectionCount=0,this.maxVideoTileCount=0,this.startTimeMs=null}resetConnectionSpecificState(){this.peer&&this.peer.close(),this.peer=null,this.previousSdpOffer=null,this.sdpOfferInit=null,this.transceiverController!==void 0&&this.transceiverController.reset(),this.indexFrame=null,this.iceCandidates=[],this.iceCandidateHandler=null,this.sdpAnswer=null,this.turnCredentials=null,this.videoDownlinkBandwidthPolicy.reset(),this.videoUplinkBandwidthPolicy.reset&&this.videoUplinkBandwidthPolicy.reset(),this.lastVideosToReceive=null,this.lastVideoSubscriptionConfiguration=new Map,this.videoSubscriptions=null,this.videoSubscriptionLimit=C.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT,this.previousSdpAnswerAsString="",this.serverSupportsCompression=!1,this.currentVideoSendCodec=void 0,this.meetingSupportedVideoSendCodecPreferences=void 0,this.videoDuplexMode=null}}C.default=E}(AudioVideoControllerState)),AudioVideoControllerState}var BackgroundBlurStrength={},hasRequiredBackgroundBlurStrength;function requireBackgroundBlurStrength(){if(hasRequiredBackgroundBlurStrength)return BackgroundBlurStrength;hasRequiredBackgroundBlurStrength=1,Object.defineProperty(BackgroundBlurStrength,"__esModule",{value:!0}),BackgroundBlurStrength.BlurStrengthMapper=void 0;const C={LOW:7,MEDIUM:15,HIGH:30};class E{static getBlurAmount(R,M){if(R<=0)throw new Error(`invalid value for blur strength: ${R}`);return Math.round(R*M.height/this.BLUR_STRENGTH_DIVISOR)}}return BackgroundBlurStrength.BlurStrengthMapper=E,E.BLUR_STRENGTH_DIVISOR=540,BackgroundBlurStrength.default=C,BackgroundBlurStrength}var BackgroundBlurVideoFrameProcessor={},BackgroundFilterVideoFrameProcessor={},loader={},fetch$1={},hasRequiredFetch;function requireFetch(){if(hasRequiredFetch)return fetch$1;hasRequiredFetch=1,Object.defineProperty(fetch$1,"__esModule",{value:!0}),fetch$1.isValidRevisionID=fetch$1.isValidAssetGroup=fetch$1.resolveURL=fetch$1.addQueryParams=fetch$1.withQueryString=fetch$1.withRequestHeaders=fetch$1.fetchWithBehavior=void 0;function C(_,D,Y){if(!Y)return fetch(_,D);const ee=w(_,Y),ie=E(D,Y);return fetch(ee,ie)}fetch$1.fetchWithBehavior=C;function E(_,D){return D!=null&&D.headers?_?Object.assign(Object.assign({},_),{headers:Object.assign(Object.assign({},_.headers||{}),D.headers)}):{headers:D.headers}:_}fetch$1.withRequestHeaders=E;function w(_,D){if(!(D!=null&&D.escapedQueryString))return _;const Y=_.lastIndexOf("?")!==-1;return`${_}${Y?"&":"?"}${D.escapedQueryString}`}fetch$1.withQueryString=w;function R(_,D){const Y=Object.keys(D);if(!Y.length)return _;const ee=new URLSearchParams(_==null?void 0:_.escapedQueryString);for(const ie of Y)ee.append(ie,D[ie]);return Object.assign(Object.assign({},_),{escapedQueryString:ee.toString()})}fetch$1.addQueryParams=R;const M={method:"HEAD",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"origin"};function x(_,D){return C(_,M,D).then(Y=>Y.redirected?Y.url:_)}fetch$1.resolveURL=x;function S(_){return!!_&&/^[-.a-zA-Z0-9]+$/.test(_)}fetch$1.isValidAssetGroup=S;function T(_){return!!_&&/^[123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ]{22}$/.test(_)}return fetch$1.isValidRevisionID=T,fetch$1}var hasRequiredLoader;function requireLoader(){if(hasRequiredLoader)return loader;hasRequiredLoader=1,Object.defineProperty(loader,"__esModule",{value:!0}),loader.loadWorker=void 0;const C=requireFetch(),E={method:"GET",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer"},w=(R,M,x,S)=>{S==null||S.debug(`Loading ${M} worker from ${R}.`);let T=!1;try{T=self.origin===new URL(R).origin}catch(_){S==null||S.error("Could not compare origins.",_)}if(T){const _=C.withQueryString(R,x);return Promise.resolve(new Worker(_,{name:M}))}return C.fetchWithBehavior(R,E,x).then(_=>{if(_.ok)return _.blob().then(D=>new Worker(window.URL.createObjectURL(D)));throw new Error("Fetch failed.")})};return loader.loadWorker=w,loader}var support={},hasRequiredSupport;function requireSupport(){return hasRequiredSupport||(hasRequiredSupport=1,function(C){var E=support&&support.__awaiter||function(oe,ae,le,de){function me(fe){return fe instanceof le?fe:new le(function(ge){ge(fe)})}return new(le||(le=Promise))(function(fe,ge){function he(Se){try{be(de.next(Se))}catch(Re){ge(Re)}}function ve(Se){try{be(de.throw(Se))}catch(Re){ge(Re)}}function be(Se){Se.done?fe(Se.value):me(Se.value).then(he,ve)}be((de=de.apply(oe,ae||[])).next())})};Object.defineProperty(C,"__esModule",{value:!0}),C.isOldChrome=C.supportsWASMStreaming=C.supportsSharedArrayBuffer=C.supportsWASM=C.supportsAudioWorklet=C.supportsWorker=C.supportsVoiceFocusWorker=C.supportsWASMPostMessage=C.isSafari=void 0;const w=requireLoader(),R=(oe=globalThis)=>!!oe.navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)/),M=(oe=globalThis)=>{const ae=oe.navigator.userAgent,le=ae.match(/Safari\//),de=ae.match(/Chrom(?:e|ium)\//);return!!(le&&!de)};C.isSafari=M;const x=(oe=globalThis)=>C.isSafari(oe)?!1:R(oe)?(ne(oe)||0)<95:!0;C.supportsWASMPostMessage=x;const S=(oe=globalThis,ae,le)=>E(void 0,void 0,void 0,function*(){if(!C.supportsWorker(oe,le))return!1;const de=`${ae.paths.workers}worker-v1.js`;try{const me=yield w.loadWorker(de,"VoiceFocusTestWorker",ae,le);try{me.terminate()}catch(fe){le==null||le.debug("Failed to terminate worker.",fe)}return!0}catch(me){return le==null||le.info("Failed to fetch and instantiate test worker",me),!1}});C.supportsVoiceFocusWorker=S;const T=(oe=globalThis,ae)=>{try{return!!oe.Worker}catch(le){return ae==null||ae.info("Does not support Worker",le),!1}};C.supportsWorker=T;const _=(oe=globalThis,ae)=>{try{return!!oe.AudioWorklet&&!!oe.AudioWorkletNode}catch(le){return ae==null||ae.info("Does not support Audio Worklet",le),!1}};C.supportsAudioWorklet=_;const D=(oe=globalThis,ae)=>{try{return!!oe.WebAssembly&&(!!oe.WebAssembly.compile||!!oe.WebAssembly.compileStreaming)}catch(le){return ae==null||ae.info("Does not support WASM",le),!1}};C.supportsWASM=D;const Y=(oe=globalThis,ae=globalThis,le)=>{try{return!!oe.SharedArrayBuffer&&(!!ae.chrome||!!oe.crossOriginIsolated)}catch{return le==null||le.info("Does not support SharedArrayBuffer."),!1}};C.supportsSharedArrayBuffer=Y;const ee=(oe=globalThis,ae)=>{var le;try{return!!(!((le=oe.WebAssembly)===null||le===void 0)&&le.compileStreaming)}catch(de){return ae==null||ae.info("Does not support WASM streaming compilation",de),!1}};C.supportsWASMStreaming=ee;const ie=90,ne=(oe=globalThis)=>{try{if(!oe.chrome)return}catch{}const ae=oe.navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)/);if(ae)return parseInt(ae[1],10)},re=(oe=globalThis,ae)=>{const le=ne(oe);return le&&le<ie?(ae==null||ae.debug(`Chrome ${le} has incomplete SIMD support.`),!0):!1};C.isOldChrome=re}(support)),support}var ModelSpecBuilder={},hasRequiredModelSpecBuilder;function requireModelSpecBuilder(){if(hasRequiredModelSpecBuilder)return ModelSpecBuilder;hasRequiredModelSpecBuilder=1,Object.defineProperty(ModelSpecBuilder,"__esModule",{value:!0});let C=class Jp{constructor(){this.path=null,this.input=null,this.output=null}static builder(){return new Jp}withDefaultModel(){return this.withSelfieSegmentationDefaults()}withSelfieSegmentationDefaults(){const w={height:144,width:256,range:[0,1],channels:3},R={height:144,width:256,range:[0,1],channels:1},M="https://static.sdkassets.chime.aws/bgblur/models/selfie_segmentation_landscape.tflite";return this.path=M,this.input=w,this.output=R,this}withPath(w){return this.path=w,this}withInput(w){return this.input=w,this}withOutput(w){return this.output=w,this}validate(){if(!this.path)throw new Error("model spec path is not set");if(!this.input)throw new Error("model spec input is not set");if(!this.output)throw new Error("model spec output is not set")}build(){return this.validate(),{path:this.path,input:this.input,output:this.output}}};return ModelSpecBuilder.default=C,ModelSpecBuilder}var Versioning={},version$2={},hasRequiredVersion;function requireVersion(){return hasRequiredVersion||(hasRequiredVersion=1,Object.defineProperty(version$2,"__esModule",{value:!0}),version$2.default={hash:"567e272",raw:"v3.25.0",semverString:"3.25.0"}),version$2}var hasRequiredVersioning;function requireVersioning(){if(hasRequiredVersioning)return Versioning;hasRequiredVersioning=1;var C=Versioning&&Versioning.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(Versioning,"__esModule",{value:!0});const E=C(requireDefaultBrowserBehavior()),w=C(requireVersion());let R=class Bs{static get sdkName(){return"amazon-chime-sdk-js"}static get sdkVersion(){return w.default.semverString}static get sdkVersionSemVer(){var x,S,T,_;const D=w.default.semverString.match(/^(?<major>[0-9]+)\.(?<minor>[0-9]+)((?:\.(?<patch>[0-9]+))(?:-(?<preRelease>[a-zA-Z]+(\.[0-9])*))?)?/);return{major:(x=D==null?void 0:D.groups)===null||x===void 0?void 0:x.major,minor:(S=D==null?void 0:D.groups)===null||S===void 0?void 0:S.minor,patch:(T=D==null?void 0:D.groups)===null||T===void 0?void 0:T.patch,preRelease:(_=D==null?void 0:D.groups)===null||_===void 0?void 0:_.preRelease}}static get buildSHA(){return w.default.hash.substr(1)}static get sdkUserAgentLowResolution(){const x=new E.default;return`${x.name()}-${x.majorVersion()}`}static urlWithVersion(x){const S=new URL(x);return S.searchParams.append(Bs.X_AMZN_VERSION,Bs.sdkVersion),S.searchParams.append(Bs.X_AMZN_USER_AGENT,Bs.sdkUserAgentLowResolution),S.toString()}};return Versioning.default=R,R.X_AMZN_VERSION="X-Amzn-Version",R.X_AMZN_USER_AGENT="X-Amzn-User-Agent",Versioning}var hasRequiredBackgroundFilterVideoFrameProcessor;function requireBackgroundFilterVideoFrameProcessor(){if(hasRequiredBackgroundFilterVideoFrameProcessor)return BackgroundFilterVideoFrameProcessor;hasRequiredBackgroundFilterVideoFrameProcessor=1;var C=BackgroundFilterVideoFrameProcessor&&BackgroundFilterVideoFrameProcessor.__awaiter||function(ee,ie,ne,re){function oe(ae){return ae instanceof ne?ae:new ne(function(le){le(ae)})}return new(ne||(ne=Promise))(function(ae,le){function de(ge){try{fe(re.next(ge))}catch(he){le(he)}}function me(ge){try{fe(re.throw(ge))}catch(he){le(he)}}function fe(ge){ge.done?ae(ge.value):oe(ge.value).then(de,me)}fe((re=re.apply(ee,ie||[])).next())})},E=BackgroundFilterVideoFrameProcessor&&BackgroundFilterVideoFrameProcessor.__importDefault||function(ee){return ee&&ee.__esModule?ee:{default:ee}};Object.defineProperty(BackgroundFilterVideoFrameProcessor,"__esModule",{value:!0});const w=requireLoader(),R=requireSupport(),M=E(requireModelSpecBuilder()),x=E(requireDefaultBrowserBehavior()),S=E(requireVersioning()),T=()=>M.default.builder().withSelfieSegmentationDefaults().build(),_="https://static.sdkassets.chime.aws",D={worker:`${_}/bgblur/workers/worker.js`,wasm:`${_}/bgblur/wasm/_cwt-wasm.wasm`,simd:`${_}/bgblur/wasm/_cwt-wasm-simd.wasm`};let Y=class{static defaultAssetSpec(){const ee=S.default.sdkVersionSemVer;return{assetGroup:`sdk-${ee.major}.${ee.minor}`}}static createUrlWithParams(ee,ie){const ne=new URL(ee),re=Object.keys(ie);for(const oe of re)ie[oe]!==void 0&&ne.searchParams.set(oe,ie[oe]);return ne.toString()}static resolveSpec(ee){const{paths:ie=D,model:ne=T(),assetGroup:re=this.defaultAssetSpec().assetGroup,revisionID:oe=this.defaultAssetSpec().revisionID}=ee||{},ae={assetGroup:re,revisionID:oe,sdk:encodeURIComponent(S.default.sdkVersion),ua:encodeURIComponent(S.default.sdkUserAgentLowResolution)};return ie.worker=this.createUrlWithParams(ie.worker,ae),ie.wasm=this.createUrlWithParams(ie.wasm,ae),ie.simd=this.createUrlWithParams(ie.simd,ae),ne.path=this.createUrlWithParams(ne.path,ae),{paths:ie,model:ne,assetGroup:re,revisionID:oe}}static resolveOptions(ee){ee.reportingPeriodMillis||(ee.reportingPeriodMillis=1e3);const ie=30;return ee.filterCPUUtilization?(ee.filterCPUUtilization<0||ee.filterCPUUtilization>100)&&(ee.logger.warn(`filterCPUUtilization must be set to a range between 0 and 100 percent. Falling back to default of ${ie} percent`),ee.filterCPUUtilization=ie):ee.filterCPUUtilization=ie,ee}static isSupported(ee,ie){const{logger:ne}=ie;return typeof globalThis>"u"?(ne.info("Browser does not have globalThis."),Promise.resolve(!1)):new x.default().supportsBackgroundFilter()?R.supportsWASM(globalThis,ne)?this.supportsBackgroundFilter(globalThis,ee,ne):(ne.info("Browser does not support WASM."),Promise.resolve(!1)):(ne.info("Browser is not supported."),Promise.resolve(!1))}static supportsBackgroundFilter(ee=globalThis,ie,ne){return C(this,void 0,void 0,function*(){if(!R.supportsWorker(ee,ne))return ne.info("Browser does not support web workers."),!1;const re=ie.paths.worker;try{const oe=yield w.loadWorker(re,"BackgroundFilterWorker",{},null);try{oe.terminate()}catch(ae){ne.info(`Failed to terminate worker. ${ae.message}`)}return!0}catch(oe){return ne.info(`Failed to fetch and instantiate test worker ${oe.message}`),!1}})}};return BackgroundFilterVideoFrameProcessor.default=Y,BackgroundFilterVideoFrameProcessor}var ConsoleLogger={},hasRequiredConsoleLogger;function requireConsoleLogger(){if(hasRequiredConsoleLogger)return ConsoleLogger;hasRequiredConsoleLogger=1;var C=ConsoleLogger&&ConsoleLogger.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(ConsoleLogger,"__esModule",{value:!0});const E=C(requireLogLevel());let w=class{constructor(R,M=E.default.WARN){this.name=R,this.level=M}info(R){this.log(E.default.INFO,R)}warn(R){this.log(E.default.WARN,R)}error(R){this.log(E.default.ERROR,R)}debug(R){E.default.DEBUG<this.level||(typeof R=="string"?this.log(E.default.DEBUG,R):R?this.log(E.default.DEBUG,R()):this.log(E.default.DEBUG,""+R))}setLogLevel(R){this.level=R}getLogLevel(){return this.level}log(R,M){if(R<this.level)return;const x=`${new Date().toISOString()} [${E.default[R]}] ${this.name} - ${M}`;switch(R){case E.default.ERROR:console.error(x);break;case E.default.WARN:console.warn(x);break;case E.default.DEBUG:console.debug(x.replace(/\\r\\n/g,`
`));break;case E.default.INFO:console.info(x);break}}};return ConsoleLogger.default=w,ConsoleLogger}var NoOpVideoFrameProcessor={},hasRequiredNoOpVideoFrameProcessor;function requireNoOpVideoFrameProcessor(){if(hasRequiredNoOpVideoFrameProcessor)return NoOpVideoFrameProcessor;hasRequiredNoOpVideoFrameProcessor=1;var C=NoOpVideoFrameProcessor&&NoOpVideoFrameProcessor.__awaiter||function(w,R,M,x){function S(T){return T instanceof M?T:new M(function(_){_(T)})}return new(M||(M=Promise))(function(T,_){function D(ie){try{ee(x.next(ie))}catch(ne){_(ne)}}function Y(ie){try{ee(x.throw(ie))}catch(ne){_(ne)}}function ee(ie){ie.done?T(ie.value):S(ie.value).then(D,Y)}ee((x=x.apply(w,R||[])).next())})};Object.defineProperty(NoOpVideoFrameProcessor,"__esModule",{value:!0});let E=class{process(w){return C(this,void 0,void 0,function*(){return w})}destroy(){return C(this,void 0,void 0,function*(){})}};return NoOpVideoFrameProcessor.default=E,NoOpVideoFrameProcessor}var BackgroundBlurProcessorBuiltIn={},BackgroundBlurProcessorProvided={},BackgroundFilterProcessor={},CanvasVideoFrameBuffer={},hasRequiredCanvasVideoFrameBuffer;function requireCanvasVideoFrameBuffer(){if(hasRequiredCanvasVideoFrameBuffer)return CanvasVideoFrameBuffer;hasRequiredCanvasVideoFrameBuffer=1;var C=CanvasVideoFrameBuffer&&CanvasVideoFrameBuffer.__awaiter||function(w,R,M,x){function S(T){return T instanceof M?T:new M(function(_){_(T)})}return new(M||(M=Promise))(function(T,_){function D(ie){try{ee(x.next(ie))}catch(ne){_(ne)}}function Y(ie){try{ee(x.throw(ie))}catch(ne){_(ne)}}function ee(ie){ie.done?T(ie.value):S(ie.value).then(D,Y)}ee((x=x.apply(w,R||[])).next())})};Object.defineProperty(CanvasVideoFrameBuffer,"__esModule",{value:!0});let E=class{constructor(w){this.canvas=w,this.destroyed=!1}destroy(){this.canvas=null,this.destroyed=!0}asCanvasImageSource(){return C(this,void 0,void 0,function*(){return this.destroyed?Promise.reject("canvas buffer is destroyed"):Promise.resolve(this.canvas)})}asCanvasElement(){return this.canvas}};return CanvasVideoFrameBuffer.default=E,CanvasVideoFrameBuffer}var BackgroundFilterFrameCounter={},hasRequiredBackgroundFilterFrameCounter;function requireBackgroundFilterFrameCounter(){if(hasRequiredBackgroundFilterFrameCounter)return BackgroundFilterFrameCounter;hasRequiredBackgroundFilterFrameCounter=1,Object.defineProperty(BackgroundFilterFrameCounter,"__esModule",{value:!0});const C=.8;let E=class{constructor(w,R,M,x){this.delegate=w,this.reportingPeriodMillis=R,this.filterCPUUtilization=M,this.logger=x,this._processingFilter=!0,this.lastReportedEventTimestamp=0,this.lastFilterCompleteTimestamp=0,this.filterTotalMillis=0,this.filterCount=0,this.framerate=0,this.filterDurationNotifyMillis=0,this.setSegmentationDuration()}reportEvent(w){const R=w-this.lastReportedEventTimestamp;if(R>=this.reportingPeriodMillis){const M=this.filterCount,x=this.filterTotalMillis;if(this.filterCount=0,this.filterTotalMillis=0,this.lastReportedEventTimestamp=w,this.framerate===0||M===0)return;const S=Math.round(x/M),T=Math.round(this.framerate*(R/1e3))-M,_=Math.round(100*x/R);S>=this.filterDurationNotifyMillis&&this.delegate.filterFrameDurationHigh({framesDropped:T,avgFilterDurationMillis:S,framerate:this.framerate,periodMillis:R}),_>=this.filterCPUUtilization&&this.delegate.filterCPUUtilizationHigh({cpuUtilization:_,filterMillis:x,periodMillis:R})}}setSegmentationDuration(){this.filterDurationNotifyMillis=Math.round(1e3/this.framerate*C)}frameReceived(w){w!==this.framerate&&(this.framerate=w,this.logger.info(`frame counter setting frame rate to ${this.framerate}`),this.setSegmentationDuration());const R=Date.now();this.reportEvent(R)}filterSubmitted(){this._processingFilter=!0,this.lastFilterCompleteTimestamp=Date.now()}filterComplete(){this.filterTotalMillis+=Date.now()-this.lastFilterCompleteTimestamp,this._processingFilter=!1,this.filterCount++}get processingSegment(){return this._processingFilter}};return BackgroundFilterFrameCounter.default=E,BackgroundFilterFrameCounter}var hasRequiredBackgroundFilterProcessor;function requireBackgroundFilterProcessor(){if(hasRequiredBackgroundFilterProcessor)return BackgroundFilterProcessor;hasRequiredBackgroundFilterProcessor=1;var C=BackgroundFilterProcessor&&BackgroundFilterProcessor.__awaiter||function(_,D,Y,ee){function ie(ne){return ne instanceof Y?ne:new Y(function(re){re(ne)})}return new(Y||(Y=Promise))(function(ne,re){function oe(de){try{le(ee.next(de))}catch(me){re(me)}}function ae(de){try{le(ee.throw(de))}catch(me){re(me)}}function le(de){de.done?ne(de.value):ie(de.value).then(oe,ae)}le((ee=ee.apply(_,D||[])).next())})},E=BackgroundFilterProcessor&&BackgroundFilterProcessor.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(BackgroundFilterProcessor,"__esModule",{value:!0}),BackgroundFilterProcessor.BackgroundFilterMonitor=void 0;const w=requireLoader(),R=E(requireCanvasVideoFrameBuffer()),M=E(requireBackgroundFilterFrameCounter());class x{constructor(){this.value=void 0,this.resolve=null}whenNext(){return this.promise||(this.promise=new Promise(D=>this.resolve=D)),this.promise}next(D){this.value=D,this.resolve(D),delete this.promise}}let S=class Hd{constructor(D,Y,ee,ie,ne){this.targetCanvas=document.createElement("canvas"),this.canvasCtx=this.targetCanvas.getContext("2d"),this.canvasVideoFrameBuffer=new R.default(this.targetCanvas),this.mask$=new x,this.sourceWidth=0,this.sourceHeight=0,this.frameNumber=0,this.videoFramesPerFilterUpdate=1,this.initWorkerPromise=Hd.createWorkerPromise(),this.loadModelPromise=Hd.createWorkerPromise(),this.modelInitialized=!1,this.destroyed=!1,this.filterType=D,this.validateSpec(Y),this.validateOptions(ee),this.spec=Y,this.logger=ee.logger,this.delegate=ie,this.initCPUMonitor(ee),this.eventController=ne}static createWorkerPromise(){const D={resolve:null,reject:null,promise:null};return D.promise=new Promise((Y,ee)=>{D.resolve=Y,D.reject=ee}),D}validateSpec(D){if(!D)throw new Error("processor has null spec");if(!D.model)throw new Error("processor spec has null model");if(!D.paths)throw new Error("processor spec has null paths")}validateOptions(D){if(!D)throw new Error("processor has null options");if(!D.logger)throw new Error("processor has null options - logger");if(!D.reportingPeriodMillis)throw new Error("processor has null options - reportingPeriodMillis");if(!D.filterCPUUtilization)throw new Error("processor has null options - filterCPUUtilization")}initCPUMonitor(D){this.videoFramesPerFilterUpdate=1,this.frameCounter=new M.default(this.delegate,D.reportingPeriodMillis,D.filterCPUUtilization,this.logger),this.cpuMonitor=new T(5e3,{reduceCPUUtilization:()=>{this.updateVideoFramesPerFilterUpdate(Math.min(this.videoFramesPerFilterUpdate+1,10))},increaseCPUUtilization:()=>{this.updateVideoFramesPerFilterUpdate(Math.max(this.videoFramesPerFilterUpdate-1,1))}}),this.delegate.addObserver(this.cpuMonitor)}stringify(D){return JSON.stringify(D,null,2)}handleInitialize(D){if(this.logger.info(`received initialize message: ${this.stringify(D)}`),!D.payload){this.logger.error("failed to initialize module"),this.initWorkerPromise.reject(new Error("failed to initialize the module"));return}const Y=this.spec.model;this.worker.postMessage({msg:"loadModel",payload:{modelUrl:Y.path,inputHeight:Y.input.height,inputWidth:Y.input.width,inputChannels:4,modelRangeMin:Y.input.range[0],modelRangeMax:Y.input.range[1],blurPixels:0}}),this.initWorkerPromise.resolve({})}handleLoadModel(D){if(this.logger.info(`received load model message: ${this.stringify(D)}`),D.payload!==2){this.logger.error("failed to load model! status: "+D.payload),this.loadModelPromise.reject(new Error("failed to load model! status: "+D.payload));return}this.modelInitialized=!0,this.loadModelPromise.resolve({})}handlePredict(D){this.mask$.next(D.payload.output)}handleWorkerEvent(D){const Y=D.data;switch(Y.msg){case"initialize":this.handleInitialize(Y);break;case"loadModel":this.handleLoadModel(Y);break;case"predict":this.handlePredict(Y);break;default:this.logger.info(`unexpected event msg: ${this.stringify(Y)}`);break}}loadAssets(){return C(this,void 0,void 0,function*(){this.logger.info("start initializing the processor");try{this.worker=yield w.loadWorker(this.spec.paths.worker,"BackgroundFilterWorker",{},null),this.worker.addEventListener("message",D=>this.handleWorkerEvent(D)),this.worker.postMessage({msg:"initialize",payload:{wasmPath:this.spec.paths.wasm,simdPath:this.spec.paths.simd}}),yield this.initWorkerPromise.promise,this.logger.info(`successfully initialized the ${this.filterType} worker`),yield this.loadModelPromise.promise,this.logger.info(`successfully loaded ${this.filterType} worker segmentation model`)}catch(D){throw new Error(`could not initialize the ${this.filterType} video frame processor due to '${D.message}'`)}this.logger.info(`successfully initialized the ${this.filterType} processor`)})}process(D){return C(this,void 0,void 0,function*(){if(this.destroyed)return D;this.frameCounter.frameReceived(D[0].framerate),this.cpuMonitor.frameReceived();const Y=D[0].asCanvasElement();if(!Y)return D;if(!this.modelInitialized)return D[0]=this.canvasVideoFrameBuffer,D;const ee=Y.width,ie=Y.height;if(ee===0||ie===0)return D;this.sourceWidth===0&&(this.sourceWidth=ee,this.sourceHeight=ie,this.targetCanvas.width=this.sourceWidth,this.targetCanvas.height=this.sourceHeight,this.logger.info(`${this.filterType} source width: ${this.sourceWidth}`),this.logger.info(`${this.filterType} source height: ${this.sourceHeight}`),this.initOnFirstExecution()),(this.sourceWidth!==ee||this.sourceHeight!==ie)&&(this.sourceWidth=ee,this.sourceHeight=ie,this.targetCanvas.width=this.sourceWidth,this.targetCanvas.height=this.sourceHeight);try{this.frameCounter.filterSubmitted();let ne=this.mask$.value;const re=this.spec.model.input.width/Y.width,oe=this.spec.model.input.height/Y.height;this.scaledCanvas===void 0&&(this.scaledCanvas=document.createElement("canvas"),this.scaledCanvas.width=this.spec.model.input.width,this.scaledCanvas.height=this.spec.model.input.height);const ae=this.scaledCanvas.getContext("2d");ae.save(),ae.scale(re,oe),ae.drawImage(Y,0,0),ae.restore();const le=ae.getImageData(0,0,this.scaledCanvas.width,this.scaledCanvas.height);if(this.frameNumber%this.videoFramesPerFilterUpdate===0){const de=this.mask$.whenNext();this.worker.postMessage({msg:"predict",payload:le},[le.data.buffer]),ne=yield de}this.destroyed||this.drawImageWithMask(Y,ne)}catch(ne){return this.logger.error(`could not process ${this.filterType} frame buffer due to ${ne}`),D}finally{this.frameCounter.filterComplete(),this.frameNumber++}return D[0]=this.canvasVideoFrameBuffer,D})}updateVideoFramesPerFilterUpdate(D){D!==this.videoFramesPerFilterUpdate&&(this.videoFramesPerFilterUpdate=D,this.logger.info(`Adjusting filter rate to compensate for CPU utilization. Filter rate is ${this.videoFramesPerFilterUpdate} video frames per filter.`))}destroy(){var D,Y,ee,ie;return C(this,void 0,void 0,function*(){this.destroyed=!0,this.delegate.removeObserver(this.cpuMonitor),this.canvasVideoFrameBuffer.destroy(),(D=this.worker)===null||D===void 0||D.postMessage({msg:"destroy"}),(Y=this.worker)===null||Y===void 0||Y.postMessage({msg:"stop"}),(ee=this.targetCanvas)===null||ee===void 0||ee.remove(),this.targetCanvas=void 0,(ie=this.scaledCanvas)===null||ie===void 0||ie.remove(),this.scaledCanvas=void 0,this.logger.info(`${this.filterType} frame process destroyed`)})}};BackgroundFilterProcessor.default=S;class T{constructor(D,Y){this.monitoringPeriodMillis=D,this.observer=Y,this.lastCPUChangeTimestamp=0}filterCPUUtilizationHigh(){const D=Date.now();D-this.lastCPUChangeTimestamp>=this.monitoringPeriodMillis&&(this.lastCPUChangeTimestamp=D,this.observer.reduceCPUUtilization())}frameReceived(){const D=Date.now();D-this.lastCPUChangeTimestamp>=this.monitoringPeriodMillis*2&&(this.lastCPUChangeTimestamp=D,this.observer.increaseCPUUtilization())}}return BackgroundFilterProcessor.BackgroundFilterMonitor=T,BackgroundFilterProcessor}var BackgroundBlurVideoFrameProcessorDelegate={},BackgroundFilterVideoFrameProcessorDelegate={},hasRequiredBackgroundFilterVideoFrameProcessorDelegate;function requireBackgroundFilterVideoFrameProcessorDelegate(){if(hasRequiredBackgroundFilterVideoFrameProcessorDelegate)return BackgroundFilterVideoFrameProcessorDelegate;hasRequiredBackgroundFilterVideoFrameProcessorDelegate=1,Object.defineProperty(BackgroundFilterVideoFrameProcessorDelegate,"__esModule",{value:!0});let C=class{constructor(){this.observers=new Set}addObserver(E){this.observers.add(E)}removeObserver(E){this.observers.delete(E)}filterFrameDurationHigh(E){var w;for(const R of this.observers)(w=R.filterFrameDurationHigh)===null||w===void 0||w.call(R,E)}filterCPUUtilizationHigh(E){var w;for(const R of this.observers)(w=R.filterCPUUtilizationHigh)===null||w===void 0||w.call(R,E)}};return BackgroundFilterVideoFrameProcessorDelegate.default=C,BackgroundFilterVideoFrameProcessorDelegate}var hasRequiredBackgroundBlurVideoFrameProcessorDelegate;function requireBackgroundBlurVideoFrameProcessorDelegate(){if(hasRequiredBackgroundBlurVideoFrameProcessorDelegate)return BackgroundBlurVideoFrameProcessorDelegate;hasRequiredBackgroundBlurVideoFrameProcessorDelegate=1;var C=BackgroundBlurVideoFrameProcessorDelegate&&BackgroundBlurVideoFrameProcessorDelegate.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(BackgroundBlurVideoFrameProcessorDelegate,"__esModule",{value:!0});const E=C(requireBackgroundFilterVideoFrameProcessorDelegate());let w=class extends E.default{};return BackgroundBlurVideoFrameProcessorDelegate.default=w,BackgroundBlurVideoFrameProcessorDelegate}var hasRequiredBackgroundBlurProcessorProvided;function requireBackgroundBlurProcessorProvided(){if(hasRequiredBackgroundBlurProcessorProvided)return BackgroundBlurProcessorProvided;hasRequiredBackgroundBlurProcessorProvided=1;var C=BackgroundBlurProcessorProvided&&BackgroundBlurProcessorProvided.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=BackgroundBlurProcessorProvided&&BackgroundBlurProcessorProvided.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(BackgroundBlurProcessorProvided,"__esModule",{value:!0});const w=E(requireBackgroundFilterProcessor()),R=requireBackgroundBlurStrength(),M=E(requireBackgroundBlurVideoFrameProcessorDelegate());let x=class extends w.default{constructor(S,T){super("background blur",S,T,new M.default),this.blurAmount=0,this.setBlurStrength(T.blurStrength),this.logger.info("BackgroundBlur processor successfully created"),this.logger.info(`BackgroundBlur spec: ${this.stringify(this.spec)}`),this.logger.info(`BackgroundBlur options: ${this.stringify(T)}`)}validateOptions(S){if(super.validateOptions(S),!S.blurStrength)throw new Error("processor has null options - blurStrength")}initOnFirstExecution(){this.setBlurPixels()}drawImageWithMask(S,T){T||(T=new ImageData(this.spec.model.input.width,this.spec.model.input.height)),this.scaledCanvas.getContext("2d").putImageData(T,0,0);const{canvasCtx:_,targetCanvas:D}=this,{width:Y,height:ee}=D;_.save(),_.clearRect(0,0,Y,ee),_.drawImage(this.scaledCanvas,0,0,Y,ee),_.globalCompositeOperation="source-in",_.drawImage(S,0,0,Y,ee),_.globalCompositeOperation="destination-over",_.filter=`blur(${this.blurAmount}px)`,_.drawImage(S,0,0,D.width,D.height),_.restore()}setBlurStrength(S){this._blurStrength=S,this.logger.info(`blur strength set to ${this._blurStrength}`),this.setBlurPixels()}setBlurPixels(){this.blurAmount=R.BlurStrengthMapper.getBlurAmount(this._blurStrength,{height:this.sourceHeight}),this.logger.info(`background blur amount set to ${this.blurAmount}`)}addObserver(S){this.delegate.addObserver(S)}removeObserver(S){this.delegate.removeObserver(S)}static isSupported(){return C(this,void 0,void 0,function*(){const S=document.createElement("canvas"),T=S.getContext("2d").filter!==void 0;return S.remove(),T})}setEventController(S){this.eventController?this.eventController=S:(this.eventController=S,this.publishBackgroundFilterEvent())}publishBackgroundFilterEvent(){const S={backgroundBlurEnabled:"true",backgroundBlurStrength:this._blurStrength,backgroundReplacementEnabled:"false",backgroundFilterVersion:1};this.eventController.publishEvent("backgroundFilterConfigSelected",S)}};return BackgroundBlurProcessorProvided.default=x,BackgroundBlurProcessorProvided}var hasRequiredBackgroundBlurProcessorBuiltIn;function requireBackgroundBlurProcessorBuiltIn(){if(hasRequiredBackgroundBlurProcessorBuiltIn)return BackgroundBlurProcessorBuiltIn;hasRequiredBackgroundBlurProcessorBuiltIn=1;var C=BackgroundBlurProcessorBuiltIn&&BackgroundBlurProcessorBuiltIn.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=BackgroundBlurProcessorBuiltIn&&BackgroundBlurProcessorBuiltIn.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(BackgroundBlurProcessorBuiltIn,"__esModule",{value:!0});const w=E(requireBackgroundBlurProcessorProvided()),R=requireBackgroundBlurStrength();let M=class extends w.default{constructor(x,S){super(x,S),this.blurCanvas=document.createElement("canvas"),this.blurCanvasCtx=this.blurCanvas.getContext("2d"),this.blurCanvas.width=this.spec.model.input.width,this.blurCanvas.height=this.spec.model.input.height,this.logger.info("BackgroundBlur processor using builtin blur")}drawImageWithMask(x,S){const T=this.blurredImage,{canvasCtx:_,targetCanvas:D}=this,{width:Y,height:ee}=D;if(!S||!T){_.clearRect(0,0,Y,ee);return}this.scaledCanvas.getContext("2d").putImageData(S,0,0),this.blurCanvasCtx.putImageData(this.blurredImage,0,0),_.save(),_.clearRect(0,0,Y,ee),_.drawImage(this.scaledCanvas,0,0,Y,ee),_.globalCompositeOperation="source-in",_.drawImage(x,0,0,Y,ee),_.globalCompositeOperation="destination-over",_.drawImage(this.blurCanvas,0,0,Y,ee),_.restore()}setBlurStrength(x){if(super.setBlurStrength(x),this.worker){this.modelInitialized=!1,this.worker.postMessage({msg:"destroy"});const S=this.spec.model;this.worker.postMessage({msg:"loadModel",payload:{modelUrl:S.path,inputHeight:S.input.height,inputWidth:S.input.width,inputChannels:4,modelRangeMin:S.input.range[0],modelRangeMax:S.input.range[1],blurPixels:this.blurAmount}})}}setBlurPixels(){this.blurAmount=R.BlurStrengthMapper.getBlurAmount(this._blurStrength,{height:540}),this.logger.info(`background blur amount set to ${this.blurAmount}`)}handleInitialize(x){if(this.logger.info(`received initialize message: ${this.stringify(x)}`),!x.payload){this.logger.error("failed to initialize module"),this.initWorkerPromise.reject(new Error("failed to initialize the module"));return}const S=this.spec.model;this.worker.postMessage({msg:"loadModel",payload:{modelUrl:S.path,inputHeight:S.input.height,inputWidth:S.input.width,inputChannels:4,modelRangeMin:S.input.range[0],modelRangeMax:S.input.range[1],blurPixels:this.blurAmount}}),this.initWorkerPromise.resolve({})}handlePredict(x){this.blurredImage=x.payload.blurOutput,super.handlePredict(x)}destroy(){const x=Object.create(null,{destroy:{get:()=>super.destroy}});var S;return C(this,void 0,void 0,function*(){x.destroy.call(this),(S=this.blurCanvas)===null||S===void 0||S.remove(),this.blurCanvas=void 0})}};return BackgroundBlurProcessorBuiltIn.default=M,BackgroundBlurProcessorBuiltIn}var hasRequiredBackgroundBlurVideoFrameProcessor;function requireBackgroundBlurVideoFrameProcessor(){if(hasRequiredBackgroundBlurVideoFrameProcessor)return BackgroundBlurVideoFrameProcessor;hasRequiredBackgroundBlurVideoFrameProcessor=1;var C=BackgroundBlurVideoFrameProcessor&&BackgroundBlurVideoFrameProcessor.__awaiter||function(ee,ie,ne,re){function oe(ae){return ae instanceof ne?ae:new ne(function(le){le(ae)})}return new(ne||(ne=Promise))(function(ae,le){function de(ge){try{fe(re.next(ge))}catch(he){le(he)}}function me(ge){try{fe(re.throw(ge))}catch(he){le(he)}}function fe(ge){ge.done?ae(ge.value):oe(ge.value).then(de,me)}fe((re=re.apply(ee,ie||[])).next())})},E=BackgroundBlurVideoFrameProcessor&&BackgroundBlurVideoFrameProcessor.__importDefault||function(ee){return ee&&ee.__esModule?ee:{default:ee}};Object.defineProperty(BackgroundBlurVideoFrameProcessor,"__esModule",{value:!0});const w=E(requireBackgroundFilterVideoFrameProcessor()),R=E(requireConsoleLogger()),M=E(requireLogLevel()),x=E(requireNoOpVideoFrameProcessor()),S=E(requireBackgroundBlurProcessorBuiltIn()),T=E(requireBackgroundBlurProcessorProvided()),_=E(requireBackgroundBlurStrength());class D extends x.default{setBlurStrength(){}loadAssets(){return C(this,void 0,void 0,function*(){})}addObserver(){}removeObserver(){}}let Y=class Ao extends w.default{static create(ie,ne){return C(this,void 0,void 0,function*(){ie=Ao.resolveSpec(ie),ne=Ao.resolveOptions(ne);const{logger:re}=ne,oe=yield Ao.isSupported(ie,ne);if(re.info(`processor is ${oe?"":"not"} supported`),!oe)return re.warn("Using no-op processor because background blur is not supported"),new D;let ae;return(yield T.default.isSupported())?(re.info("Using browser-provided background blur"),ae=new T.default(ie,ne)):(re.info("Using built-in background blur"),ae=new S.default(ie,ne)),yield ae.loadAssets(),ae})}static resolveOptions(ie={}){let ne=Object.assign({},ie);return ne.blurStrength||(ne.blurStrength=_.default.MEDIUM),ne.logger||(ne.logger=new R.default("BackgroundBlurProcessor",M.default.INFO)),ne=super.resolveOptions(ne),ne}static isSupported(ie,ne){return ie=Ao.resolveSpec(ie),ne=Ao.resolveOptions(ne),super.isSupported(ie,ne)}};return BackgroundBlurVideoFrameProcessor.default=Y,BackgroundBlurVideoFrameProcessor}var BackgroundReplacementVideoFrameProcessor={},BackgroundReplacementFilter={},BackgroundReplacementVideoFrameProcessorDelegate={},hasRequiredBackgroundReplacementVideoFrameProcessorDelegate;function requireBackgroundReplacementVideoFrameProcessorDelegate(){if(hasRequiredBackgroundReplacementVideoFrameProcessorDelegate)return BackgroundReplacementVideoFrameProcessorDelegate;hasRequiredBackgroundReplacementVideoFrameProcessorDelegate=1;var C=BackgroundReplacementVideoFrameProcessorDelegate&&BackgroundReplacementVideoFrameProcessorDelegate.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(BackgroundReplacementVideoFrameProcessorDelegate,"__esModule",{value:!0});const E=C(requireBackgroundFilterVideoFrameProcessorDelegate());let w=class extends E.default{};return BackgroundReplacementVideoFrameProcessorDelegate.default=w,BackgroundReplacementVideoFrameProcessorDelegate}var hasRequiredBackgroundReplacementFilter;function requireBackgroundReplacementFilter(){if(hasRequiredBackgroundReplacementFilter)return BackgroundReplacementFilter;hasRequiredBackgroundReplacementFilter=1;var C=BackgroundReplacementFilter&&BackgroundReplacementFilter.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=BackgroundReplacementFilter&&BackgroundReplacementFilter.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(BackgroundReplacementFilter,"__esModule",{value:!0});const w=E(requireBackgroundFilterProcessor()),R=E(requireBackgroundReplacementVideoFrameProcessorDelegate());let M=class zd extends w.default{constructor(S,T){super("background replacement",S,T,new R.default),this.replacementBlob=T.imageBlob,this.logger.info("BackgroundReplacement processor successfully created"),this.logger.info(`BackgroundReplacement spec: ${this.stringify(this.spec)}`),this.logger.info(`BackgroundReplacement options: ${this.stringify(T)}`)}setImageBlob(S){return C(this,void 0,void 0,function*(){this.replacementBlob=S,this.replacementImage=yield zd.loadImage(this.createReplacementObjectUrl())})}initOnFirstExecution(){}drawImageWithMask(S,T){T||(T=new ImageData(this.spec.model.input.width,this.spec.model.input.height)),this.scaledCanvas.getContext("2d").putImageData(T,0,0);const{canvasCtx:_,targetCanvas:D}=this,{width:Y,height:ee}=D;_.save(),_.clearRect(0,0,Y,ee),_.drawImage(this.scaledCanvas,0,0,Y,ee),_.globalCompositeOperation="source-in",_.drawImage(S,0,0,Y,ee),_.globalCompositeOperation="destination-over",_.drawImage(this.replacementImage,0,0,D.width,D.height),_.restore()}static loadImageExecutor(S,T,_){const D=new Image;D.crossOrigin="Anonymous",D.addEventListener("load",()=>{S(D)},!1),D.addEventListener("error",Y=>{T(new Error(`Could not load replacement image ${D.src}: ${Y.message}`))},!1),D.src=_}static loadImage(S){return C(this,void 0,void 0,function*(){return new Promise((T,_)=>this.loadImageExecutor(T,_,S))})}revokeReplacementObjectUrl(){this.replacementObjectUrl&&URL.revokeObjectURL(this.replacementObjectUrl)}createReplacementObjectUrl(){return this.revokeReplacementObjectUrl(),this.replacementObjectUrl=URL.createObjectURL(this.replacementBlob),this.replacementObjectUrl}loadAssets(){const S=Object.create(null,{loadAssets:{get:()=>super.loadAssets}});return C(this,void 0,void 0,function*(){this.replacementImage=yield zd.loadImage(this.createReplacementObjectUrl()),S.loadAssets.call(this)})}addObserver(S){this.delegate.addObserver(S)}removeObserver(S){this.delegate.removeObserver(S)}destroy(){const S=Object.create(null,{destroy:{get:()=>super.destroy}});return C(this,void 0,void 0,function*(){S.destroy.call(this),this.revokeReplacementObjectUrl()})}setEventController(S){this.eventController?this.eventController=S:(this.eventController=S,this.publishBackgroundFilterEvent())}publishBackgroundFilterEvent(){const S={backgroundBlurEnabled:"false",backgroundBlurStrength:"low",backgroundReplacementEnabled:"true",backgroundFilterVersion:1};this.eventController.publishEvent("backgroundFilterConfigSelected",S)}};return BackgroundReplacementFilter.default=M,BackgroundReplacementFilter}var hasRequiredBackgroundReplacementVideoFrameProcessor;function requireBackgroundReplacementVideoFrameProcessor(){if(hasRequiredBackgroundReplacementVideoFrameProcessor)return BackgroundReplacementVideoFrameProcessor;hasRequiredBackgroundReplacementVideoFrameProcessor=1;var C=BackgroundReplacementVideoFrameProcessor&&BackgroundReplacementVideoFrameProcessor.__awaiter||function(D,Y,ee,ie){function ne(re){return re instanceof ee?re:new ee(function(oe){oe(re)})}return new(ee||(ee=Promise))(function(re,oe){function ae(me){try{de(ie.next(me))}catch(fe){oe(fe)}}function le(me){try{de(ie.throw(me))}catch(fe){oe(fe)}}function de(me){me.done?re(me.value):ne(me.value).then(ae,le)}de((ie=ie.apply(D,Y||[])).next())})},E=BackgroundReplacementVideoFrameProcessor&&BackgroundReplacementVideoFrameProcessor.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(BackgroundReplacementVideoFrameProcessor,"__esModule",{value:!0});const w=E(requireBackgroundFilterVideoFrameProcessor()),R=E(requireConsoleLogger()),M=E(requireLogLevel()),x=E(requireNoOpVideoFrameProcessor()),S=E(requireBackgroundReplacementFilter());class T extends x.default{loadAssets(){return C(this,void 0,void 0,function*(){})}addObserver(){}removeObserver(){}setImageBlob(){return C(this,void 0,void 0,function*(){})}}let _=class Xp extends w.default{static create(Y,ee){return C(this,void 0,void 0,function*(){Y=this.resolveSpec(Y),ee=this.resolveOptions(ee),yield this.resolveOptionsAsync(ee);const{logger:ie}=ee;if(!(yield Xp.isSupported(Y,ee)))return ie.warn("Using no-op processor because background replacement is not supported"),new T;ie.info("Using background replacement filter");const ne=new S.default(Y,ee);return yield ne.loadAssets(),ne})}static resolveOptions(Y={}){const ee=Object.assign({},Y);return ee.logger||(ee.logger=new R.default("BackgroundReplacementProcessor",M.default.INFO)),super.resolveOptions(ee)}static resolveOptionsAsync(Y){return C(this,void 0,void 0,function*(){if(!Y.imageBlob){const ee=document.createElement("canvas");ee.width=100,ee.height=100;const ie=ee.getContext("2d");ie.fillStyle="blue",ie.fillRect(0,0,100,100);const ne=yield new Promise(re=>{ee.toBlob(re)});Y.imageBlob=ne}})}static isSupported(Y,ee){const ie=Object.create(null,{isSupported:{get:()=>super.isSupported}});return C(this,void 0,void 0,function*(){Y=this.resolveSpec(Y),ee=this.resolveOptions(ee),yield this.resolveOptionsAsync(ee);const ne=ee.imageBlob,re=URL.createObjectURL(ne);try{yield S.default.loadImage(re)}catch(oe){return ee.logger.info(`Failed to fetch load replacement image ${oe.message}`),!1}finally{URL.revokeObjectURL(re)}return ie.isSupported.call(this,Y,ee)})}};return BackgroundReplacementVideoFrameProcessor.default=_,BackgroundReplacementVideoFrameProcessor}var BaseConnectionHealthPolicy={},hasRequiredBaseConnectionHealthPolicy;function requireBaseConnectionHealthPolicy(){if(hasRequiredBaseConnectionHealthPolicy)return BaseConnectionHealthPolicy;hasRequiredBaseConnectionHealthPolicy=1,Object.defineProperty(BaseConnectionHealthPolicy,"__esModule",{value:!0});let C=class{constructor(E,w,R){this.minHealth=E.minHealth,this.maxHealth=E.maxHealth,this.currentHealth=E.initialHealth,this.currentData=w.clone(),this.name=R}minimumHealth(){return this.minHealth}maximumHealth(){return this.maxHealth}health(){return this.maximumHealth()}update(E){this.currentData=E}getConnectionHealthData(){return this.currentData.clone()}healthy(){return this.health()>this.minimumHealth()}healthIfChanged(){const E=this.health();return E!==this.currentHealth?(this.currentHealth=E,E):null}};return BaseConnectionHealthPolicy.default=C,BaseConnectionHealthPolicy}var BitrateParameters={},hasRequiredBitrateParameters;function requireBitrateParameters(){if(hasRequiredBitrateParameters)return BitrateParameters;hasRequiredBitrateParameters=1,Object.defineProperty(BitrateParameters,"__esModule",{value:!0});let C=class{};return BitrateParameters.default=C,BitrateParameters}var CSPMonitor={},hasRequiredCSPMonitor;function requireCSPMonitor(){if(hasRequiredCSPMonitor)return CSPMonitor;hasRequiredCSPMonitor=1,Object.defineProperty(CSPMonitor,"__esModule",{value:!0});let C=class Fn{static register(){!("document"in commonjsGlobal)||!document.addEventListener||Fn.shouldRegisterCSPMonitor&&(Fn.added||(document.addEventListener("securitypolicyviolation",Fn.listener),Fn.added=!0))}static unregister(){!("document"in commonjsGlobal)||!document.removeEventListener||(document.removeEventListener("securitypolicyviolation",Fn.listener),Fn.loggers=new Set,Fn.added=!1)}static disable(){Fn.shouldRegisterCSPMonitor=!1,Fn.unregister()}static addLogger(w){w&&Fn.loggers.add(w)}static removeLogger(w){w&&Fn.loggers.delete(w)}};return CSPMonitor.default=C,C.loggers=new Set,C.shouldRegisterCSPMonitor=!0,C.added=!1,C.listener=E=>{const w=`Security Policy Violation
Blocked URI: ${E.blockedURI}
Violated Directive: ${E.violatedDirective}
Original Policy: ${E.originalPolicy}
Document URI: ${E.documentURI}
Source File: ${E.sourceFile}
Line No.: ${E.lineNumber}
`;for(const R of C.loggers)R.error(w);C.loggers.size===0&&console.error(w)},CSPMonitor}var CheckAudioConnectivityFeedback={},hasRequiredCheckAudioConnectivityFeedback;function requireCheckAudioConnectivityFeedback(){return hasRequiredCheckAudioConnectivityFeedback||(hasRequiredCheckAudioConnectivityFeedback=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.CheckAudioConnectivityFeedback=void 0;var E;(function(w){w[w.Succeeded=0]="Succeeded",w[w.AudioInputRequestFailed=1]="AudioInputRequestFailed",w[w.AudioInputPermissionDenied=2]="AudioInputPermissionDenied",w[w.ConnectionFailed=3]="ConnectionFailed",w[w.AudioNotReceived=4]="AudioNotReceived"})(E=C.CheckAudioConnectivityFeedback||(C.CheckAudioConnectivityFeedback={})),C.default=E}(CheckAudioConnectivityFeedback)),CheckAudioConnectivityFeedback}var CheckAudioInputFeedback={},hasRequiredCheckAudioInputFeedback;function requireCheckAudioInputFeedback(){return hasRequiredCheckAudioInputFeedback||(hasRequiredCheckAudioInputFeedback=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.CheckAudioInputFeedback=void 0;var E;(function(w){w[w.Succeeded=0]="Succeeded",w[w.Failed=1]="Failed",w[w.PermissionDenied=2]="PermissionDenied"})(E=C.CheckAudioInputFeedback||(C.CheckAudioInputFeedback={})),C.default=E}(CheckAudioInputFeedback)),CheckAudioInputFeedback}var CheckAudioOutputFeedback={},hasRequiredCheckAudioOutputFeedback;function requireCheckAudioOutputFeedback(){return hasRequiredCheckAudioOutputFeedback||(hasRequiredCheckAudioOutputFeedback=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.CheckAudioOutputFeedback=void 0;var E;(function(w){w[w.Succeeded=0]="Succeeded",w[w.Failed=1]="Failed"})(E=C.CheckAudioOutputFeedback||(C.CheckAudioOutputFeedback={})),C.default=E}(CheckAudioOutputFeedback)),CheckAudioOutputFeedback}var CheckCameraResolutionFeedback={},hasRequiredCheckCameraResolutionFeedback;function requireCheckCameraResolutionFeedback(){return hasRequiredCheckCameraResolutionFeedback||(hasRequiredCheckCameraResolutionFeedback=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.CheckCameraResolutionFeedback=void 0;var E;(function(w){w[w.Succeeded=0]="Succeeded",w[w.Failed=1]="Failed",w[w.ResolutionNotSupported=2]="ResolutionNotSupported",w[w.PermissionDenied=3]="PermissionDenied"})(E=C.CheckCameraResolutionFeedback||(C.CheckCameraResolutionFeedback={})),C.default=E}(CheckCameraResolutionFeedback)),CheckCameraResolutionFeedback}var CheckContentShareConnectivityFeedback={},hasRequiredCheckContentShareConnectivityFeedback;function requireCheckContentShareConnectivityFeedback(){return hasRequiredCheckContentShareConnectivityFeedback||(hasRequiredCheckContentShareConnectivityFeedback=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.CheckContentShareConnectivityFeedback=void 0;var E;(function(w){w[w.Succeeded=0]="Succeeded",w[w.Failed=1]="Failed",w[w.PermissionDenied=2]="PermissionDenied",w[w.TimedOut=3]="TimedOut",w[w.ConnectionFailed=4]="ConnectionFailed"})(E=C.CheckContentShareConnectivityFeedback||(C.CheckContentShareConnectivityFeedback={})),C.default=E}(CheckContentShareConnectivityFeedback)),CheckContentShareConnectivityFeedback}var CheckNetworkTCPConnectivityFeedback={},hasRequiredCheckNetworkTCPConnectivityFeedback;function requireCheckNetworkTCPConnectivityFeedback(){return hasRequiredCheckNetworkTCPConnectivityFeedback||(hasRequiredCheckNetworkTCPConnectivityFeedback=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.CheckNetworkTCPConnectivityFeedback=void 0;var E;(function(w){w[w.Succeeded=0]="Succeeded",w[w.MeetingSessionURLsNotInitialized=1]="MeetingSessionURLsNotInitialized",w[w.ConnectionFailed=2]="ConnectionFailed",w[w.ICENegotiationFailed=3]="ICENegotiationFailed"})(E=C.CheckNetworkTCPConnectivityFeedback||(C.CheckNetworkTCPConnectivityFeedback={})),C.default=E}(CheckNetworkTCPConnectivityFeedback)),CheckNetworkTCPConnectivityFeedback}var CheckNetworkUDPConnectivityFeedback={},hasRequiredCheckNetworkUDPConnectivityFeedback;function requireCheckNetworkUDPConnectivityFeedback(){return hasRequiredCheckNetworkUDPConnectivityFeedback||(hasRequiredCheckNetworkUDPConnectivityFeedback=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.CheckNetworkUDPConnectivityFeedback=void 0;var E;(function(w){w[w.Succeeded=0]="Succeeded",w[w.MeetingSessionURLsNotInitialized=1]="MeetingSessionURLsNotInitialized",w[w.ConnectionFailed=2]="ConnectionFailed",w[w.ICENegotiationFailed=3]="ICENegotiationFailed"})(E=C.CheckNetworkUDPConnectivityFeedback||(C.CheckNetworkUDPConnectivityFeedback={})),C.default=E}(CheckNetworkUDPConnectivityFeedback)),CheckNetworkUDPConnectivityFeedback}var CheckVideoConnectivityFeedback={},hasRequiredCheckVideoConnectivityFeedback;function requireCheckVideoConnectivityFeedback(){return hasRequiredCheckVideoConnectivityFeedback||(hasRequiredCheckVideoConnectivityFeedback=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.CheckVideoConnectivityFeedback=void 0;var E;(function(w){w[w.Succeeded=0]="Succeeded",w[w.VideoInputRequestFailed=1]="VideoInputRequestFailed",w[w.VideoInputPermissionDenied=2]="VideoInputPermissionDenied",w[w.ConnectionFailed=3]="ConnectionFailed",w[w.VideoNotSent=4]="VideoNotSent"})(E=C.CheckVideoConnectivityFeedback||(C.CheckVideoConnectivityFeedback={})),C.default=E}(CheckVideoConnectivityFeedback)),CheckVideoConnectivityFeedback}var CheckVideoInputFeedback={},hasRequiredCheckVideoInputFeedback;function requireCheckVideoInputFeedback(){return hasRequiredCheckVideoInputFeedback||(hasRequiredCheckVideoInputFeedback=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.CheckVideoInputFeedback=void 0;var E;(function(w){w[w.Succeeded=0]="Succeeded",w[w.Failed=1]="Failed",w[w.PermissionDenied=2]="PermissionDenied"})(E=C.CheckVideoInputFeedback||(C.CheckVideoInputFeedback={})),C.default=E}(CheckVideoInputFeedback)),CheckVideoInputFeedback}var CleanRestartedSessionTask={},hasRequiredCleanRestartedSessionTask;function requireCleanRestartedSessionTask(){if(hasRequiredCleanRestartedSessionTask)return CleanRestartedSessionTask;hasRequiredCleanRestartedSessionTask=1;var C=CleanRestartedSessionTask&&CleanRestartedSessionTask.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})},E=CleanRestartedSessionTask&&CleanRestartedSessionTask.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(CleanRestartedSessionTask,"__esModule",{value:!0});const w=E(requireBaseTask());let R=class extends w.default{constructor(M){super(M.logger),this.context=M,this.taskName="CleanRestartedSessionTask"}run(){return C(this,void 0,void 0,function*(){this.context.resetConnectionSpecificState()})}};return CleanRestartedSessionTask.default=R,CleanRestartedSessionTask}var CleanStoppedSessionTask={},SignalingClientEventType={},hasRequiredSignalingClientEventType;function requireSignalingClientEventType(){return hasRequiredSignalingClientEventType||(hasRequiredSignalingClientEventType=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.SignalingClientEventType=void 0;var E;(function(w){w[w.WebSocketConnecting=0]="WebSocketConnecting",w[w.WebSocketOpen=1]="WebSocketOpen",w[w.WebSocketError=2]="WebSocketError",w[w.WebSocketClosing=3]="WebSocketClosing",w[w.WebSocketClosed=4]="WebSocketClosed",w[w.WebSocketFailed=5]="WebSocketFailed",w[w.WebSocketMessage=6]="WebSocketMessage",w[w.WebSocketSendMessageFailure=7]="WebSocketSendMessageFailure",w[w.WebSocketSentMessage=8]="WebSocketSentMessage",w[w.ProtocolDecodeFailure=9]="ProtocolDecodeFailure",w[w.ReceivedSignalFrame=10]="ReceivedSignalFrame",w[w.WebSocketSkippedMessage=11]="WebSocketSkippedMessage"})(E=C.SignalingClientEventType||(C.SignalingClientEventType={})),C.default=E}(SignalingClientEventType)),SignalingClientEventType}var hasRequiredCleanStoppedSessionTask;function requireCleanStoppedSessionTask(){if(hasRequiredCleanStoppedSessionTask)return CleanStoppedSessionTask;hasRequiredCleanStoppedSessionTask=1;var C=CleanStoppedSessionTask&&CleanStoppedSessionTask.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=CleanStoppedSessionTask&&CleanStoppedSessionTask.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(CleanStoppedSessionTask,"__esModule",{value:!0});const w=E(requireSignalingClientEventType()),R=E(requireBaseTask());let M=class extends R.default{constructor(x){super(x.logger),this.context=x,this.taskName="CleanStoppedSessionTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return C(this,void 0,void 0,function*(){try{this.context.signalingClient.ready()&&(this.context.signalingClient.closeConnection(),yield this.receiveWebSocketClosedEvent())}catch(x){throw x}finally{for(const S of this.context.removableObservers)S.removeObserver();this.context.resetConnectionSpecificState(),this.context.statsCollector.stop(),this.context.statsCollector=null,this.context.connectionMonitor.stop(),this.context.connectionMonitor=null,this.context.videoUplinkBandwidthPolicy.setTransceiverController&&this.context.videoUplinkBandwidthPolicy.setTransceiverController(void 0),this.context.videoDownlinkBandwidthPolicy.bindToTileController&&this.context.videoDownlinkBandwidthPolicy.bindToTileController(void 0);const x=this.context.videoTileController.getLocalVideoTile();x&&x.bindVideoStream("",!0,null,null,null,null),this.context.videoTileController.removeAllVideoTiles()}})}receiveWebSocketClosedEvent(){return new Promise((x,S)=>{class T{constructor(Y){this.signalingClient=Y}cancel(){this.signalingClient.removeObserver(this),S(new Error("CleanStoppedSessionTask got canceled while waiting for the WebSocket closed event"))}handleSignalingClientEvent(Y){Y.type===w.default.WebSocketClosed&&(this.signalingClient.removeObserver(this),x())}}const _=new T(this.context.signalingClient);this.taskCanceler=_,this.context.signalingClient.registerObserver(_)})}};return CleanStoppedSessionTask.default=M,CleanStoppedSessionTask}var ClientMetricReport={},indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=C;function C(E,w){for(var R=new Array(arguments.length-1),M=0,x=2,S=!0;x<arguments.length;)R[M++]=arguments[x++];return new Promise(function(T,_){R[M]=function(D){if(S)if(S=!1,D)_(D);else{for(var Y=new Array(arguments.length-1),ee=0;ee<Y.length;)Y[ee++]=arguments[ee];T.apply(null,Y)}};try{E.apply(w||null,R)}catch(D){S&&(S=!1,_(D))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(C){var E=C;E.length=function(S){var T=S.length;if(!T)return 0;for(var _=0;--T%4>1&&S.charAt(T)==="=";)++_;return Math.ceil(S.length*3)/4-_};for(var w=new Array(64),R=new Array(123),M=0;M<64;)R[w[M]=M<26?M+65:M<52?M+71:M<62?M-4:M-59|43]=M++;E.encode=function(S,T,_){for(var D=null,Y=[],ee=0,ie=0,ne;T<_;){var re=S[T++];switch(ie){case 0:Y[ee++]=w[re>>2],ne=(re&3)<<4,ie=1;break;case 1:Y[ee++]=w[ne|re>>4],ne=(re&15)<<2,ie=2;break;case 2:Y[ee++]=w[ne|re>>6],Y[ee++]=w[re&63],ie=0;break}ee>8191&&((D||(D=[])).push(String.fromCharCode.apply(String,Y)),ee=0)}return ie&&(Y[ee++]=w[ne],Y[ee++]=61,ie===1&&(Y[ee++]=61)),D?(ee&&D.push(String.fromCharCode.apply(String,Y.slice(0,ee))),D.join("")):String.fromCharCode.apply(String,Y.slice(0,ee))};var x="invalid encoding";E.decode=function(S,T,_){for(var D=_,Y=0,ee,ie=0;ie<S.length;){var ne=S.charCodeAt(ie++);if(ne===61&&Y>1)break;if((ne=R[ne])===void 0)throw Error(x);switch(Y){case 0:ee=ne,Y=1;break;case 1:T[_++]=ee<<2|(ne&48)>>4,ee=ne,Y=2;break;case 2:T[_++]=(ee&15)<<4|(ne&60)>>2,ee=ne,Y=3;break;case 3:T[_++]=(ee&3)<<6|ne,Y=0;break}}if(Y===1)throw Error(x);return _-D},E.test=function(S){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(S)}}(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=C;function C(){this._listeners={}}return C.prototype.on=function(E,w,R){return(this._listeners[E]||(this._listeners[E]=[])).push({fn:w,ctx:R||this}),this},C.prototype.off=function(E,w){if(E===void 0)this._listeners={};else if(w===void 0)this._listeners[E]=[];else for(var R=this._listeners[E],M=0;M<R.length;)R[M].fn===w?R.splice(M,1):++M;return this},C.prototype.emit=function(E){var w=this._listeners[E];if(w){for(var R=[],M=1;M<arguments.length;)R.push(arguments[M++]);for(M=0;M<w.length;)w[M].fn.apply(w[M++].ctx,R)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=C(C);function C(x){return typeof Float32Array<"u"?function(){var S=new Float32Array([-0]),T=new Uint8Array(S.buffer),_=T[3]===128;function D(ne,re,oe){S[0]=ne,re[oe]=T[0],re[oe+1]=T[1],re[oe+2]=T[2],re[oe+3]=T[3]}function Y(ne,re,oe){S[0]=ne,re[oe]=T[3],re[oe+1]=T[2],re[oe+2]=T[1],re[oe+3]=T[0]}x.writeFloatLE=_?D:Y,x.writeFloatBE=_?Y:D;function ee(ne,re){return T[0]=ne[re],T[1]=ne[re+1],T[2]=ne[re+2],T[3]=ne[re+3],S[0]}function ie(ne,re){return T[3]=ne[re],T[2]=ne[re+1],T[1]=ne[re+2],T[0]=ne[re+3],S[0]}x.readFloatLE=_?ee:ie,x.readFloatBE=_?ie:ee}():function(){function S(_,D,Y,ee){var ie=D<0?1:0;if(ie&&(D=-D),D===0)_(1/D>0?0:2147483648,Y,ee);else if(isNaN(D))_(2143289344,Y,ee);else if(D>34028234663852886e22)_((ie<<31|2139095040)>>>0,Y,ee);else if(D<11754943508222875e-54)_((ie<<31|Math.round(D/1401298464324817e-60))>>>0,Y,ee);else{var ne=Math.floor(Math.log(D)/Math.LN2),re=Math.round(D*Math.pow(2,-ne)*8388608)&8388607;_((ie<<31|ne+127<<23|re)>>>0,Y,ee)}}x.writeFloatLE=S.bind(null,E),x.writeFloatBE=S.bind(null,w);function T(_,D,Y){var ee=_(D,Y),ie=(ee>>31)*2+1,ne=ee>>>23&255,re=ee&8388607;return ne===255?re?NaN:ie*(1/0):ne===0?ie*1401298464324817e-60*re:ie*Math.pow(2,ne-150)*(re+8388608)}x.readFloatLE=T.bind(null,R),x.readFloatBE=T.bind(null,M)}(),typeof Float64Array<"u"?function(){var S=new Float64Array([-0]),T=new Uint8Array(S.buffer),_=T[7]===128;function D(ne,re,oe){S[0]=ne,re[oe]=T[0],re[oe+1]=T[1],re[oe+2]=T[2],re[oe+3]=T[3],re[oe+4]=T[4],re[oe+5]=T[5],re[oe+6]=T[6],re[oe+7]=T[7]}function Y(ne,re,oe){S[0]=ne,re[oe]=T[7],re[oe+1]=T[6],re[oe+2]=T[5],re[oe+3]=T[4],re[oe+4]=T[3],re[oe+5]=T[2],re[oe+6]=T[1],re[oe+7]=T[0]}x.writeDoubleLE=_?D:Y,x.writeDoubleBE=_?Y:D;function ee(ne,re){return T[0]=ne[re],T[1]=ne[re+1],T[2]=ne[re+2],T[3]=ne[re+3],T[4]=ne[re+4],T[5]=ne[re+5],T[6]=ne[re+6],T[7]=ne[re+7],S[0]}function ie(ne,re){return T[7]=ne[re],T[6]=ne[re+1],T[5]=ne[re+2],T[4]=ne[re+3],T[3]=ne[re+4],T[2]=ne[re+5],T[1]=ne[re+6],T[0]=ne[re+7],S[0]}x.readDoubleLE=_?ee:ie,x.readDoubleBE=_?ie:ee}():function(){function S(_,D,Y,ee,ie,ne){var re=ee<0?1:0;if(re&&(ee=-ee),ee===0)_(0,ie,ne+D),_(1/ee>0?0:2147483648,ie,ne+Y);else if(isNaN(ee))_(0,ie,ne+D),_(2146959360,ie,ne+Y);else if(ee>17976931348623157e292)_(0,ie,ne+D),_((re<<31|2146435072)>>>0,ie,ne+Y);else{var oe;if(ee<22250738585072014e-324)oe=ee/5e-324,_(oe>>>0,ie,ne+D),_((re<<31|oe/4294967296)>>>0,ie,ne+Y);else{var ae=Math.floor(Math.log(ee)/Math.LN2);ae===1024&&(ae=1023),oe=ee*Math.pow(2,-ae),_(oe*4503599627370496>>>0,ie,ne+D),_((re<<31|ae+1023<<20|oe*1048576&1048575)>>>0,ie,ne+Y)}}}x.writeDoubleLE=S.bind(null,E,0,4),x.writeDoubleBE=S.bind(null,w,4,0);function T(_,D,Y,ee,ie){var ne=_(ee,ie+D),re=_(ee,ie+Y),oe=(re>>31)*2+1,ae=re>>>20&2047,le=4294967296*(re&1048575)+ne;return ae===2047?le?NaN:oe*(1/0):ae===0?oe*5e-324*le:oe*Math.pow(2,ae-1075)*(le+4503599627370496)}x.readDoubleLE=T.bind(null,R,0,4),x.readDoubleBE=T.bind(null,M,4,0)}(),x}function E(x,S,T){S[T]=x&255,S[T+1]=x>>>8&255,S[T+2]=x>>>16&255,S[T+3]=x>>>24}function w(x,S,T){S[T]=x>>>24,S[T+1]=x>>>16&255,S[T+2]=x>>>8&255,S[T+3]=x&255}function R(x,S){return(x[S]|x[S+1]<<8|x[S+2]<<16|x[S+3]<<24)>>>0}function M(x,S){return(x[S]<<24|x[S+1]<<16|x[S+2]<<8|x[S+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(C){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(C){var E=C;E.length=function(w){for(var R=0,M=0,x=0;x<w.length;++x)M=w.charCodeAt(x),M<128?R+=1:M<2048?R+=2:(M&64512)===55296&&(w.charCodeAt(x+1)&64512)===56320?(++x,R+=4):R+=3;return R},E.read=function(w,R,M){var x=M-R;if(x<1)return"";for(var S=null,T=[],_=0,D;R<M;)D=w[R++],D<128?T[_++]=D:D>191&&D<224?T[_++]=(D&31)<<6|w[R++]&63:D>239&&D<365?(D=((D&7)<<18|(w[R++]&63)<<12|(w[R++]&63)<<6|w[R++]&63)-65536,T[_++]=55296+(D>>10),T[_++]=56320+(D&1023)):T[_++]=(D&15)<<12|(w[R++]&63)<<6|w[R++]&63,_>8191&&((S||(S=[])).push(String.fromCharCode.apply(String,T)),_=0);return S?(_&&S.push(String.fromCharCode.apply(String,T.slice(0,_))),S.join("")):String.fromCharCode.apply(String,T.slice(0,_))},E.write=function(w,R,M){for(var x=M,S,T,_=0;_<w.length;++_)S=w.charCodeAt(_),S<128?R[M++]=S:S<2048?(R[M++]=S>>6|192,R[M++]=S&63|128):(S&64512)===55296&&((T=w.charCodeAt(_+1))&64512)===56320?(S=65536+((S&1023)<<10)+(T&1023),++_,R[M++]=S>>18|240,R[M++]=S>>12&63|128,R[M++]=S>>6&63|128,R[M++]=S&63|128):(R[M++]=S>>12|224,R[M++]=S>>6&63|128,R[M++]=S&63|128);return M-x}}(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=C;function C(E,w,R){var M=R||8192,x=M>>>1,S=null,T=M;return function(_){if(_<1||_>x)return E(_);T+_>M&&(S=E(M),T=0);var D=w.call(S,T,T+=_);return T&7&&(T=(T|7)+1),D}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=E;var C=requireMinimal$1();function E(x,S){this.lo=x>>>0,this.hi=S>>>0}var w=E.zero=new E(0,0);w.toNumber=function(){return 0},w.zzEncode=w.zzDecode=function(){return this},w.length=function(){return 1};var R=E.zeroHash="\0\0\0\0\0\0\0\0";E.fromNumber=function(x){if(x===0)return w;var S=x<0;S&&(x=-x);var T=x>>>0,_=(x-T)/4294967296>>>0;return S&&(_=~_>>>0,T=~T>>>0,++T>4294967295&&(T=0,++_>4294967295&&(_=0))),new E(T,_)},E.from=function(x){if(typeof x=="number")return E.fromNumber(x);if(C.isString(x))if(C.Long)x=C.Long.fromString(x);else return E.fromNumber(parseInt(x,10));return x.low||x.high?new E(x.low>>>0,x.high>>>0):w},E.prototype.toNumber=function(x){if(!x&&this.hi>>>31){var S=~this.lo+1>>>0,T=~this.hi>>>0;return S||(T=T+1>>>0),-(S+T*4294967296)}return this.lo+this.hi*4294967296},E.prototype.toLong=function(x){return C.Long?new C.Long(this.lo|0,this.hi|0,!!x):{low:this.lo|0,high:this.hi|0,unsigned:!!x}};var M=String.prototype.charCodeAt;return E.fromHash=function(x){return x===R?w:new E((M.call(x,0)|M.call(x,1)<<8|M.call(x,2)<<16|M.call(x,3)<<24)>>>0,(M.call(x,4)|M.call(x,5)<<8|M.call(x,6)<<16|M.call(x,7)<<24)>>>0)},E.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},E.prototype.zzEncode=function(){var x=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^x)>>>0,this.lo=(this.lo<<1^x)>>>0,this},E.prototype.zzDecode=function(){var x=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^x)>>>0,this.hi=(this.hi>>>1^x)>>>0,this},E.prototype.length=function(){var x=this.lo,S=(this.lo>>>28|this.hi<<4)>>>0,T=this.hi>>>24;return T===0?S===0?x<16384?x<128?1:2:x<2097152?3:4:S<16384?S<128?5:6:S<2097152?7:8:T<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(C){var E=C;E.asPromise=requireAspromise(),E.base64=requireBase64(),E.EventEmitter=requireEventemitter(),E.float=requireFloat(),E.inquire=requireInquire(),E.utf8=requireUtf8(),E.pool=requirePool(),E.LongBits=requireLongbits(),E.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),E.global=E.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal$1,E.emptyArray=Object.freeze?Object.freeze([]):[],E.emptyObject=Object.freeze?Object.freeze({}):{},E.isInteger=Number.isInteger||function(M){return typeof M=="number"&&isFinite(M)&&Math.floor(M)===M},E.isString=function(M){return typeof M=="string"||M instanceof String},E.isObject=function(M){return M&&typeof M=="object"},E.isset=E.isSet=function(M,x){var S=M[x];return S!=null&&M.hasOwnProperty(x)?typeof S!="object"||(Array.isArray(S)?S.length:Object.keys(S).length)>0:!1},E.Buffer=function(){try{var M=E.inquire("buffer").Buffer;return M.prototype.utf8Write?M:null}catch{return null}}(),E._Buffer_from=null,E._Buffer_allocUnsafe=null,E.newBuffer=function(M){return typeof M=="number"?E.Buffer?E._Buffer_allocUnsafe(M):new E.Array(M):E.Buffer?E._Buffer_from(M):typeof Uint8Array>"u"?M:new Uint8Array(M)},E.Array=typeof Uint8Array<"u"?Uint8Array:Array,E.Long=E.global.dcodeIO&&E.global.dcodeIO.Long||E.global.Long||E.inquire("long"),E.key2Re=/^true|false|0|1$/,E.key32Re=/^-?(?:0|[1-9][0-9]*)$/,E.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,E.longToHash=function(M){return M?E.LongBits.from(M).toHash():E.LongBits.zeroHash},E.longFromHash=function(M,x){var S=E.LongBits.fromHash(M);return E.Long?E.Long.fromBits(S.lo,S.hi,x):S.toNumber(!!x)};function w(M,x,S){for(var T=Object.keys(x),_=0;_<T.length;++_)(M[T[_]]===void 0||!S)&&(M[T[_]]=x[T[_]]);return M}E.merge=w,E.lcFirst=function(M){return M.charAt(0).toLowerCase()+M.substring(1)};function R(M){function x(S,T){if(!(this instanceof x))return new x(S,T);Object.defineProperty(this,"message",{get:function(){return S}}),Error.captureStackTrace?Error.captureStackTrace(this,x):Object.defineProperty(this,"stack",{value:new Error().stack||""}),T&&w(this,T)}return x.prototype=Object.create(Error.prototype,{constructor:{value:x,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return M},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),x}E.newError=R,E.ProtocolError=R("ProtocolError"),E.oneOfGetter=function(M){for(var x={},S=0;S<M.length;++S)x[M[S]]=1;return function(){for(var T=Object.keys(this),_=T.length-1;_>-1;--_)if(x[T[_]]===1&&this[T[_]]!==void 0&&this[T[_]]!==null)return T[_]}},E.oneOfSetter=function(M){return function(x){for(var S=0;S<M.length;++S)M[S]!==x&&delete this[M[S]]}},E.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},E._configure=function(){var M=E.Buffer;if(!M){E._Buffer_from=E._Buffer_allocUnsafe=null;return}E._Buffer_from=M.from!==Uint8Array.from&&M.from||function(x,S){return new M(x,S)},E._Buffer_allocUnsafe=M.allocUnsafe||function(x){return new M(x)}}}(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=_;var C=requireMinimal$1(),E,w=C.LongBits,R=C.base64,M=C.utf8;function x(ae,le,de){this.fn=ae,this.len=le,this.next=void 0,this.val=de}function S(){}function T(ae){this.head=ae.head,this.tail=ae.tail,this.len=ae.len,this.next=ae.states}function _(){this.len=0,this.head=new x(S,0,0),this.tail=this.head,this.states=null}var D=function(){return C.Buffer?function(){return(_.create=function(){return new E})()}:function(){return new _}};_.create=D(),_.alloc=function(ae){return new C.Array(ae)},C.Array!==Array&&(_.alloc=C.pool(_.alloc,C.Array.prototype.subarray)),_.prototype._push=function(ae,le,de){return this.tail=this.tail.next=new x(ae,le,de),this.len+=le,this};function Y(ae,le,de){le[de]=ae&255}function ee(ae,le,de){for(;ae>127;)le[de++]=ae&127|128,ae>>>=7;le[de]=ae}function ie(ae,le){this.len=ae,this.next=void 0,this.val=le}ie.prototype=Object.create(x.prototype),ie.prototype.fn=ee,_.prototype.uint32=function(ae){return this.len+=(this.tail=this.tail.next=new ie((ae=ae>>>0)<128?1:ae<16384?2:ae<2097152?3:ae<268435456?4:5,ae)).len,this},_.prototype.int32=function(ae){return ae<0?this._push(ne,10,w.fromNumber(ae)):this.uint32(ae)},_.prototype.sint32=function(ae){return this.uint32((ae<<1^ae>>31)>>>0)};function ne(ae,le,de){for(;ae.hi;)le[de++]=ae.lo&127|128,ae.lo=(ae.lo>>>7|ae.hi<<25)>>>0,ae.hi>>>=7;for(;ae.lo>127;)le[de++]=ae.lo&127|128,ae.lo=ae.lo>>>7;le[de++]=ae.lo}_.prototype.uint64=function(ae){var le=w.from(ae);return this._push(ne,le.length(),le)},_.prototype.int64=_.prototype.uint64,_.prototype.sint64=function(ae){var le=w.from(ae).zzEncode();return this._push(ne,le.length(),le)},_.prototype.bool=function(ae){return this._push(Y,1,ae?1:0)};function re(ae,le,de){le[de]=ae&255,le[de+1]=ae>>>8&255,le[de+2]=ae>>>16&255,le[de+3]=ae>>>24}_.prototype.fixed32=function(ae){return this._push(re,4,ae>>>0)},_.prototype.sfixed32=_.prototype.fixed32,_.prototype.fixed64=function(ae){var le=w.from(ae);return this._push(re,4,le.lo)._push(re,4,le.hi)},_.prototype.sfixed64=_.prototype.fixed64,_.prototype.float=function(ae){return this._push(C.float.writeFloatLE,4,ae)},_.prototype.double=function(ae){return this._push(C.float.writeDoubleLE,8,ae)};var oe=C.Array.prototype.set?function(ae,le,de){le.set(ae,de)}:function(ae,le,de){for(var me=0;me<ae.length;++me)le[de+me]=ae[me]};return _.prototype.bytes=function(ae){var le=ae.length>>>0;if(!le)return this._push(Y,1,0);if(C.isString(ae)){var de=_.alloc(le=R.length(ae));R.decode(ae,de,0),ae=de}return this.uint32(le)._push(oe,le,ae)},_.prototype.string=function(ae){var le=M.length(ae);return le?this.uint32(le)._push(M.write,le,ae):this._push(Y,1,0)},_.prototype.fork=function(){return this.states=new T(this),this.head=this.tail=new x(S,0,0),this.len=0,this},_.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new x(S,0,0),this.len=0),this},_.prototype.ldelim=function(){var ae=this.head,le=this.tail,de=this.len;return this.reset().uint32(de),de&&(this.tail.next=ae.next,this.tail=le,this.len+=de),this},_.prototype.finish=function(){for(var ae=this.head.next,le=this.constructor.alloc(this.len),de=0;ae;)ae.fn(ae.val,le,de),de+=ae.len,ae=ae.next;return le},_._configure=function(ae){E=ae,_.create=D(),E._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=w;var C=requireWriter();(w.prototype=Object.create(C.prototype)).constructor=w;var E=requireMinimal$1();function w(){C.call(this)}w._configure=function(){w.alloc=E._Buffer_allocUnsafe,w.writeBytesBuffer=E.Buffer&&E.Buffer.prototype instanceof Uint8Array&&E.Buffer.prototype.set.name==="set"?function(M,x,S){x.set(M,S)}:function(M,x,S){if(M.copy)M.copy(x,S,0,M.length);else for(var T=0;T<M.length;)x[S++]=M[T++]}},w.prototype.bytes=function(M){E.isString(M)&&(M=E._Buffer_from(M,"base64"));var x=M.length>>>0;return this.uint32(x),x&&this._push(w.writeBytesBuffer,x,M),this};function R(M,x,S){M.length<40?E.utf8.write(M,x,S):x.utf8Write?x.utf8Write(M,S):x.write(M,S)}return w.prototype.string=function(M){var x=E.Buffer.byteLength(M);return this.uint32(x),x&&this._push(R,x,M),this},w._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=x;var C=requireMinimal$1(),E,w=C.LongBits,R=C.utf8;function M(ee,ie){return RangeError("index out of range: "+ee.pos+" + "+(ie||1)+" > "+ee.len)}function x(ee){this.buf=ee,this.pos=0,this.len=ee.length}var S=typeof Uint8Array<"u"?function(ee){if(ee instanceof Uint8Array||Array.isArray(ee))return new x(ee);throw Error("illegal buffer")}:function(ee){if(Array.isArray(ee))return new x(ee);throw Error("illegal buffer")},T=function(){return C.Buffer?function(ee){return(x.create=function(ie){return C.Buffer.isBuffer(ie)?new E(ie):S(ie)})(ee)}:S};x.create=T(),x.prototype._slice=C.Array.prototype.subarray||C.Array.prototype.slice,x.prototype.uint32=function(){var ee=4294967295;return function(){if(ee=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(ee=(ee|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(ee=(ee|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(ee=(ee|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(ee=(ee|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return ee;if((this.pos+=5)>this.len)throw this.pos=this.len,M(this,10);return ee}}(),x.prototype.int32=function(){return this.uint32()|0},x.prototype.sint32=function(){var ee=this.uint32();return ee>>>1^-(ee&1)|0};function _(){var ee=new w(0,0),ie=0;if(this.len-this.pos>4){for(;ie<4;++ie)if(ee.lo=(ee.lo|(this.buf[this.pos]&127)<<ie*7)>>>0,this.buf[this.pos++]<128)return ee;if(ee.lo=(ee.lo|(this.buf[this.pos]&127)<<28)>>>0,ee.hi=(ee.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return ee;ie=0}else{for(;ie<3;++ie){if(this.pos>=this.len)throw M(this);if(ee.lo=(ee.lo|(this.buf[this.pos]&127)<<ie*7)>>>0,this.buf[this.pos++]<128)return ee}return ee.lo=(ee.lo|(this.buf[this.pos++]&127)<<ie*7)>>>0,ee}if(this.len-this.pos>4){for(;ie<5;++ie)if(ee.hi=(ee.hi|(this.buf[this.pos]&127)<<ie*7+3)>>>0,this.buf[this.pos++]<128)return ee}else for(;ie<5;++ie){if(this.pos>=this.len)throw M(this);if(ee.hi=(ee.hi|(this.buf[this.pos]&127)<<ie*7+3)>>>0,this.buf[this.pos++]<128)return ee}throw Error("invalid varint encoding")}x.prototype.bool=function(){return this.uint32()!==0};function D(ee,ie){return(ee[ie-4]|ee[ie-3]<<8|ee[ie-2]<<16|ee[ie-1]<<24)>>>0}x.prototype.fixed32=function(){if(this.pos+4>this.len)throw M(this,4);return D(this.buf,this.pos+=4)},x.prototype.sfixed32=function(){if(this.pos+4>this.len)throw M(this,4);return D(this.buf,this.pos+=4)|0};function Y(){if(this.pos+8>this.len)throw M(this,8);return new w(D(this.buf,this.pos+=4),D(this.buf,this.pos+=4))}return x.prototype.float=function(){if(this.pos+4>this.len)throw M(this,4);var ee=C.float.readFloatLE(this.buf,this.pos);return this.pos+=4,ee},x.prototype.double=function(){if(this.pos+8>this.len)throw M(this,4);var ee=C.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,ee},x.prototype.bytes=function(){var ee=this.uint32(),ie=this.pos,ne=this.pos+ee;if(ne>this.len)throw M(this,ee);if(this.pos+=ee,Array.isArray(this.buf))return this.buf.slice(ie,ne);if(ie===ne){var re=C.Buffer;return re?re.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,ie,ne)},x.prototype.string=function(){var ee=this.bytes();return R.read(ee,0,ee.length)},x.prototype.skip=function(ee){if(typeof ee=="number"){if(this.pos+ee>this.len)throw M(this,ee);this.pos+=ee}else do if(this.pos>=this.len)throw M(this);while(this.buf[this.pos++]&128);return this},x.prototype.skipType=function(ee){switch(ee){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(ee=this.uint32()&7)!==4;)this.skipType(ee);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+ee+" at offset "+this.pos)}return this},x._configure=function(ee){E=ee,x.create=T(),E._configure();var ie=C.Long?"toLong":"toNumber";C.merge(x.prototype,{int64:function(){return _.call(this)[ie](!1)},uint64:function(){return _.call(this)[ie](!0)},sint64:function(){return _.call(this).zzDecode()[ie](!1)},fixed64:function(){return Y.call(this)[ie](!0)},sfixed64:function(){return Y.call(this)[ie](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=w;var C=requireReader();(w.prototype=Object.create(C.prototype)).constructor=w;var E=requireMinimal$1();function w(R){C.call(this,R)}return w._configure=function(){E.Buffer&&(w.prototype._slice=E.Buffer.prototype.slice)},w.prototype.string=function(){var R=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+R,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+R,this.len))},w._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=E;var C=requireMinimal$1();(E.prototype=Object.create(C.EventEmitter.prototype)).constructor=E;function E(w,R,M){if(typeof w!="function")throw TypeError("rpcImpl must be a function");C.EventEmitter.call(this),this.rpcImpl=w,this.requestDelimited=!!R,this.responseDelimited=!!M}return E.prototype.rpcCall=function w(R,M,x,S,T){if(!S)throw TypeError("request must be specified");var _=this;if(!T)return C.asPromise(w,_,R,M,x,S);if(!_.rpcImpl){setTimeout(function(){T(Error("already ended"))},0);return}try{return _.rpcImpl(R,M[_.requestDelimited?"encodeDelimited":"encode"](S).finish(),function(D,Y){if(D)return _.emit("error",D,R),T(D);if(Y===null){_.end(!0);return}if(!(Y instanceof x))try{Y=x[_.responseDelimited?"decodeDelimited":"decode"](Y)}catch(ee){return _.emit("error",ee,R),T(ee)}return _.emit("data",Y,R),T(null,Y)})}catch(D){_.emit("error",D,R),setTimeout(function(){T(D)},0);return}},E.prototype.end=function(w){return this.rpcImpl&&(w||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(C){var E=C;E.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(C){var E=C;E.build="minimal",E.Writer=requireWriter(),E.BufferWriter=requireWriter_buffer(),E.Reader=requireReader(),E.BufferReader=requireReader_buffer(),E.util=requireMinimal$1(),E.rpc=requireRpc(),E.roots=requireRoots(),E.configure=w;function w(){E.util._configure(),E.Writer._configure(E.BufferWriter),E.Reader._configure(E.BufferReader)}w()}(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var SignalingProtocol,hasRequiredSignalingProtocol;function requireSignalingProtocol(){if(hasRequiredSignalingProtocol)return SignalingProtocol;hasRequiredSignalingProtocol=1;var C=requireMinimal(),E=C.Reader,w=C.Writer,R=C.util,M=C.roots.default||(C.roots.default={});return M.SdkSignalFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.timestampMs=R.Long?R.Long.fromBits(0,0,!0):0,x.prototype.type=1,x.prototype.error=null,x.prototype.join=null,x.prototype.joinack=null,x.prototype.sub=null,x.prototype.suback=null,x.prototype.index=null,x.prototype.pause=null,x.prototype.leave=null,x.prototype.leaveAck=null,x.prototype.bitrates=null,x.prototype.audioControl=null,x.prototype.audioMetadata=null,x.prototype.audioStreamIdInfo=null,x.prototype.pingPong=null,x.prototype.audioStatus=null,x.prototype.clientMetric=null,x.prototype.dataMessage=null,x.prototype.remoteVideoUpdate=null,x.prototype.primaryMeetingJoin=null,x.prototype.primaryMeetingJoinAck=null,x.prototype.primaryMeetingLeave=null,x.prototype.notification=null,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),T.uint32(8).uint64(S.timestampMs),T.uint32(16).int32(S.type),S.error!=null&&Object.hasOwnProperty.call(S,"error")&&M.SdkErrorFrame.encode(S.error,T.uint32(26).fork()).ldelim(),S.join!=null&&Object.hasOwnProperty.call(S,"join")&&M.SdkJoinFrame.encode(S.join,T.uint32(34).fork()).ldelim(),S.joinack!=null&&Object.hasOwnProperty.call(S,"joinack")&&M.SdkJoinAckFrame.encode(S.joinack,T.uint32(42).fork()).ldelim(),S.sub!=null&&Object.hasOwnProperty.call(S,"sub")&&M.SdkSubscribeFrame.encode(S.sub,T.uint32(50).fork()).ldelim(),S.suback!=null&&Object.hasOwnProperty.call(S,"suback")&&M.SdkSubscribeAckFrame.encode(S.suback,T.uint32(58).fork()).ldelim(),S.index!=null&&Object.hasOwnProperty.call(S,"index")&&M.SdkIndexFrame.encode(S.index,T.uint32(66).fork()).ldelim(),S.pause!=null&&Object.hasOwnProperty.call(S,"pause")&&M.SdkPauseResumeFrame.encode(S.pause,T.uint32(82).fork()).ldelim(),S.leave!=null&&Object.hasOwnProperty.call(S,"leave")&&M.SdkLeaveFrame.encode(S.leave,T.uint32(90).fork()).ldelim(),S.leaveAck!=null&&Object.hasOwnProperty.call(S,"leaveAck")&&M.SdkLeaveAckFrame.encode(S.leaveAck,T.uint32(98).fork()).ldelim(),S.bitrates!=null&&Object.hasOwnProperty.call(S,"bitrates")&&M.SdkBitrateFrame.encode(S.bitrates,T.uint32(114).fork()).ldelim(),S.audioControl!=null&&Object.hasOwnProperty.call(S,"audioControl")&&M.SdkAudioControlFrame.encode(S.audioControl,T.uint32(138).fork()).ldelim(),S.audioMetadata!=null&&Object.hasOwnProperty.call(S,"audioMetadata")&&M.SdkAudioMetadataFrame.encode(S.audioMetadata,T.uint32(146).fork()).ldelim(),S.audioStreamIdInfo!=null&&Object.hasOwnProperty.call(S,"audioStreamIdInfo")&&M.SdkAudioStreamIdInfoFrame.encode(S.audioStreamIdInfo,T.uint32(154).fork()).ldelim(),S.pingPong!=null&&Object.hasOwnProperty.call(S,"pingPong")&&M.SdkPingPongFrame.encode(S.pingPong,T.uint32(162).fork()).ldelim(),S.audioStatus!=null&&Object.hasOwnProperty.call(S,"audioStatus")&&M.SdkAudioStatusFrame.encode(S.audioStatus,T.uint32(170).fork()).ldelim(),S.clientMetric!=null&&Object.hasOwnProperty.call(S,"clientMetric")&&M.SdkClientMetricFrame.encode(S.clientMetric,T.uint32(178).fork()).ldelim(),S.dataMessage!=null&&Object.hasOwnProperty.call(S,"dataMessage")&&M.SdkDataMessageFrame.encode(S.dataMessage,T.uint32(186).fork()).ldelim(),S.remoteVideoUpdate!=null&&Object.hasOwnProperty.call(S,"remoteVideoUpdate")&&M.SdkRemoteVideoUpdateFrame.encode(S.remoteVideoUpdate,T.uint32(202).fork()).ldelim(),S.primaryMeetingJoin!=null&&Object.hasOwnProperty.call(S,"primaryMeetingJoin")&&M.SdkPrimaryMeetingJoinFrame.encode(S.primaryMeetingJoin,T.uint32(210).fork()).ldelim(),S.primaryMeetingJoinAck!=null&&Object.hasOwnProperty.call(S,"primaryMeetingJoinAck")&&M.SdkPrimaryMeetingJoinAckFrame.encode(S.primaryMeetingJoinAck,T.uint32(218).fork()).ldelim(),S.primaryMeetingLeave!=null&&Object.hasOwnProperty.call(S,"primaryMeetingLeave")&&M.SdkPrimaryMeetingLeaveFrame.encode(S.primaryMeetingLeave,T.uint32(226).fork()).ldelim(),S.notification!=null&&Object.hasOwnProperty.call(S,"notification")&&M.SdkNotificationFrame.encode(S.notification,T.uint32(282).fork()).ldelim(),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkSignalFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.timestampMs=S.uint64();break}case 2:{D.type=S.int32();break}case 3:{D.error=M.SdkErrorFrame.decode(S,S.uint32());break}case 4:{D.join=M.SdkJoinFrame.decode(S,S.uint32());break}case 5:{D.joinack=M.SdkJoinAckFrame.decode(S,S.uint32());break}case 6:{D.sub=M.SdkSubscribeFrame.decode(S,S.uint32());break}case 7:{D.suback=M.SdkSubscribeAckFrame.decode(S,S.uint32());break}case 8:{D.index=M.SdkIndexFrame.decode(S,S.uint32());break}case 10:{D.pause=M.SdkPauseResumeFrame.decode(S,S.uint32());break}case 11:{D.leave=M.SdkLeaveFrame.decode(S,S.uint32());break}case 12:{D.leaveAck=M.SdkLeaveAckFrame.decode(S,S.uint32());break}case 14:{D.bitrates=M.SdkBitrateFrame.decode(S,S.uint32());break}case 17:{D.audioControl=M.SdkAudioControlFrame.decode(S,S.uint32());break}case 18:{D.audioMetadata=M.SdkAudioMetadataFrame.decode(S,S.uint32());break}case 19:{D.audioStreamIdInfo=M.SdkAudioStreamIdInfoFrame.decode(S,S.uint32());break}case 20:{D.pingPong=M.SdkPingPongFrame.decode(S,S.uint32());break}case 21:{D.audioStatus=M.SdkAudioStatusFrame.decode(S,S.uint32());break}case 22:{D.clientMetric=M.SdkClientMetricFrame.decode(S,S.uint32());break}case 23:{D.dataMessage=M.SdkDataMessageFrame.decode(S,S.uint32());break}case 25:{D.remoteVideoUpdate=M.SdkRemoteVideoUpdateFrame.decode(S,S.uint32());break}case 26:{D.primaryMeetingJoin=M.SdkPrimaryMeetingJoinFrame.decode(S,S.uint32());break}case 27:{D.primaryMeetingJoinAck=M.SdkPrimaryMeetingJoinAckFrame.decode(S,S.uint32());break}case 28:{D.primaryMeetingLeave=M.SdkPrimaryMeetingLeaveFrame.decode(S,S.uint32());break}case 35:{D.notification=M.SdkNotificationFrame.decode(S,S.uint32());break}default:S.skipType(Y&7);break}}if(!D.hasOwnProperty("timestampMs"))throw R.ProtocolError("missing required 'timestampMs'",{instance:D});if(!D.hasOwnProperty("type"))throw R.ProtocolError("missing required 'type'",{instance:D});return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(!R.isInteger(S.timestampMs)&&!(S.timestampMs&&R.isInteger(S.timestampMs.low)&&R.isInteger(S.timestampMs.high)))return"timestampMs: integer|Long expected";switch(S.type){default:return"type: enum value expected";case 1:case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 13:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 34:break}if(S.error!=null&&S.hasOwnProperty("error")){var T=M.SdkErrorFrame.verify(S.error);if(T)return"error."+T}if(S.join!=null&&S.hasOwnProperty("join")){var T=M.SdkJoinFrame.verify(S.join);if(T)return"join."+T}if(S.joinack!=null&&S.hasOwnProperty("joinack")){var T=M.SdkJoinAckFrame.verify(S.joinack);if(T)return"joinack."+T}if(S.sub!=null&&S.hasOwnProperty("sub")){var T=M.SdkSubscribeFrame.verify(S.sub);if(T)return"sub."+T}if(S.suback!=null&&S.hasOwnProperty("suback")){var T=M.SdkSubscribeAckFrame.verify(S.suback);if(T)return"suback."+T}if(S.index!=null&&S.hasOwnProperty("index")){var T=M.SdkIndexFrame.verify(S.index);if(T)return"index."+T}if(S.pause!=null&&S.hasOwnProperty("pause")){var T=M.SdkPauseResumeFrame.verify(S.pause);if(T)return"pause."+T}if(S.leave!=null&&S.hasOwnProperty("leave")){var T=M.SdkLeaveFrame.verify(S.leave);if(T)return"leave."+T}if(S.leaveAck!=null&&S.hasOwnProperty("leaveAck")){var T=M.SdkLeaveAckFrame.verify(S.leaveAck);if(T)return"leaveAck."+T}if(S.bitrates!=null&&S.hasOwnProperty("bitrates")){var T=M.SdkBitrateFrame.verify(S.bitrates);if(T)return"bitrates."+T}if(S.audioControl!=null&&S.hasOwnProperty("audioControl")){var T=M.SdkAudioControlFrame.verify(S.audioControl);if(T)return"audioControl."+T}if(S.audioMetadata!=null&&S.hasOwnProperty("audioMetadata")){var T=M.SdkAudioMetadataFrame.verify(S.audioMetadata);if(T)return"audioMetadata."+T}if(S.audioStreamIdInfo!=null&&S.hasOwnProperty("audioStreamIdInfo")){var T=M.SdkAudioStreamIdInfoFrame.verify(S.audioStreamIdInfo);if(T)return"audioStreamIdInfo."+T}if(S.pingPong!=null&&S.hasOwnProperty("pingPong")){var T=M.SdkPingPongFrame.verify(S.pingPong);if(T)return"pingPong."+T}if(S.audioStatus!=null&&S.hasOwnProperty("audioStatus")){var T=M.SdkAudioStatusFrame.verify(S.audioStatus);if(T)return"audioStatus."+T}if(S.clientMetric!=null&&S.hasOwnProperty("clientMetric")){var T=M.SdkClientMetricFrame.verify(S.clientMetric);if(T)return"clientMetric."+T}if(S.dataMessage!=null&&S.hasOwnProperty("dataMessage")){var T=M.SdkDataMessageFrame.verify(S.dataMessage);if(T)return"dataMessage."+T}if(S.remoteVideoUpdate!=null&&S.hasOwnProperty("remoteVideoUpdate")){var T=M.SdkRemoteVideoUpdateFrame.verify(S.remoteVideoUpdate);if(T)return"remoteVideoUpdate."+T}if(S.primaryMeetingJoin!=null&&S.hasOwnProperty("primaryMeetingJoin")){var T=M.SdkPrimaryMeetingJoinFrame.verify(S.primaryMeetingJoin);if(T)return"primaryMeetingJoin."+T}if(S.primaryMeetingJoinAck!=null&&S.hasOwnProperty("primaryMeetingJoinAck")){var T=M.SdkPrimaryMeetingJoinAckFrame.verify(S.primaryMeetingJoinAck);if(T)return"primaryMeetingJoinAck."+T}if(S.primaryMeetingLeave!=null&&S.hasOwnProperty("primaryMeetingLeave")){var T=M.SdkPrimaryMeetingLeaveFrame.verify(S.primaryMeetingLeave);if(T)return"primaryMeetingLeave."+T}if(S.notification!=null&&S.hasOwnProperty("notification")){var T=M.SdkNotificationFrame.verify(S.notification);if(T)return"notification."+T}return null},x.fromObject=function(S){if(S instanceof M.SdkSignalFrame)return S;var T=new M.SdkSignalFrame;switch(S.timestampMs!=null&&(R.Long?(T.timestampMs=R.Long.fromValue(S.timestampMs)).unsigned=!0:typeof S.timestampMs=="string"?T.timestampMs=parseInt(S.timestampMs,10):typeof S.timestampMs=="number"?T.timestampMs=S.timestampMs:typeof S.timestampMs=="object"&&(T.timestampMs=new R.LongBits(S.timestampMs.low>>>0,S.timestampMs.high>>>0).toNumber(!0))),S.type){default:if(typeof S.type=="number"){T.type=S.type;break}break;case"JOIN":case 1:T.type=1;break;case"JOIN_ACK":case 2:T.type=2;break;case"SUBSCRIBE":case 3:T.type=3;break;case"SUBSCRIBE_ACK":case 4:T.type=4;break;case"INDEX":case 5:T.type=5;break;case"PAUSE":case 7:T.type=7;break;case"RESUME":case 8:T.type=8;break;case"LEAVE":case 9:T.type=9;break;case"LEAVE_ACK":case 10:T.type=10;break;case"BITRATES":case 13:T.type=13;break;case"AUDIO_CONTROL":case 16:T.type=16;break;case"AUDIO_METADATA":case 17:T.type=17;break;case"AUDIO_STREAM_ID_INFO":case 18:T.type=18;break;case"PING_PONG":case 19:T.type=19;break;case"AUDIO_STATUS":case 20:T.type=20;break;case"CLIENT_METRIC":case 21:T.type=21;break;case"DATA_MESSAGE":case 22:T.type=22;break;case"REMOTE_VIDEO_UPDATE":case 24:T.type=24;break;case"PRIMARY_MEETING_JOIN":case 25:T.type=25;break;case"PRIMARY_MEETING_JOIN_ACK":case 26:T.type=26;break;case"PRIMARY_MEETING_LEAVE":case 27:T.type=27;break;case"NOTIFICATION":case 34:T.type=34;break}if(S.error!=null){if(typeof S.error!="object")throw TypeError(".SdkSignalFrame.error: object expected");T.error=M.SdkErrorFrame.fromObject(S.error)}if(S.join!=null){if(typeof S.join!="object")throw TypeError(".SdkSignalFrame.join: object expected");T.join=M.SdkJoinFrame.fromObject(S.join)}if(S.joinack!=null){if(typeof S.joinack!="object")throw TypeError(".SdkSignalFrame.joinack: object expected");T.joinack=M.SdkJoinAckFrame.fromObject(S.joinack)}if(S.sub!=null){if(typeof S.sub!="object")throw TypeError(".SdkSignalFrame.sub: object expected");T.sub=M.SdkSubscribeFrame.fromObject(S.sub)}if(S.suback!=null){if(typeof S.suback!="object")throw TypeError(".SdkSignalFrame.suback: object expected");T.suback=M.SdkSubscribeAckFrame.fromObject(S.suback)}if(S.index!=null){if(typeof S.index!="object")throw TypeError(".SdkSignalFrame.index: object expected");T.index=M.SdkIndexFrame.fromObject(S.index)}if(S.pause!=null){if(typeof S.pause!="object")throw TypeError(".SdkSignalFrame.pause: object expected");T.pause=M.SdkPauseResumeFrame.fromObject(S.pause)}if(S.leave!=null){if(typeof S.leave!="object")throw TypeError(".SdkSignalFrame.leave: object expected");T.leave=M.SdkLeaveFrame.fromObject(S.leave)}if(S.leaveAck!=null){if(typeof S.leaveAck!="object")throw TypeError(".SdkSignalFrame.leaveAck: object expected");T.leaveAck=M.SdkLeaveAckFrame.fromObject(S.leaveAck)}if(S.bitrates!=null){if(typeof S.bitrates!="object")throw TypeError(".SdkSignalFrame.bitrates: object expected");T.bitrates=M.SdkBitrateFrame.fromObject(S.bitrates)}if(S.audioControl!=null){if(typeof S.audioControl!="object")throw TypeError(".SdkSignalFrame.audioControl: object expected");T.audioControl=M.SdkAudioControlFrame.fromObject(S.audioControl)}if(S.audioMetadata!=null){if(typeof S.audioMetadata!="object")throw TypeError(".SdkSignalFrame.audioMetadata: object expected");T.audioMetadata=M.SdkAudioMetadataFrame.fromObject(S.audioMetadata)}if(S.audioStreamIdInfo!=null){if(typeof S.audioStreamIdInfo!="object")throw TypeError(".SdkSignalFrame.audioStreamIdInfo: object expected");T.audioStreamIdInfo=M.SdkAudioStreamIdInfoFrame.fromObject(S.audioStreamIdInfo)}if(S.pingPong!=null){if(typeof S.pingPong!="object")throw TypeError(".SdkSignalFrame.pingPong: object expected");T.pingPong=M.SdkPingPongFrame.fromObject(S.pingPong)}if(S.audioStatus!=null){if(typeof S.audioStatus!="object")throw TypeError(".SdkSignalFrame.audioStatus: object expected");T.audioStatus=M.SdkAudioStatusFrame.fromObject(S.audioStatus)}if(S.clientMetric!=null){if(typeof S.clientMetric!="object")throw TypeError(".SdkSignalFrame.clientMetric: object expected");T.clientMetric=M.SdkClientMetricFrame.fromObject(S.clientMetric)}if(S.dataMessage!=null){if(typeof S.dataMessage!="object")throw TypeError(".SdkSignalFrame.dataMessage: object expected");T.dataMessage=M.SdkDataMessageFrame.fromObject(S.dataMessage)}if(S.remoteVideoUpdate!=null){if(typeof S.remoteVideoUpdate!="object")throw TypeError(".SdkSignalFrame.remoteVideoUpdate: object expected");T.remoteVideoUpdate=M.SdkRemoteVideoUpdateFrame.fromObject(S.remoteVideoUpdate)}if(S.primaryMeetingJoin!=null){if(typeof S.primaryMeetingJoin!="object")throw TypeError(".SdkSignalFrame.primaryMeetingJoin: object expected");T.primaryMeetingJoin=M.SdkPrimaryMeetingJoinFrame.fromObject(S.primaryMeetingJoin)}if(S.primaryMeetingJoinAck!=null){if(typeof S.primaryMeetingJoinAck!="object")throw TypeError(".SdkSignalFrame.primaryMeetingJoinAck: object expected");T.primaryMeetingJoinAck=M.SdkPrimaryMeetingJoinAckFrame.fromObject(S.primaryMeetingJoinAck)}if(S.primaryMeetingLeave!=null){if(typeof S.primaryMeetingLeave!="object")throw TypeError(".SdkSignalFrame.primaryMeetingLeave: object expected");T.primaryMeetingLeave=M.SdkPrimaryMeetingLeaveFrame.fromObject(S.primaryMeetingLeave)}if(S.notification!=null){if(typeof S.notification!="object")throw TypeError(".SdkSignalFrame.notification: object expected");T.notification=M.SdkNotificationFrame.fromObject(S.notification)}return T},x.toObject=function(S,T){T||(T={});var _={};if(T.defaults){if(R.Long){var D=new R.Long(0,0,!0);_.timestampMs=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.timestampMs=T.longs===String?"0":0;_.type=T.enums===String?"JOIN":1,_.error=null,_.join=null,_.joinack=null,_.sub=null,_.suback=null,_.index=null,_.pause=null,_.leave=null,_.leaveAck=null,_.bitrates=null,_.audioControl=null,_.audioMetadata=null,_.audioStreamIdInfo=null,_.pingPong=null,_.audioStatus=null,_.clientMetric=null,_.dataMessage=null,_.remoteVideoUpdate=null,_.primaryMeetingJoin=null,_.primaryMeetingJoinAck=null,_.primaryMeetingLeave=null,_.notification=null}return S.timestampMs!=null&&S.hasOwnProperty("timestampMs")&&(typeof S.timestampMs=="number"?_.timestampMs=T.longs===String?String(S.timestampMs):S.timestampMs:_.timestampMs=T.longs===String?R.Long.prototype.toString.call(S.timestampMs):T.longs===Number?new R.LongBits(S.timestampMs.low>>>0,S.timestampMs.high>>>0).toNumber(!0):S.timestampMs),S.type!=null&&S.hasOwnProperty("type")&&(_.type=T.enums===String?M.SdkSignalFrame.Type[S.type]===void 0?S.type:M.SdkSignalFrame.Type[S.type]:S.type),S.error!=null&&S.hasOwnProperty("error")&&(_.error=M.SdkErrorFrame.toObject(S.error,T)),S.join!=null&&S.hasOwnProperty("join")&&(_.join=M.SdkJoinFrame.toObject(S.join,T)),S.joinack!=null&&S.hasOwnProperty("joinack")&&(_.joinack=M.SdkJoinAckFrame.toObject(S.joinack,T)),S.sub!=null&&S.hasOwnProperty("sub")&&(_.sub=M.SdkSubscribeFrame.toObject(S.sub,T)),S.suback!=null&&S.hasOwnProperty("suback")&&(_.suback=M.SdkSubscribeAckFrame.toObject(S.suback,T)),S.index!=null&&S.hasOwnProperty("index")&&(_.index=M.SdkIndexFrame.toObject(S.index,T)),S.pause!=null&&S.hasOwnProperty("pause")&&(_.pause=M.SdkPauseResumeFrame.toObject(S.pause,T)),S.leave!=null&&S.hasOwnProperty("leave")&&(_.leave=M.SdkLeaveFrame.toObject(S.leave,T)),S.leaveAck!=null&&S.hasOwnProperty("leaveAck")&&(_.leaveAck=M.SdkLeaveAckFrame.toObject(S.leaveAck,T)),S.bitrates!=null&&S.hasOwnProperty("bitrates")&&(_.bitrates=M.SdkBitrateFrame.toObject(S.bitrates,T)),S.audioControl!=null&&S.hasOwnProperty("audioControl")&&(_.audioControl=M.SdkAudioControlFrame.toObject(S.audioControl,T)),S.audioMetadata!=null&&S.hasOwnProperty("audioMetadata")&&(_.audioMetadata=M.SdkAudioMetadataFrame.toObject(S.audioMetadata,T)),S.audioStreamIdInfo!=null&&S.hasOwnProperty("audioStreamIdInfo")&&(_.audioStreamIdInfo=M.SdkAudioStreamIdInfoFrame.toObject(S.audioStreamIdInfo,T)),S.pingPong!=null&&S.hasOwnProperty("pingPong")&&(_.pingPong=M.SdkPingPongFrame.toObject(S.pingPong,T)),S.audioStatus!=null&&S.hasOwnProperty("audioStatus")&&(_.audioStatus=M.SdkAudioStatusFrame.toObject(S.audioStatus,T)),S.clientMetric!=null&&S.hasOwnProperty("clientMetric")&&(_.clientMetric=M.SdkClientMetricFrame.toObject(S.clientMetric,T)),S.dataMessage!=null&&S.hasOwnProperty("dataMessage")&&(_.dataMessage=M.SdkDataMessageFrame.toObject(S.dataMessage,T)),S.remoteVideoUpdate!=null&&S.hasOwnProperty("remoteVideoUpdate")&&(_.remoteVideoUpdate=M.SdkRemoteVideoUpdateFrame.toObject(S.remoteVideoUpdate,T)),S.primaryMeetingJoin!=null&&S.hasOwnProperty("primaryMeetingJoin")&&(_.primaryMeetingJoin=M.SdkPrimaryMeetingJoinFrame.toObject(S.primaryMeetingJoin,T)),S.primaryMeetingJoinAck!=null&&S.hasOwnProperty("primaryMeetingJoinAck")&&(_.primaryMeetingJoinAck=M.SdkPrimaryMeetingJoinAckFrame.toObject(S.primaryMeetingJoinAck,T)),S.primaryMeetingLeave!=null&&S.hasOwnProperty("primaryMeetingLeave")&&(_.primaryMeetingLeave=M.SdkPrimaryMeetingLeaveFrame.toObject(S.primaryMeetingLeave,T)),S.notification!=null&&S.hasOwnProperty("notification")&&(_.notification=M.SdkNotificationFrame.toObject(S.notification,T)),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkSignalFrame"},x.Type=function(){var S={},T=Object.create(S);return T[S[1]="JOIN"]=1,T[S[2]="JOIN_ACK"]=2,T[S[3]="SUBSCRIBE"]=3,T[S[4]="SUBSCRIBE_ACK"]=4,T[S[5]="INDEX"]=5,T[S[7]="PAUSE"]=7,T[S[8]="RESUME"]=8,T[S[9]="LEAVE"]=9,T[S[10]="LEAVE_ACK"]=10,T[S[13]="BITRATES"]=13,T[S[16]="AUDIO_CONTROL"]=16,T[S[17]="AUDIO_METADATA"]=17,T[S[18]="AUDIO_STREAM_ID_INFO"]=18,T[S[19]="PING_PONG"]=19,T[S[20]="AUDIO_STATUS"]=20,T[S[21]="CLIENT_METRIC"]=21,T[S[22]="DATA_MESSAGE"]=22,T[S[24]="REMOTE_VIDEO_UPDATE"]=24,T[S[25]="PRIMARY_MEETING_JOIN"]=25,T[S[26]="PRIMARY_MEETING_JOIN_ACK"]=26,T[S[27]="PRIMARY_MEETING_LEAVE"]=27,T[S[34]="NOTIFICATION"]=34,T}(),x}(),M.SdkErrorFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.status=0,x.prototype.description="",x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.status!=null&&Object.hasOwnProperty.call(S,"status")&&T.uint32(8).uint32(S.status),S.description!=null&&Object.hasOwnProperty.call(S,"description")&&T.uint32(18).string(S.description),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkErrorFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.status=S.uint32();break}case 2:{D.description=S.string();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.status!=null&&S.hasOwnProperty("status")&&!R.isInteger(S.status)?"status: integer expected":S.description!=null&&S.hasOwnProperty("description")&&!R.isString(S.description)?"description: string expected":null},x.fromObject=function(S){if(S instanceof M.SdkErrorFrame)return S;var T=new M.SdkErrorFrame;return S.status!=null&&(T.status=S.status>>>0),S.description!=null&&(T.description=String(S.description)),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.status=0,_.description=""),S.status!=null&&S.hasOwnProperty("status")&&(_.status=S.status),S.description!=null&&S.hasOwnProperty("description")&&(_.description=S.description),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkErrorFrame"},x}(),M.SdkJoinFlags=function(){var x={},S=Object.create(x);return S[x[2]="HAS_STREAM_UPDATE"]=2,S[x[16]="COMPLETE_VIDEO_SOURCES_LIST"]=16,S[x[32]="EXCLUDE_SELF_CONTENT_IN_INDEX"]=32,S}(),M.SdkClientDetails=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.appName="",x.prototype.appVersion="",x.prototype.deviceModel="",x.prototype.deviceMake="",x.prototype.platformName="",x.prototype.platformVersion="",x.prototype.clientSource="",x.prototype.chimeSdkVersion="",x.prototype.clientUtcOffset="",x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.appName!=null&&Object.hasOwnProperty.call(S,"appName")&&T.uint32(10).string(S.appName),S.appVersion!=null&&Object.hasOwnProperty.call(S,"appVersion")&&T.uint32(18).string(S.appVersion),S.deviceModel!=null&&Object.hasOwnProperty.call(S,"deviceModel")&&T.uint32(26).string(S.deviceModel),S.deviceMake!=null&&Object.hasOwnProperty.call(S,"deviceMake")&&T.uint32(34).string(S.deviceMake),S.platformName!=null&&Object.hasOwnProperty.call(S,"platformName")&&T.uint32(42).string(S.platformName),S.platformVersion!=null&&Object.hasOwnProperty.call(S,"platformVersion")&&T.uint32(50).string(S.platformVersion),S.clientSource!=null&&Object.hasOwnProperty.call(S,"clientSource")&&T.uint32(58).string(S.clientSource),S.chimeSdkVersion!=null&&Object.hasOwnProperty.call(S,"chimeSdkVersion")&&T.uint32(66).string(S.chimeSdkVersion),S.clientUtcOffset!=null&&Object.hasOwnProperty.call(S,"clientUtcOffset")&&T.uint32(74).string(S.clientUtcOffset),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkClientDetails;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.appName=S.string();break}case 2:{D.appVersion=S.string();break}case 3:{D.deviceModel=S.string();break}case 4:{D.deviceMake=S.string();break}case 5:{D.platformName=S.string();break}case 6:{D.platformVersion=S.string();break}case 7:{D.clientSource=S.string();break}case 8:{D.chimeSdkVersion=S.string();break}case 9:{D.clientUtcOffset=S.string();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.appName!=null&&S.hasOwnProperty("appName")&&!R.isString(S.appName)?"appName: string expected":S.appVersion!=null&&S.hasOwnProperty("appVersion")&&!R.isString(S.appVersion)?"appVersion: string expected":S.deviceModel!=null&&S.hasOwnProperty("deviceModel")&&!R.isString(S.deviceModel)?"deviceModel: string expected":S.deviceMake!=null&&S.hasOwnProperty("deviceMake")&&!R.isString(S.deviceMake)?"deviceMake: string expected":S.platformName!=null&&S.hasOwnProperty("platformName")&&!R.isString(S.platformName)?"platformName: string expected":S.platformVersion!=null&&S.hasOwnProperty("platformVersion")&&!R.isString(S.platformVersion)?"platformVersion: string expected":S.clientSource!=null&&S.hasOwnProperty("clientSource")&&!R.isString(S.clientSource)?"clientSource: string expected":S.chimeSdkVersion!=null&&S.hasOwnProperty("chimeSdkVersion")&&!R.isString(S.chimeSdkVersion)?"chimeSdkVersion: string expected":S.clientUtcOffset!=null&&S.hasOwnProperty("clientUtcOffset")&&!R.isString(S.clientUtcOffset)?"clientUtcOffset: string expected":null},x.fromObject=function(S){if(S instanceof M.SdkClientDetails)return S;var T=new M.SdkClientDetails;return S.appName!=null&&(T.appName=String(S.appName)),S.appVersion!=null&&(T.appVersion=String(S.appVersion)),S.deviceModel!=null&&(T.deviceModel=String(S.deviceModel)),S.deviceMake!=null&&(T.deviceMake=String(S.deviceMake)),S.platformName!=null&&(T.platformName=String(S.platformName)),S.platformVersion!=null&&(T.platformVersion=String(S.platformVersion)),S.clientSource!=null&&(T.clientSource=String(S.clientSource)),S.chimeSdkVersion!=null&&(T.chimeSdkVersion=String(S.chimeSdkVersion)),S.clientUtcOffset!=null&&(T.clientUtcOffset=String(S.clientUtcOffset)),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.appName="",_.appVersion="",_.deviceModel="",_.deviceMake="",_.platformName="",_.platformVersion="",_.clientSource="",_.chimeSdkVersion="",_.clientUtcOffset=""),S.appName!=null&&S.hasOwnProperty("appName")&&(_.appName=S.appName),S.appVersion!=null&&S.hasOwnProperty("appVersion")&&(_.appVersion=S.appVersion),S.deviceModel!=null&&S.hasOwnProperty("deviceModel")&&(_.deviceModel=S.deviceModel),S.deviceMake!=null&&S.hasOwnProperty("deviceMake")&&(_.deviceMake=S.deviceMake),S.platformName!=null&&S.hasOwnProperty("platformName")&&(_.platformName=S.platformName),S.platformVersion!=null&&S.hasOwnProperty("platformVersion")&&(_.platformVersion=S.platformVersion),S.clientSource!=null&&S.hasOwnProperty("clientSource")&&(_.clientSource=S.clientSource),S.chimeSdkVersion!=null&&S.hasOwnProperty("chimeSdkVersion")&&(_.chimeSdkVersion=S.chimeSdkVersion),S.clientUtcOffset!=null&&S.hasOwnProperty("clientUtcOffset")&&(_.clientUtcOffset=S.clientUtcOffset),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkClientDetails"},x}(),M.SdkServerSideNetworkAdaption=function(){var x={},S=Object.create(x);return S[x[1]="DEFAULT"]=1,S[x[2]="NONE"]=2,S[x[3]="BANDWIDTH_PROBING"]=3,S[x[4]="BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION"]=4,S}(),M.SdkJoinFrame=function(){function x(S){if(this.supportedServerSideNetworkAdaptions=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.protocolVersion=2,x.prototype.maxNumOfVideos=0,x.prototype.flags=0,x.prototype.clientDetails=null,x.prototype.audioSessionId=R.Long?R.Long.fromBits(0,0,!0):0,x.prototype.wantsCompressedSdp=!1,x.prototype.serverSideNetworkAdaption=1,x.prototype.supportedServerSideNetworkAdaptions=R.emptyArray,x.prototype.wantsAllTemporalLayersInIndex=!1,x.prototype.disablePeriodicKeyframeRequestOnContentSender=!1,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.protocolVersion!=null&&Object.hasOwnProperty.call(S,"protocolVersion")&&T.uint32(8).uint32(S.protocolVersion),S.maxNumOfVideos!=null&&Object.hasOwnProperty.call(S,"maxNumOfVideos")&&T.uint32(16).uint32(S.maxNumOfVideos),S.flags!=null&&Object.hasOwnProperty.call(S,"flags")&&T.uint32(24).uint32(S.flags),S.clientDetails!=null&&Object.hasOwnProperty.call(S,"clientDetails")&&M.SdkClientDetails.encode(S.clientDetails,T.uint32(34).fork()).ldelim(),S.audioSessionId!=null&&Object.hasOwnProperty.call(S,"audioSessionId")&&T.uint32(48).uint64(S.audioSessionId),S.wantsCompressedSdp!=null&&Object.hasOwnProperty.call(S,"wantsCompressedSdp")&&T.uint32(56).bool(S.wantsCompressedSdp),S.serverSideNetworkAdaption!=null&&Object.hasOwnProperty.call(S,"serverSideNetworkAdaption")&&T.uint32(80).int32(S.serverSideNetworkAdaption),S.supportedServerSideNetworkAdaptions!=null&&S.supportedServerSideNetworkAdaptions.length)for(var _=0;_<S.supportedServerSideNetworkAdaptions.length;++_)T.uint32(88).int32(S.supportedServerSideNetworkAdaptions[_]);return S.wantsAllTemporalLayersInIndex!=null&&Object.hasOwnProperty.call(S,"wantsAllTemporalLayersInIndex")&&T.uint32(96).bool(S.wantsAllTemporalLayersInIndex),S.disablePeriodicKeyframeRequestOnContentSender!=null&&Object.hasOwnProperty.call(S,"disablePeriodicKeyframeRequestOnContentSender")&&T.uint32(104).bool(S.disablePeriodicKeyframeRequestOnContentSender),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkJoinFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.protocolVersion=S.uint32();break}case 2:{D.maxNumOfVideos=S.uint32();break}case 3:{D.flags=S.uint32();break}case 4:{D.clientDetails=M.SdkClientDetails.decode(S,S.uint32());break}case 6:{D.audioSessionId=S.uint64();break}case 7:{D.wantsCompressedSdp=S.bool();break}case 10:{D.serverSideNetworkAdaption=S.int32();break}case 11:{if(D.supportedServerSideNetworkAdaptions&&D.supportedServerSideNetworkAdaptions.length||(D.supportedServerSideNetworkAdaptions=[]),(Y&7)===2)for(var ee=S.uint32()+S.pos;S.pos<ee;)D.supportedServerSideNetworkAdaptions.push(S.int32());else D.supportedServerSideNetworkAdaptions.push(S.int32());break}case 12:{D.wantsAllTemporalLayersInIndex=S.bool();break}case 13:{D.disablePeriodicKeyframeRequestOnContentSender=S.bool();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.protocolVersion!=null&&S.hasOwnProperty("protocolVersion")&&!R.isInteger(S.protocolVersion))return"protocolVersion: integer expected";if(S.maxNumOfVideos!=null&&S.hasOwnProperty("maxNumOfVideos")&&!R.isInteger(S.maxNumOfVideos))return"maxNumOfVideos: integer expected";if(S.flags!=null&&S.hasOwnProperty("flags")&&!R.isInteger(S.flags))return"flags: integer expected";if(S.clientDetails!=null&&S.hasOwnProperty("clientDetails")){var T=M.SdkClientDetails.verify(S.clientDetails);if(T)return"clientDetails."+T}if(S.audioSessionId!=null&&S.hasOwnProperty("audioSessionId")&&!R.isInteger(S.audioSessionId)&&!(S.audioSessionId&&R.isInteger(S.audioSessionId.low)&&R.isInteger(S.audioSessionId.high)))return"audioSessionId: integer|Long expected";if(S.wantsCompressedSdp!=null&&S.hasOwnProperty("wantsCompressedSdp")&&typeof S.wantsCompressedSdp!="boolean")return"wantsCompressedSdp: boolean expected";if(S.serverSideNetworkAdaption!=null&&S.hasOwnProperty("serverSideNetworkAdaption"))switch(S.serverSideNetworkAdaption){default:return"serverSideNetworkAdaption: enum value expected";case 1:case 2:case 3:case 4:break}if(S.supportedServerSideNetworkAdaptions!=null&&S.hasOwnProperty("supportedServerSideNetworkAdaptions")){if(!Array.isArray(S.supportedServerSideNetworkAdaptions))return"supportedServerSideNetworkAdaptions: array expected";for(var _=0;_<S.supportedServerSideNetworkAdaptions.length;++_)switch(S.supportedServerSideNetworkAdaptions[_]){default:return"supportedServerSideNetworkAdaptions: enum value[] expected";case 1:case 2:case 3:case 4:break}}return S.wantsAllTemporalLayersInIndex!=null&&S.hasOwnProperty("wantsAllTemporalLayersInIndex")&&typeof S.wantsAllTemporalLayersInIndex!="boolean"?"wantsAllTemporalLayersInIndex: boolean expected":S.disablePeriodicKeyframeRequestOnContentSender!=null&&S.hasOwnProperty("disablePeriodicKeyframeRequestOnContentSender")&&typeof S.disablePeriodicKeyframeRequestOnContentSender!="boolean"?"disablePeriodicKeyframeRequestOnContentSender: boolean expected":null},x.fromObject=function(S){if(S instanceof M.SdkJoinFrame)return S;var T=new M.SdkJoinFrame;if(S.protocolVersion!=null&&(T.protocolVersion=S.protocolVersion>>>0),S.maxNumOfVideos!=null&&(T.maxNumOfVideos=S.maxNumOfVideos>>>0),S.flags!=null&&(T.flags=S.flags>>>0),S.clientDetails!=null){if(typeof S.clientDetails!="object")throw TypeError(".SdkJoinFrame.clientDetails: object expected");T.clientDetails=M.SdkClientDetails.fromObject(S.clientDetails)}switch(S.audioSessionId!=null&&(R.Long?(T.audioSessionId=R.Long.fromValue(S.audioSessionId)).unsigned=!0:typeof S.audioSessionId=="string"?T.audioSessionId=parseInt(S.audioSessionId,10):typeof S.audioSessionId=="number"?T.audioSessionId=S.audioSessionId:typeof S.audioSessionId=="object"&&(T.audioSessionId=new R.LongBits(S.audioSessionId.low>>>0,S.audioSessionId.high>>>0).toNumber(!0))),S.wantsCompressedSdp!=null&&(T.wantsCompressedSdp=!!S.wantsCompressedSdp),S.serverSideNetworkAdaption){default:if(typeof S.serverSideNetworkAdaption=="number"){T.serverSideNetworkAdaption=S.serverSideNetworkAdaption;break}break;case"DEFAULT":case 1:T.serverSideNetworkAdaption=1;break;case"NONE":case 2:T.serverSideNetworkAdaption=2;break;case"BANDWIDTH_PROBING":case 3:T.serverSideNetworkAdaption=3;break;case"BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION":case 4:T.serverSideNetworkAdaption=4;break}if(S.supportedServerSideNetworkAdaptions){if(!Array.isArray(S.supportedServerSideNetworkAdaptions))throw TypeError(".SdkJoinFrame.supportedServerSideNetworkAdaptions: array expected");T.supportedServerSideNetworkAdaptions=[];for(var _=0;_<S.supportedServerSideNetworkAdaptions.length;++_)switch(S.supportedServerSideNetworkAdaptions[_]){default:if(typeof S.supportedServerSideNetworkAdaptions[_]=="number"){T.supportedServerSideNetworkAdaptions[_]=S.supportedServerSideNetworkAdaptions[_];break}case"DEFAULT":case 1:T.supportedServerSideNetworkAdaptions[_]=1;break;case"NONE":case 2:T.supportedServerSideNetworkAdaptions[_]=2;break;case"BANDWIDTH_PROBING":case 3:T.supportedServerSideNetworkAdaptions[_]=3;break;case"BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION":case 4:T.supportedServerSideNetworkAdaptions[_]=4;break}}return S.wantsAllTemporalLayersInIndex!=null&&(T.wantsAllTemporalLayersInIndex=!!S.wantsAllTemporalLayersInIndex),S.disablePeriodicKeyframeRequestOnContentSender!=null&&(T.disablePeriodicKeyframeRequestOnContentSender=!!S.disablePeriodicKeyframeRequestOnContentSender),T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.supportedServerSideNetworkAdaptions=[]),T.defaults){if(_.protocolVersion=2,_.maxNumOfVideos=0,_.flags=0,_.clientDetails=null,R.Long){var D=new R.Long(0,0,!0);_.audioSessionId=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.audioSessionId=T.longs===String?"0":0;_.wantsCompressedSdp=!1,_.serverSideNetworkAdaption=T.enums===String?"DEFAULT":1,_.wantsAllTemporalLayersInIndex=!1,_.disablePeriodicKeyframeRequestOnContentSender=!1}if(S.protocolVersion!=null&&S.hasOwnProperty("protocolVersion")&&(_.protocolVersion=S.protocolVersion),S.maxNumOfVideos!=null&&S.hasOwnProperty("maxNumOfVideos")&&(_.maxNumOfVideos=S.maxNumOfVideos),S.flags!=null&&S.hasOwnProperty("flags")&&(_.flags=S.flags),S.clientDetails!=null&&S.hasOwnProperty("clientDetails")&&(_.clientDetails=M.SdkClientDetails.toObject(S.clientDetails,T)),S.audioSessionId!=null&&S.hasOwnProperty("audioSessionId")&&(typeof S.audioSessionId=="number"?_.audioSessionId=T.longs===String?String(S.audioSessionId):S.audioSessionId:_.audioSessionId=T.longs===String?R.Long.prototype.toString.call(S.audioSessionId):T.longs===Number?new R.LongBits(S.audioSessionId.low>>>0,S.audioSessionId.high>>>0).toNumber(!0):S.audioSessionId),S.wantsCompressedSdp!=null&&S.hasOwnProperty("wantsCompressedSdp")&&(_.wantsCompressedSdp=S.wantsCompressedSdp),S.serverSideNetworkAdaption!=null&&S.hasOwnProperty("serverSideNetworkAdaption")&&(_.serverSideNetworkAdaption=T.enums===String?M.SdkServerSideNetworkAdaption[S.serverSideNetworkAdaption]===void 0?S.serverSideNetworkAdaption:M.SdkServerSideNetworkAdaption[S.serverSideNetworkAdaption]:S.serverSideNetworkAdaption),S.supportedServerSideNetworkAdaptions&&S.supportedServerSideNetworkAdaptions.length){_.supportedServerSideNetworkAdaptions=[];for(var Y=0;Y<S.supportedServerSideNetworkAdaptions.length;++Y)_.supportedServerSideNetworkAdaptions[Y]=T.enums===String?M.SdkServerSideNetworkAdaption[S.supportedServerSideNetworkAdaptions[Y]]===void 0?S.supportedServerSideNetworkAdaptions[Y]:M.SdkServerSideNetworkAdaption[S.supportedServerSideNetworkAdaptions[Y]]:S.supportedServerSideNetworkAdaptions[Y]}return S.wantsAllTemporalLayersInIndex!=null&&S.hasOwnProperty("wantsAllTemporalLayersInIndex")&&(_.wantsAllTemporalLayersInIndex=S.wantsAllTemporalLayersInIndex),S.disablePeriodicKeyframeRequestOnContentSender!=null&&S.hasOwnProperty("disablePeriodicKeyframeRequestOnContentSender")&&(_.disablePeriodicKeyframeRequestOnContentSender=S.disablePeriodicKeyframeRequestOnContentSender),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkJoinFrame"},x}(),M.SdkJoinAckFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.turnCredentials=null,x.prototype.videoSubscriptionLimit=0,x.prototype.wantsCompressedSdp=!1,x.prototype.defaultServerSideNetworkAdaption=1,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.turnCredentials!=null&&Object.hasOwnProperty.call(S,"turnCredentials")&&M.SdkTurnCredentials.encode(S.turnCredentials,T.uint32(10).fork()).ldelim(),S.videoSubscriptionLimit!=null&&Object.hasOwnProperty.call(S,"videoSubscriptionLimit")&&T.uint32(16).uint32(S.videoSubscriptionLimit),S.wantsCompressedSdp!=null&&Object.hasOwnProperty.call(S,"wantsCompressedSdp")&&T.uint32(24).bool(S.wantsCompressedSdp),S.defaultServerSideNetworkAdaption!=null&&Object.hasOwnProperty.call(S,"defaultServerSideNetworkAdaption")&&T.uint32(32).int32(S.defaultServerSideNetworkAdaption),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkJoinAckFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.turnCredentials=M.SdkTurnCredentials.decode(S,S.uint32());break}case 2:{D.videoSubscriptionLimit=S.uint32();break}case 3:{D.wantsCompressedSdp=S.bool();break}case 4:{D.defaultServerSideNetworkAdaption=S.int32();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.turnCredentials!=null&&S.hasOwnProperty("turnCredentials")){var T=M.SdkTurnCredentials.verify(S.turnCredentials);if(T)return"turnCredentials."+T}if(S.videoSubscriptionLimit!=null&&S.hasOwnProperty("videoSubscriptionLimit")&&!R.isInteger(S.videoSubscriptionLimit))return"videoSubscriptionLimit: integer expected";if(S.wantsCompressedSdp!=null&&S.hasOwnProperty("wantsCompressedSdp")&&typeof S.wantsCompressedSdp!="boolean")return"wantsCompressedSdp: boolean expected";if(S.defaultServerSideNetworkAdaption!=null&&S.hasOwnProperty("defaultServerSideNetworkAdaption"))switch(S.defaultServerSideNetworkAdaption){default:return"defaultServerSideNetworkAdaption: enum value expected";case 1:case 2:case 3:case 4:break}return null},x.fromObject=function(S){if(S instanceof M.SdkJoinAckFrame)return S;var T=new M.SdkJoinAckFrame;if(S.turnCredentials!=null){if(typeof S.turnCredentials!="object")throw TypeError(".SdkJoinAckFrame.turnCredentials: object expected");T.turnCredentials=M.SdkTurnCredentials.fromObject(S.turnCredentials)}switch(S.videoSubscriptionLimit!=null&&(T.videoSubscriptionLimit=S.videoSubscriptionLimit>>>0),S.wantsCompressedSdp!=null&&(T.wantsCompressedSdp=!!S.wantsCompressedSdp),S.defaultServerSideNetworkAdaption){default:if(typeof S.defaultServerSideNetworkAdaption=="number"){T.defaultServerSideNetworkAdaption=S.defaultServerSideNetworkAdaption;break}break;case"DEFAULT":case 1:T.defaultServerSideNetworkAdaption=1;break;case"NONE":case 2:T.defaultServerSideNetworkAdaption=2;break;case"BANDWIDTH_PROBING":case 3:T.defaultServerSideNetworkAdaption=3;break;case"BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION":case 4:T.defaultServerSideNetworkAdaption=4;break}return T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.turnCredentials=null,_.videoSubscriptionLimit=0,_.wantsCompressedSdp=!1,_.defaultServerSideNetworkAdaption=T.enums===String?"DEFAULT":1),S.turnCredentials!=null&&S.hasOwnProperty("turnCredentials")&&(_.turnCredentials=M.SdkTurnCredentials.toObject(S.turnCredentials,T)),S.videoSubscriptionLimit!=null&&S.hasOwnProperty("videoSubscriptionLimit")&&(_.videoSubscriptionLimit=S.videoSubscriptionLimit),S.wantsCompressedSdp!=null&&S.hasOwnProperty("wantsCompressedSdp")&&(_.wantsCompressedSdp=S.wantsCompressedSdp),S.defaultServerSideNetworkAdaption!=null&&S.hasOwnProperty("defaultServerSideNetworkAdaption")&&(_.defaultServerSideNetworkAdaption=T.enums===String?M.SdkServerSideNetworkAdaption[S.defaultServerSideNetworkAdaption]===void 0?S.defaultServerSideNetworkAdaption:M.SdkServerSideNetworkAdaption[S.defaultServerSideNetworkAdaption]:S.defaultServerSideNetworkAdaption),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkJoinAckFrame"},x}(),M.SdkLeaveFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkLeaveFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":null},x.fromObject=function(S){return S instanceof M.SdkLeaveFrame?S:new M.SdkLeaveFrame},x.toObject=function(){return{}},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkLeaveFrame"},x}(),M.SdkLeaveAckFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkLeaveAckFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":null},x.fromObject=function(S){return S instanceof M.SdkLeaveAckFrame?S:new M.SdkLeaveAckFrame},x.toObject=function(){return{}},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkLeaveAckFrame"},x}(),M.SdkStreamServiceType=function(){var x={},S=Object.create(x);return S[x[1]="RX"]=1,S[x[2]="TX"]=2,S[x[3]="DUPLEX"]=3,S}(),M.SdkStreamMediaType=function(){var x={},S=Object.create(x);return S[x[1]="AUDIO"]=1,S[x[2]="VIDEO"]=2,S}(),M.SdkSubscribeFrame=function(){function x(S){if(this.sendStreams=[],this.receiveStreamIds=[],this.videoSubscriptionConfiguration=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.duplex=1,x.prototype.sendStreams=R.emptyArray,x.prototype.receiveStreamIds=R.emptyArray,x.prototype.sdpOffer="",x.prototype.audioHost="",x.prototype.audioCheckin=!1,x.prototype.audioMuted=!1,x.prototype.compressedSdpOffer=R.newBuffer([]),x.prototype.videoSubscriptionConfiguration=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.duplex!=null&&Object.hasOwnProperty.call(S,"duplex")&&T.uint32(8).int32(S.duplex),S.sendStreams!=null&&S.sendStreams.length)for(var _=0;_<S.sendStreams.length;++_)M.SdkStreamDescriptor.encode(S.sendStreams[_],T.uint32(18).fork()).ldelim();if(S.receiveStreamIds!=null&&S.receiveStreamIds.length)for(var _=0;_<S.receiveStreamIds.length;++_)T.uint32(24).uint32(S.receiveStreamIds[_]);if(S.sdpOffer!=null&&Object.hasOwnProperty.call(S,"sdpOffer")&&T.uint32(34).string(S.sdpOffer),S.audioHost!=null&&Object.hasOwnProperty.call(S,"audioHost")&&T.uint32(42).string(S.audioHost),S.audioCheckin!=null&&Object.hasOwnProperty.call(S,"audioCheckin")&&T.uint32(48).bool(S.audioCheckin),S.audioMuted!=null&&Object.hasOwnProperty.call(S,"audioMuted")&&T.uint32(56).bool(S.audioMuted),S.compressedSdpOffer!=null&&Object.hasOwnProperty.call(S,"compressedSdpOffer")&&T.uint32(66).bytes(S.compressedSdpOffer),S.videoSubscriptionConfiguration!=null&&S.videoSubscriptionConfiguration.length)for(var _=0;_<S.videoSubscriptionConfiguration.length;++_)M.SdkVideoSubscriptionConfiguration.encode(S.videoSubscriptionConfiguration[_],T.uint32(74).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkSubscribeFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.duplex=S.int32();break}case 2:{D.sendStreams&&D.sendStreams.length||(D.sendStreams=[]),D.sendStreams.push(M.SdkStreamDescriptor.decode(S,S.uint32()));break}case 3:{if(D.receiveStreamIds&&D.receiveStreamIds.length||(D.receiveStreamIds=[]),(Y&7)===2)for(var ee=S.uint32()+S.pos;S.pos<ee;)D.receiveStreamIds.push(S.uint32());else D.receiveStreamIds.push(S.uint32());break}case 4:{D.sdpOffer=S.string();break}case 5:{D.audioHost=S.string();break}case 6:{D.audioCheckin=S.bool();break}case 7:{D.audioMuted=S.bool();break}case 8:{D.compressedSdpOffer=S.bytes();break}case 9:{D.videoSubscriptionConfiguration&&D.videoSubscriptionConfiguration.length||(D.videoSubscriptionConfiguration=[]),D.videoSubscriptionConfiguration.push(M.SdkVideoSubscriptionConfiguration.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.duplex!=null&&S.hasOwnProperty("duplex"))switch(S.duplex){default:return"duplex: enum value expected";case 1:case 2:case 3:break}if(S.sendStreams!=null&&S.hasOwnProperty("sendStreams")){if(!Array.isArray(S.sendStreams))return"sendStreams: array expected";for(var T=0;T<S.sendStreams.length;++T){var _=M.SdkStreamDescriptor.verify(S.sendStreams[T]);if(_)return"sendStreams."+_}}if(S.receiveStreamIds!=null&&S.hasOwnProperty("receiveStreamIds")){if(!Array.isArray(S.receiveStreamIds))return"receiveStreamIds: array expected";for(var T=0;T<S.receiveStreamIds.length;++T)if(!R.isInteger(S.receiveStreamIds[T]))return"receiveStreamIds: integer[] expected"}if(S.sdpOffer!=null&&S.hasOwnProperty("sdpOffer")&&!R.isString(S.sdpOffer))return"sdpOffer: string expected";if(S.audioHost!=null&&S.hasOwnProperty("audioHost")&&!R.isString(S.audioHost))return"audioHost: string expected";if(S.audioCheckin!=null&&S.hasOwnProperty("audioCheckin")&&typeof S.audioCheckin!="boolean")return"audioCheckin: boolean expected";if(S.audioMuted!=null&&S.hasOwnProperty("audioMuted")&&typeof S.audioMuted!="boolean")return"audioMuted: boolean expected";if(S.compressedSdpOffer!=null&&S.hasOwnProperty("compressedSdpOffer")&&!(S.compressedSdpOffer&&typeof S.compressedSdpOffer.length=="number"||R.isString(S.compressedSdpOffer)))return"compressedSdpOffer: buffer expected";if(S.videoSubscriptionConfiguration!=null&&S.hasOwnProperty("videoSubscriptionConfiguration")){if(!Array.isArray(S.videoSubscriptionConfiguration))return"videoSubscriptionConfiguration: array expected";for(var T=0;T<S.videoSubscriptionConfiguration.length;++T){var _=M.SdkVideoSubscriptionConfiguration.verify(S.videoSubscriptionConfiguration[T]);if(_)return"videoSubscriptionConfiguration."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkSubscribeFrame)return S;var T=new M.SdkSubscribeFrame;switch(S.duplex){default:if(typeof S.duplex=="number"){T.duplex=S.duplex;break}break;case"RX":case 1:T.duplex=1;break;case"TX":case 2:T.duplex=2;break;case"DUPLEX":case 3:T.duplex=3;break}if(S.sendStreams){if(!Array.isArray(S.sendStreams))throw TypeError(".SdkSubscribeFrame.sendStreams: array expected");T.sendStreams=[];for(var _=0;_<S.sendStreams.length;++_){if(typeof S.sendStreams[_]!="object")throw TypeError(".SdkSubscribeFrame.sendStreams: object expected");T.sendStreams[_]=M.SdkStreamDescriptor.fromObject(S.sendStreams[_])}}if(S.receiveStreamIds){if(!Array.isArray(S.receiveStreamIds))throw TypeError(".SdkSubscribeFrame.receiveStreamIds: array expected");T.receiveStreamIds=[];for(var _=0;_<S.receiveStreamIds.length;++_)T.receiveStreamIds[_]=S.receiveStreamIds[_]>>>0}if(S.sdpOffer!=null&&(T.sdpOffer=String(S.sdpOffer)),S.audioHost!=null&&(T.audioHost=String(S.audioHost)),S.audioCheckin!=null&&(T.audioCheckin=!!S.audioCheckin),S.audioMuted!=null&&(T.audioMuted=!!S.audioMuted),S.compressedSdpOffer!=null&&(typeof S.compressedSdpOffer=="string"?R.base64.decode(S.compressedSdpOffer,T.compressedSdpOffer=R.newBuffer(R.base64.length(S.compressedSdpOffer)),0):S.compressedSdpOffer.length>=0&&(T.compressedSdpOffer=S.compressedSdpOffer)),S.videoSubscriptionConfiguration){if(!Array.isArray(S.videoSubscriptionConfiguration))throw TypeError(".SdkSubscribeFrame.videoSubscriptionConfiguration: array expected");T.videoSubscriptionConfiguration=[];for(var _=0;_<S.videoSubscriptionConfiguration.length;++_){if(typeof S.videoSubscriptionConfiguration[_]!="object")throw TypeError(".SdkSubscribeFrame.videoSubscriptionConfiguration: object expected");T.videoSubscriptionConfiguration[_]=M.SdkVideoSubscriptionConfiguration.fromObject(S.videoSubscriptionConfiguration[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.sendStreams=[],_.receiveStreamIds=[],_.videoSubscriptionConfiguration=[]),T.defaults&&(_.duplex=T.enums===String?"RX":1,_.sdpOffer="",_.audioHost="",_.audioCheckin=!1,_.audioMuted=!1,T.bytes===String?_.compressedSdpOffer="":(_.compressedSdpOffer=[],T.bytes!==Array&&(_.compressedSdpOffer=R.newBuffer(_.compressedSdpOffer)))),S.duplex!=null&&S.hasOwnProperty("duplex")&&(_.duplex=T.enums===String?M.SdkStreamServiceType[S.duplex]===void 0?S.duplex:M.SdkStreamServiceType[S.duplex]:S.duplex),S.sendStreams&&S.sendStreams.length){_.sendStreams=[];for(var D=0;D<S.sendStreams.length;++D)_.sendStreams[D]=M.SdkStreamDescriptor.toObject(S.sendStreams[D],T)}if(S.receiveStreamIds&&S.receiveStreamIds.length){_.receiveStreamIds=[];for(var D=0;D<S.receiveStreamIds.length;++D)_.receiveStreamIds[D]=S.receiveStreamIds[D]}if(S.sdpOffer!=null&&S.hasOwnProperty("sdpOffer")&&(_.sdpOffer=S.sdpOffer),S.audioHost!=null&&S.hasOwnProperty("audioHost")&&(_.audioHost=S.audioHost),S.audioCheckin!=null&&S.hasOwnProperty("audioCheckin")&&(_.audioCheckin=S.audioCheckin),S.audioMuted!=null&&S.hasOwnProperty("audioMuted")&&(_.audioMuted=S.audioMuted),S.compressedSdpOffer!=null&&S.hasOwnProperty("compressedSdpOffer")&&(_.compressedSdpOffer=T.bytes===String?R.base64.encode(S.compressedSdpOffer,0,S.compressedSdpOffer.length):T.bytes===Array?Array.prototype.slice.call(S.compressedSdpOffer):S.compressedSdpOffer),S.videoSubscriptionConfiguration&&S.videoSubscriptionConfiguration.length){_.videoSubscriptionConfiguration=[];for(var D=0;D<S.videoSubscriptionConfiguration.length;++D)_.videoSubscriptionConfiguration[D]=M.SdkVideoSubscriptionConfiguration.toObject(S.videoSubscriptionConfiguration[D],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkSubscribeFrame"},x}(),M.SdkSubscribeAckFrame=function(){function x(S){if(this.allocations=[],this.tracks=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.duplex=1,x.prototype.allocations=R.emptyArray,x.prototype.sdpAnswer="",x.prototype.tracks=R.emptyArray,x.prototype.compressedSdpAnswer=R.newBuffer([]),x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.duplex!=null&&Object.hasOwnProperty.call(S,"duplex")&&T.uint32(8).int32(S.duplex),S.allocations!=null&&S.allocations.length)for(var _=0;_<S.allocations.length;++_)M.SdkStreamAllocation.encode(S.allocations[_],T.uint32(18).fork()).ldelim();if(S.sdpAnswer!=null&&Object.hasOwnProperty.call(S,"sdpAnswer")&&T.uint32(26).string(S.sdpAnswer),S.tracks!=null&&S.tracks.length)for(var _=0;_<S.tracks.length;++_)M.SdkTrackMapping.encode(S.tracks[_],T.uint32(34).fork()).ldelim();return S.compressedSdpAnswer!=null&&Object.hasOwnProperty.call(S,"compressedSdpAnswer")&&T.uint32(42).bytes(S.compressedSdpAnswer),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkSubscribeAckFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.duplex=S.int32();break}case 2:{D.allocations&&D.allocations.length||(D.allocations=[]),D.allocations.push(M.SdkStreamAllocation.decode(S,S.uint32()));break}case 3:{D.sdpAnswer=S.string();break}case 4:{D.tracks&&D.tracks.length||(D.tracks=[]),D.tracks.push(M.SdkTrackMapping.decode(S,S.uint32()));break}case 5:{D.compressedSdpAnswer=S.bytes();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.duplex!=null&&S.hasOwnProperty("duplex"))switch(S.duplex){default:return"duplex: enum value expected";case 1:case 2:case 3:break}if(S.allocations!=null&&S.hasOwnProperty("allocations")){if(!Array.isArray(S.allocations))return"allocations: array expected";for(var T=0;T<S.allocations.length;++T){var _=M.SdkStreamAllocation.verify(S.allocations[T]);if(_)return"allocations."+_}}if(S.sdpAnswer!=null&&S.hasOwnProperty("sdpAnswer")&&!R.isString(S.sdpAnswer))return"sdpAnswer: string expected";if(S.tracks!=null&&S.hasOwnProperty("tracks")){if(!Array.isArray(S.tracks))return"tracks: array expected";for(var T=0;T<S.tracks.length;++T){var _=M.SdkTrackMapping.verify(S.tracks[T]);if(_)return"tracks."+_}}return S.compressedSdpAnswer!=null&&S.hasOwnProperty("compressedSdpAnswer")&&!(S.compressedSdpAnswer&&typeof S.compressedSdpAnswer.length=="number"||R.isString(S.compressedSdpAnswer))?"compressedSdpAnswer: buffer expected":null},x.fromObject=function(S){if(S instanceof M.SdkSubscribeAckFrame)return S;var T=new M.SdkSubscribeAckFrame;switch(S.duplex){default:if(typeof S.duplex=="number"){T.duplex=S.duplex;break}break;case"RX":case 1:T.duplex=1;break;case"TX":case 2:T.duplex=2;break;case"DUPLEX":case 3:T.duplex=3;break}if(S.allocations){if(!Array.isArray(S.allocations))throw TypeError(".SdkSubscribeAckFrame.allocations: array expected");T.allocations=[];for(var _=0;_<S.allocations.length;++_){if(typeof S.allocations[_]!="object")throw TypeError(".SdkSubscribeAckFrame.allocations: object expected");T.allocations[_]=M.SdkStreamAllocation.fromObject(S.allocations[_])}}if(S.sdpAnswer!=null&&(T.sdpAnswer=String(S.sdpAnswer)),S.tracks){if(!Array.isArray(S.tracks))throw TypeError(".SdkSubscribeAckFrame.tracks: array expected");T.tracks=[];for(var _=0;_<S.tracks.length;++_){if(typeof S.tracks[_]!="object")throw TypeError(".SdkSubscribeAckFrame.tracks: object expected");T.tracks[_]=M.SdkTrackMapping.fromObject(S.tracks[_])}}return S.compressedSdpAnswer!=null&&(typeof S.compressedSdpAnswer=="string"?R.base64.decode(S.compressedSdpAnswer,T.compressedSdpAnswer=R.newBuffer(R.base64.length(S.compressedSdpAnswer)),0):S.compressedSdpAnswer.length>=0&&(T.compressedSdpAnswer=S.compressedSdpAnswer)),T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.allocations=[],_.tracks=[]),T.defaults&&(_.duplex=T.enums===String?"RX":1,_.sdpAnswer="",T.bytes===String?_.compressedSdpAnswer="":(_.compressedSdpAnswer=[],T.bytes!==Array&&(_.compressedSdpAnswer=R.newBuffer(_.compressedSdpAnswer)))),S.duplex!=null&&S.hasOwnProperty("duplex")&&(_.duplex=T.enums===String?M.SdkStreamServiceType[S.duplex]===void 0?S.duplex:M.SdkStreamServiceType[S.duplex]:S.duplex),S.allocations&&S.allocations.length){_.allocations=[];for(var D=0;D<S.allocations.length;++D)_.allocations[D]=M.SdkStreamAllocation.toObject(S.allocations[D],T)}if(S.sdpAnswer!=null&&S.hasOwnProperty("sdpAnswer")&&(_.sdpAnswer=S.sdpAnswer),S.tracks&&S.tracks.length){_.tracks=[];for(var D=0;D<S.tracks.length;++D)_.tracks[D]=M.SdkTrackMapping.toObject(S.tracks[D],T)}return S.compressedSdpAnswer!=null&&S.hasOwnProperty("compressedSdpAnswer")&&(_.compressedSdpAnswer=T.bytes===String?R.base64.encode(S.compressedSdpAnswer,0,S.compressedSdpAnswer.length):T.bytes===Array?Array.prototype.slice.call(S.compressedSdpAnswer):S.compressedSdpAnswer),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkSubscribeAckFrame"},x}(),M.SdkIndexFrame=function(){function x(S){if(this.sources=[],this.pausedAtSourceIds=[],this.supportedReceiveCodecIntersection=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.atCapacity=!1,x.prototype.sources=R.emptyArray,x.prototype.pausedAtSourceIds=R.emptyArray,x.prototype.numParticipants=0,x.prototype.supportedReceiveCodecIntersection=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.atCapacity!=null&&Object.hasOwnProperty.call(S,"atCapacity")&&T.uint32(8).bool(S.atCapacity),S.sources!=null&&S.sources.length)for(var _=0;_<S.sources.length;++_)M.SdkStreamDescriptor.encode(S.sources[_],T.uint32(18).fork()).ldelim();if(S.pausedAtSourceIds!=null&&S.pausedAtSourceIds.length)for(var _=0;_<S.pausedAtSourceIds.length;++_)T.uint32(24).uint32(S.pausedAtSourceIds[_]);if(S.numParticipants!=null&&Object.hasOwnProperty.call(S,"numParticipants")&&T.uint32(32).uint32(S.numParticipants),S.supportedReceiveCodecIntersection!=null&&S.supportedReceiveCodecIntersection.length)for(var _=0;_<S.supportedReceiveCodecIntersection.length;++_)T.uint32(40).int32(S.supportedReceiveCodecIntersection[_]);return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkIndexFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.atCapacity=S.bool();break}case 2:{D.sources&&D.sources.length||(D.sources=[]),D.sources.push(M.SdkStreamDescriptor.decode(S,S.uint32()));break}case 3:{if(D.pausedAtSourceIds&&D.pausedAtSourceIds.length||(D.pausedAtSourceIds=[]),(Y&7)===2)for(var ee=S.uint32()+S.pos;S.pos<ee;)D.pausedAtSourceIds.push(S.uint32());else D.pausedAtSourceIds.push(S.uint32());break}case 4:{D.numParticipants=S.uint32();break}case 5:{if(D.supportedReceiveCodecIntersection&&D.supportedReceiveCodecIntersection.length||(D.supportedReceiveCodecIntersection=[]),(Y&7)===2)for(var ee=S.uint32()+S.pos;S.pos<ee;)D.supportedReceiveCodecIntersection.push(S.int32());else D.supportedReceiveCodecIntersection.push(S.int32());break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.atCapacity!=null&&S.hasOwnProperty("atCapacity")&&typeof S.atCapacity!="boolean")return"atCapacity: boolean expected";if(S.sources!=null&&S.hasOwnProperty("sources")){if(!Array.isArray(S.sources))return"sources: array expected";for(var T=0;T<S.sources.length;++T){var _=M.SdkStreamDescriptor.verify(S.sources[T]);if(_)return"sources."+_}}if(S.pausedAtSourceIds!=null&&S.hasOwnProperty("pausedAtSourceIds")){if(!Array.isArray(S.pausedAtSourceIds))return"pausedAtSourceIds: array expected";for(var T=0;T<S.pausedAtSourceIds.length;++T)if(!R.isInteger(S.pausedAtSourceIds[T]))return"pausedAtSourceIds: integer[] expected"}if(S.numParticipants!=null&&S.hasOwnProperty("numParticipants")&&!R.isInteger(S.numParticipants))return"numParticipants: integer expected";if(S.supportedReceiveCodecIntersection!=null&&S.hasOwnProperty("supportedReceiveCodecIntersection")){if(!Array.isArray(S.supportedReceiveCodecIntersection))return"supportedReceiveCodecIntersection: array expected";for(var T=0;T<S.supportedReceiveCodecIntersection.length;++T)switch(S.supportedReceiveCodecIntersection[T]){default:return"supportedReceiveCodecIntersection: enum value[] expected";case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 11:break}}return null},x.fromObject=function(S){if(S instanceof M.SdkIndexFrame)return S;var T=new M.SdkIndexFrame;if(S.atCapacity!=null&&(T.atCapacity=!!S.atCapacity),S.sources){if(!Array.isArray(S.sources))throw TypeError(".SdkIndexFrame.sources: array expected");T.sources=[];for(var _=0;_<S.sources.length;++_){if(typeof S.sources[_]!="object")throw TypeError(".SdkIndexFrame.sources: object expected");T.sources[_]=M.SdkStreamDescriptor.fromObject(S.sources[_])}}if(S.pausedAtSourceIds){if(!Array.isArray(S.pausedAtSourceIds))throw TypeError(".SdkIndexFrame.pausedAtSourceIds: array expected");T.pausedAtSourceIds=[];for(var _=0;_<S.pausedAtSourceIds.length;++_)T.pausedAtSourceIds[_]=S.pausedAtSourceIds[_]>>>0}if(S.numParticipants!=null&&(T.numParticipants=S.numParticipants>>>0),S.supportedReceiveCodecIntersection){if(!Array.isArray(S.supportedReceiveCodecIntersection))throw TypeError(".SdkIndexFrame.supportedReceiveCodecIntersection: array expected");T.supportedReceiveCodecIntersection=[];for(var _=0;_<S.supportedReceiveCodecIntersection.length;++_)switch(S.supportedReceiveCodecIntersection[_]){default:if(typeof S.supportedReceiveCodecIntersection[_]=="number"){T.supportedReceiveCodecIntersection[_]=S.supportedReceiveCodecIntersection[_];break}case"VP8":case 1:T.supportedReceiveCodecIntersection[_]=1;break;case"H264_BASELINE_PROFILE":case 2:T.supportedReceiveCodecIntersection[_]=2;break;case"H264_CONSTRAINED_BASELINE_PROFILE":case 3:T.supportedReceiveCodecIntersection[_]=3;break;case"H264_MAIN_PROFILE":case 4:T.supportedReceiveCodecIntersection[_]=4;break;case"H264_HIGH_PROFILE":case 5:T.supportedReceiveCodecIntersection[_]=5;break;case"H264_CONSTRAINED_HIGH_PROFILE":case 6:T.supportedReceiveCodecIntersection[_]=6;break;case"VP9_PROFILE_0":case 8:T.supportedReceiveCodecIntersection[_]=8;break;case"AV1_MAIN_PROFILE":case 11:T.supportedReceiveCodecIntersection[_]=11;break}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.sources=[],_.pausedAtSourceIds=[],_.supportedReceiveCodecIntersection=[]),T.defaults&&(_.atCapacity=!1,_.numParticipants=0),S.atCapacity!=null&&S.hasOwnProperty("atCapacity")&&(_.atCapacity=S.atCapacity),S.sources&&S.sources.length){_.sources=[];for(var D=0;D<S.sources.length;++D)_.sources[D]=M.SdkStreamDescriptor.toObject(S.sources[D],T)}if(S.pausedAtSourceIds&&S.pausedAtSourceIds.length){_.pausedAtSourceIds=[];for(var D=0;D<S.pausedAtSourceIds.length;++D)_.pausedAtSourceIds[D]=S.pausedAtSourceIds[D]}if(S.numParticipants!=null&&S.hasOwnProperty("numParticipants")&&(_.numParticipants=S.numParticipants),S.supportedReceiveCodecIntersection&&S.supportedReceiveCodecIntersection.length){_.supportedReceiveCodecIntersection=[];for(var D=0;D<S.supportedReceiveCodecIntersection.length;++D)_.supportedReceiveCodecIntersection[D]=T.enums===String?M.SdkVideoCodecCapability[S.supportedReceiveCodecIntersection[D]]===void 0?S.supportedReceiveCodecIntersection[D]:M.SdkVideoCodecCapability[S.supportedReceiveCodecIntersection[D]]:S.supportedReceiveCodecIntersection[D]}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkIndexFrame"},x}(),M.SdkPauseResumeFrame=function(){function x(S){if(this.streamIds=[],this.groupIds=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.streamIds=R.emptyArray,x.prototype.groupIds=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.streamIds!=null&&S.streamIds.length)for(var _=0;_<S.streamIds.length;++_)T.uint32(8).uint32(S.streamIds[_]);if(S.groupIds!=null&&S.groupIds.length)for(var _=0;_<S.groupIds.length;++_)T.uint32(16).uint32(S.groupIds[_]);return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkPauseResumeFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{if(D.streamIds&&D.streamIds.length||(D.streamIds=[]),(Y&7)===2)for(var ee=S.uint32()+S.pos;S.pos<ee;)D.streamIds.push(S.uint32());else D.streamIds.push(S.uint32());break}case 2:{if(D.groupIds&&D.groupIds.length||(D.groupIds=[]),(Y&7)===2)for(var ee=S.uint32()+S.pos;S.pos<ee;)D.groupIds.push(S.uint32());else D.groupIds.push(S.uint32());break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.streamIds!=null&&S.hasOwnProperty("streamIds")){if(!Array.isArray(S.streamIds))return"streamIds: array expected";for(var T=0;T<S.streamIds.length;++T)if(!R.isInteger(S.streamIds[T]))return"streamIds: integer[] expected"}if(S.groupIds!=null&&S.hasOwnProperty("groupIds")){if(!Array.isArray(S.groupIds))return"groupIds: array expected";for(var T=0;T<S.groupIds.length;++T)if(!R.isInteger(S.groupIds[T]))return"groupIds: integer[] expected"}return null},x.fromObject=function(S){if(S instanceof M.SdkPauseResumeFrame)return S;var T=new M.SdkPauseResumeFrame;if(S.streamIds){if(!Array.isArray(S.streamIds))throw TypeError(".SdkPauseResumeFrame.streamIds: array expected");T.streamIds=[];for(var _=0;_<S.streamIds.length;++_)T.streamIds[_]=S.streamIds[_]>>>0}if(S.groupIds){if(!Array.isArray(S.groupIds))throw TypeError(".SdkPauseResumeFrame.groupIds: array expected");T.groupIds=[];for(var _=0;_<S.groupIds.length;++_)T.groupIds[_]=S.groupIds[_]>>>0}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.streamIds=[],_.groupIds=[]),S.streamIds&&S.streamIds.length){_.streamIds=[];for(var D=0;D<S.streamIds.length;++D)_.streamIds[D]=S.streamIds[D]}if(S.groupIds&&S.groupIds.length){_.groupIds=[];for(var D=0;D<S.groupIds.length;++D)_.groupIds[D]=S.groupIds[D]}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkPauseResumeFrame"},x}(),M.SdkBitrateFrame=function(){function x(S){if(this.bitrates=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.bitrates=R.emptyArray,x.prototype.serverAvailableOutgoingBitrate=0,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.bitrates!=null&&S.bitrates.length)for(var _=0;_<S.bitrates.length;++_)M.SdkBitrate.encode(S.bitrates[_],T.uint32(10).fork()).ldelim();return S.serverAvailableOutgoingBitrate!=null&&Object.hasOwnProperty.call(S,"serverAvailableOutgoingBitrate")&&T.uint32(16).uint32(S.serverAvailableOutgoingBitrate),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkBitrateFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.bitrates&&D.bitrates.length||(D.bitrates=[]),D.bitrates.push(M.SdkBitrate.decode(S,S.uint32()));break}case 2:{D.serverAvailableOutgoingBitrate=S.uint32();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.bitrates!=null&&S.hasOwnProperty("bitrates")){if(!Array.isArray(S.bitrates))return"bitrates: array expected";for(var T=0;T<S.bitrates.length;++T){var _=M.SdkBitrate.verify(S.bitrates[T]);if(_)return"bitrates."+_}}return S.serverAvailableOutgoingBitrate!=null&&S.hasOwnProperty("serverAvailableOutgoingBitrate")&&!R.isInteger(S.serverAvailableOutgoingBitrate)?"serverAvailableOutgoingBitrate: integer expected":null},x.fromObject=function(S){if(S instanceof M.SdkBitrateFrame)return S;var T=new M.SdkBitrateFrame;if(S.bitrates){if(!Array.isArray(S.bitrates))throw TypeError(".SdkBitrateFrame.bitrates: array expected");T.bitrates=[];for(var _=0;_<S.bitrates.length;++_){if(typeof S.bitrates[_]!="object")throw TypeError(".SdkBitrateFrame.bitrates: object expected");T.bitrates[_]=M.SdkBitrate.fromObject(S.bitrates[_])}}return S.serverAvailableOutgoingBitrate!=null&&(T.serverAvailableOutgoingBitrate=S.serverAvailableOutgoingBitrate>>>0),T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.bitrates=[]),T.defaults&&(_.serverAvailableOutgoingBitrate=0),S.bitrates&&S.bitrates.length){_.bitrates=[];for(var D=0;D<S.bitrates.length;++D)_.bitrates[D]=M.SdkBitrate.toObject(S.bitrates[D],T)}return S.serverAvailableOutgoingBitrate!=null&&S.hasOwnProperty("serverAvailableOutgoingBitrate")&&(_.serverAvailableOutgoingBitrate=S.serverAvailableOutgoingBitrate),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkBitrateFrame"},x}(),M.SdkStreamDescriptor=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.streamId=0,x.prototype.framerate=0,x.prototype.maxBitrateKbps=0,x.prototype.trackLabel="",x.prototype.groupId=0,x.prototype.avgBitrateBps=0,x.prototype.attendeeId="",x.prototype.mediaType=1,x.prototype.externalUserId="",x.prototype.width=0,x.prototype.height=0,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.streamId!=null&&Object.hasOwnProperty.call(S,"streamId")&&T.uint32(8).uint32(S.streamId),S.framerate!=null&&Object.hasOwnProperty.call(S,"framerate")&&T.uint32(16).uint32(S.framerate),S.maxBitrateKbps!=null&&Object.hasOwnProperty.call(S,"maxBitrateKbps")&&T.uint32(24).uint32(S.maxBitrateKbps),S.trackLabel!=null&&Object.hasOwnProperty.call(S,"trackLabel")&&T.uint32(34).string(S.trackLabel),S.groupId!=null&&Object.hasOwnProperty.call(S,"groupId")&&T.uint32(48).uint32(S.groupId),S.avgBitrateBps!=null&&Object.hasOwnProperty.call(S,"avgBitrateBps")&&T.uint32(56).uint32(S.avgBitrateBps),S.attendeeId!=null&&Object.hasOwnProperty.call(S,"attendeeId")&&T.uint32(66).string(S.attendeeId),S.mediaType!=null&&Object.hasOwnProperty.call(S,"mediaType")&&T.uint32(72).int32(S.mediaType),S.externalUserId!=null&&Object.hasOwnProperty.call(S,"externalUserId")&&T.uint32(82).string(S.externalUserId),S.width!=null&&Object.hasOwnProperty.call(S,"width")&&T.uint32(88).uint32(S.width),S.height!=null&&Object.hasOwnProperty.call(S,"height")&&T.uint32(96).uint32(S.height),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkStreamDescriptor;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.streamId=S.uint32();break}case 2:{D.framerate=S.uint32();break}case 3:{D.maxBitrateKbps=S.uint32();break}case 4:{D.trackLabel=S.string();break}case 6:{D.groupId=S.uint32();break}case 7:{D.avgBitrateBps=S.uint32();break}case 8:{D.attendeeId=S.string();break}case 9:{D.mediaType=S.int32();break}case 10:{D.externalUserId=S.string();break}case 11:{D.width=S.uint32();break}case 12:{D.height=S.uint32();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.streamId!=null&&S.hasOwnProperty("streamId")&&!R.isInteger(S.streamId))return"streamId: integer expected";if(S.framerate!=null&&S.hasOwnProperty("framerate")&&!R.isInteger(S.framerate))return"framerate: integer expected";if(S.maxBitrateKbps!=null&&S.hasOwnProperty("maxBitrateKbps")&&!R.isInteger(S.maxBitrateKbps))return"maxBitrateKbps: integer expected";if(S.trackLabel!=null&&S.hasOwnProperty("trackLabel")&&!R.isString(S.trackLabel))return"trackLabel: string expected";if(S.groupId!=null&&S.hasOwnProperty("groupId")&&!R.isInteger(S.groupId))return"groupId: integer expected";if(S.avgBitrateBps!=null&&S.hasOwnProperty("avgBitrateBps")&&!R.isInteger(S.avgBitrateBps))return"avgBitrateBps: integer expected";if(S.attendeeId!=null&&S.hasOwnProperty("attendeeId")&&!R.isString(S.attendeeId))return"attendeeId: string expected";if(S.mediaType!=null&&S.hasOwnProperty("mediaType"))switch(S.mediaType){default:return"mediaType: enum value expected";case 1:case 2:break}return S.externalUserId!=null&&S.hasOwnProperty("externalUserId")&&!R.isString(S.externalUserId)?"externalUserId: string expected":S.width!=null&&S.hasOwnProperty("width")&&!R.isInteger(S.width)?"width: integer expected":S.height!=null&&S.hasOwnProperty("height")&&!R.isInteger(S.height)?"height: integer expected":null},x.fromObject=function(S){if(S instanceof M.SdkStreamDescriptor)return S;var T=new M.SdkStreamDescriptor;switch(S.streamId!=null&&(T.streamId=S.streamId>>>0),S.framerate!=null&&(T.framerate=S.framerate>>>0),S.maxBitrateKbps!=null&&(T.maxBitrateKbps=S.maxBitrateKbps>>>0),S.trackLabel!=null&&(T.trackLabel=String(S.trackLabel)),S.groupId!=null&&(T.groupId=S.groupId>>>0),S.avgBitrateBps!=null&&(T.avgBitrateBps=S.avgBitrateBps>>>0),S.attendeeId!=null&&(T.attendeeId=String(S.attendeeId)),S.mediaType){default:if(typeof S.mediaType=="number"){T.mediaType=S.mediaType;break}break;case"AUDIO":case 1:T.mediaType=1;break;case"VIDEO":case 2:T.mediaType=2;break}return S.externalUserId!=null&&(T.externalUserId=String(S.externalUserId)),S.width!=null&&(T.width=S.width>>>0),S.height!=null&&(T.height=S.height>>>0),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.streamId=0,_.framerate=0,_.maxBitrateKbps=0,_.trackLabel="",_.groupId=0,_.avgBitrateBps=0,_.attendeeId="",_.mediaType=T.enums===String?"AUDIO":1,_.externalUserId="",_.width=0,_.height=0),S.streamId!=null&&S.hasOwnProperty("streamId")&&(_.streamId=S.streamId),S.framerate!=null&&S.hasOwnProperty("framerate")&&(_.framerate=S.framerate),S.maxBitrateKbps!=null&&S.hasOwnProperty("maxBitrateKbps")&&(_.maxBitrateKbps=S.maxBitrateKbps),S.trackLabel!=null&&S.hasOwnProperty("trackLabel")&&(_.trackLabel=S.trackLabel),S.groupId!=null&&S.hasOwnProperty("groupId")&&(_.groupId=S.groupId),S.avgBitrateBps!=null&&S.hasOwnProperty("avgBitrateBps")&&(_.avgBitrateBps=S.avgBitrateBps),S.attendeeId!=null&&S.hasOwnProperty("attendeeId")&&(_.attendeeId=S.attendeeId),S.mediaType!=null&&S.hasOwnProperty("mediaType")&&(_.mediaType=T.enums===String?M.SdkStreamMediaType[S.mediaType]===void 0?S.mediaType:M.SdkStreamMediaType[S.mediaType]:S.mediaType),S.externalUserId!=null&&S.hasOwnProperty("externalUserId")&&(_.externalUserId=S.externalUserId),S.width!=null&&S.hasOwnProperty("width")&&(_.width=S.width),S.height!=null&&S.hasOwnProperty("height")&&(_.height=S.height),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkStreamDescriptor"},x}(),M.SdkStreamAllocation=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.trackLabel="",x.prototype.streamId=0,x.prototype.groupId=0,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.trackLabel!=null&&Object.hasOwnProperty.call(S,"trackLabel")&&T.uint32(10).string(S.trackLabel),S.streamId!=null&&Object.hasOwnProperty.call(S,"streamId")&&T.uint32(16).uint32(S.streamId),S.groupId!=null&&Object.hasOwnProperty.call(S,"groupId")&&T.uint32(24).uint32(S.groupId),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkStreamAllocation;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.trackLabel=S.string();break}case 2:{D.streamId=S.uint32();break}case 3:{D.groupId=S.uint32();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.trackLabel!=null&&S.hasOwnProperty("trackLabel")&&!R.isString(S.trackLabel)?"trackLabel: string expected":S.streamId!=null&&S.hasOwnProperty("streamId")&&!R.isInteger(S.streamId)?"streamId: integer expected":S.groupId!=null&&S.hasOwnProperty("groupId")&&!R.isInteger(S.groupId)?"groupId: integer expected":null},x.fromObject=function(S){if(S instanceof M.SdkStreamAllocation)return S;var T=new M.SdkStreamAllocation;return S.trackLabel!=null&&(T.trackLabel=String(S.trackLabel)),S.streamId!=null&&(T.streamId=S.streamId>>>0),S.groupId!=null&&(T.groupId=S.groupId>>>0),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.trackLabel="",_.streamId=0,_.groupId=0),S.trackLabel!=null&&S.hasOwnProperty("trackLabel")&&(_.trackLabel=S.trackLabel),S.streamId!=null&&S.hasOwnProperty("streamId")&&(_.streamId=S.streamId),S.groupId!=null&&S.hasOwnProperty("groupId")&&(_.groupId=S.groupId),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkStreamAllocation"},x}(),M.SdkTrackMapping=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.streamId=0,x.prototype.ssrc=0,x.prototype.trackLabel="",x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.streamId!=null&&Object.hasOwnProperty.call(S,"streamId")&&T.uint32(8).uint32(S.streamId),S.ssrc!=null&&Object.hasOwnProperty.call(S,"ssrc")&&T.uint32(16).uint32(S.ssrc),S.trackLabel!=null&&Object.hasOwnProperty.call(S,"trackLabel")&&T.uint32(26).string(S.trackLabel),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTrackMapping;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.streamId=S.uint32();break}case 2:{D.ssrc=S.uint32();break}case 3:{D.trackLabel=S.string();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.streamId!=null&&S.hasOwnProperty("streamId")&&!R.isInteger(S.streamId)?"streamId: integer expected":S.ssrc!=null&&S.hasOwnProperty("ssrc")&&!R.isInteger(S.ssrc)?"ssrc: integer expected":S.trackLabel!=null&&S.hasOwnProperty("trackLabel")&&!R.isString(S.trackLabel)?"trackLabel: string expected":null},x.fromObject=function(S){if(S instanceof M.SdkTrackMapping)return S;var T=new M.SdkTrackMapping;return S.streamId!=null&&(T.streamId=S.streamId>>>0),S.ssrc!=null&&(T.ssrc=S.ssrc>>>0),S.trackLabel!=null&&(T.trackLabel=String(S.trackLabel)),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.streamId=0,_.ssrc=0,_.trackLabel=""),S.streamId!=null&&S.hasOwnProperty("streamId")&&(_.streamId=S.streamId),S.ssrc!=null&&S.hasOwnProperty("ssrc")&&(_.ssrc=S.ssrc),S.trackLabel!=null&&S.hasOwnProperty("trackLabel")&&(_.trackLabel=S.trackLabel),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTrackMapping"},x}(),M.SdkBitrate=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.sourceStreamId=0,x.prototype.avgBitrateBps=0,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.sourceStreamId!=null&&Object.hasOwnProperty.call(S,"sourceStreamId")&&T.uint32(8).uint32(S.sourceStreamId),S.avgBitrateBps!=null&&Object.hasOwnProperty.call(S,"avgBitrateBps")&&T.uint32(16).uint32(S.avgBitrateBps),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkBitrate;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.sourceStreamId=S.uint32();break}case 2:{D.avgBitrateBps=S.uint32();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.sourceStreamId!=null&&S.hasOwnProperty("sourceStreamId")&&!R.isInteger(S.sourceStreamId)?"sourceStreamId: integer expected":S.avgBitrateBps!=null&&S.hasOwnProperty("avgBitrateBps")&&!R.isInteger(S.avgBitrateBps)?"avgBitrateBps: integer expected":null},x.fromObject=function(S){if(S instanceof M.SdkBitrate)return S;var T=new M.SdkBitrate;return S.sourceStreamId!=null&&(T.sourceStreamId=S.sourceStreamId>>>0),S.avgBitrateBps!=null&&(T.avgBitrateBps=S.avgBitrateBps>>>0),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.sourceStreamId=0,_.avgBitrateBps=0),S.sourceStreamId!=null&&S.hasOwnProperty("sourceStreamId")&&(_.sourceStreamId=S.sourceStreamId),S.avgBitrateBps!=null&&S.hasOwnProperty("avgBitrateBps")&&(_.avgBitrateBps=S.avgBitrateBps),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkBitrate"},x}(),M.SdkAudioControlFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.muted=!1,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.muted!=null&&Object.hasOwnProperty.call(S,"muted")&&T.uint32(8).bool(S.muted),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkAudioControlFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.muted=S.bool();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.muted!=null&&S.hasOwnProperty("muted")&&typeof S.muted!="boolean"?"muted: boolean expected":null},x.fromObject=function(S){if(S instanceof M.SdkAudioControlFrame)return S;var T=new M.SdkAudioControlFrame;return S.muted!=null&&(T.muted=!!S.muted),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.muted=!1),S.muted!=null&&S.hasOwnProperty("muted")&&(_.muted=S.muted),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkAudioControlFrame"},x}(),M.SdkAudioMetadataFrame=function(){function x(S){if(this.attendeeStates=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.attendeeStates=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.attendeeStates!=null&&S.attendeeStates.length)for(var _=0;_<S.attendeeStates.length;++_)M.SdkAudioAttendeeState.encode(S.attendeeStates[_],T.uint32(10).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkAudioMetadataFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.attendeeStates&&D.attendeeStates.length||(D.attendeeStates=[]),D.attendeeStates.push(M.SdkAudioAttendeeState.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.attendeeStates!=null&&S.hasOwnProperty("attendeeStates")){if(!Array.isArray(S.attendeeStates))return"attendeeStates: array expected";for(var T=0;T<S.attendeeStates.length;++T){var _=M.SdkAudioAttendeeState.verify(S.attendeeStates[T]);if(_)return"attendeeStates."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkAudioMetadataFrame)return S;var T=new M.SdkAudioMetadataFrame;if(S.attendeeStates){if(!Array.isArray(S.attendeeStates))throw TypeError(".SdkAudioMetadataFrame.attendeeStates: array expected");T.attendeeStates=[];for(var _=0;_<S.attendeeStates.length;++_){if(typeof S.attendeeStates[_]!="object")throw TypeError(".SdkAudioMetadataFrame.attendeeStates: object expected");T.attendeeStates[_]=M.SdkAudioAttendeeState.fromObject(S.attendeeStates[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.attendeeStates=[]),S.attendeeStates&&S.attendeeStates.length){_.attendeeStates=[];for(var D=0;D<S.attendeeStates.length;++D)_.attendeeStates[D]=M.SdkAudioAttendeeState.toObject(S.attendeeStates[D],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkAudioMetadataFrame"},x}(),M.SdkAudioAttendeeState=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.audioStreamId=0,x.prototype.volume=0,x.prototype.muted=!1,x.prototype.signalStrength=0,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.audioStreamId!=null&&Object.hasOwnProperty.call(S,"audioStreamId")&&T.uint32(8).uint32(S.audioStreamId),S.volume!=null&&Object.hasOwnProperty.call(S,"volume")&&T.uint32(16).uint32(S.volume),S.muted!=null&&Object.hasOwnProperty.call(S,"muted")&&T.uint32(24).bool(S.muted),S.signalStrength!=null&&Object.hasOwnProperty.call(S,"signalStrength")&&T.uint32(32).uint32(S.signalStrength),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkAudioAttendeeState;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.audioStreamId=S.uint32();break}case 2:{D.volume=S.uint32();break}case 3:{D.muted=S.bool();break}case 4:{D.signalStrength=S.uint32();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.audioStreamId!=null&&S.hasOwnProperty("audioStreamId")&&!R.isInteger(S.audioStreamId)?"audioStreamId: integer expected":S.volume!=null&&S.hasOwnProperty("volume")&&!R.isInteger(S.volume)?"volume: integer expected":S.muted!=null&&S.hasOwnProperty("muted")&&typeof S.muted!="boolean"?"muted: boolean expected":S.signalStrength!=null&&S.hasOwnProperty("signalStrength")&&!R.isInteger(S.signalStrength)?"signalStrength: integer expected":null},x.fromObject=function(S){if(S instanceof M.SdkAudioAttendeeState)return S;var T=new M.SdkAudioAttendeeState;return S.audioStreamId!=null&&(T.audioStreamId=S.audioStreamId>>>0),S.volume!=null&&(T.volume=S.volume>>>0),S.muted!=null&&(T.muted=!!S.muted),S.signalStrength!=null&&(T.signalStrength=S.signalStrength>>>0),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.audioStreamId=0,_.volume=0,_.muted=!1,_.signalStrength=0),S.audioStreamId!=null&&S.hasOwnProperty("audioStreamId")&&(_.audioStreamId=S.audioStreamId),S.volume!=null&&S.hasOwnProperty("volume")&&(_.volume=S.volume),S.muted!=null&&S.hasOwnProperty("muted")&&(_.muted=S.muted),S.signalStrength!=null&&S.hasOwnProperty("signalStrength")&&(_.signalStrength=S.signalStrength),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkAudioAttendeeState"},x}(),M.SdkAudioStreamIdInfoFrame=function(){function x(S){if(this.streams=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.streams=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.streams!=null&&S.streams.length)for(var _=0;_<S.streams.length;++_)M.SdkAudioStreamIdInfo.encode(S.streams[_],T.uint32(10).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkAudioStreamIdInfoFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.streams&&D.streams.length||(D.streams=[]),D.streams.push(M.SdkAudioStreamIdInfo.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.streams!=null&&S.hasOwnProperty("streams")){if(!Array.isArray(S.streams))return"streams: array expected";for(var T=0;T<S.streams.length;++T){var _=M.SdkAudioStreamIdInfo.verify(S.streams[T]);if(_)return"streams."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkAudioStreamIdInfoFrame)return S;var T=new M.SdkAudioStreamIdInfoFrame;if(S.streams){if(!Array.isArray(S.streams))throw TypeError(".SdkAudioStreamIdInfoFrame.streams: array expected");T.streams=[];for(var _=0;_<S.streams.length;++_){if(typeof S.streams[_]!="object")throw TypeError(".SdkAudioStreamIdInfoFrame.streams: object expected");T.streams[_]=M.SdkAudioStreamIdInfo.fromObject(S.streams[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.streams=[]),S.streams&&S.streams.length){_.streams=[];for(var D=0;D<S.streams.length;++D)_.streams[D]=M.SdkAudioStreamIdInfo.toObject(S.streams[D],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkAudioStreamIdInfoFrame"},x}(),M.SdkAudioStreamIdInfo=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.audioStreamId=0,x.prototype.attendeeId="",x.prototype.muted=!1,x.prototype.externalUserId="",x.prototype.dropped=!1,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.audioStreamId!=null&&Object.hasOwnProperty.call(S,"audioStreamId")&&T.uint32(8).uint32(S.audioStreamId),S.attendeeId!=null&&Object.hasOwnProperty.call(S,"attendeeId")&&T.uint32(18).string(S.attendeeId),S.muted!=null&&Object.hasOwnProperty.call(S,"muted")&&T.uint32(24).bool(S.muted),S.externalUserId!=null&&Object.hasOwnProperty.call(S,"externalUserId")&&T.uint32(34).string(S.externalUserId),S.dropped!=null&&Object.hasOwnProperty.call(S,"dropped")&&T.uint32(40).bool(S.dropped),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkAudioStreamIdInfo;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.audioStreamId=S.uint32();break}case 2:{D.attendeeId=S.string();break}case 3:{D.muted=S.bool();break}case 4:{D.externalUserId=S.string();break}case 5:{D.dropped=S.bool();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.audioStreamId!=null&&S.hasOwnProperty("audioStreamId")&&!R.isInteger(S.audioStreamId)?"audioStreamId: integer expected":S.attendeeId!=null&&S.hasOwnProperty("attendeeId")&&!R.isString(S.attendeeId)?"attendeeId: string expected":S.muted!=null&&S.hasOwnProperty("muted")&&typeof S.muted!="boolean"?"muted: boolean expected":S.externalUserId!=null&&S.hasOwnProperty("externalUserId")&&!R.isString(S.externalUserId)?"externalUserId: string expected":S.dropped!=null&&S.hasOwnProperty("dropped")&&typeof S.dropped!="boolean"?"dropped: boolean expected":null},x.fromObject=function(S){if(S instanceof M.SdkAudioStreamIdInfo)return S;var T=new M.SdkAudioStreamIdInfo;return S.audioStreamId!=null&&(T.audioStreamId=S.audioStreamId>>>0),S.attendeeId!=null&&(T.attendeeId=String(S.attendeeId)),S.muted!=null&&(T.muted=!!S.muted),S.externalUserId!=null&&(T.externalUserId=String(S.externalUserId)),S.dropped!=null&&(T.dropped=!!S.dropped),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.audioStreamId=0,_.attendeeId="",_.muted=!1,_.externalUserId="",_.dropped=!1),S.audioStreamId!=null&&S.hasOwnProperty("audioStreamId")&&(_.audioStreamId=S.audioStreamId),S.attendeeId!=null&&S.hasOwnProperty("attendeeId")&&(_.attendeeId=S.attendeeId),S.muted!=null&&S.hasOwnProperty("muted")&&(_.muted=S.muted),S.externalUserId!=null&&S.hasOwnProperty("externalUserId")&&(_.externalUserId=S.externalUserId),S.dropped!=null&&S.hasOwnProperty("dropped")&&(_.dropped=S.dropped),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkAudioStreamIdInfo"},x}(),M.SdkPingPongType=function(){var x={},S=Object.create(x);return S[x[1]="PING"]=1,S[x[2]="PONG"]=2,S}(),M.SdkPingPongFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.type=1,x.prototype.pingId=0,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),T.uint32(8).int32(S.type),T.uint32(16).uint32(S.pingId),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkPingPongFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.type=S.int32();break}case 2:{D.pingId=S.uint32();break}default:S.skipType(Y&7);break}}if(!D.hasOwnProperty("type"))throw R.ProtocolError("missing required 'type'",{instance:D});if(!D.hasOwnProperty("pingId"))throw R.ProtocolError("missing required 'pingId'",{instance:D});return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";switch(S.type){default:return"type: enum value expected";case 1:case 2:break}return R.isInteger(S.pingId)?null:"pingId: integer expected"},x.fromObject=function(S){if(S instanceof M.SdkPingPongFrame)return S;var T=new M.SdkPingPongFrame;switch(S.type){default:if(typeof S.type=="number"){T.type=S.type;break}break;case"PING":case 1:T.type=1;break;case"PONG":case 2:T.type=2;break}return S.pingId!=null&&(T.pingId=S.pingId>>>0),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.type=T.enums===String?"PING":1,_.pingId=0),S.type!=null&&S.hasOwnProperty("type")&&(_.type=T.enums===String?M.SdkPingPongType[S.type]===void 0?S.type:M.SdkPingPongType[S.type]:S.type),S.pingId!=null&&S.hasOwnProperty("pingId")&&(_.pingId=S.pingId),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkPingPongFrame"},x}(),M.SdkAudioStatusFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.audioStatus=0,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.audioStatus!=null&&Object.hasOwnProperty.call(S,"audioStatus")&&T.uint32(8).uint32(S.audioStatus),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkAudioStatusFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.audioStatus=S.uint32();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.audioStatus!=null&&S.hasOwnProperty("audioStatus")&&!R.isInteger(S.audioStatus)?"audioStatus: integer expected":null},x.fromObject=function(S){if(S instanceof M.SdkAudioStatusFrame)return S;var T=new M.SdkAudioStatusFrame;return S.audioStatus!=null&&(T.audioStatus=S.audioStatus>>>0),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.audioStatus=0),S.audioStatus!=null&&S.hasOwnProperty("audioStatus")&&(_.audioStatus=S.audioStatus),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkAudioStatusFrame"},x}(),M.SdkMetric=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.type=1,x.prototype.value=0,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.type!=null&&Object.hasOwnProperty.call(S,"type")&&T.uint32(8).int32(S.type),S.value!=null&&Object.hasOwnProperty.call(S,"value")&&T.uint32(17).double(S.value),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkMetric;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.type=S.int32();break}case 2:{D.value=S.double();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.type!=null&&S.hasOwnProperty("type"))switch(S.type){default:return"type: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 64:case 66:case 69:case 72:case 86:case 87:case 88:case 89:case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:break}return S.value!=null&&S.hasOwnProperty("value")&&typeof S.value!="number"?"value: number expected":null},x.fromObject=function(S){if(S instanceof M.SdkMetric)return S;var T=new M.SdkMetric;switch(S.type){default:if(typeof S.type=="number"){T.type=S.type;break}break;case"VIDEO_ACTUAL_ENCODER_BITRATE":case 1:T.type=1;break;case"VIDEO_AVAILABLE_SEND_BANDWIDTH":case 2:T.type=2;break;case"VIDEO_RETRANSMIT_BITRATE":case 3:T.type=3;break;case"VIDEO_AVAILABLE_RECEIVE_BANDWIDTH":case 4:T.type=4;break;case"VIDEO_TARGET_ENCODER_BITRATE":case 5:T.type=5;break;case"VIDEO_BUCKET_DELAY_MS":case 6:T.type=6;break;case"STUN_RTT_MS":case 7:T.type=7;break;case"SOCKET_DISCARDED_PPS":case 8:T.type=8;break;case"RTC_MIC_JITTER_MS":case 9:T.type=9;break;case"RTC_MIC_PPS":case 10:T.type=10;break;case"RTC_MIC_FRACTION_PACKET_LOST_PERCENT":case 11:T.type=11;break;case"RTC_MIC_BITRATE":case 12:T.type=12;break;case"RTC_MIC_RTT_MS":case 13:T.type=13;break;case"RTC_SPK_PPS":case 14:T.type=14;break;case"RTC_SPK_FRACTION_PACKET_LOST_PERCENT":case 15:T.type=15;break;case"RTC_SPK_JITTER_MS":case 16:T.type=16;break;case"RTC_SPK_FRACTION_DECODER_LOSS_PERCENT":case 17:T.type=17;break;case"RTC_SPK_BITRATE":case 18:T.type=18;break;case"RTC_SPK_CURRENT_DELAY_MS":case 19:T.type=19;break;case"RTC_SPK_JITTER_BUFFER_MS":case 20:T.type=20;break;case"VIDEO_SENT_RTT_MS":case 21:T.type=21;break;case"VIDEO_ENCODE_USAGE_PERCENT":case 22:T.type=22;break;case"VIDEO_NACKS_RECEIVED":case 23:T.type=23;break;case"VIDEO_PLIS_RECEIVED":case 24:T.type=24;break;case"VIDEO_ENCODE_MS":case 25:T.type=25;break;case"VIDEO_INPUT_FPS":case 26:T.type=26;break;case"VIDEO_ENCODE_FPS":case 27:T.type=27;break;case"VIDEO_SENT_FPS":case 28:T.type=28;break;case"VIDEO_FIRS_RECEIVED":case 29:T.type=29;break;case"VIDEO_SENT_PPS":case 30:T.type=30;break;case"VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT":case 31:T.type=31;break;case"VIDEO_SENT_BITRATE":case 32:T.type=32;break;case"VIDEO_DROPPED_FPS":case 33:T.type=33;break;case"VIDEO_TARGET_DELAY_MS":case 34:T.type=34;break;case"VIDEO_DECODE_MS":case 35:T.type=35;break;case"VIDEO_OUTPUT_FPS":case 36:T.type=36;break;case"VIDEO_RECEIVED_PPS":case 37:T.type=37;break;case"VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT":case 38:T.type=38;break;case"VIDEO_RENDER_DELAY_MS":case 39:T.type=39;break;case"VIDEO_RECEIVED_FPS":case 40:T.type=40;break;case"VIDEO_DECODE_FPS":case 41:T.type=41;break;case"VIDEO_NACKS_SENT":case 42:T.type=42;break;case"VIDEO_FIRS_SENT":case 43:T.type=43;break;case"VIDEO_RECEIVED_BITRATE":case 44:T.type=44;break;case"VIDEO_CURRENT_DELAY_MS":case 45:T.type=45;break;case"VIDEO_JITTER_BUFFER_MS":case 46:T.type=46;break;case"VIDEO_DISCARDED_PPS":case 47:T.type=47;break;case"VIDEO_PLIS_SENT":case 48:T.type=48;break;case"VIDEO_RECEIVED_JITTER_MS":case 49:T.type=49;break;case"VIDEO_ENCODE_HEIGHT":case 64:T.type=64;break;case"VIDEO_SENT_QP_SUM":case 66:T.type=66;break;case"VIDEO_DECODE_HEIGHT":case 69:T.type=69;break;case"VIDEO_RECEIVED_QP_SUM":case 72:T.type=72;break;case"VIDEO_ENCODE_WIDTH":case 86:T.type=86;break;case"VIDEO_DECODE_WIDTH":case 87:T.type=87;break;case"VIDEO_ENCODER_IS_HARDWARE":case 88:T.type=88;break;case"VIDEO_DECODER_IS_HARDWARE":case 89:T.type=89;break;case"VIDEO_FREEZE_COUNT":case 90:T.type=90;break;case"VIDEO_FREEZE_DURATION":case 91:T.type=91;break;case"VIDEO_PAUSE_COUNT":case 92:T.type=92;break;case"VIDEO_PAUSE_DURATION":case 93:T.type=93;break;case"VIDEO_QUALITY_REASON":case 94:T.type=94;break;case"VIDEO_PROCESSING_TIME":case 95:T.type=95;break;case"RTC_SPK_AUDIO_LEVEL":case 96:T.type=96;break;case"RTC_MIC_AUDIO_LEVEL":case 97:T.type=97;break;case"RTC_SPK_TOTAL_LOST":case 98:T.type=98;break;case"RTC_SPK_TOTAL_EXPECTED":case 99:T.type=99;break;case"RTC_SPK_TOTAL_RECOVERED_RED":case 100:T.type=100;break;case"RTC_SPK_TOTAL_RECOVERED_FEC":case 101:T.type=101;break;case"VIDEO_QUALITY_LIMITATION_DURATION_CPU":case 102:T.type=102;break;case"VIDEO_CODEC_DEGRADATION_HIGH_ENCODE_CPU":case 103:T.type=103;break;case"VIDEO_CODEC_DEGRADATION_ENCODE_FAILURE":case 104:T.type=104;break}return S.value!=null&&(T.value=Number(S.value)),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.type=T.enums===String?"VIDEO_ACTUAL_ENCODER_BITRATE":1,_.value=0),S.type!=null&&S.hasOwnProperty("type")&&(_.type=T.enums===String?M.SdkMetric.Type[S.type]===void 0?S.type:M.SdkMetric.Type[S.type]:S.type),S.value!=null&&S.hasOwnProperty("value")&&(_.value=T.json&&!isFinite(S.value)?String(S.value):S.value),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkMetric"},x.Type=function(){var S={},T=Object.create(S);return T[S[1]="VIDEO_ACTUAL_ENCODER_BITRATE"]=1,T[S[2]="VIDEO_AVAILABLE_SEND_BANDWIDTH"]=2,T[S[3]="VIDEO_RETRANSMIT_BITRATE"]=3,T[S[4]="VIDEO_AVAILABLE_RECEIVE_BANDWIDTH"]=4,T[S[5]="VIDEO_TARGET_ENCODER_BITRATE"]=5,T[S[6]="VIDEO_BUCKET_DELAY_MS"]=6,T[S[7]="STUN_RTT_MS"]=7,T[S[8]="SOCKET_DISCARDED_PPS"]=8,T[S[9]="RTC_MIC_JITTER_MS"]=9,T[S[10]="RTC_MIC_PPS"]=10,T[S[11]="RTC_MIC_FRACTION_PACKET_LOST_PERCENT"]=11,T[S[12]="RTC_MIC_BITRATE"]=12,T[S[13]="RTC_MIC_RTT_MS"]=13,T[S[14]="RTC_SPK_PPS"]=14,T[S[15]="RTC_SPK_FRACTION_PACKET_LOST_PERCENT"]=15,T[S[16]="RTC_SPK_JITTER_MS"]=16,T[S[17]="RTC_SPK_FRACTION_DECODER_LOSS_PERCENT"]=17,T[S[18]="RTC_SPK_BITRATE"]=18,T[S[19]="RTC_SPK_CURRENT_DELAY_MS"]=19,T[S[20]="RTC_SPK_JITTER_BUFFER_MS"]=20,T[S[21]="VIDEO_SENT_RTT_MS"]=21,T[S[22]="VIDEO_ENCODE_USAGE_PERCENT"]=22,T[S[23]="VIDEO_NACKS_RECEIVED"]=23,T[S[24]="VIDEO_PLIS_RECEIVED"]=24,T[S[25]="VIDEO_ENCODE_MS"]=25,T[S[26]="VIDEO_INPUT_FPS"]=26,T[S[27]="VIDEO_ENCODE_FPS"]=27,T[S[28]="VIDEO_SENT_FPS"]=28,T[S[29]="VIDEO_FIRS_RECEIVED"]=29,T[S[30]="VIDEO_SENT_PPS"]=30,T[S[31]="VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT"]=31,T[S[32]="VIDEO_SENT_BITRATE"]=32,T[S[33]="VIDEO_DROPPED_FPS"]=33,T[S[34]="VIDEO_TARGET_DELAY_MS"]=34,T[S[35]="VIDEO_DECODE_MS"]=35,T[S[36]="VIDEO_OUTPUT_FPS"]=36,T[S[37]="VIDEO_RECEIVED_PPS"]=37,T[S[38]="VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT"]=38,T[S[39]="VIDEO_RENDER_DELAY_MS"]=39,T[S[40]="VIDEO_RECEIVED_FPS"]=40,T[S[41]="VIDEO_DECODE_FPS"]=41,T[S[42]="VIDEO_NACKS_SENT"]=42,T[S[43]="VIDEO_FIRS_SENT"]=43,T[S[44]="VIDEO_RECEIVED_BITRATE"]=44,T[S[45]="VIDEO_CURRENT_DELAY_MS"]=45,T[S[46]="VIDEO_JITTER_BUFFER_MS"]=46,T[S[47]="VIDEO_DISCARDED_PPS"]=47,T[S[48]="VIDEO_PLIS_SENT"]=48,T[S[49]="VIDEO_RECEIVED_JITTER_MS"]=49,T[S[64]="VIDEO_ENCODE_HEIGHT"]=64,T[S[66]="VIDEO_SENT_QP_SUM"]=66,T[S[69]="VIDEO_DECODE_HEIGHT"]=69,T[S[72]="VIDEO_RECEIVED_QP_SUM"]=72,T[S[86]="VIDEO_ENCODE_WIDTH"]=86,T[S[87]="VIDEO_DECODE_WIDTH"]=87,T[S[88]="VIDEO_ENCODER_IS_HARDWARE"]=88,T[S[89]="VIDEO_DECODER_IS_HARDWARE"]=89,T[S[90]="VIDEO_FREEZE_COUNT"]=90,T[S[91]="VIDEO_FREEZE_DURATION"]=91,T[S[92]="VIDEO_PAUSE_COUNT"]=92,T[S[93]="VIDEO_PAUSE_DURATION"]=93,T[S[94]="VIDEO_QUALITY_REASON"]=94,T[S[95]="VIDEO_PROCESSING_TIME"]=95,T[S[96]="RTC_SPK_AUDIO_LEVEL"]=96,T[S[97]="RTC_MIC_AUDIO_LEVEL"]=97,T[S[98]="RTC_SPK_TOTAL_LOST"]=98,T[S[99]="RTC_SPK_TOTAL_EXPECTED"]=99,T[S[100]="RTC_SPK_TOTAL_RECOVERED_RED"]=100,T[S[101]="RTC_SPK_TOTAL_RECOVERED_FEC"]=101,T[S[102]="VIDEO_QUALITY_LIMITATION_DURATION_CPU"]=102,T[S[103]="VIDEO_CODEC_DEGRADATION_HIGH_ENCODE_CPU"]=103,T[S[104]="VIDEO_CODEC_DEGRADATION_ENCODE_FAILURE"]=104,T}(),x}(),M.SdkStreamMetricFrame=function(){function x(S){if(this.metrics=[],this.dimensions=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.streamId=0,x.prototype.groupId=0,x.prototype.metrics=R.emptyArray,x.prototype.dimensions=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.streamId!=null&&Object.hasOwnProperty.call(S,"streamId")&&T.uint32(24).uint32(S.streamId),S.groupId!=null&&Object.hasOwnProperty.call(S,"groupId")&&T.uint32(32).uint32(S.groupId),S.metrics!=null&&S.metrics.length)for(var _=0;_<S.metrics.length;++_)M.SdkMetric.encode(S.metrics[_],T.uint32(42).fork()).ldelim();if(S.dimensions!=null&&S.dimensions.length)for(var _=0;_<S.dimensions.length;++_)M.SdkStreamDimension.encode(S.dimensions[_],T.uint32(50).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkStreamMetricFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 3:{D.streamId=S.uint32();break}case 4:{D.groupId=S.uint32();break}case 5:{D.metrics&&D.metrics.length||(D.metrics=[]),D.metrics.push(M.SdkMetric.decode(S,S.uint32()));break}case 6:{D.dimensions&&D.dimensions.length||(D.dimensions=[]),D.dimensions.push(M.SdkStreamDimension.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.streamId!=null&&S.hasOwnProperty("streamId")&&!R.isInteger(S.streamId))return"streamId: integer expected";if(S.groupId!=null&&S.hasOwnProperty("groupId")&&!R.isInteger(S.groupId))return"groupId: integer expected";if(S.metrics!=null&&S.hasOwnProperty("metrics")){if(!Array.isArray(S.metrics))return"metrics: array expected";for(var T=0;T<S.metrics.length;++T){var _=M.SdkMetric.verify(S.metrics[T]);if(_)return"metrics."+_}}if(S.dimensions!=null&&S.hasOwnProperty("dimensions")){if(!Array.isArray(S.dimensions))return"dimensions: array expected";for(var T=0;T<S.dimensions.length;++T){var _=M.SdkStreamDimension.verify(S.dimensions[T]);if(_)return"dimensions."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkStreamMetricFrame)return S;var T=new M.SdkStreamMetricFrame;if(S.streamId!=null&&(T.streamId=S.streamId>>>0),S.groupId!=null&&(T.groupId=S.groupId>>>0),S.metrics){if(!Array.isArray(S.metrics))throw TypeError(".SdkStreamMetricFrame.metrics: array expected");T.metrics=[];for(var _=0;_<S.metrics.length;++_){if(typeof S.metrics[_]!="object")throw TypeError(".SdkStreamMetricFrame.metrics: object expected");T.metrics[_]=M.SdkMetric.fromObject(S.metrics[_])}}if(S.dimensions){if(!Array.isArray(S.dimensions))throw TypeError(".SdkStreamMetricFrame.dimensions: array expected");T.dimensions=[];for(var _=0;_<S.dimensions.length;++_){if(typeof S.dimensions[_]!="object")throw TypeError(".SdkStreamMetricFrame.dimensions: object expected");T.dimensions[_]=M.SdkStreamDimension.fromObject(S.dimensions[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.metrics=[],_.dimensions=[]),T.defaults&&(_.streamId=0,_.groupId=0),S.streamId!=null&&S.hasOwnProperty("streamId")&&(_.streamId=S.streamId),S.groupId!=null&&S.hasOwnProperty("groupId")&&(_.groupId=S.groupId),S.metrics&&S.metrics.length){_.metrics=[];for(var D=0;D<S.metrics.length;++D)_.metrics[D]=M.SdkMetric.toObject(S.metrics[D],T)}if(S.dimensions&&S.dimensions.length){_.dimensions=[];for(var D=0;D<S.dimensions.length;++D)_.dimensions[D]=M.SdkStreamDimension.toObject(S.dimensions[D],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkStreamMetricFrame"},x}(),M.SdkClientMetricFrame=function(){function x(S){if(this.globalMetrics=[],this.streamMetricFrames=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.globalMetrics=R.emptyArray,x.prototype.streamMetricFrames=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.globalMetrics!=null&&S.globalMetrics.length)for(var _=0;_<S.globalMetrics.length;++_)M.SdkMetric.encode(S.globalMetrics[_],T.uint32(10).fork()).ldelim();if(S.streamMetricFrames!=null&&S.streamMetricFrames.length)for(var _=0;_<S.streamMetricFrames.length;++_)M.SdkStreamMetricFrame.encode(S.streamMetricFrames[_],T.uint32(18).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkClientMetricFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.globalMetrics&&D.globalMetrics.length||(D.globalMetrics=[]),D.globalMetrics.push(M.SdkMetric.decode(S,S.uint32()));break}case 2:{D.streamMetricFrames&&D.streamMetricFrames.length||(D.streamMetricFrames=[]),D.streamMetricFrames.push(M.SdkStreamMetricFrame.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.globalMetrics!=null&&S.hasOwnProperty("globalMetrics")){if(!Array.isArray(S.globalMetrics))return"globalMetrics: array expected";for(var T=0;T<S.globalMetrics.length;++T){var _=M.SdkMetric.verify(S.globalMetrics[T]);if(_)return"globalMetrics."+_}}if(S.streamMetricFrames!=null&&S.hasOwnProperty("streamMetricFrames")){if(!Array.isArray(S.streamMetricFrames))return"streamMetricFrames: array expected";for(var T=0;T<S.streamMetricFrames.length;++T){var _=M.SdkStreamMetricFrame.verify(S.streamMetricFrames[T]);if(_)return"streamMetricFrames."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkClientMetricFrame)return S;var T=new M.SdkClientMetricFrame;if(S.globalMetrics){if(!Array.isArray(S.globalMetrics))throw TypeError(".SdkClientMetricFrame.globalMetrics: array expected");T.globalMetrics=[];for(var _=0;_<S.globalMetrics.length;++_){if(typeof S.globalMetrics[_]!="object")throw TypeError(".SdkClientMetricFrame.globalMetrics: object expected");T.globalMetrics[_]=M.SdkMetric.fromObject(S.globalMetrics[_])}}if(S.streamMetricFrames){if(!Array.isArray(S.streamMetricFrames))throw TypeError(".SdkClientMetricFrame.streamMetricFrames: array expected");T.streamMetricFrames=[];for(var _=0;_<S.streamMetricFrames.length;++_){if(typeof S.streamMetricFrames[_]!="object")throw TypeError(".SdkClientMetricFrame.streamMetricFrames: object expected");T.streamMetricFrames[_]=M.SdkStreamMetricFrame.fromObject(S.streamMetricFrames[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.globalMetrics=[],_.streamMetricFrames=[]),S.globalMetrics&&S.globalMetrics.length){_.globalMetrics=[];for(var D=0;D<S.globalMetrics.length;++D)_.globalMetrics[D]=M.SdkMetric.toObject(S.globalMetrics[D],T)}if(S.streamMetricFrames&&S.streamMetricFrames.length){_.streamMetricFrames=[];for(var D=0;D<S.streamMetricFrames.length;++D)_.streamMetricFrames[D]=M.SdkStreamMetricFrame.toObject(S.streamMetricFrames[D],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkClientMetricFrame"},x}(),M.SdkStreamDimension=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.type=1,x.prototype.value=null,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.type!=null&&Object.hasOwnProperty.call(S,"type")&&T.uint32(8).int32(S.type),S.value!=null&&Object.hasOwnProperty.call(S,"value")&&M.SdkDimensionValue.encode(S.value,T.uint32(18).fork()).ldelim(),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkStreamDimension;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.type=S.int32();break}case 2:{D.value=M.SdkDimensionValue.decode(S,S.uint32());break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.type!=null&&S.hasOwnProperty("type"))switch(S.type){default:return"type: enum value expected";case 1:case 2:break}if(S.value!=null&&S.hasOwnProperty("value")){var T=M.SdkDimensionValue.verify(S.value);if(T)return"value."+T}return null},x.fromObject=function(S){if(S instanceof M.SdkStreamDimension)return S;var T=new M.SdkStreamDimension;switch(S.type){default:if(typeof S.type=="number"){T.type=S.type;break}break;case"VIDEO_ENCODER_NAME":case 1:T.type=1;break;case"VIDEO_DECODER_NAME":case 2:T.type=2;break}if(S.value!=null){if(typeof S.value!="object")throw TypeError(".SdkStreamDimension.value: object expected");T.value=M.SdkDimensionValue.fromObject(S.value)}return T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.type=T.enums===String?"VIDEO_ENCODER_NAME":1,_.value=null),S.type!=null&&S.hasOwnProperty("type")&&(_.type=T.enums===String?M.SdkStreamDimension.Type[S.type]===void 0?S.type:M.SdkStreamDimension.Type[S.type]:S.type),S.value!=null&&S.hasOwnProperty("value")&&(_.value=M.SdkDimensionValue.toObject(S.value,T)),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkStreamDimension"},x.Type=function(){var S={},T=Object.create(S);return T[S[1]="VIDEO_ENCODER_NAME"]=1,T[S[2]="VIDEO_DECODER_NAME"]=2,T}(),x}(),M.SdkDimensionValue=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.stringValue="",x.prototype.boolValue=!1,x.prototype.uintValue=R.Long?R.Long.fromBits(0,0,!0):0,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.stringValue!=null&&Object.hasOwnProperty.call(S,"stringValue")&&T.uint32(10).string(S.stringValue),S.boolValue!=null&&Object.hasOwnProperty.call(S,"boolValue")&&T.uint32(16).bool(S.boolValue),S.uintValue!=null&&Object.hasOwnProperty.call(S,"uintValue")&&T.uint32(24).uint64(S.uintValue),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkDimensionValue;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.stringValue=S.string();break}case 2:{D.boolValue=S.bool();break}case 3:{D.uintValue=S.uint64();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.stringValue!=null&&S.hasOwnProperty("stringValue")&&!R.isString(S.stringValue)?"stringValue: string expected":S.boolValue!=null&&S.hasOwnProperty("boolValue")&&typeof S.boolValue!="boolean"?"boolValue: boolean expected":S.uintValue!=null&&S.hasOwnProperty("uintValue")&&!R.isInteger(S.uintValue)&&!(S.uintValue&&R.isInteger(S.uintValue.low)&&R.isInteger(S.uintValue.high))?"uintValue: integer|Long expected":null},x.fromObject=function(S){if(S instanceof M.SdkDimensionValue)return S;var T=new M.SdkDimensionValue;return S.stringValue!=null&&(T.stringValue=String(S.stringValue)),S.boolValue!=null&&(T.boolValue=!!S.boolValue),S.uintValue!=null&&(R.Long?(T.uintValue=R.Long.fromValue(S.uintValue)).unsigned=!0:typeof S.uintValue=="string"?T.uintValue=parseInt(S.uintValue,10):typeof S.uintValue=="number"?T.uintValue=S.uintValue:typeof S.uintValue=="object"&&(T.uintValue=new R.LongBits(S.uintValue.low>>>0,S.uintValue.high>>>0).toNumber(!0))),T},x.toObject=function(S,T){T||(T={});var _={};if(T.defaults)if(_.stringValue="",_.boolValue=!1,R.Long){var D=new R.Long(0,0,!0);_.uintValue=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.uintValue=T.longs===String?"0":0;return S.stringValue!=null&&S.hasOwnProperty("stringValue")&&(_.stringValue=S.stringValue),S.boolValue!=null&&S.hasOwnProperty("boolValue")&&(_.boolValue=S.boolValue),S.uintValue!=null&&S.hasOwnProperty("uintValue")&&(typeof S.uintValue=="number"?_.uintValue=T.longs===String?String(S.uintValue):S.uintValue:_.uintValue=T.longs===String?R.Long.prototype.toString.call(S.uintValue):T.longs===Number?new R.LongBits(S.uintValue.low>>>0,S.uintValue.high>>>0).toNumber(!0):S.uintValue),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkDimensionValue"},x}(),M.SdkDataMessageFrame=function(){function x(S){if(this.messages=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.messages=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.messages!=null&&S.messages.length)for(var _=0;_<S.messages.length;++_)M.SdkDataMessagePayload.encode(S.messages[_],T.uint32(10).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkDataMessageFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.messages&&D.messages.length||(D.messages=[]),D.messages.push(M.SdkDataMessagePayload.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.messages!=null&&S.hasOwnProperty("messages")){if(!Array.isArray(S.messages))return"messages: array expected";for(var T=0;T<S.messages.length;++T){var _=M.SdkDataMessagePayload.verify(S.messages[T]);if(_)return"messages."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkDataMessageFrame)return S;var T=new M.SdkDataMessageFrame;if(S.messages){if(!Array.isArray(S.messages))throw TypeError(".SdkDataMessageFrame.messages: array expected");T.messages=[];for(var _=0;_<S.messages.length;++_){if(typeof S.messages[_]!="object")throw TypeError(".SdkDataMessageFrame.messages: object expected");T.messages[_]=M.SdkDataMessagePayload.fromObject(S.messages[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.messages=[]),S.messages&&S.messages.length){_.messages=[];for(var D=0;D<S.messages.length;++D)_.messages[D]=M.SdkDataMessagePayload.toObject(S.messages[D],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkDataMessageFrame"},x}(),M.SdkDataMessagePayload=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.topic="",x.prototype.data=R.newBuffer([]),x.prototype.lifetimeMs=0,x.prototype.senderAttendeeId="",x.prototype.ingestTimeNs=R.Long?R.Long.fromBits(0,0,!1):0,x.prototype.senderExternalUserId="",x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.topic!=null&&Object.hasOwnProperty.call(S,"topic")&&T.uint32(10).string(S.topic),S.data!=null&&Object.hasOwnProperty.call(S,"data")&&T.uint32(18).bytes(S.data),S.lifetimeMs!=null&&Object.hasOwnProperty.call(S,"lifetimeMs")&&T.uint32(24).uint32(S.lifetimeMs),S.senderAttendeeId!=null&&Object.hasOwnProperty.call(S,"senderAttendeeId")&&T.uint32(34).string(S.senderAttendeeId),S.ingestTimeNs!=null&&Object.hasOwnProperty.call(S,"ingestTimeNs")&&T.uint32(40).int64(S.ingestTimeNs),S.senderExternalUserId!=null&&Object.hasOwnProperty.call(S,"senderExternalUserId")&&T.uint32(50).string(S.senderExternalUserId),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkDataMessagePayload;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.topic=S.string();break}case 2:{D.data=S.bytes();break}case 3:{D.lifetimeMs=S.uint32();break}case 4:{D.senderAttendeeId=S.string();break}case 5:{D.ingestTimeNs=S.int64();break}case 6:{D.senderExternalUserId=S.string();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.topic!=null&&S.hasOwnProperty("topic")&&!R.isString(S.topic)?"topic: string expected":S.data!=null&&S.hasOwnProperty("data")&&!(S.data&&typeof S.data.length=="number"||R.isString(S.data))?"data: buffer expected":S.lifetimeMs!=null&&S.hasOwnProperty("lifetimeMs")&&!R.isInteger(S.lifetimeMs)?"lifetimeMs: integer expected":S.senderAttendeeId!=null&&S.hasOwnProperty("senderAttendeeId")&&!R.isString(S.senderAttendeeId)?"senderAttendeeId: string expected":S.ingestTimeNs!=null&&S.hasOwnProperty("ingestTimeNs")&&!R.isInteger(S.ingestTimeNs)&&!(S.ingestTimeNs&&R.isInteger(S.ingestTimeNs.low)&&R.isInteger(S.ingestTimeNs.high))?"ingestTimeNs: integer|Long expected":S.senderExternalUserId!=null&&S.hasOwnProperty("senderExternalUserId")&&!R.isString(S.senderExternalUserId)?"senderExternalUserId: string expected":null},x.fromObject=function(S){if(S instanceof M.SdkDataMessagePayload)return S;var T=new M.SdkDataMessagePayload;return S.topic!=null&&(T.topic=String(S.topic)),S.data!=null&&(typeof S.data=="string"?R.base64.decode(S.data,T.data=R.newBuffer(R.base64.length(S.data)),0):S.data.length>=0&&(T.data=S.data)),S.lifetimeMs!=null&&(T.lifetimeMs=S.lifetimeMs>>>0),S.senderAttendeeId!=null&&(T.senderAttendeeId=String(S.senderAttendeeId)),S.ingestTimeNs!=null&&(R.Long?(T.ingestTimeNs=R.Long.fromValue(S.ingestTimeNs)).unsigned=!1:typeof S.ingestTimeNs=="string"?T.ingestTimeNs=parseInt(S.ingestTimeNs,10):typeof S.ingestTimeNs=="number"?T.ingestTimeNs=S.ingestTimeNs:typeof S.ingestTimeNs=="object"&&(T.ingestTimeNs=new R.LongBits(S.ingestTimeNs.low>>>0,S.ingestTimeNs.high>>>0).toNumber())),S.senderExternalUserId!=null&&(T.senderExternalUserId=String(S.senderExternalUserId)),T},x.toObject=function(S,T){T||(T={});var _={};if(T.defaults){if(_.topic="",T.bytes===String?_.data="":(_.data=[],T.bytes!==Array&&(_.data=R.newBuffer(_.data))),_.lifetimeMs=0,_.senderAttendeeId="",R.Long){var D=new R.Long(0,0,!1);_.ingestTimeNs=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.ingestTimeNs=T.longs===String?"0":0;_.senderExternalUserId=""}return S.topic!=null&&S.hasOwnProperty("topic")&&(_.topic=S.topic),S.data!=null&&S.hasOwnProperty("data")&&(_.data=T.bytes===String?R.base64.encode(S.data,0,S.data.length):T.bytes===Array?Array.prototype.slice.call(S.data):S.data),S.lifetimeMs!=null&&S.hasOwnProperty("lifetimeMs")&&(_.lifetimeMs=S.lifetimeMs),S.senderAttendeeId!=null&&S.hasOwnProperty("senderAttendeeId")&&(_.senderAttendeeId=S.senderAttendeeId),S.ingestTimeNs!=null&&S.hasOwnProperty("ingestTimeNs")&&(typeof S.ingestTimeNs=="number"?_.ingestTimeNs=T.longs===String?String(S.ingestTimeNs):S.ingestTimeNs:_.ingestTimeNs=T.longs===String?R.Long.prototype.toString.call(S.ingestTimeNs):T.longs===Number?new R.LongBits(S.ingestTimeNs.low>>>0,S.ingestTimeNs.high>>>0).toNumber():S.ingestTimeNs),S.senderExternalUserId!=null&&S.hasOwnProperty("senderExternalUserId")&&(_.senderExternalUserId=S.senderExternalUserId),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkDataMessagePayload"},x}(),M.SdkTurnCredentials=function(){function x(S){if(this.uris=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.username="",x.prototype.password="",x.prototype.ttl=0,x.prototype.uris=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.username!=null&&Object.hasOwnProperty.call(S,"username")&&T.uint32(10).string(S.username),S.password!=null&&Object.hasOwnProperty.call(S,"password")&&T.uint32(18).string(S.password),S.ttl!=null&&Object.hasOwnProperty.call(S,"ttl")&&T.uint32(24).uint32(S.ttl),S.uris!=null&&S.uris.length)for(var _=0;_<S.uris.length;++_)T.uint32(34).string(S.uris[_]);return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTurnCredentials;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.username=S.string();break}case 2:{D.password=S.string();break}case 3:{D.ttl=S.uint32();break}case 4:{D.uris&&D.uris.length||(D.uris=[]),D.uris.push(S.string());break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.username!=null&&S.hasOwnProperty("username")&&!R.isString(S.username))return"username: string expected";if(S.password!=null&&S.hasOwnProperty("password")&&!R.isString(S.password))return"password: string expected";if(S.ttl!=null&&S.hasOwnProperty("ttl")&&!R.isInteger(S.ttl))return"ttl: integer expected";if(S.uris!=null&&S.hasOwnProperty("uris")){if(!Array.isArray(S.uris))return"uris: array expected";for(var T=0;T<S.uris.length;++T)if(!R.isString(S.uris[T]))return"uris: string[] expected"}return null},x.fromObject=function(S){if(S instanceof M.SdkTurnCredentials)return S;var T=new M.SdkTurnCredentials;if(S.username!=null&&(T.username=String(S.username)),S.password!=null&&(T.password=String(S.password)),S.ttl!=null&&(T.ttl=S.ttl>>>0),S.uris){if(!Array.isArray(S.uris))throw TypeError(".SdkTurnCredentials.uris: array expected");T.uris=[];for(var _=0;_<S.uris.length;++_)T.uris[_]=String(S.uris[_])}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.uris=[]),T.defaults&&(_.username="",_.password="",_.ttl=0),S.username!=null&&S.hasOwnProperty("username")&&(_.username=S.username),S.password!=null&&S.hasOwnProperty("password")&&(_.password=S.password),S.ttl!=null&&S.hasOwnProperty("ttl")&&(_.ttl=S.ttl),S.uris&&S.uris.length){_.uris=[];for(var D=0;D<S.uris.length;++D)_.uris[D]=S.uris[D]}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTurnCredentials"},x}(),M.SdkTranscriptItem=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.content="",x.prototype.endTime=R.Long?R.Long.fromBits(0,0,!1):0,x.prototype.speakerAttendeeId="",x.prototype.speakerExternalUserId="",x.prototype.startTime=R.Long?R.Long.fromBits(0,0,!1):0,x.prototype.type=1,x.prototype.vocabularyFilterMatch=!1,x.prototype.confidence=0,x.prototype.stable=!1,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.content!=null&&Object.hasOwnProperty.call(S,"content")&&T.uint32(10).string(S.content),S.endTime!=null&&Object.hasOwnProperty.call(S,"endTime")&&T.uint32(16).int64(S.endTime),S.speakerAttendeeId!=null&&Object.hasOwnProperty.call(S,"speakerAttendeeId")&&T.uint32(26).string(S.speakerAttendeeId),S.speakerExternalUserId!=null&&Object.hasOwnProperty.call(S,"speakerExternalUserId")&&T.uint32(34).string(S.speakerExternalUserId),S.startTime!=null&&Object.hasOwnProperty.call(S,"startTime")&&T.uint32(40).int64(S.startTime),S.type!=null&&Object.hasOwnProperty.call(S,"type")&&T.uint32(48).int32(S.type),S.vocabularyFilterMatch!=null&&Object.hasOwnProperty.call(S,"vocabularyFilterMatch")&&T.uint32(56).bool(S.vocabularyFilterMatch),S.confidence!=null&&Object.hasOwnProperty.call(S,"confidence")&&T.uint32(65).double(S.confidence),S.stable!=null&&Object.hasOwnProperty.call(S,"stable")&&T.uint32(72).bool(S.stable),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTranscriptItem;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.content=S.string();break}case 2:{D.endTime=S.int64();break}case 3:{D.speakerAttendeeId=S.string();break}case 4:{D.speakerExternalUserId=S.string();break}case 5:{D.startTime=S.int64();break}case 6:{D.type=S.int32();break}case 7:{D.vocabularyFilterMatch=S.bool();break}case 8:{D.confidence=S.double();break}case 9:{D.stable=S.bool();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.content!=null&&S.hasOwnProperty("content")&&!R.isString(S.content))return"content: string expected";if(S.endTime!=null&&S.hasOwnProperty("endTime")&&!R.isInteger(S.endTime)&&!(S.endTime&&R.isInteger(S.endTime.low)&&R.isInteger(S.endTime.high)))return"endTime: integer|Long expected";if(S.speakerAttendeeId!=null&&S.hasOwnProperty("speakerAttendeeId")&&!R.isString(S.speakerAttendeeId))return"speakerAttendeeId: string expected";if(S.speakerExternalUserId!=null&&S.hasOwnProperty("speakerExternalUserId")&&!R.isString(S.speakerExternalUserId))return"speakerExternalUserId: string expected";if(S.startTime!=null&&S.hasOwnProperty("startTime")&&!R.isInteger(S.startTime)&&!(S.startTime&&R.isInteger(S.startTime.low)&&R.isInteger(S.startTime.high)))return"startTime: integer|Long expected";if(S.type!=null&&S.hasOwnProperty("type"))switch(S.type){default:return"type: enum value expected";case 1:case 2:break}return S.vocabularyFilterMatch!=null&&S.hasOwnProperty("vocabularyFilterMatch")&&typeof S.vocabularyFilterMatch!="boolean"?"vocabularyFilterMatch: boolean expected":S.confidence!=null&&S.hasOwnProperty("confidence")&&typeof S.confidence!="number"?"confidence: number expected":S.stable!=null&&S.hasOwnProperty("stable")&&typeof S.stable!="boolean"?"stable: boolean expected":null},x.fromObject=function(S){if(S instanceof M.SdkTranscriptItem)return S;var T=new M.SdkTranscriptItem;switch(S.content!=null&&(T.content=String(S.content)),S.endTime!=null&&(R.Long?(T.endTime=R.Long.fromValue(S.endTime)).unsigned=!1:typeof S.endTime=="string"?T.endTime=parseInt(S.endTime,10):typeof S.endTime=="number"?T.endTime=S.endTime:typeof S.endTime=="object"&&(T.endTime=new R.LongBits(S.endTime.low>>>0,S.endTime.high>>>0).toNumber())),S.speakerAttendeeId!=null&&(T.speakerAttendeeId=String(S.speakerAttendeeId)),S.speakerExternalUserId!=null&&(T.speakerExternalUserId=String(S.speakerExternalUserId)),S.startTime!=null&&(R.Long?(T.startTime=R.Long.fromValue(S.startTime)).unsigned=!1:typeof S.startTime=="string"?T.startTime=parseInt(S.startTime,10):typeof S.startTime=="number"?T.startTime=S.startTime:typeof S.startTime=="object"&&(T.startTime=new R.LongBits(S.startTime.low>>>0,S.startTime.high>>>0).toNumber())),S.type){default:if(typeof S.type=="number"){T.type=S.type;break}break;case"PRONUNCIATION":case 1:T.type=1;break;case"PUNCTUATION":case 2:T.type=2;break}return S.vocabularyFilterMatch!=null&&(T.vocabularyFilterMatch=!!S.vocabularyFilterMatch),S.confidence!=null&&(T.confidence=Number(S.confidence)),S.stable!=null&&(T.stable=!!S.stable),T},x.toObject=function(S,T){T||(T={});var _={};if(T.defaults){if(_.content="",R.Long){var D=new R.Long(0,0,!1);_.endTime=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.endTime=T.longs===String?"0":0;if(_.speakerAttendeeId="",_.speakerExternalUserId="",R.Long){var D=new R.Long(0,0,!1);_.startTime=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.startTime=T.longs===String?"0":0;_.type=T.enums===String?"PRONUNCIATION":1,_.vocabularyFilterMatch=!1,_.confidence=0,_.stable=!1}return S.content!=null&&S.hasOwnProperty("content")&&(_.content=S.content),S.endTime!=null&&S.hasOwnProperty("endTime")&&(typeof S.endTime=="number"?_.endTime=T.longs===String?String(S.endTime):S.endTime:_.endTime=T.longs===String?R.Long.prototype.toString.call(S.endTime):T.longs===Number?new R.LongBits(S.endTime.low>>>0,S.endTime.high>>>0).toNumber():S.endTime),S.speakerAttendeeId!=null&&S.hasOwnProperty("speakerAttendeeId")&&(_.speakerAttendeeId=S.speakerAttendeeId),S.speakerExternalUserId!=null&&S.hasOwnProperty("speakerExternalUserId")&&(_.speakerExternalUserId=S.speakerExternalUserId),S.startTime!=null&&S.hasOwnProperty("startTime")&&(typeof S.startTime=="number"?_.startTime=T.longs===String?String(S.startTime):S.startTime:_.startTime=T.longs===String?R.Long.prototype.toString.call(S.startTime):T.longs===Number?new R.LongBits(S.startTime.low>>>0,S.startTime.high>>>0).toNumber():S.startTime),S.type!=null&&S.hasOwnProperty("type")&&(_.type=T.enums===String?M.SdkTranscriptItem.Type[S.type]===void 0?S.type:M.SdkTranscriptItem.Type[S.type]:S.type),S.vocabularyFilterMatch!=null&&S.hasOwnProperty("vocabularyFilterMatch")&&(_.vocabularyFilterMatch=S.vocabularyFilterMatch),S.confidence!=null&&S.hasOwnProperty("confidence")&&(_.confidence=T.json&&!isFinite(S.confidence)?String(S.confidence):S.confidence),S.stable!=null&&S.hasOwnProperty("stable")&&(_.stable=S.stable),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTranscriptItem"},x.Type=function(){var S={},T=Object.create(S);return T[S[1]="PRONUNCIATION"]=1,T[S[2]="PUNCTUATION"]=2,T}(),x}(),M.SdkTranscriptEntity=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.category="",x.prototype.confidence=0,x.prototype.content="",x.prototype.endTime=R.Long?R.Long.fromBits(0,0,!1):0,x.prototype.startTime=R.Long?R.Long.fromBits(0,0,!1):0,x.prototype.type="",x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.category!=null&&Object.hasOwnProperty.call(S,"category")&&T.uint32(10).string(S.category),S.confidence!=null&&Object.hasOwnProperty.call(S,"confidence")&&T.uint32(17).double(S.confidence),S.content!=null&&Object.hasOwnProperty.call(S,"content")&&T.uint32(26).string(S.content),S.endTime!=null&&Object.hasOwnProperty.call(S,"endTime")&&T.uint32(32).int64(S.endTime),S.startTime!=null&&Object.hasOwnProperty.call(S,"startTime")&&T.uint32(40).int64(S.startTime),S.type!=null&&Object.hasOwnProperty.call(S,"type")&&T.uint32(50).string(S.type),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTranscriptEntity;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.category=S.string();break}case 2:{D.confidence=S.double();break}case 3:{D.content=S.string();break}case 4:{D.endTime=S.int64();break}case 5:{D.startTime=S.int64();break}case 6:{D.type=S.string();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.category!=null&&S.hasOwnProperty("category")&&!R.isString(S.category)?"category: string expected":S.confidence!=null&&S.hasOwnProperty("confidence")&&typeof S.confidence!="number"?"confidence: number expected":S.content!=null&&S.hasOwnProperty("content")&&!R.isString(S.content)?"content: string expected":S.endTime!=null&&S.hasOwnProperty("endTime")&&!R.isInteger(S.endTime)&&!(S.endTime&&R.isInteger(S.endTime.low)&&R.isInteger(S.endTime.high))?"endTime: integer|Long expected":S.startTime!=null&&S.hasOwnProperty("startTime")&&!R.isInteger(S.startTime)&&!(S.startTime&&R.isInteger(S.startTime.low)&&R.isInteger(S.startTime.high))?"startTime: integer|Long expected":S.type!=null&&S.hasOwnProperty("type")&&!R.isString(S.type)?"type: string expected":null},x.fromObject=function(S){if(S instanceof M.SdkTranscriptEntity)return S;var T=new M.SdkTranscriptEntity;return S.category!=null&&(T.category=String(S.category)),S.confidence!=null&&(T.confidence=Number(S.confidence)),S.content!=null&&(T.content=String(S.content)),S.endTime!=null&&(R.Long?(T.endTime=R.Long.fromValue(S.endTime)).unsigned=!1:typeof S.endTime=="string"?T.endTime=parseInt(S.endTime,10):typeof S.endTime=="number"?T.endTime=S.endTime:typeof S.endTime=="object"&&(T.endTime=new R.LongBits(S.endTime.low>>>0,S.endTime.high>>>0).toNumber())),S.startTime!=null&&(R.Long?(T.startTime=R.Long.fromValue(S.startTime)).unsigned=!1:typeof S.startTime=="string"?T.startTime=parseInt(S.startTime,10):typeof S.startTime=="number"?T.startTime=S.startTime:typeof S.startTime=="object"&&(T.startTime=new R.LongBits(S.startTime.low>>>0,S.startTime.high>>>0).toNumber())),S.type!=null&&(T.type=String(S.type)),T},x.toObject=function(S,T){T||(T={});var _={};if(T.defaults){if(_.category="",_.confidence=0,_.content="",R.Long){var D=new R.Long(0,0,!1);_.endTime=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.endTime=T.longs===String?"0":0;if(R.Long){var D=new R.Long(0,0,!1);_.startTime=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.startTime=T.longs===String?"0":0;_.type=""}return S.category!=null&&S.hasOwnProperty("category")&&(_.category=S.category),S.confidence!=null&&S.hasOwnProperty("confidence")&&(_.confidence=T.json&&!isFinite(S.confidence)?String(S.confidence):S.confidence),S.content!=null&&S.hasOwnProperty("content")&&(_.content=S.content),S.endTime!=null&&S.hasOwnProperty("endTime")&&(typeof S.endTime=="number"?_.endTime=T.longs===String?String(S.endTime):S.endTime:_.endTime=T.longs===String?R.Long.prototype.toString.call(S.endTime):T.longs===Number?new R.LongBits(S.endTime.low>>>0,S.endTime.high>>>0).toNumber():S.endTime),S.startTime!=null&&S.hasOwnProperty("startTime")&&(typeof S.startTime=="number"?_.startTime=T.longs===String?String(S.startTime):S.startTime:_.startTime=T.longs===String?R.Long.prototype.toString.call(S.startTime):T.longs===Number?new R.LongBits(S.startTime.low>>>0,S.startTime.high>>>0).toNumber():S.startTime),S.type!=null&&S.hasOwnProperty("type")&&(_.type=S.type),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTranscriptEntity"},x}(),M.SdkTranscriptAlternative=function(){function x(S){if(this.items=[],this.entities=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.items=R.emptyArray,x.prototype.transcript="",x.prototype.entities=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.items!=null&&S.items.length)for(var _=0;_<S.items.length;++_)M.SdkTranscriptItem.encode(S.items[_],T.uint32(10).fork()).ldelim();if(S.transcript!=null&&Object.hasOwnProperty.call(S,"transcript")&&T.uint32(18).string(S.transcript),S.entities!=null&&S.entities.length)for(var _=0;_<S.entities.length;++_)M.SdkTranscriptEntity.encode(S.entities[_],T.uint32(26).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTranscriptAlternative;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.items&&D.items.length||(D.items=[]),D.items.push(M.SdkTranscriptItem.decode(S,S.uint32()));break}case 2:{D.transcript=S.string();break}case 3:{D.entities&&D.entities.length||(D.entities=[]),D.entities.push(M.SdkTranscriptEntity.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.items!=null&&S.hasOwnProperty("items")){if(!Array.isArray(S.items))return"items: array expected";for(var T=0;T<S.items.length;++T){var _=M.SdkTranscriptItem.verify(S.items[T]);if(_)return"items."+_}}if(S.transcript!=null&&S.hasOwnProperty("transcript")&&!R.isString(S.transcript))return"transcript: string expected";if(S.entities!=null&&S.hasOwnProperty("entities")){if(!Array.isArray(S.entities))return"entities: array expected";for(var T=0;T<S.entities.length;++T){var _=M.SdkTranscriptEntity.verify(S.entities[T]);if(_)return"entities."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkTranscriptAlternative)return S;var T=new M.SdkTranscriptAlternative;if(S.items){if(!Array.isArray(S.items))throw TypeError(".SdkTranscriptAlternative.items: array expected");T.items=[];for(var _=0;_<S.items.length;++_){if(typeof S.items[_]!="object")throw TypeError(".SdkTranscriptAlternative.items: object expected");T.items[_]=M.SdkTranscriptItem.fromObject(S.items[_])}}if(S.transcript!=null&&(T.transcript=String(S.transcript)),S.entities){if(!Array.isArray(S.entities))throw TypeError(".SdkTranscriptAlternative.entities: array expected");T.entities=[];for(var _=0;_<S.entities.length;++_){if(typeof S.entities[_]!="object")throw TypeError(".SdkTranscriptAlternative.entities: object expected");T.entities[_]=M.SdkTranscriptEntity.fromObject(S.entities[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.items=[],_.entities=[]),T.defaults&&(_.transcript=""),S.items&&S.items.length){_.items=[];for(var D=0;D<S.items.length;++D)_.items[D]=M.SdkTranscriptItem.toObject(S.items[D],T)}if(S.transcript!=null&&S.hasOwnProperty("transcript")&&(_.transcript=S.transcript),S.entities&&S.entities.length){_.entities=[];for(var D=0;D<S.entities.length;++D)_.entities[D]=M.SdkTranscriptEntity.toObject(S.entities[D],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTranscriptAlternative"},x}(),M.SdkTranscriptLanguageWithScore=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.languageCode="",x.prototype.score=0,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.languageCode!=null&&Object.hasOwnProperty.call(S,"languageCode")&&T.uint32(10).string(S.languageCode),S.score!=null&&Object.hasOwnProperty.call(S,"score")&&T.uint32(17).double(S.score),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTranscriptLanguageWithScore;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.languageCode=S.string();break}case 2:{D.score=S.double();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.languageCode!=null&&S.hasOwnProperty("languageCode")&&!R.isString(S.languageCode)?"languageCode: string expected":S.score!=null&&S.hasOwnProperty("score")&&typeof S.score!="number"?"score: number expected":null},x.fromObject=function(S){if(S instanceof M.SdkTranscriptLanguageWithScore)return S;var T=new M.SdkTranscriptLanguageWithScore;return S.languageCode!=null&&(T.languageCode=String(S.languageCode)),S.score!=null&&(T.score=Number(S.score)),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.languageCode="",_.score=0),S.languageCode!=null&&S.hasOwnProperty("languageCode")&&(_.languageCode=S.languageCode),S.score!=null&&S.hasOwnProperty("score")&&(_.score=T.json&&!isFinite(S.score)?String(S.score):S.score),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTranscriptLanguageWithScore"},x}(),M.SdkTranscriptResult=function(){function x(S){if(this.alternatives=[],this.languageIdentification=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.alternatives=R.emptyArray,x.prototype.channelId="",x.prototype.endTime=R.Long?R.Long.fromBits(0,0,!1):0,x.prototype.isPartial=!1,x.prototype.resultId="",x.prototype.startTime=R.Long?R.Long.fromBits(0,0,!1):0,x.prototype.languageCode="",x.prototype.languageIdentification=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.alternatives!=null&&S.alternatives.length)for(var _=0;_<S.alternatives.length;++_)M.SdkTranscriptAlternative.encode(S.alternatives[_],T.uint32(10).fork()).ldelim();if(S.channelId!=null&&Object.hasOwnProperty.call(S,"channelId")&&T.uint32(18).string(S.channelId),S.endTime!=null&&Object.hasOwnProperty.call(S,"endTime")&&T.uint32(24).int64(S.endTime),S.isPartial!=null&&Object.hasOwnProperty.call(S,"isPartial")&&T.uint32(32).bool(S.isPartial),S.resultId!=null&&Object.hasOwnProperty.call(S,"resultId")&&T.uint32(42).string(S.resultId),S.startTime!=null&&Object.hasOwnProperty.call(S,"startTime")&&T.uint32(48).int64(S.startTime),S.languageCode!=null&&Object.hasOwnProperty.call(S,"languageCode")&&T.uint32(58).string(S.languageCode),S.languageIdentification!=null&&S.languageIdentification.length)for(var _=0;_<S.languageIdentification.length;++_)M.SdkTranscriptLanguageWithScore.encode(S.languageIdentification[_],T.uint32(66).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTranscriptResult;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.alternatives&&D.alternatives.length||(D.alternatives=[]),D.alternatives.push(M.SdkTranscriptAlternative.decode(S,S.uint32()));break}case 2:{D.channelId=S.string();break}case 3:{D.endTime=S.int64();break}case 4:{D.isPartial=S.bool();break}case 5:{D.resultId=S.string();break}case 6:{D.startTime=S.int64();break}case 7:{D.languageCode=S.string();break}case 8:{D.languageIdentification&&D.languageIdentification.length||(D.languageIdentification=[]),D.languageIdentification.push(M.SdkTranscriptLanguageWithScore.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.alternatives!=null&&S.hasOwnProperty("alternatives")){if(!Array.isArray(S.alternatives))return"alternatives: array expected";for(var T=0;T<S.alternatives.length;++T){var _=M.SdkTranscriptAlternative.verify(S.alternatives[T]);if(_)return"alternatives."+_}}if(S.channelId!=null&&S.hasOwnProperty("channelId")&&!R.isString(S.channelId))return"channelId: string expected";if(S.endTime!=null&&S.hasOwnProperty("endTime")&&!R.isInteger(S.endTime)&&!(S.endTime&&R.isInteger(S.endTime.low)&&R.isInteger(S.endTime.high)))return"endTime: integer|Long expected";if(S.isPartial!=null&&S.hasOwnProperty("isPartial")&&typeof S.isPartial!="boolean")return"isPartial: boolean expected";if(S.resultId!=null&&S.hasOwnProperty("resultId")&&!R.isString(S.resultId))return"resultId: string expected";if(S.startTime!=null&&S.hasOwnProperty("startTime")&&!R.isInteger(S.startTime)&&!(S.startTime&&R.isInteger(S.startTime.low)&&R.isInteger(S.startTime.high)))return"startTime: integer|Long expected";if(S.languageCode!=null&&S.hasOwnProperty("languageCode")&&!R.isString(S.languageCode))return"languageCode: string expected";if(S.languageIdentification!=null&&S.hasOwnProperty("languageIdentification")){if(!Array.isArray(S.languageIdentification))return"languageIdentification: array expected";for(var T=0;T<S.languageIdentification.length;++T){var _=M.SdkTranscriptLanguageWithScore.verify(S.languageIdentification[T]);if(_)return"languageIdentification."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkTranscriptResult)return S;var T=new M.SdkTranscriptResult;if(S.alternatives){if(!Array.isArray(S.alternatives))throw TypeError(".SdkTranscriptResult.alternatives: array expected");T.alternatives=[];for(var _=0;_<S.alternatives.length;++_){if(typeof S.alternatives[_]!="object")throw TypeError(".SdkTranscriptResult.alternatives: object expected");T.alternatives[_]=M.SdkTranscriptAlternative.fromObject(S.alternatives[_])}}if(S.channelId!=null&&(T.channelId=String(S.channelId)),S.endTime!=null&&(R.Long?(T.endTime=R.Long.fromValue(S.endTime)).unsigned=!1:typeof S.endTime=="string"?T.endTime=parseInt(S.endTime,10):typeof S.endTime=="number"?T.endTime=S.endTime:typeof S.endTime=="object"&&(T.endTime=new R.LongBits(S.endTime.low>>>0,S.endTime.high>>>0).toNumber())),S.isPartial!=null&&(T.isPartial=!!S.isPartial),S.resultId!=null&&(T.resultId=String(S.resultId)),S.startTime!=null&&(R.Long?(T.startTime=R.Long.fromValue(S.startTime)).unsigned=!1:typeof S.startTime=="string"?T.startTime=parseInt(S.startTime,10):typeof S.startTime=="number"?T.startTime=S.startTime:typeof S.startTime=="object"&&(T.startTime=new R.LongBits(S.startTime.low>>>0,S.startTime.high>>>0).toNumber())),S.languageCode!=null&&(T.languageCode=String(S.languageCode)),S.languageIdentification){if(!Array.isArray(S.languageIdentification))throw TypeError(".SdkTranscriptResult.languageIdentification: array expected");T.languageIdentification=[];for(var _=0;_<S.languageIdentification.length;++_){if(typeof S.languageIdentification[_]!="object")throw TypeError(".SdkTranscriptResult.languageIdentification: object expected");T.languageIdentification[_]=M.SdkTranscriptLanguageWithScore.fromObject(S.languageIdentification[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.alternatives=[],_.languageIdentification=[]),T.defaults){if(_.channelId="",R.Long){var D=new R.Long(0,0,!1);_.endTime=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.endTime=T.longs===String?"0":0;if(_.isPartial=!1,_.resultId="",R.Long){var D=new R.Long(0,0,!1);_.startTime=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.startTime=T.longs===String?"0":0;_.languageCode=""}if(S.alternatives&&S.alternatives.length){_.alternatives=[];for(var Y=0;Y<S.alternatives.length;++Y)_.alternatives[Y]=M.SdkTranscriptAlternative.toObject(S.alternatives[Y],T)}if(S.channelId!=null&&S.hasOwnProperty("channelId")&&(_.channelId=S.channelId),S.endTime!=null&&S.hasOwnProperty("endTime")&&(typeof S.endTime=="number"?_.endTime=T.longs===String?String(S.endTime):S.endTime:_.endTime=T.longs===String?R.Long.prototype.toString.call(S.endTime):T.longs===Number?new R.LongBits(S.endTime.low>>>0,S.endTime.high>>>0).toNumber():S.endTime),S.isPartial!=null&&S.hasOwnProperty("isPartial")&&(_.isPartial=S.isPartial),S.resultId!=null&&S.hasOwnProperty("resultId")&&(_.resultId=S.resultId),S.startTime!=null&&S.hasOwnProperty("startTime")&&(typeof S.startTime=="number"?_.startTime=T.longs===String?String(S.startTime):S.startTime:_.startTime=T.longs===String?R.Long.prototype.toString.call(S.startTime):T.longs===Number?new R.LongBits(S.startTime.low>>>0,S.startTime.high>>>0).toNumber():S.startTime),S.languageCode!=null&&S.hasOwnProperty("languageCode")&&(_.languageCode=S.languageCode),S.languageIdentification&&S.languageIdentification.length){_.languageIdentification=[];for(var Y=0;Y<S.languageIdentification.length;++Y)_.languageIdentification[Y]=M.SdkTranscriptLanguageWithScore.toObject(S.languageIdentification[Y],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTranscriptResult"},x}(),M.SdkTranscript=function(){function x(S){if(this.results=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.results=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.results!=null&&S.results.length)for(var _=0;_<S.results.length;++_)M.SdkTranscriptResult.encode(S.results[_],T.uint32(10).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTranscript;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.results&&D.results.length||(D.results=[]),D.results.push(M.SdkTranscriptResult.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.results!=null&&S.hasOwnProperty("results")){if(!Array.isArray(S.results))return"results: array expected";for(var T=0;T<S.results.length;++T){var _=M.SdkTranscriptResult.verify(S.results[T]);if(_)return"results."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkTranscript)return S;var T=new M.SdkTranscript;if(S.results){if(!Array.isArray(S.results))throw TypeError(".SdkTranscript.results: array expected");T.results=[];for(var _=0;_<S.results.length;++_){if(typeof S.results[_]!="object")throw TypeError(".SdkTranscript.results: object expected");T.results[_]=M.SdkTranscriptResult.fromObject(S.results[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.results=[]),S.results&&S.results.length){_.results=[];for(var D=0;D<S.results.length;++D)_.results[D]=M.SdkTranscriptResult.toObject(S.results[D],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTranscript"},x}(),M.SdkTranscriptionStatus=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.type=1,x.prototype.eventTime=R.Long?R.Long.fromBits(0,0,!1):0,x.prototype.transcriptionRegion="",x.prototype.transcriptionConfiguration="",x.prototype.message="",x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.type!=null&&Object.hasOwnProperty.call(S,"type")&&T.uint32(8).int32(S.type),S.eventTime!=null&&Object.hasOwnProperty.call(S,"eventTime")&&T.uint32(16).int64(S.eventTime),S.transcriptionRegion!=null&&Object.hasOwnProperty.call(S,"transcriptionRegion")&&T.uint32(26).string(S.transcriptionRegion),S.transcriptionConfiguration!=null&&Object.hasOwnProperty.call(S,"transcriptionConfiguration")&&T.uint32(34).string(S.transcriptionConfiguration),S.message!=null&&Object.hasOwnProperty.call(S,"message")&&T.uint32(42).string(S.message),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTranscriptionStatus;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.type=S.int32();break}case 2:{D.eventTime=S.int64();break}case 3:{D.transcriptionRegion=S.string();break}case 4:{D.transcriptionConfiguration=S.string();break}case 5:{D.message=S.string();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.type!=null&&S.hasOwnProperty("type"))switch(S.type){default:return"type: enum value expected";case 1:case 2:case 3:case 4:case 5:break}return S.eventTime!=null&&S.hasOwnProperty("eventTime")&&!R.isInteger(S.eventTime)&&!(S.eventTime&&R.isInteger(S.eventTime.low)&&R.isInteger(S.eventTime.high))?"eventTime: integer|Long expected":S.transcriptionRegion!=null&&S.hasOwnProperty("transcriptionRegion")&&!R.isString(S.transcriptionRegion)?"transcriptionRegion: string expected":S.transcriptionConfiguration!=null&&S.hasOwnProperty("transcriptionConfiguration")&&!R.isString(S.transcriptionConfiguration)?"transcriptionConfiguration: string expected":S.message!=null&&S.hasOwnProperty("message")&&!R.isString(S.message)?"message: string expected":null},x.fromObject=function(S){if(S instanceof M.SdkTranscriptionStatus)return S;var T=new M.SdkTranscriptionStatus;switch(S.type){default:if(typeof S.type=="number"){T.type=S.type;break}break;case"STARTED":case 1:T.type=1;break;case"INTERRUPTED":case 2:T.type=2;break;case"RESUMED":case 3:T.type=3;break;case"STOPPED":case 4:T.type=4;break;case"FAILED":case 5:T.type=5;break}return S.eventTime!=null&&(R.Long?(T.eventTime=R.Long.fromValue(S.eventTime)).unsigned=!1:typeof S.eventTime=="string"?T.eventTime=parseInt(S.eventTime,10):typeof S.eventTime=="number"?T.eventTime=S.eventTime:typeof S.eventTime=="object"&&(T.eventTime=new R.LongBits(S.eventTime.low>>>0,S.eventTime.high>>>0).toNumber())),S.transcriptionRegion!=null&&(T.transcriptionRegion=String(S.transcriptionRegion)),S.transcriptionConfiguration!=null&&(T.transcriptionConfiguration=String(S.transcriptionConfiguration)),S.message!=null&&(T.message=String(S.message)),T},x.toObject=function(S,T){T||(T={});var _={};if(T.defaults){if(_.type=T.enums===String?"STARTED":1,R.Long){var D=new R.Long(0,0,!1);_.eventTime=T.longs===String?D.toString():T.longs===Number?D.toNumber():D}else _.eventTime=T.longs===String?"0":0;_.transcriptionRegion="",_.transcriptionConfiguration="",_.message=""}return S.type!=null&&S.hasOwnProperty("type")&&(_.type=T.enums===String?M.SdkTranscriptionStatus.Type[S.type]===void 0?S.type:M.SdkTranscriptionStatus.Type[S.type]:S.type),S.eventTime!=null&&S.hasOwnProperty("eventTime")&&(typeof S.eventTime=="number"?_.eventTime=T.longs===String?String(S.eventTime):S.eventTime:_.eventTime=T.longs===String?R.Long.prototype.toString.call(S.eventTime):T.longs===Number?new R.LongBits(S.eventTime.low>>>0,S.eventTime.high>>>0).toNumber():S.eventTime),S.transcriptionRegion!=null&&S.hasOwnProperty("transcriptionRegion")&&(_.transcriptionRegion=S.transcriptionRegion),S.transcriptionConfiguration!=null&&S.hasOwnProperty("transcriptionConfiguration")&&(_.transcriptionConfiguration=S.transcriptionConfiguration),S.message!=null&&S.hasOwnProperty("message")&&(_.message=S.message),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTranscriptionStatus"},x.Type=function(){var S={},T=Object.create(S);return T[S[1]="STARTED"]=1,T[S[2]="INTERRUPTED"]=2,T[S[3]="RESUMED"]=3,T[S[4]="STOPPED"]=4,T[S[5]="FAILED"]=5,T}(),x}(),M.SdkTranscriptEvent=function(){function x(T){if(T)for(var _=Object.keys(T),D=0;D<_.length;++D)T[_[D]]!=null&&(this[_[D]]=T[_[D]])}x.prototype.status=null,x.prototype.transcript=null;var S;return Object.defineProperty(x.prototype,"Event",{get:R.oneOfGetter(S=["status","transcript"]),set:R.oneOfSetter(S)}),x.create=function(T){return new x(T)},x.encode=function(T,_){return _||(_=w.create()),T.status!=null&&Object.hasOwnProperty.call(T,"status")&&M.SdkTranscriptionStatus.encode(T.status,_.uint32(10).fork()).ldelim(),T.transcript!=null&&Object.hasOwnProperty.call(T,"transcript")&&M.SdkTranscript.encode(T.transcript,_.uint32(18).fork()).ldelim(),_},x.encodeDelimited=function(T,_){return this.encode(T,_).ldelim()},x.decode=function(T,_){T instanceof E||(T=E.create(T));for(var D=_===void 0?T.len:T.pos+_,Y=new M.SdkTranscriptEvent;T.pos<D;){var ee=T.uint32();switch(ee>>>3){case 1:{Y.status=M.SdkTranscriptionStatus.decode(T,T.uint32());break}case 2:{Y.transcript=M.SdkTranscript.decode(T,T.uint32());break}default:T.skipType(ee&7);break}}return Y},x.decodeDelimited=function(T){return T instanceof E||(T=new E(T)),this.decode(T,T.uint32())},x.verify=function(T){if(typeof T!="object"||T===null)return"object expected";var _={};if(T.status!=null&&T.hasOwnProperty("status")){_.Event=1;{var D=M.SdkTranscriptionStatus.verify(T.status);if(D)return"status."+D}}if(T.transcript!=null&&T.hasOwnProperty("transcript")){if(_.Event===1)return"Event: multiple values";_.Event=1;{var D=M.SdkTranscript.verify(T.transcript);if(D)return"transcript."+D}}return null},x.fromObject=function(T){if(T instanceof M.SdkTranscriptEvent)return T;var _=new M.SdkTranscriptEvent;if(T.status!=null){if(typeof T.status!="object")throw TypeError(".SdkTranscriptEvent.status: object expected");_.status=M.SdkTranscriptionStatus.fromObject(T.status)}if(T.transcript!=null){if(typeof T.transcript!="object")throw TypeError(".SdkTranscriptEvent.transcript: object expected");_.transcript=M.SdkTranscript.fromObject(T.transcript)}return _},x.toObject=function(T,_){_||(_={});var D={};return T.status!=null&&T.hasOwnProperty("status")&&(D.status=M.SdkTranscriptionStatus.toObject(T.status,_),_.oneofs&&(D.Event="status")),T.transcript!=null&&T.hasOwnProperty("transcript")&&(D.transcript=M.SdkTranscript.toObject(T.transcript,_),_.oneofs&&(D.Event="transcript")),D},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(T){return T===void 0&&(T="type.googleapis.com"),T+"/SdkTranscriptEvent"},x}(),M.SdkTranscriptFrame=function(){function x(S){if(this.events=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.events=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.events!=null&&S.events.length)for(var _=0;_<S.events.length;++_)M.SdkTranscriptEvent.encode(S.events[_],T.uint32(10).fork()).ldelim();return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkTranscriptFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.events&&D.events.length||(D.events=[]),D.events.push(M.SdkTranscriptEvent.decode(S,S.uint32()));break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.events!=null&&S.hasOwnProperty("events")){if(!Array.isArray(S.events))return"events: array expected";for(var T=0;T<S.events.length;++T){var _=M.SdkTranscriptEvent.verify(S.events[T]);if(_)return"events."+_}}return null},x.fromObject=function(S){if(S instanceof M.SdkTranscriptFrame)return S;var T=new M.SdkTranscriptFrame;if(S.events){if(!Array.isArray(S.events))throw TypeError(".SdkTranscriptFrame.events: array expected");T.events=[];for(var _=0;_<S.events.length;++_){if(typeof S.events[_]!="object")throw TypeError(".SdkTranscriptFrame.events: object expected");T.events[_]=M.SdkTranscriptEvent.fromObject(S.events[_])}}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.events=[]),S.events&&S.events.length){_.events=[];for(var D=0;D<S.events.length;++D)_.events[D]=M.SdkTranscriptEvent.toObject(S.events[D],T)}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkTranscriptFrame"},x}(),M.SdkRemoteVideoUpdateFrame=function(){function x(S){if(this.addedOrUpdatedVideoSubscriptions=[],this.removedVideoSubscriptionMids=[],S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.addedOrUpdatedVideoSubscriptions=R.emptyArray,x.prototype.removedVideoSubscriptionMids=R.emptyArray,x.create=function(S){return new x(S)},x.encode=function(S,T){if(T||(T=w.create()),S.addedOrUpdatedVideoSubscriptions!=null&&S.addedOrUpdatedVideoSubscriptions.length)for(var _=0;_<S.addedOrUpdatedVideoSubscriptions.length;++_)M.SdkVideoSubscriptionConfiguration.encode(S.addedOrUpdatedVideoSubscriptions[_],T.uint32(10).fork()).ldelim();if(S.removedVideoSubscriptionMids!=null&&S.removedVideoSubscriptionMids.length)for(var _=0;_<S.removedVideoSubscriptionMids.length;++_)T.uint32(18).string(S.removedVideoSubscriptionMids[_]);return T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkRemoteVideoUpdateFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.addedOrUpdatedVideoSubscriptions&&D.addedOrUpdatedVideoSubscriptions.length||(D.addedOrUpdatedVideoSubscriptions=[]),D.addedOrUpdatedVideoSubscriptions.push(M.SdkVideoSubscriptionConfiguration.decode(S,S.uint32()));break}case 2:{D.removedVideoSubscriptionMids&&D.removedVideoSubscriptionMids.length||(D.removedVideoSubscriptionMids=[]),D.removedVideoSubscriptionMids.push(S.string());break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.addedOrUpdatedVideoSubscriptions!=null&&S.hasOwnProperty("addedOrUpdatedVideoSubscriptions")){if(!Array.isArray(S.addedOrUpdatedVideoSubscriptions))return"addedOrUpdatedVideoSubscriptions: array expected";for(var T=0;T<S.addedOrUpdatedVideoSubscriptions.length;++T){var _=M.SdkVideoSubscriptionConfiguration.verify(S.addedOrUpdatedVideoSubscriptions[T]);if(_)return"addedOrUpdatedVideoSubscriptions."+_}}if(S.removedVideoSubscriptionMids!=null&&S.hasOwnProperty("removedVideoSubscriptionMids")){if(!Array.isArray(S.removedVideoSubscriptionMids))return"removedVideoSubscriptionMids: array expected";for(var T=0;T<S.removedVideoSubscriptionMids.length;++T)if(!R.isString(S.removedVideoSubscriptionMids[T]))return"removedVideoSubscriptionMids: string[] expected"}return null},x.fromObject=function(S){if(S instanceof M.SdkRemoteVideoUpdateFrame)return S;var T=new M.SdkRemoteVideoUpdateFrame;if(S.addedOrUpdatedVideoSubscriptions){if(!Array.isArray(S.addedOrUpdatedVideoSubscriptions))throw TypeError(".SdkRemoteVideoUpdateFrame.addedOrUpdatedVideoSubscriptions: array expected");T.addedOrUpdatedVideoSubscriptions=[];for(var _=0;_<S.addedOrUpdatedVideoSubscriptions.length;++_){if(typeof S.addedOrUpdatedVideoSubscriptions[_]!="object")throw TypeError(".SdkRemoteVideoUpdateFrame.addedOrUpdatedVideoSubscriptions: object expected");T.addedOrUpdatedVideoSubscriptions[_]=M.SdkVideoSubscriptionConfiguration.fromObject(S.addedOrUpdatedVideoSubscriptions[_])}}if(S.removedVideoSubscriptionMids){if(!Array.isArray(S.removedVideoSubscriptionMids))throw TypeError(".SdkRemoteVideoUpdateFrame.removedVideoSubscriptionMids: array expected");T.removedVideoSubscriptionMids=[];for(var _=0;_<S.removedVideoSubscriptionMids.length;++_)T.removedVideoSubscriptionMids[_]=String(S.removedVideoSubscriptionMids[_])}return T},x.toObject=function(S,T){T||(T={});var _={};if((T.arrays||T.defaults)&&(_.addedOrUpdatedVideoSubscriptions=[],_.removedVideoSubscriptionMids=[]),S.addedOrUpdatedVideoSubscriptions&&S.addedOrUpdatedVideoSubscriptions.length){_.addedOrUpdatedVideoSubscriptions=[];for(var D=0;D<S.addedOrUpdatedVideoSubscriptions.length;++D)_.addedOrUpdatedVideoSubscriptions[D]=M.SdkVideoSubscriptionConfiguration.toObject(S.addedOrUpdatedVideoSubscriptions[D],T)}if(S.removedVideoSubscriptionMids&&S.removedVideoSubscriptionMids.length){_.removedVideoSubscriptionMids=[];for(var D=0;D<S.removedVideoSubscriptionMids.length;++D)_.removedVideoSubscriptionMids[D]=S.removedVideoSubscriptionMids[D]}return _},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkRemoteVideoUpdateFrame"},x}(),M.SdkVideoQualityAdaptationPreference=function(){var x={},S=Object.create(x);return S[x[1]="BALANCED"]=1,S[x[2]="MAINTAIN_FRAMERATE"]=2,S[x[3]="MAINTAIN_RESOLUTION"]=3,S}(),M.SdkVideoSubscriptionConfiguration=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.mid="",x.prototype.attendeeId="",x.prototype.streamId=0,x.prototype.priority=0,x.prototype.targetBitrateKbps=0,x.prototype.groupId=0,x.prototype.qualityAdaptationPreference=1,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),T.uint32(10).string(S.mid),S.attendeeId!=null&&Object.hasOwnProperty.call(S,"attendeeId")&&T.uint32(18).string(S.attendeeId),S.streamId!=null&&Object.hasOwnProperty.call(S,"streamId")&&T.uint32(24).uint32(S.streamId),S.priority!=null&&Object.hasOwnProperty.call(S,"priority")&&T.uint32(32).uint32(S.priority),S.targetBitrateKbps!=null&&Object.hasOwnProperty.call(S,"targetBitrateKbps")&&T.uint32(40).uint32(S.targetBitrateKbps),S.groupId!=null&&Object.hasOwnProperty.call(S,"groupId")&&T.uint32(48).uint32(S.groupId),S.qualityAdaptationPreference!=null&&Object.hasOwnProperty.call(S,"qualityAdaptationPreference")&&T.uint32(56).int32(S.qualityAdaptationPreference),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkVideoSubscriptionConfiguration;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.mid=S.string();break}case 2:{D.attendeeId=S.string();break}case 3:{D.streamId=S.uint32();break}case 4:{D.priority=S.uint32();break}case 5:{D.targetBitrateKbps=S.uint32();break}case 6:{D.groupId=S.uint32();break}case 7:{D.qualityAdaptationPreference=S.int32();break}default:S.skipType(Y&7);break}}if(!D.hasOwnProperty("mid"))throw R.ProtocolError("missing required 'mid'",{instance:D});return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(!R.isString(S.mid))return"mid: string expected";if(S.attendeeId!=null&&S.hasOwnProperty("attendeeId")&&!R.isString(S.attendeeId))return"attendeeId: string expected";if(S.streamId!=null&&S.hasOwnProperty("streamId")&&!R.isInteger(S.streamId))return"streamId: integer expected";if(S.priority!=null&&S.hasOwnProperty("priority")&&!R.isInteger(S.priority))return"priority: integer expected";if(S.targetBitrateKbps!=null&&S.hasOwnProperty("targetBitrateKbps")&&!R.isInteger(S.targetBitrateKbps))return"targetBitrateKbps: integer expected";if(S.groupId!=null&&S.hasOwnProperty("groupId")&&!R.isInteger(S.groupId))return"groupId: integer expected";if(S.qualityAdaptationPreference!=null&&S.hasOwnProperty("qualityAdaptationPreference"))switch(S.qualityAdaptationPreference){default:return"qualityAdaptationPreference: enum value expected";case 1:case 2:case 3:break}return null},x.fromObject=function(S){if(S instanceof M.SdkVideoSubscriptionConfiguration)return S;var T=new M.SdkVideoSubscriptionConfiguration;switch(S.mid!=null&&(T.mid=String(S.mid)),S.attendeeId!=null&&(T.attendeeId=String(S.attendeeId)),S.streamId!=null&&(T.streamId=S.streamId>>>0),S.priority!=null&&(T.priority=S.priority>>>0),S.targetBitrateKbps!=null&&(T.targetBitrateKbps=S.targetBitrateKbps>>>0),S.groupId!=null&&(T.groupId=S.groupId>>>0),S.qualityAdaptationPreference){default:if(typeof S.qualityAdaptationPreference=="number"){T.qualityAdaptationPreference=S.qualityAdaptationPreference;break}break;case"BALANCED":case 1:T.qualityAdaptationPreference=1;break;case"MAINTAIN_FRAMERATE":case 2:T.qualityAdaptationPreference=2;break;case"MAINTAIN_RESOLUTION":case 3:T.qualityAdaptationPreference=3;break}return T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.mid="",_.attendeeId="",_.streamId=0,_.priority=0,_.targetBitrateKbps=0,_.groupId=0,_.qualityAdaptationPreference=T.enums===String?"BALANCED":1),S.mid!=null&&S.hasOwnProperty("mid")&&(_.mid=S.mid),S.attendeeId!=null&&S.hasOwnProperty("attendeeId")&&(_.attendeeId=S.attendeeId),S.streamId!=null&&S.hasOwnProperty("streamId")&&(_.streamId=S.streamId),S.priority!=null&&S.hasOwnProperty("priority")&&(_.priority=S.priority),S.targetBitrateKbps!=null&&S.hasOwnProperty("targetBitrateKbps")&&(_.targetBitrateKbps=S.targetBitrateKbps),S.groupId!=null&&S.hasOwnProperty("groupId")&&(_.groupId=S.groupId),S.qualityAdaptationPreference!=null&&S.hasOwnProperty("qualityAdaptationPreference")&&(_.qualityAdaptationPreference=T.enums===String?M.SdkVideoQualityAdaptationPreference[S.qualityAdaptationPreference]===void 0?S.qualityAdaptationPreference:M.SdkVideoQualityAdaptationPreference[S.qualityAdaptationPreference]:S.qualityAdaptationPreference),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkVideoSubscriptionConfiguration"},x}(),M.SdkNotificationFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.level=3,x.prototype.message="",x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.level!=null&&Object.hasOwnProperty.call(S,"level")&&T.uint32(8).int32(S.level),S.message!=null&&Object.hasOwnProperty.call(S,"message")&&T.uint32(18).string(S.message),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkNotificationFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.level=S.int32();break}case 2:{D.message=S.string();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.level!=null&&S.hasOwnProperty("level"))switch(S.level){default:return"level: enum value expected";case 1:case 2:case 3:break}return S.message!=null&&S.hasOwnProperty("message")&&!R.isString(S.message)?"message: string expected":null},x.fromObject=function(S){if(S instanceof M.SdkNotificationFrame)return S;var T=new M.SdkNotificationFrame;switch(S.level){case"INFO":case 1:T.level=1;break;case"WARNING":case 2:T.level=2;break;default:if(typeof S.level=="number"){T.level=S.level;break}break;case"ERROR":case 3:T.level=3;break}return S.message!=null&&(T.message=String(S.message)),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.level=T.enums===String?"ERROR":3,_.message=""),S.level!=null&&S.hasOwnProperty("level")&&(_.level=T.enums===String?M.SdkNotificationFrame.NotificationLevel[S.level]===void 0?S.level:M.SdkNotificationFrame.NotificationLevel[S.level]:S.level),S.message!=null&&S.hasOwnProperty("message")&&(_.message=S.message),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkNotificationFrame"},x.NotificationLevel=function(){var S={},T=Object.create(S);return T[S[1]="INFO"]=1,T[S[2]="WARNING"]=2,T[S[3]="ERROR"]=3,T}(),x}(),M.SdkPrimaryMeetingJoinFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.credentials=null,x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.credentials!=null&&Object.hasOwnProperty.call(S,"credentials")&&M.SdkMeetingSessionCredentials.encode(S.credentials,T.uint32(10).fork()).ldelim(),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkPrimaryMeetingJoinFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.credentials=M.SdkMeetingSessionCredentials.decode(S,S.uint32());break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){if(typeof S!="object"||S===null)return"object expected";if(S.credentials!=null&&S.hasOwnProperty("credentials")){var T=M.SdkMeetingSessionCredentials.verify(S.credentials);if(T)return"credentials."+T}return null},x.fromObject=function(S){if(S instanceof M.SdkPrimaryMeetingJoinFrame)return S;var T=new M.SdkPrimaryMeetingJoinFrame;if(S.credentials!=null){if(typeof S.credentials!="object")throw TypeError(".SdkPrimaryMeetingJoinFrame.credentials: object expected");T.credentials=M.SdkMeetingSessionCredentials.fromObject(S.credentials)}return T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.credentials=null),S.credentials!=null&&S.hasOwnProperty("credentials")&&(_.credentials=M.SdkMeetingSessionCredentials.toObject(S.credentials,T)),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkPrimaryMeetingJoinFrame"},x}(),M.SdkPrimaryMeetingJoinAckFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkPrimaryMeetingJoinAckFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":null},x.fromObject=function(S){return S instanceof M.SdkPrimaryMeetingJoinAckFrame?S:new M.SdkPrimaryMeetingJoinAckFrame},x.toObject=function(){return{}},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkPrimaryMeetingJoinAckFrame"},x}(),M.SdkPrimaryMeetingLeaveFrame=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkPrimaryMeetingLeaveFrame;S.pos<_;){var Y=S.uint32();switch(Y>>>3){default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":null},x.fromObject=function(S){return S instanceof M.SdkPrimaryMeetingLeaveFrame?S:new M.SdkPrimaryMeetingLeaveFrame},x.toObject=function(){return{}},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkPrimaryMeetingLeaveFrame"},x}(),M.SdkMeetingSessionCredentials=function(){function x(S){if(S)for(var T=Object.keys(S),_=0;_<T.length;++_)S[T[_]]!=null&&(this[T[_]]=S[T[_]])}return x.prototype.attendeeId="",x.prototype.externalUserId="",x.prototype.joinToken="",x.create=function(S){return new x(S)},x.encode=function(S,T){return T||(T=w.create()),S.attendeeId!=null&&Object.hasOwnProperty.call(S,"attendeeId")&&T.uint32(10).string(S.attendeeId),S.externalUserId!=null&&Object.hasOwnProperty.call(S,"externalUserId")&&T.uint32(18).string(S.externalUserId),S.joinToken!=null&&Object.hasOwnProperty.call(S,"joinToken")&&T.uint32(26).string(S.joinToken),T},x.encodeDelimited=function(S,T){return this.encode(S,T).ldelim()},x.decode=function(S,T){S instanceof E||(S=E.create(S));for(var _=T===void 0?S.len:S.pos+T,D=new M.SdkMeetingSessionCredentials;S.pos<_;){var Y=S.uint32();switch(Y>>>3){case 1:{D.attendeeId=S.string();break}case 2:{D.externalUserId=S.string();break}case 3:{D.joinToken=S.string();break}default:S.skipType(Y&7);break}}return D},x.decodeDelimited=function(S){return S instanceof E||(S=new E(S)),this.decode(S,S.uint32())},x.verify=function(S){return typeof S!="object"||S===null?"object expected":S.attendeeId!=null&&S.hasOwnProperty("attendeeId")&&!R.isString(S.attendeeId)?"attendeeId: string expected":S.externalUserId!=null&&S.hasOwnProperty("externalUserId")&&!R.isString(S.externalUserId)?"externalUserId: string expected":S.joinToken!=null&&S.hasOwnProperty("joinToken")&&!R.isString(S.joinToken)?"joinToken: string expected":null},x.fromObject=function(S){if(S instanceof M.SdkMeetingSessionCredentials)return S;var T=new M.SdkMeetingSessionCredentials;return S.attendeeId!=null&&(T.attendeeId=String(S.attendeeId)),S.externalUserId!=null&&(T.externalUserId=String(S.externalUserId)),S.joinToken!=null&&(T.joinToken=String(S.joinToken)),T},x.toObject=function(S,T){T||(T={});var _={};return T.defaults&&(_.attendeeId="",_.externalUserId="",_.joinToken=""),S.attendeeId!=null&&S.hasOwnProperty("attendeeId")&&(_.attendeeId=S.attendeeId),S.externalUserId!=null&&S.hasOwnProperty("externalUserId")&&(_.externalUserId=S.externalUserId),S.joinToken!=null&&S.hasOwnProperty("joinToken")&&(_.joinToken=S.joinToken),_},x.prototype.toJSON=function(){return this.constructor.toObject(this,C.util.toJSONOptions)},x.getTypeUrl=function(S){return S===void 0&&(S="type.googleapis.com"),S+"/SdkMeetingSessionCredentials"},x}(),M.SdkVideoCodecCapability=function(){var x={},S=Object.create(x);return S[x[1]="VP8"]=1,S[x[2]="H264_BASELINE_PROFILE"]=2,S[x[3]="H264_CONSTRAINED_BASELINE_PROFILE"]=3,S[x[4]="H264_MAIN_PROFILE"]=4,S[x[5]="H264_HIGH_PROFILE"]=5,S[x[6]="H264_CONSTRAINED_HIGH_PROFILE"]=6,S[x[8]="VP9_PROFILE_0"]=8,S[x[11]="AV1_MAIN_PROFILE"]=11,S}(),SignalingProtocol=M,R.Long=void 0,C.configure(),SignalingProtocol}var ClientMetricReportDirection={},hasRequiredClientMetricReportDirection;function requireClientMetricReportDirection(){return hasRequiredClientMetricReportDirection||(hasRequiredClientMetricReportDirection=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.ClientMetricReportDirection=void 0;var E;(function(w){w[w.UPSTREAM=0]="UPSTREAM",w[w.DOWNSTREAM=1]="DOWNSTREAM"})(E=C.ClientMetricReportDirection||(C.ClientMetricReportDirection={})),C.default=E}(ClientMetricReportDirection)),ClientMetricReportDirection}var ClientMetricReportMediaType={},hasRequiredClientMetricReportMediaType;function requireClientMetricReportMediaType(){return hasRequiredClientMetricReportMediaType||(hasRequiredClientMetricReportMediaType=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.ClientMetricReportMediaType=void 0;var E;(function(w){w[w.AUDIO=0]="AUDIO",w[w.VIDEO=1]="VIDEO"})(E=C.ClientMetricReportMediaType||(C.ClientMetricReportMediaType={})),C.default=E}(ClientMetricReportMediaType)),ClientMetricReportMediaType}var GlobalMetricReport={},hasRequiredGlobalMetricReport;function requireGlobalMetricReport(){if(hasRequiredGlobalMetricReport)return GlobalMetricReport;hasRequiredGlobalMetricReport=1,Object.defineProperty(GlobalMetricReport,"__esModule",{value:!0});let C=class{constructor(){this.previousMetrics={},this.currentMetrics={},this.currentStringMetrics={},this.previousObjectMetrics={},this.currentObjectMetrics={}}};return GlobalMetricReport.default=C,GlobalMetricReport}var hasRequiredClientMetricReport;function requireClientMetricReport(){if(hasRequiredClientMetricReport)return ClientMetricReport;hasRequiredClientMetricReport=1;var C=ClientMetricReport&&ClientMetricReport.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(ClientMetricReport,"__esModule",{value:!0});const E=requireSignalingProtocol(),w=C(requireClientMetricReportDirection()),R=C(requireClientMetricReportMediaType()),M=C(requireGlobalMetricReport());let x=class Yp{constructor(T,_,D){this.logger=T,this.videoStreamIndex=_,this.selfAttendeeId=D,this.globalMetricReport=new M.default,this.streamMetricReports={},this.rtcStatsReport={},this.customStatsReports=[],this.currentTimestampMs=0,this.previousTimestampMs=0,this.currentSsrcs={},this.overriddenObservableMetrics=new Map,this.identityValue=(Y,ee)=>{const ie=ee?this.streamMetricReports[ee]:this.globalMetricReport;return Number(ie.currentMetrics[Y])},this.decoderLossPercent=(Y,ee)=>{const ie=this.streamMetricReports[ee],ne=ie.currentMetrics.concealedSamples-(ie.previousMetrics.concealedSamples||0),re=ie.currentMetrics.totalSamplesReceived-(ie.previousMetrics.totalSamplesReceived||0);return re<=0||re-ne<=0?0:ne/re*100},this.packetLossPercent=(Y,ee)=>{const ie=this.streamMetricReports[ee],ne=ie.currentMetrics[Y]-(ie.previousMetrics[Y]||0),re=ie.currentMetrics.packetsLost-(ie.previousMetrics.packetsLost||0),oe=ne+re;return oe<=0||re<=0?0:re*100/oe},this.jitterBufferMs=(Y,ee)=>{const ie=this.streamMetricReports[ee],ne=ie.currentMetrics.jitterBufferDelay-(ie.previousMetrics.jitterBufferDelay||0),re=ie.currentMetrics.jitterBufferEmittedCount-(ie.previousMetrics.jitterBufferEmittedCount||0);return ne<=0||re<=0?0:ne/re*1e3},this.countPerSecond=(Y,ee)=>{const ie=ee?this.streamMetricReports[ee]:this.globalMetricReport;let ne=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(ne<=0)return 0;this.previousTimestampMs<=0&&(ne=1);const re=ie.currentMetrics[Y]-(ie.previousMetrics[Y]||0);return re<=0?0:Math.trunc(re/ne)},this.bitsPerSecond=(Y,ee)=>{const ie=ee?this.streamMetricReports[ee]:this.globalMetricReport;let ne=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(ne<=0)return 0;this.previousTimestampMs<=0&&(ne=1);const re=(ie.currentMetrics[Y]-(ie.previousMetrics[Y]||0))*8;return re<=0?0:Math.trunc(re/ne)},this.secondsToMilliseconds=(Y,ee)=>{const ie=ee?this.streamMetricReports[ee]:this.globalMetricReport;return Number(ie.currentMetrics[Y]*1e3)},this.averageTimeSpentPerSecondInMilliseconds=(Y,ee)=>{const ie=ee?this.streamMetricReports[ee]:this.globalMetricReport;let ne=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(ne<=0)return 0;this.previousTimestampMs<=0&&(ne=1);const re=ie.currentMetrics[Y]-(ie.previousMetrics[Y]||0);return re<=0?0:re*1e3/ne},this.averageCpuQualityLimitationDurationPerSecondInMilliseconds=(Y,ee)=>{const ie=this.streamMetricReports[ee];if(ie.previousObjectMetrics[Y]===void 0||ie.currentObjectMetrics[Y]===void 0)return NaN;let ne=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(ne<=0)return 0;this.previousTimestampMs<=0&&(ne=1);let re=0,oe=0;for(const[le,de]of Object.entries(ie.previousObjectMetrics[Y]))le==="cpu"&&(re=de);for(const[le,de]of Object.entries(ie.currentObjectMetrics[Y]))le==="cpu"&&(oe=de);const ae=oe-re;return ae<=0?0:ae*1e3/ne},this.isHardwareImplementation=(Y,ee)=>{const ie=this.streamMetricReports[ee];if(ie.currentStringMetrics[Y]===void 0)return NaN;const ne=String(ie.currentStringMetrics[Y]),re=ne.includes("ExternalDecoder")||ne.includes("ExternalEncoder")||ne.includes("EncodeAccelerator")||ne.includes("DecodeAccelerator"),oe=ne.includes("fallback from");return re&&!oe?1:0},this.globalMetricMap={retransmittedBytesSent:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_RETRANSMIT_BITRATE},totalEncodedBytesTarget:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_TARGET_ENCODER_BITRATE},totalPacketSendDelay:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_BUCKET_DELAY_MS},packetsDiscardedOnSend:{transform:this.countPerSecond,type:E.SdkMetric.Type.SOCKET_DISCARDED_PPS},availableIncomingBitrate:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_AVAILABLE_RECEIVE_BANDWIDTH},availableOutgoingBitrate:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_AVAILABLE_SEND_BANDWIDTH},currentRoundTripTime:{transform:this.secondsToMilliseconds,type:E.SdkMetric.Type.STUN_RTT_MS},audioLevel:{transform:this.identityValue,type:E.SdkMetric.Type.RTC_MIC_AUDIO_LEVEL,source:"audioLevel"}},this.audioUpstreamMetricMap={jitter:{transform:this.secondsToMilliseconds,type:E.SdkMetric.Type.RTC_MIC_JITTER_MS},packetsSent:{transform:this.countPerSecond,type:E.SdkMetric.Type.RTC_MIC_PPS},bytesSent:{transform:this.bitsPerSecond,type:E.SdkMetric.Type.RTC_MIC_BITRATE},roundTripTime:{transform:this.secondsToMilliseconds,type:E.SdkMetric.Type.RTC_MIC_RTT_MS},packetsLost:{transform:this.packetLossPercent,type:E.SdkMetric.Type.RTC_MIC_FRACTION_PACKET_LOST_PERCENT,source:"packetsSent"}},this.audioDownstreamMetricMap={concealedSamples:{transform:this.countPerSecond},totalSamplesReceived:{transform:this.countPerSecond},decoderLoss:{transform:this.decoderLossPercent,type:E.SdkMetric.Type.RTC_SPK_FRACTION_DECODER_LOSS_PERCENT},packetsReceived:{transform:this.countPerSecond,type:E.SdkMetric.Type.RTC_SPK_PPS},packetsLost:{transform:this.packetLossPercent,type:E.SdkMetric.Type.RTC_SPK_FRACTION_PACKET_LOST_PERCENT,source:"packetsReceived"},jitter:{transform:this.secondsToMilliseconds,type:E.SdkMetric.Type.RTC_SPK_JITTER_MS},jitterBufferDelay:{transform:this.countPerSecond},jitterBufferEmittedCount:{transform:this.countPerSecond},jitterBufferMs:{transform:this.jitterBufferMs,type:E.SdkMetric.Type.RTC_SPK_JITTER_BUFFER_MS},bytesReceived:{transform:this.bitsPerSecond,type:E.SdkMetric.Type.RTC_SPK_BITRATE},audioLevel:{transform:this.identityValue,type:E.SdkMetric.Type.RTC_SPK_AUDIO_LEVEL},totalAudioPacketsLost:{transform:this.identityValue,type:E.SdkMetric.Type.RTC_SPK_TOTAL_LOST},totalAudioPacketsExpected:{transform:this.identityValue,type:E.SdkMetric.Type.RTC_SPK_TOTAL_EXPECTED},totalAudioPacketsRecoveredRed:{transform:this.identityValue,type:E.SdkMetric.Type.RTC_SPK_TOTAL_RECOVERED_RED},totalAudioPacketsRecoveredFec:{transform:this.identityValue,type:E.SdkMetric.Type.RTC_SPK_TOTAL_RECOVERED_FEC}},this.videoUpstreamMetricMap={roundTripTime:{transform:this.secondsToMilliseconds,type:E.SdkMetric.Type.VIDEO_SENT_RTT_MS},nackCount:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_NACKS_RECEIVED},pliCount:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_PLIS_RECEIVED},firCount:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_FIRS_RECEIVED},framesPerSecond:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_INPUT_FPS},framesEncoded:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_ENCODE_FPS},packetsSent:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_SENT_PPS},packetsLost:{transform:this.packetLossPercent,type:E.SdkMetric.Type.VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT,source:"packetsSent"},bytesSent:{transform:this.bitsPerSecond,type:E.SdkMetric.Type.VIDEO_SENT_BITRATE},qpSum:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_SENT_QP_SUM},frameHeight:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_ENCODE_HEIGHT},frameWidth:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_ENCODE_WIDTH},jitter:{transform:this.secondsToMilliseconds},totalEncodeTime:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:E.SdkMetric.Type.VIDEO_ENCODE_MS},encoderImplementation:{transform:this.isHardwareImplementation,type:E.SdkMetric.Type.VIDEO_ENCODER_IS_HARDWARE},qualityLimitationDurations:{transform:this.averageCpuQualityLimitationDurationPerSecondInMilliseconds,type:E.SdkMetric.Type.VIDEO_QUALITY_LIMITATION_DURATION_CPU},videoCodecDegradationHighEncodeCpu:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_CODEC_DEGRADATION_HIGH_ENCODE_CPU},videoCodecDegradationEncodeFailure:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_CODEC_DEGRADATION_ENCODE_FAILURE}},this.videoDownstreamMetricMap={packetsReceived:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_RECEIVED_PPS},packetsLost:{transform:this.packetLossPercent,type:E.SdkMetric.Type.VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT,source:"packetsReceived"},framesReceived:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_RECEIVED_FPS},framesDecoded:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_DECODE_FPS},nackCount:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_NACKS_SENT},firCount:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_FIRS_SENT},pliCount:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_PLIS_SENT},bytesReceived:{transform:this.bitsPerSecond,type:E.SdkMetric.Type.VIDEO_RECEIVED_BITRATE},jitter:{transform:this.secondsToMilliseconds,type:E.SdkMetric.Type.VIDEO_RECEIVED_JITTER_MS},jitterBufferDelay:{transform:this.countPerSecond},jitterBufferEmittedCount:{transform:this.countPerSecond},jitterBufferMs:{transform:this.jitterBufferMs,type:E.SdkMetric.Type.VIDEO_JITTER_BUFFER_MS},qpSum:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_RECEIVED_QP_SUM},frameHeight:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_DECODE_HEIGHT},frameWidth:{transform:this.identityValue,type:E.SdkMetric.Type.VIDEO_DECODE_WIDTH},totalDecodeTime:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:E.SdkMetric.Type.VIDEO_DECODE_MS},decoderImplementation:{transform:this.isHardwareImplementation,type:E.SdkMetric.Type.VIDEO_DECODER_IS_HARDWARE},totalFreezesDuration:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:E.SdkMetric.Type.VIDEO_FREEZE_DURATION},freezeCount:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_FREEZE_COUNT},totalPausesDuration:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:E.SdkMetric.Type.VIDEO_PAUSE_DURATION},pauseCount:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_PAUSE_COUNT},framesDropped:{transform:this.countPerSecond,type:E.SdkMetric.Type.VIDEO_DROPPED_FPS}},this.streamDimensionMap={encoderImplementation:E.SdkStreamDimension.Type.VIDEO_ENCODER_NAME,decoderImplementation:E.SdkStreamDimension.Type.VIDEO_DECODER_NAME},this.observableVideoMetricSpec={videoUpstreamBitrate:{source:"bytesSent",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamPacketsSent:{source:"packetsSent",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamPacketLossPercent:{source:"packetsLost",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamFramesEncodedPerSecond:{source:"framesEncoded",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamFramesInputPerSecond:{source:"framesPerSecond",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamFrameHeight:{source:"frameHeight",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamFrameWidth:{source:"frameWidth",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamJitterMs:{source:"jitter",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamRoundTripTimeMs:{source:"roundTripTime",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamEncoderImplementation:{source:"encoderImplementation",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamTotalEncodeTimePerSecond:{source:"totalEncodeTime",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoUpstreamCpuQualityLimitationDurationPerSecond:{source:"qualityLimitationDurations",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoDownstreamBitrate:{source:"bytesReceived",media:R.default.VIDEO,dir:w.default.DOWNSTREAM},videoDownstreamPacketLossPercent:{source:"packetsLost",media:R.default.VIDEO,dir:w.default.DOWNSTREAM},videoDownstreamPacketsReceived:{source:"packetsReceived",media:R.default.VIDEO,dir:w.default.DOWNSTREAM},videoDownstreamFramesDecodedPerSecond:{source:"framesDecoded",media:R.default.VIDEO,dir:w.default.DOWNSTREAM},videoDownstreamFrameHeight:{source:"frameHeight",media:R.default.VIDEO,dir:w.default.DOWNSTREAM},videoDownstreamFrameWidth:{source:"frameWidth",media:R.default.VIDEO,dir:w.default.DOWNSTREAM},videoDownstreamJitterMs:{source:"jitter",media:R.default.VIDEO,dir:w.default.DOWNSTREAM},videoDownstreamDelayMs:{source:"jitterBufferMs",media:R.default.VIDEO,dir:w.default.DOWNSTREAM}},this.observableMetricSpec={audioPacketsReceived:{source:"packetsReceived",media:R.default.AUDIO,dir:w.default.DOWNSTREAM},audioPacketsReceivedFractionLoss:{source:"packetsLost",media:R.default.AUDIO,dir:w.default.DOWNSTREAM},audioDecoderLoss:{source:"decoderLoss",media:R.default.AUDIO,dir:w.default.DOWNSTREAM},audioPacketsSent:{source:"packetsSent",media:R.default.AUDIO,dir:w.default.UPSTREAM},audioPacketLossPercent:{source:"packetsLost",media:R.default.AUDIO,dir:w.default.UPSTREAM},audioUpstreamRoundTripTimeMs:{source:"roundTripTime",media:R.default.AUDIO,dir:w.default.UPSTREAM},videoUpstreamBitrate:{source:"bytesSent",media:R.default.VIDEO,dir:w.default.UPSTREAM},videoPacketSentPerSecond:{source:"packetsSent",media:R.default.VIDEO,dir:w.default.UPSTREAM},audioSpeakerDelayMs:{source:"jitterBufferMs",media:R.default.AUDIO,dir:w.default.DOWNSTREAM},audioUpstreamJitterMs:{source:"jitter",media:R.default.AUDIO,dir:w.default.UPSTREAM},audioDownstreamJitterMs:{source:"jitter",media:R.default.AUDIO,dir:w.default.DOWNSTREAM},nackCountReceivedPerSecond:{source:"nackCount",media:R.default.VIDEO,dir:w.default.UPSTREAM},availableOutgoingBitrate:{source:"availableOutgoingBitrate"},availableIncomingBitrate:{source:"availableIncomingBitrate"},currentRoundTripTimeMs:{source:"currentRoundTripTime"},audioDownstreamLevel:{source:"audioLevel",media:R.default.AUDIO,dir:w.default.DOWNSTREAM},audioUpstreamLevel:{source:"audioLevel"}}}getMetricMap(T,_){switch(T){case R.default.AUDIO:switch(_){case w.default.UPSTREAM:return this.audioUpstreamMetricMap;case w.default.DOWNSTREAM:return this.audioDownstreamMetricMap}case R.default.VIDEO:switch(_){case w.default.UPSTREAM:return this.videoUpstreamMetricMap;case w.default.DOWNSTREAM:return this.videoDownstreamMetricMap}default:return this.globalMetricMap}}getStreamDimensionMap(){return this.streamDimensionMap}getObservableMetricValue(T){if(this.overriddenObservableMetrics.has(T))return this.overriddenObservableMetrics.get(T);const _=this.observableMetricSpec[T],D=this.getMetricMap(_.media,_.dir)[_.source],{transform:Y,source:ee}=D;if(_.hasOwnProperty("media"))for(const ie in this.streamMetricReports){const ne=this.streamMetricReports[ie];if(ne.direction===_.dir&&ne.mediaType===_.media)return Y(ee||_.source,Number(ie))}else return Y(ee||_.source);return 0}getObservableVideoMetricValue(T,_){const D=this.observableVideoMetricSpec[T],Y=this.getMetricMap(D.media,D.dir)[D.source],{transform:ee,source:ie}=Y;return ee(ie||D.source,_)}getVideoUpstreamSsrc(){for(const T in this.streamMetricReports)if(this.streamMetricReports[T].mediaType===R.default.VIDEO&&this.streamMetricReports[T].direction===w.default.UPSTREAM)return Number(T);return null}getObservableMetrics(){const T={};for(const _ in this.observableMetricSpec)T[_]=this.getObservableMetricValue(_);return T}getObservableVideoMetrics(){const T={};if(!this.videoStreamIndex||!this.selfAttendeeId)return this.logger.error("Need to define VideoStreamIndex and selfAttendeeId if using getObservableVideoMetrics API"),T;for(const _ in this.streamMetricReports)if(this.streamMetricReports[_].mediaType===R.default.VIDEO){const D={};for(const ne in this.observableVideoMetricSpec)if(this.observableVideoMetricSpec[ne].dir===this.streamMetricReports[_].direction){const re=this.getObservableVideoMetricValue(ne,Number(_));isNaN(re)||(D[ne]=re)}const Y=this.streamMetricReports[_].groupId,ee=this.streamMetricReports[_].streamId;let ie="";this.videoStreamIndex.attendeeIdForGroupId!==void 0?ie=Y?this.videoStreamIndex.attendeeIdForGroupId(Y):this.selfAttendeeId:ie=ee?this.videoStreamIndex.attendeeIdForStreamId(ee):this.selfAttendeeId,T[ie]=T[ie]?T[ie]:{},T[ie][_]=D}return T}getRTCStatsReport(){return this.rtcStatsReport}clone(){const T=new Yp(this.logger,this.videoStreamIndex,this.selfAttendeeId);return T.globalMetricReport=this.globalMetricReport,T.streamMetricReports=this.streamMetricReports,T.rtcStatsReport=this.rtcStatsReport,T.customStatsReports=this.customStatsReports,T.currentTimestampMs=this.currentTimestampMs,T.previousTimestampMs=this.previousTimestampMs,T.overriddenObservableMetrics=this.overriddenObservableMetrics,T}print(){const T={globalMetricReport:this.globalMetricReport,streamMetricReports:this.streamMetricReports,currentTimestampMs:this.currentTimestampMs,previousTimestampMs:this.previousTimestampMs};this.logger.debug(()=>`Client Metric Report: ${JSON.stringify(T)}`)}removeDestroyedSsrcs(){for(const T in this.streamMetricReports)this.currentSsrcs[T]||delete this.streamMetricReports[T]}overrideObservableMetric(T,_){this.overriddenObservableMetrics.set(T,_)}};return ClientMetricReport.default=x,ClientMetricReport}var ClientVideoStreamReceivingReport={},hasRequiredClientVideoStreamReceivingReport;function requireClientVideoStreamReceivingReport(){if(hasRequiredClientVideoStreamReceivingReport)return ClientVideoStreamReceivingReport;hasRequiredClientVideoStreamReceivingReport=1,Object.defineProperty(ClientVideoStreamReceivingReport,"__esModule",{value:!0});let C=class{};return ClientVideoStreamReceivingReport.default=C,ClientVideoStreamReceivingReport}var ConnectionHealthData={},hasRequiredConnectionHealthData;function requireConnectionHealthData(){if(hasRequiredConnectionHealthData)return ConnectionHealthData;hasRequiredConnectionHealthData=1,Object.defineProperty(ConnectionHealthData,"__esModule",{value:!0});let C=class Oa{constructor(){this.connectionStartTimestampMs=0,this.consecutiveStatsWithNoPackets=0,this.consecutiveStatsWithNoAudioPacketsSent=0,this.lastPacketLossInboundTimestampMs=0,this.lastGoodSignalTimestampMs=0,this.lastWeakSignalTimestampMs=0,this.lastNoSignalTimestampMs=0,this.consecutiveMissedPongs=0,this.packetsReceivedInLastMinute=[],this.fractionPacketsLostInboundInLastMinute=[],this.audioSpeakerDelayMs=0,this.isVideoEncoderHardware=!1,this.videoEncodingTimeInMs=0,this.cpuLimitationDuration=0,this.videoInputFps=0,this.videoEncodeFps=0,this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}static isTimestampRecent(w,R){return Date.now()<w+R}setConnectionStartTime(){this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}reset(){this.connectionStartTimestampMs=0,this.consecutiveStatsWithNoPackets=0,this.consecutiveStatsWithNoAudioPacketsSent=0,this.lastPacketLossInboundTimestampMs=0,this.lastGoodSignalTimestampMs=0,this.lastWeakSignalTimestampMs=0,this.lastNoSignalTimestampMs=0,this.consecutiveMissedPongs=0,this.packetsReceivedInLastMinute=[],this.fractionPacketsLostInboundInLastMinute=[],this.audioSpeakerDelayMs=0,this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now(),this.isVideoEncoderHardware=!1,this.videoEncodingTimeInMs=0,this.cpuLimitationDuration=0,this.videoInputFps=0,this.videoEncodeFps=0}isConnectionStartRecent(w){return Oa.isTimestampRecent(this.connectionStartTimestampMs,w)}isLastPacketLossRecent(w){return Oa.isTimestampRecent(this.lastPacketLossInboundTimestampMs,w)}isGoodSignalRecent(w){return Oa.isTimestampRecent(this.lastGoodSignalTimestampMs,w)}isWeakSignalRecent(w){return Oa.isTimestampRecent(this.lastWeakSignalTimestampMs,w)}isNoSignalRecent(w){return Oa.isTimestampRecent(this.lastNoSignalTimestampMs,w)}clone(){const w=new Oa;return w.connectionStartTimestampMs=this.connectionStartTimestampMs,w.consecutiveStatsWithNoPackets=this.consecutiveStatsWithNoPackets,w.consecutiveStatsWithNoAudioPacketsSent=this.consecutiveStatsWithNoAudioPacketsSent,w.lastPacketLossInboundTimestampMs=this.lastPacketLossInboundTimestampMs,w.lastGoodSignalTimestampMs=this.lastGoodSignalTimestampMs,w.lastWeakSignalTimestampMs=this.lastWeakSignalTimestampMs,w.lastNoSignalTimestampMs=this.lastNoSignalTimestampMs,w.consecutiveMissedPongs=this.consecutiveMissedPongs,w.packetsReceivedInLastMinute=this.packetsReceivedInLastMinute.slice(0),w.fractionPacketsLostInboundInLastMinute=this.fractionPacketsLostInboundInLastMinute.slice(0),w.audioSpeakerDelayMs=this.audioSpeakerDelayMs,w.isVideoEncoderHardware=this.isVideoEncoderHardware,w.videoEncodingTimeInMs=this.videoEncodingTimeInMs,w.cpuLimitationDuration=this.cpuLimitationDuration,w.videoInputFps=this.videoInputFps,w.videoEncodeFps=this.videoEncodeFps,w}setConsecutiveMissedPongs(w){this.consecutiveMissedPongs=w}setConsecutiveStatsWithNoPackets(w){this.consecutiveStatsWithNoPackets=w}setConsecutiveStatsWithNoAudioPacketsSent(w){this.consecutiveStatsWithNoAudioPacketsSent=w}setLastPacketLossInboundTimestampMs(w){this.lastPacketLossInboundTimestampMs=w}setLastNoSignalTimestampMs(w){this.lastNoSignalTimestampMs=w}setLastWeakSignalTimestampMs(w){this.lastWeakSignalTimestampMs=w}setLastGoodSignalTimestampMs(w){this.lastGoodSignalTimestampMs=w}setAudioSpeakerDelayMs(w){this.audioSpeakerDelayMs=w}setIsVideoEncoderHardware(w){this.isVideoEncoderHardware=w}setVideoEncodingTimeInMs(w){this.videoEncodingTimeInMs=w}setCpuLimitationDuration(w){this.cpuLimitationDuration=w}setVideoInputFps(w){this.videoInputFps=w}setVideoEncodeFps(w){this.videoEncodeFps=w}};return ConnectionHealthData.default=C,ConnectionHealthData}var ConnectionHealthPolicyConfiguration={},VideoEncodingCpuConnectionHealthPolicy={},VideoEncodingConnectionHealthPolicyName={},hasRequiredVideoEncodingConnectionHealthPolicyName;function requireVideoEncodingConnectionHealthPolicyName(){return hasRequiredVideoEncodingConnectionHealthPolicyName||(hasRequiredVideoEncodingConnectionHealthPolicyName=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.VideoEncodingConnectionHealthPolicyName=void 0;var E;(function(w){w.VideoEncodingCpuHealth="Video Encoding CPU Health",w.VideoEncodingFramerateHealth="Video Encoding framerate Health"})(E=C.VideoEncodingConnectionHealthPolicyName||(C.VideoEncodingConnectionHealthPolicyName={})),C.default=E}(VideoEncodingConnectionHealthPolicyName)),VideoEncodingConnectionHealthPolicyName}var hasRequiredVideoEncodingCpuConnectionHealthPolicy;function requireVideoEncodingCpuConnectionHealthPolicy(){if(hasRequiredVideoEncodingCpuConnectionHealthPolicy)return VideoEncodingCpuConnectionHealthPolicy;hasRequiredVideoEncodingCpuConnectionHealthPolicy=1;var C=VideoEncodingCpuConnectionHealthPolicy&&VideoEncodingCpuConnectionHealthPolicy.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(VideoEncodingCpuConnectionHealthPolicy,"__esModule",{value:!0});const E=C(requireBaseConnectionHealthPolicy()),w=C(requireVideoEncodingConnectionHealthPolicyName());let R=class extends E.default{constructor(M,x){super(M,x,w.default.VideoEncodingCpuHealth),this.consecutiveHighEncodeCpuCnt=0,this.consecutiveHighEncodeCpuThreshold=M.consecutiveHighEncodeCpuThreshold,this.highEncodeCpuMsThreshold=M.highEncodeCpuMsThreshold}health(){if(!this.currentData.isVideoEncoderHardware&&(this.currentData.videoEncodingTimeInMs>=this.highEncodeCpuMsThreshold||this.currentData.cpuLimitationDuration>0)){if(this.consecutiveHighEncodeCpuCnt++,this.consecutiveHighEncodeCpuCnt>this.consecutiveHighEncodeCpuThreshold)return this.consecutiveHighEncodeCpuCnt=0,this.minimumHealth()}else this.consecutiveHighEncodeCpuCnt=0;return this.maximumHealth()}};return VideoEncodingCpuConnectionHealthPolicy.default=R,VideoEncodingCpuConnectionHealthPolicy}var VideoEncodingFramerateConnectionHealthPolicy={},hasRequiredVideoEncodingFramerateConnectionHealthPolicy;function requireVideoEncodingFramerateConnectionHealthPolicy(){if(hasRequiredVideoEncodingFramerateConnectionHealthPolicy)return VideoEncodingFramerateConnectionHealthPolicy;hasRequiredVideoEncodingFramerateConnectionHealthPolicy=1;var C=VideoEncodingFramerateConnectionHealthPolicy&&VideoEncodingFramerateConnectionHealthPolicy.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(VideoEncodingFramerateConnectionHealthPolicy,"__esModule",{value:!0});const E=C(requireBaseConnectionHealthPolicy()),w=C(requireVideoEncodingConnectionHealthPolicyName());let R=class extends E.default{constructor(M,x){super(M,x,w.default.VideoEncodingFramerateHealth),this.consecutiveEncodeFailureCnt=0,this.consecutiveVideoEncodingFailureThreshold=M.consecutiveVideoEncodingFailureThreshold}health(){if(this.currentData.videoEncodeFps===0&&this.currentData.videoInputFps>0){if(this.consecutiveEncodeFailureCnt++,this.consecutiveEncodeFailureCnt>this.consecutiveVideoEncodingFailureThreshold)return this.consecutiveEncodeFailureCnt=0,this.minimumHealth()}else this.consecutiveEncodeFailureCnt=0;return this.maximumHealth()}};return VideoEncodingFramerateConnectionHealthPolicy.default=R,VideoEncodingFramerateConnectionHealthPolicy}var hasRequiredConnectionHealthPolicyConfiguration;function requireConnectionHealthPolicyConfiguration(){if(hasRequiredConnectionHealthPolicyConfiguration)return ConnectionHealthPolicyConfiguration;hasRequiredConnectionHealthPolicyConfiguration=1;var C=ConnectionHealthPolicyConfiguration&&ConnectionHealthPolicyConfiguration.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(ConnectionHealthPolicyConfiguration,"__esModule",{value:!0});const E=C(requireVideoEncodingCpuConnectionHealthPolicy()),w=C(requireVideoEncodingFramerateConnectionHealthPolicy());let R=class{constructor(){this.minHealth=0,this.maxHealth=1,this.initialHealth=1,this.connectionUnhealthyThreshold=25,this.noSignalThresholdTimeMs=1e4,this.connectionWaitTimeMs=1e4,this.zeroBarsNoSignalTimeMs=5e3,this.oneBarWeakSignalTimeMs=5e3,this.twoBarsTimeMs=5e3,this.threeBarsTimeMs=1e4,this.fourBarsTimeMs=2e4,this.fiveBarsTimeMs=6e4,this.cooldownTimeMs=6e4,this.pastSamplesToConsider=15,this.goodSignalTimeMs=15e3,this.fractionalLoss=.5,this.packetsExpected=50,this.maximumTimesToWarn=2,this.missedPongsLowerThreshold=1,this.missedPongsUpperThreshold=4,this.maximumAudioDelayMs=6e4,this.maximumAudioDelayDataPoints=10,this.sendingAudioFailureSamplesToConsider=2,this.sendingAudioFailureInitialWaitTimeMs=3e3,this.videoEncodingHealthPolicies=[E.default,w.default],this.consecutiveHighEncodeCpuThreshold=10,this.highEncodeCpuMsThreshold=500,this.consecutiveVideoEncodingFailureThreshold=5}};return ConnectionHealthPolicyConfiguration.default=R,ConnectionHealthPolicyConfiguration}var ContentShareConstants={},hasRequiredContentShareConstants;function requireContentShareConstants(){if(hasRequiredContentShareConstants)return ContentShareConstants;hasRequiredContentShareConstants=1,Object.defineProperty(ContentShareConstants,"__esModule",{value:!0});var C;return function(E){E.Modality="#content"}(C||(C={})),ContentShareConstants.default=C,ContentShareConstants}var ContentShareMediaStreamBroker={},DefaultDeviceController={},DefaultMediaDeviceFactory={},MediaDeviceProxyHandler={},IntervalScheduler={},hasRequiredIntervalScheduler;function requireIntervalScheduler(){if(hasRequiredIntervalScheduler)return IntervalScheduler;hasRequiredIntervalScheduler=1,Object.defineProperty(IntervalScheduler,"__esModule",{value:!0});let C=class{constructor(E){this.intervalMs=E}start(E){this.stop(),this.timer=setInterval(E,this.intervalMs)}stop(){this.timer!==void 0&&(clearInterval(this.timer),this.timer=void 0)}running(){return this.timer!==void 0}};return IntervalScheduler.default=C,IntervalScheduler}var hasRequiredMediaDeviceProxyHandler;function requireMediaDeviceProxyHandler(){if(hasRequiredMediaDeviceProxyHandler)return MediaDeviceProxyHandler;hasRequiredMediaDeviceProxyHandler=1;var C=MediaDeviceProxyHandler&&MediaDeviceProxyHandler.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=MediaDeviceProxyHandler&&MediaDeviceProxyHandler.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(MediaDeviceProxyHandler,"__esModule",{value:!0});const w=E(requireAsyncScheduler()),R=E(requireIntervalScheduler());let M=class Zp{constructor(){this.scheduler=null,this.devices=null,this.deviceChangeListeners=new Set,this.get=(S,T,_)=>{if(!Reflect.has(S,T))return;if(!("ondevicechange"in navigator.mediaDevices)){if(T==="addEventListener")return this.patchAddEventListener(S,T,_);if(T==="removeEventListener")return this.patchRemoveEventListener(S,T,_)}const D=Reflect.get(S,T,_);return typeof D=="function"?D.bind(S):D},this.patchAddEventListener=(S,T,_)=>{const D=Reflect.get(S,T,_);return(Y,ee,ie)=>{if(Y==="devicechange")this.deviceChangeListeners.add(ee),this.scheduler||(this.scheduler=new R.default(Zp.INTERVAL_MS),this.scheduler.start(this.pollDeviceLists));else return Reflect.apply(D,S,[Y,ee,ie])}},this.patchRemoveEventListener=(S,T,_)=>{const D=Reflect.get(S,T,_);return(Y,ee,ie)=>{if(Y==="devicechange")this.deviceChangeListeners.delete(ee),this.deviceChangeListeners.size===0&&this.scheduler&&(this.scheduler.stop(),this.scheduler=null);else return Reflect.apply(D,S,[Y,ee,ie])}},this.pollDeviceLists=()=>C(this,void 0,void 0,function*(){const S=yield this.sortedDeviceList();this.devices&&(S.length!==this.devices.length||S.some((T,_)=>T.deviceId!==this.devices[_].deviceId))&&this.handleDeviceChangeEvent(),this.devices=S})}sortedDeviceList(){return C(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).sort((S,T)=>S.deviceId<T.deviceId?1:S.deviceId>T.deviceId?-1:0)})}handleDeviceChangeEvent(){for(const S of this.deviceChangeListeners)w.default.nextTick(()=>{if(this.deviceChangeListeners.has(S)){const T=new Event("devicechange");typeof S=="function"?S(T):S.handleEvent(T)}})}};return MediaDeviceProxyHandler.default=M,M.INTERVAL_MS=1e3,MediaDeviceProxyHandler}var hasRequiredDefaultMediaDeviceFactory;function requireDefaultMediaDeviceFactory(){if(hasRequiredDefaultMediaDeviceFactory)return DefaultMediaDeviceFactory;hasRequiredDefaultMediaDeviceFactory=1;var C=DefaultMediaDeviceFactory&&DefaultMediaDeviceFactory.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(DefaultMediaDeviceFactory,"__esModule",{value:!0});const E=C(requireMediaDeviceProxyHandler());let w=class{constructor(){this.isMediaDevicesSupported=typeof navigator<"u"&&!!navigator.mediaDevices}create(){if(this.isMediaDevicesSupported)return new Proxy(navigator.mediaDevices,new E.default);throw new Error("navigator.mediaDevices is not supported")}};return DefaultMediaDeviceFactory.default=w,DefaultMediaDeviceFactory}var PromiseQueue={},hasRequiredPromiseQueue;function requirePromiseQueue(){if(hasRequiredPromiseQueue)return PromiseQueue;hasRequiredPromiseQueue=1,Object.defineProperty(PromiseQueue,"__esModule",{value:!0});let C=class{constructor(){this.queue=Promise.resolve()}add(E){return new Promise((w,R)=>{this.queue=this.queue.then(E).then(w).catch(R)})}};return PromiseQueue.default=C,PromiseQueue}var Types={},hasRequiredTypes$1;function requireTypes$1(){if(hasRequiredTypes$1)return Types;hasRequiredTypes$1=1,Object.defineProperty(Types,"__esModule",{value:!0}),Types.None=Types.Some=Types.Maybe=void 0;class C{static of(M){return M==null?w.of():E.of(M)}}Types.Maybe=C;class E{constructor(M){this.value=M,this.isSome=!0,this.isNone=!1}map(M){return C.of(M(this.value))}flatMap(M){return M(this.value)}get(){return this.value}getOrElse(M){return this.value}defaulting(M){return C.of(this.getOrElse(M))}static of(M){if(M==null)throw new Error("value is ${value}");return new E(M)}}Types.Some=E;class w{constructor(){this.isSome=!1,this.isNone=!0}get(){throw new Error("value is null")}getOrElse(M){return M}map(M){return new w}flatMap(M){return new w}defaulting(M){return C.of(this.getOrElse(M))}static of(){return new w}}return Types.None=w,Types}var DefaultVideoTransformDevice={},DefaultVideoFrameProcessorPipeline={},DefaultVideoFrameProcessorTimer={},hasRequiredDefaultVideoFrameProcessorTimer;function requireDefaultVideoFrameProcessorTimer(){if(hasRequiredDefaultVideoFrameProcessorTimer)return DefaultVideoFrameProcessorTimer;hasRequiredDefaultVideoFrameProcessorTimer=1;var C=DefaultVideoFrameProcessorTimer&&DefaultVideoFrameProcessorTimer.__awaiter||function(w,R,M,x){function S(T){return T instanceof M?T:new M(function(_){_(T)})}return new(M||(M=Promise))(function(T,_){function D(ie){try{ee(x.next(ie))}catch(ne){_(ne)}}function Y(ie){try{ee(x.throw(ie))}catch(ne){_(ne)}}function ee(ie){ie.done?T(ie.value):S(ie.value).then(D,Y)}ee((x=x.apply(w,R||[])).next())})};Object.defineProperty(DefaultVideoFrameProcessorTimer,"__esModule",{value:!0});let E=class{constructor(){this.workerTimer=void 0,this.callback=void 0,this.workerTimer=this.createWorkerTimer()}createWorkerTimer(){try{const w=new Blob([`self.onmessage = async function(e){ 
            var timerID = null;
            const awaitTimeout = delay => new Promise( resolve => {
              timerID = setTimeout(resolve, delay);
            })
            await awaitTimeout(e.data);
            postMessage(timerID);
          }`],{type:"application/javascript"});return new Worker(window.URL.createObjectURL(w))}catch{}}start(w,R){return C(this,void 0,void 0,function*(){this.callback=R,this.workerTimer?(this.workerTimer.onmessage=M=>{this.lastTimeout=M.data,this.callback()},this.workerTimer.postMessage(w)):this.lastTimeout=setTimeout(()=>{this.callback()},w)})}destroy(){return C(this,void 0,void 0,function*(){this.callback=void 0,this.lastTimeout&&(clearTimeout(this.lastTimeout),this.lastTimeout=void 0),this.workerTimer&&(this.workerTimer.terminate(),this.workerTimer=void 0)})}};return DefaultVideoFrameProcessorTimer.default=E,DefaultVideoFrameProcessorTimer}var hasRequiredDefaultVideoFrameProcessorPipeline;function requireDefaultVideoFrameProcessorPipeline(){if(hasRequiredDefaultVideoFrameProcessorPipeline)return DefaultVideoFrameProcessorPipeline;hasRequiredDefaultVideoFrameProcessorPipeline=1;var C=DefaultVideoFrameProcessorPipeline&&DefaultVideoFrameProcessorPipeline.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=DefaultVideoFrameProcessorPipeline&&DefaultVideoFrameProcessorPipeline.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(DefaultVideoFrameProcessorPipeline,"__esModule",{value:!0});const w=E(requireCanvasVideoFrameBuffer()),R=E(requireDefaultVideoFrameProcessorTimer()),M=15;let x=class{constructor(S,T,_=new R.default){this.logger=S,this.stages=T,this.fr=M,this.outputMediaStream=new MediaStream,this.videoInput=document.createElement("video"),this.canvasOutput=document.createElement("canvas"),this.outputCtx=this.canvasOutput.getContext("2d"),this.canvasInput=document.createElement("canvas"),this.inputCtx=this.canvasInput.getContext("2d"),this.inputVideoStream=null,this.sourceBuffers=[],this.destBuffers=[],this.observers=new Set,this.hasStarted=!1,this.process=D=>C(this,void 0,void 0,function*(){if(!this.inputVideoStream)return;const Y=performance.now();this.videoInput.videoWidth&&(this.canvasInput.width!==this.videoInput.videoWidth&&(this.canvasInput.width=this.videoInput.videoWidth,this.canvasInput.height=this.videoInput.videoHeight,this.sourceBuffers[0].height=this.canvasInput.height,this.sourceBuffers[0].width=this.canvasInput.width,this.sourceBuffers[0].framerate=this.framerate),this.inputCtx.drawImage(this.videoInput,0,0));let ee=[];ee.push(this.sourceBuffers[0]);try{for(const de of this.processors)ee=yield de.process(ee)}catch{this.forEachObserver(de=>{de.processingDidFailToStart&&de.processingDidFailToStart()});return}this.destBuffers=ee;let ie;try{ie=yield this.destBuffers[0].asCanvasImageSource()}catch{this.inputVideoStream&&(this.logger.info("buffers are destroyed and pipeline could not start"),this.forEachObserver(de=>{de.processingDidFailToStart&&de.processingDidFailToStart()}));return}const ne=ie.width,re=ie.height;ne!==0&&re!==0&&(this.canvasOutput.width!==ne&&this.canvasOutput.height!==re&&(this.canvasOutput.width=ne,this.canvasOutput.height=re),this.outputCtx.drawImage(ie,0,0,ne,re,0,0,ne,re),this.hasStarted||(this.hasStarted=!0,this.forEachObserver(de=>{de.processingDidStart&&de.processingDidStart()})));const oe=performance.now()-Y,ae=1e3*2/this.framerate-oe,le=Math.max(0,1e3/this.framerate-oe);ae<=0&&this.forEachObserver(de=>{de.processingLatencyTooHigh&&de.processingLatencyTooHigh(oe)}),yield this.timer.start(le,this.process.bind(this))}),this.timer=_}destroy(){if(this.stop(),this.stages)for(const S of this.stages)S.destroy();this.timer.destroy()}get framerate(){return this.fr}set framerate(S){this.fr=S<0?M:S}stop(){if(this.videoInput.removeEventListener("loadedmetadata",this.process),this.videoInput.srcObject=null,this.destroyInputMediaStreamAndBuffers(),this.outputMediaStream)for(const S of this.outputMediaStream.getVideoTracks())S.stop();this.hasStarted&&(this.hasStarted=!1,this.forEachObserver(S=>{S.processingDidStop&&S.processingDidStop()}))}addObserver(S){this.observers.add(S)}removeObserver(S){this.observers.delete(S)}getInputMediaStream(){return C(this,void 0,void 0,function*(){return this.inputVideoStream})}getActiveOutputMediaStream(){return this.isOutputMediaStreamActive()?this.outputMediaStream:(this.outputMediaStream=this.canvasOutput.captureStream(this.framerate),this.cloneInputAudioTracksToOutput(),this.outputMediaStream)}setInputMediaStream(S){return C(this,void 0,void 0,function*(){if(!S){this.stop();return}if(S.getVideoTracks().length===0){this.logger.error("No video tracks in input media stream, ignoring");return}this.inputVideoStream=S;const T=this.inputVideoStream.getVideoTracks()[0].getSettings();this.logger.info(`processing pipeline input stream settings ${JSON.stringify(T)}`),this.canvasOutput.width=T.width,this.canvasOutput.height=T.height,this.videoInput.addEventListener("loadedmetadata",this.process),this.videoInput.srcObject=this.inputVideoStream,this.videoInput.setAttribute("playsinline","true");const _=new w.default(this.canvasInput);this.sourceBuffers.push(_),this.videoInput.load();try{yield this.videoInput.play()}catch{this.logger.warn("Video element play() overrided by another load().")}this.cloneInputAudioTracksToOutput()})}cloneInputAudioTracksToOutput(){if(!this.isOutputMediaStreamActive()||this.inputVideoStream===null){this.logger.info("Not cloning input audio tracks to output, do not have media streams ready");return}for(const S of this.outputMediaStream.getAudioTracks())this.logger.info(`Removing audio track ${S.id} from output stream`),this.outputMediaStream.removeTrack(S);for(const S of this.inputVideoStream.getAudioTracks())this.logger.info(`Adding audio track ${S.id} to output stream`),this.outputMediaStream.addTrack(S)}isOutputMediaStreamActive(){return this.outputMediaStream&&this.outputMediaStream.active}set processors(S){this.stages=S}get processors(){return this.stages}forEachObserver(S){for(const T of this.observers)setTimeout(()=>{S(T)},0)}destroyInputMediaStreamAndBuffers(){if(this.inputVideoStream)for(const S of this.inputVideoStream.getTracks())S.stop();this.inputVideoStream=null;for(const S of this.sourceBuffers)S.destroy();this.sourceBuffers=[]}};return DefaultVideoFrameProcessorPipeline.default=x,DefaultVideoFrameProcessorPipeline}var hasRequiredDefaultVideoTransformDevice;function requireDefaultVideoTransformDevice(){if(hasRequiredDefaultVideoTransformDevice)return DefaultVideoTransformDevice;hasRequiredDefaultVideoTransformDevice=1;var C=DefaultVideoTransformDevice&&DefaultVideoTransformDevice.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=DefaultVideoTransformDevice&&DefaultVideoTransformDevice.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(DefaultVideoTransformDevice,"__esModule",{value:!0});const w=E(requireDefaultBrowserBehavior()),R=E(requireDefaultVideoFrameProcessorPipeline());let M=class Qp{constructor(S,T,_,D=new w.default){this.logger=S,this.device=T,this.processors=_,this.browserBehavior=D,this.observers=new Set,this.pipe=new R.default(this.logger,this.processors),this.pipe.addObserver(this)}get outputMediaStream(){return this.pipe.outputMediaStream}passEventControllerToProcessors(S){if(this.pipe.processors)for(const T of this.pipe.processors)typeof T.setEventController=="function"&&T.setEventController(S)}chooseNewInnerDevice(S){const T=new Qp(this.logger,S,this.processors,this.browserBehavior);return T.pipe=this.pipe,T}getInnerDevice(){return this.device}intrinsicDevice(){return C(this,void 0,void 0,function*(){return this.device})}transformStream(S){return C(this,void 0,void 0,function*(){return yield this.pipe.setInputMediaStream(S),this.inputMediaStream=S,this.pipe.getActiveOutputMediaStream()})}onOutputStreamDisconnect(){this.logger.info("DefaultVideoTransformDevice: detach stopping input media stream");const S=this.device&&this.device.id;if(this.pipe.stop(),!S&&this.inputMediaStream)for(const T of this.inputMediaStream.getVideoTracks())T.stop()}stop(){return C(this,void 0,void 0,function*(){if(this.inputMediaStream)for(const S of this.inputMediaStream.getVideoTracks())S.stop();this.pipe.destroy(),this.inputMediaStream=null})}addObserver(S){this.observers.add(S)}removeObserver(S){this.observers.delete(S)}processingDidStart(){this.logger.info("video transform device processing started"),this.forEachObserver(S=>{S.processingDidStart&&S.processingDidStart()})}processingLatencyTooHigh(S){this.forEachObserver(T=>{T.processingLatencyTooHigh&&T.processingLatencyTooHigh(S)})}processingDidFailToStart(){this.logger.info("video transform device processing failed to start"),this.forEachObserver(S=>{S.processingDidFailToStart&&S.processingDidFailToStart()})}processingDidStop(){this.logger.info("video transform device processing stopped"),this.forEachObserver(S=>{S.processingDidStop&&S.processingDidStop()})}forEachObserver(S){for(const T of this.observers)setTimeout(()=>{S(T)},0)}};return DefaultVideoTransformDevice.default=M,DefaultVideoTransformDevice}var DefaultVideoTile={},DefaultModality={},hasRequiredDefaultModality;function requireDefaultModality(){if(hasRequiredDefaultModality)return DefaultModality;hasRequiredDefaultModality=1;var C=DefaultModality&&DefaultModality.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(DefaultModality,"__esModule",{value:!0});const E=C(requireContentShareConstants());let w=class Da{constructor(M){this._id=M}id(){return this._id}base(){return this._id?this._id.split(Da.MODALITY_SEPARATOR)[0]:""}modality(){if(!this._id)return"";const M=this._id.split(Da.MODALITY_SEPARATOR);return M.length===2?M[1]:""}hasModality(M){return M!==""&&this.modality()===M}withModality(M){const x=new Da(this.base()+Da.MODALITY_SEPARATOR+M);return M===""||this.base()===""||new Da(x._id).modality()!==M?new Da(this.base()):x}};return DefaultModality.default=w,w.MODALITY_SEPARATOR=E.default.Modality[0],w.MODALITY_CONTENT=E.default.Modality.substr(1),DefaultModality}var VideoTileState={},hasRequiredVideoTileState;function requireVideoTileState(){if(hasRequiredVideoTileState)return VideoTileState;hasRequiredVideoTileState=1,Object.defineProperty(VideoTileState,"__esModule",{value:!0});let C=class em{constructor(){this.tileId=null,this.localTile=!1,this.localTileStarted=!1,this.isContent=!1,this.active=!1,this.paused=!1,this.poorConnection=!1,this.boundAttendeeId=null,this.boundExternalUserId=null,this.boundVideoStream=null,this.boundVideoElement=null,this.nameplate=null,this.videoStreamContentWidth=null,this.videoStreamContentHeight=null,this.videoElementCSSWidthPixels=null,this.videoElementCSSHeightPixels=null,this.devicePixelRatio=0,this.videoElementPhysicalWidthPixels=null,this.videoElementPhysicalHeightPixels=null,this.streamId=null,this.groupId=null}clone(){const w=new em;return w.tileId=this.tileId,w.localTile=this.localTile,w.isContent=this.isContent,w.active=this.active,w.paused=this.paused,w.poorConnection=this.poorConnection,w.boundAttendeeId=this.boundAttendeeId,w.boundExternalUserId=this.boundExternalUserId,w.boundVideoStream=this.boundVideoStream,w.boundVideoElement=this.boundVideoElement,w.nameplate=this.nameplate,w.videoStreamContentWidth=this.videoStreamContentWidth,w.videoStreamContentHeight=this.videoStreamContentHeight,w.videoElementCSSWidthPixels=this.videoElementCSSWidthPixels,w.videoElementCSSHeightPixels=this.videoElementCSSHeightPixels,w.devicePixelRatio=this.devicePixelRatio,w.videoElementPhysicalWidthPixels=this.videoElementPhysicalWidthPixels,w.videoElementPhysicalHeightPixels=this.videoElementPhysicalHeightPixels,w.streamId=this.streamId,w.groupId=this.groupId,w}};return VideoTileState.default=C,VideoTileState}var hasRequiredDefaultVideoTile;function requireDefaultVideoTile(){if(hasRequiredDefaultVideoTile)return DefaultVideoTile;hasRequiredDefaultVideoTile=1;var C=DefaultVideoTile&&DefaultVideoTile.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(DefaultVideoTile,"__esModule",{value:!0});const E=C(requireDefaultBrowserBehavior()),w=C(requireDefaultModality()),R=C(requireVideoTileState());let M=class ea{constructor(S,T,_,D){this.tileController=_,this.devicePixelRatioMonitor=D,this.tileState=new R.default,this.tileState.tileId=S,this.tileState.localTile=T,this.devicePixelRatioMonitor.registerObserver(this)}static connectVideoStreamToVideoElement(S,T,_){const D=_&&S.getVideoTracks()[0].getSettings().facingMode!=="environment"?"rotateY(180deg)":"";if(ea.setVideoElementFlag(T,"disablePictureInPicture",_),ea.setVideoElementFlag(T,"disableRemotePlayback",_),T.style.transform!==D&&(T.style.transform=D),T.hasAttribute("controls")&&T.removeAttribute("controls"),T.hasAttribute("autoplay")||T.setAttribute("autoplay","true"),T.hasAttribute("playsinline")||T.setAttribute("playsinline","true"),T.hasAttribute("muted")||(T.setAttribute("muted","true"),T.muted=!0),T.srcObject!==S&&(T.srcObject=S,new E.default().requiresVideoPlayWorkaround()&&T.paused)){const Y=T.play();Y!==void 0&&Y.catch(ee=>{console.warn("Error playing video in Safari",ee)}).then(()=>{console.debug("Video played successfully in Safari")})}}static disconnectVideoStreamFromVideoElement(S,T,_=!1){if(S)if(T)_||(S.srcObject=null,S.style.transform="");else{if(!S.srcObject)return;S.pause(),S.style.transform="",ea.setVideoElementFlag(S,"disablePictureInPicture",!1),ea.setVideoElementFlag(S,"disableRemotePlayback",!1),S.srcObject=null}}destroy(){this.devicePixelRatioMonitor.removeObserver(this),this.tileState.boundVideoElement&&this.tileState.boundVideoElement.srcObject===this.tileState.boundVideoStream&&ea.disconnectVideoStreamFromVideoElement(this.tileState.boundVideoElement,!1),this.tileState=new R.default}devicePixelRatioChanged(S){this.tileState.devicePixelRatio=S,this.sendTileStateUpdate()}id(){return this.tileState.tileId}state(){return this.tileState.clone()}stateRef(){return this.tileState}bindVideoStream(S,T,_,D,Y,ee,ie,ne){let re=!1;this.tileState.boundAttendeeId!==S&&(this.tileState.boundAttendeeId=S,new w.default(S).hasModality(w.default.MODALITY_CONTENT)&&(this.tileState.isContent=!0),re=!0),this.tileState.boundExternalUserId!==ie&&(this.tileState.boundExternalUserId=ie,re=!0),this.tileState.localTile!==T&&(this.tileState.localTile=T,re=!0),this.tileState.boundVideoStream!==_&&(this.tileState.boundVideoStream=_,re=!0),this.tileState.videoStreamContentWidth!==D&&(this.tileState.videoStreamContentWidth=D,re=!0),this.tileState.videoStreamContentHeight!==Y&&(this.tileState.videoStreamContentHeight=Y,re=!0),this.tileState.streamId!==ee&&(this.tileState.streamId=ee,re=!0),this.tileState.groupId!==ne&&(this.tileState.groupId=ne,re=!0),re&&this.sendTileStateUpdate()}bindVideoElement(S){let T=!1;this.tileState.boundVideoElement!==S&&(this.tileState.boundVideoElement=S,T=!0),this.tileState.boundVideoElement!==null?(this.tileState.videoElementCSSWidthPixels!==S.clientWidth&&(this.tileState.videoElementCSSWidthPixels=S.clientWidth,T=!0),this.tileState.videoElementCSSHeightPixels!==S.clientHeight&&(this.tileState.videoElementCSSHeightPixels=S.clientHeight,T=!0)):(this.tileState.videoElementCSSWidthPixels=null,this.tileState.videoElementCSSHeightPixels=null),T&&this.sendTileStateUpdate()}pause(){this.tileState.paused||(this.tileState.paused=!0,this.sendTileStateUpdate())}unpause(){this.tileState.paused&&(this.tileState.paused=!1,this.sendTileStateUpdate())}markPoorConnection(){return this.tileState.poorConnection?!1:(this.tileState.poorConnection=!0,this.sendTileStateUpdate(),!0)}unmarkPoorConnection(){return this.tileState.poorConnection?(this.tileState.poorConnection=!1,this.sendTileStateUpdate(),!0):!1}capture(){if(!this.tileState.active)return null;const S=document.createElement("canvas"),T=this.tileState.boundVideoElement;S.width=T.videoWidth||T.width,S.height=T.videoHeight||T.height;const _=S.getContext("2d");return _.drawImage(T,0,0,S.width,S.height),_.getImageData(0,0,S.width,S.height)}setStreamId(S){this.tileState.streamId=S,this.tileController.sendTileStateUpdate(this.state())}sendTileStateUpdate(){this.updateActiveState(),this.updateVideoStreamOnVideoElement(),this.updateVideoElementPhysicalPixels(),this.tileController.sendTileStateUpdate(this.state())}updateActiveState(){this.tileState.active=!!(!this.tileState.paused&&!this.tileState.poorConnection&&this.tileState.boundAttendeeId&&this.tileState.boundVideoElement&&this.tileState.boundVideoStream)}updateVideoElementPhysicalPixels(){typeof this.tileState.videoElementCSSWidthPixels=="number"&&typeof this.tileState.videoElementCSSHeightPixels=="number"?(this.tileState.videoElementPhysicalWidthPixels=this.tileState.devicePixelRatio*this.tileState.videoElementCSSWidthPixels,this.tileState.videoElementPhysicalHeightPixels=this.tileState.devicePixelRatio*this.tileState.videoElementCSSHeightPixels):(this.tileState.videoElementPhysicalWidthPixels=null,this.tileState.videoElementPhysicalHeightPixels=null)}updateVideoStreamOnVideoElement(){this.tileState.active?ea.connectVideoStreamToVideoElement(this.tileState.boundVideoStream,this.tileState.boundVideoElement,this.tileState.localTile):ea.disconnectVideoStreamFromVideoElement(this.tileState.boundVideoElement,this.tileState.paused,this.tileController.keepLastFrameWhenPaused)}static setVideoElementFlag(S,T,_){T in S&&(S[T]=_)}};return DefaultVideoTile.default=M,DefaultVideoTile}var AudioTransformDevice={},hasRequiredAudioTransformDevice;function requireAudioTransformDevice(){if(hasRequiredAudioTransformDevice)return AudioTransformDevice;hasRequiredAudioTransformDevice=1,Object.defineProperty(AudioTransformDevice,"__esModule",{value:!0}),AudioTransformDevice.isAudioTransformDevice=void 0;function C(E){return!!E&&typeof E=="object"&&"mute"in E&&"stop"in E&&"intrinsicDevice"in E}return AudioTransformDevice.isAudioTransformDevice=C,AudioTransformDevice}var DeviceSelection={},hasRequiredDeviceSelection;function requireDeviceSelection(){if(hasRequiredDeviceSelection)return DeviceSelection;hasRequiredDeviceSelection=1,Object.defineProperty(DeviceSelection,"__esModule",{value:!0});let C=class{constructor(){this.groupId=""}matchesConstraints(E){return JSON.stringify(this.constraints)===JSON.stringify(E)}};return DeviceSelection.default=C,DeviceSelection}var GetUserMediaError={},hasRequiredGetUserMediaError;function requireGetUserMediaError(){if(hasRequiredGetUserMediaError)return GetUserMediaError;hasRequiredGetUserMediaError=1,Object.defineProperty(GetUserMediaError,"__esModule",{value:!0});let C=class extends Error{constructor(E,w){super(w||"Error fetching device."),this.cause=E,this.name="GetUserMediaError"}};return GetUserMediaError.default=C,GetUserMediaError}var NotFoundError={},hasRequiredNotFoundError;function requireNotFoundError(){if(hasRequiredNotFoundError)return NotFoundError;hasRequiredNotFoundError=1;var C=NotFoundError&&NotFoundError.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(NotFoundError,"__esModule",{value:!0});const E=C(requireGetUserMediaError());let w=class extends E.default{constructor(R){super(R),this.name="NotFoundError"}};return NotFoundError.default=w,NotFoundError}var NotReadableError={},hasRequiredNotReadableError;function requireNotReadableError(){if(hasRequiredNotReadableError)return NotReadableError;hasRequiredNotReadableError=1;var C=NotReadableError&&NotReadableError.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(NotReadableError,"__esModule",{value:!0});const E=C(requireGetUserMediaError());let w=class extends E.default{constructor(R){super(R),this.name="NotReadableError"}};return NotReadableError.default=w,NotReadableError}var OverconstrainedError={},hasRequiredOverconstrainedError;function requireOverconstrainedError(){if(hasRequiredOverconstrainedError)return OverconstrainedError;hasRequiredOverconstrainedError=1;var C=OverconstrainedError&&OverconstrainedError.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(OverconstrainedError,"__esModule",{value:!0});const E=C(requireGetUserMediaError());let w=class extends E.default{constructor(R,M){super(R),this.constraint=M,this.name="OverconstrainedError"}};return OverconstrainedError.default=w,OverconstrainedError}var PermissionDeniedError={},hasRequiredPermissionDeniedError;function requirePermissionDeniedError(){if(hasRequiredPermissionDeniedError)return PermissionDeniedError;hasRequiredPermissionDeniedError=1;var C=PermissionDeniedError&&PermissionDeniedError.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(PermissionDeniedError,"__esModule",{value:!0});const E=C(requireGetUserMediaError());let w=class extends E.default{constructor(R,M){super(R,M),this.name="PermissionDeniedError"}};return PermissionDeniedError.default=w,PermissionDeniedError}var _TypeError={},hasRequired_TypeError;function require_TypeError(){if(hasRequired_TypeError)return _TypeError;hasRequired_TypeError=1;var C=_TypeError&&_TypeError.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(_TypeError,"__esModule",{value:!0});const E=C(requireGetUserMediaError());class w extends E.default{constructor(M){super(M),this.name="TypeError"}}return _TypeError.default=w,_TypeError}var VideoQualitySettings={},hasRequiredVideoQualitySettings;function requireVideoQualitySettings(){if(hasRequiredVideoQualitySettings)return VideoQualitySettings;hasRequiredVideoQualitySettings=1,Object.defineProperty(VideoQualitySettings,"__esModule",{value:!0});let C=class{constructor(E,w,R){this.videoWidth=E,this.videoHeight=w,this.videoFrameRate=R}equals(E){return this.videoWidth===E.videoWidth&&this.videoHeight===E.videoHeight&&this.videoFrameRate===E.videoFrameRate}};return VideoQualitySettings.default=C,C.VideoDisabled=new C(0,0,0),C.VideoResolutionHD=new C(1280,720,30),C.VideoResolutionFHD=new C(1920,1080,30),C.VideoResolutionUHD=new C(3840,2160,30),VideoQualitySettings}var VideoTransformDevice={},hasRequiredVideoTransformDevice;function requireVideoTransformDevice(){if(hasRequiredVideoTransformDevice)return VideoTransformDevice;hasRequiredVideoTransformDevice=1,Object.defineProperty(VideoTransformDevice,"__esModule",{value:!0}),VideoTransformDevice.isVideoTransformDevice=void 0;function C(E){return!!E&&typeof E=="object"&&"transformStream"in E&&"stop"in E&&"intrinsicDevice"in E}return VideoTransformDevice.isVideoTransformDevice=C,VideoTransformDevice}var hasRequiredDefaultDeviceController;function requireDefaultDeviceController(){if(hasRequiredDefaultDeviceController)return DefaultDeviceController;hasRequiredDefaultDeviceController=1;var C=DefaultDeviceController&&DefaultDeviceController.__awaiter||function(ge,he,ve,be){function Se(Re){return Re instanceof ve?Re:new ve(function(Ae){Ae(Re)})}return new(ve||(ve=Promise))(function(Re,Ae){function Me(Pe){try{Qe(be.next(Pe))}catch(je){Ae(je)}}function Be(Pe){try{Qe(be.throw(Pe))}catch(je){Ae(je)}}function Qe(Pe){Pe.done?Re(Pe.value):Se(Pe.value).then(Me,Be)}Qe((be=be.apply(ge,he||[])).next())})},E=DefaultDeviceController&&DefaultDeviceController.__importDefault||function(ge){return ge&&ge.__esModule?ge:{default:ge}};Object.defineProperty(DefaultDeviceController,"__esModule",{value:!0});const w=E(requireDefaultBrowserBehavior()),R=E(requireDefaultMediaDeviceFactory()),M=E(requireAsyncScheduler()),x=E(requirePromiseQueue()),S=requireTypes$1(),T=E(requireDefaultVideoTransformDevice()),_=E(requireDefaultVideoTile()),D=requireAudioTransformDevice(),Y=E(requireDeviceSelection()),ee=E(requireGetUserMediaError()),ie=E(requireNotFoundError()),ne=E(requireNotReadableError()),re=E(requireOverconstrainedError()),oe=E(requirePermissionDeniedError()),ae=E(require_TypeError()),le=E(requireVideoQualitySettings()),de=requireVideoTransformDevice();let me=class ki{constructor(he,ve,be=new w.default,Se){this.logger=he,this.browserBehavior=be,this.eventController=Se,this.deviceInfoCache=null,this.activeDevices={audio:null,video:null},this.chosenVideoTransformDevice=null,this.audioOutputDeviceId=void 0,this.deviceChangeObservers=new Set,this.mediaStreamBrokerObservers=new Set,this.deviceLabelTrigger=()=>navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),this.audioInputDestinationNode=null,this.audioInputSourceNode=null,this.videoInputQualitySettings=null,this.useWebAudio=!1,this.useMediaConstraintsFallback=!0,this.audioInputTaskQueue=new x.default,this.videoInputTaskQueue=new x.default,this.muted=!1,this.mediaStreamMuteObserver=(Be,Qe)=>{for(const Pe of this.deviceChangeObservers)M.default.nextTick(()=>{this.deviceChangeObservers.has(Pe)&&Pe.audioInputMuteStateChanged&&Pe.audioInputMuteStateChanged(Be,Qe)})},this.alreadyHandlingDeviceChange=!1;const{enableWebAudio:Re=!1,useMediaConstraintsFallback:Ae=!0}=ve||{};this.useWebAudio=Re,this.useMediaConstraintsFallback=Ae,this.videoInputQualitySettings=new le.default(ki.defaultVideoWidth,ki.defaultVideoHeight,ki.defaultVideoFrameRate);const Me=this.browserBehavior.requiresResolutionAlignment(this.videoInputQualitySettings.videoWidth,this.videoInputQualitySettings.videoHeight);this.videoInputQualitySettings.videoWidth=Me[0],this.videoInputQualitySettings.videoHeight=Me[1],this.logger.info(`DefaultDeviceController video dimension ${this.videoInputQualitySettings.videoWidth} x ${this.videoInputQualitySettings.videoHeight}`);try{this.mediaDeviceWrapper=new R.default().create();const Be=navigator.mediaDevices.getSupportedConstraints();this.logger.info(`Supported Constraints in this browser ${JSON.stringify(Be)}`)}catch(Be){he.error(Be.message)}}isWatchingForDeviceChanges(){return!!this.onDeviceChangeCallback}ensureWatchingDeviceChanges(){var he;this.isWatchingForDeviceChanges()||(this.logger.info("Starting devicechange listener."),this.onDeviceChangeCallback=()=>{this.logger.info("Device change event callback is triggered"),this.handleDeviceChange()},(he=this.mediaDeviceWrapper)===null||he===void 0||he.addEventListener("devicechange",this.onDeviceChangeCallback))}stopWatchingDeviceChanges(){var he;this.isWatchingForDeviceChanges()&&(this.logger.info("Stopping devicechange listener."),(he=this.mediaDeviceWrapper)===null||he===void 0||he.removeEventListener("devicechange",this.onDeviceChangeCallback),this.onDeviceChangeCallback=void 0)}shouldObserveDeviceChanges(){return this.deviceChangeObservers.size?!0:this.activeDevices.audio&&this.activeDevices.audio.constraints!==null||this.activeDevices.video&&this.activeDevices.video.constraints!==null||!!this.audioOutputDeviceId}watchForDeviceChangesIfNecessary(){this.shouldObserveDeviceChanges()?this.ensureWatchingDeviceChanges():this.stopWatchingDeviceChanges()}destroy(){return C(this,void 0,void 0,function*(){this.stopWatchingDeviceChanges(),yield this.stopAudioInput(),yield this.stopVideoInput()})}listAudioInputDevices(he=!1){return C(this,void 0,void 0,function*(){const ve=yield this.listDevicesOfKind("audioinput",he);return this.trace("listAudioInputDevices",he,ve),ve})}listVideoInputDevices(he=!1){return C(this,void 0,void 0,function*(){const ve=yield this.listDevicesOfKind("videoinput",he);return this.trace("listVideoInputDevices",he,ve),ve})}listAudioOutputDevices(he=!1){return C(this,void 0,void 0,function*(){const ve=yield this.listDevicesOfKind("audiooutput",he);return this.trace("listAudioOutputDevices",he,ve),ve})}pushAudioMeetingStateForPermissions(he){var ve;(ve=this.eventController)===null||ve===void 0||ve.publishEvent(he===void 0?"audioInputUnselected":"audioInputSelected")}pushVideoMeetingStateForPermissions(he){var ve;(ve=this.eventController)===null||ve===void 0||ve.publishEvent(he===void 0?"videoInputUnselected":"videoInputSelected")}startAudioInput(he){return C(this,void 0,void 0,function*(){return yield this.audioInputTaskQueue.add(()=>this.startAudioInputTask(he))})}startAudioInputTask(he){var ve;return C(this,void 0,void 0,function*(){if(he===void 0){this.logger.error("Audio input device cannot be undefined");return}try{return D.isAudioTransformDevice(he)?(this.logger.info(`Choosing transform input device ${he}`),yield this.chooseAudioTransformInputDevice(he)):(this.logger.info(`Choosing intrinsic audio input device ${he}`),this.removeTransform(),yield this.chooseInputIntrinsicDevice("audio",he)),this.trace("startAudioInputDevice",he,"success"),this.useWebAudio?(this.attachAudioInputStreamToAudioContext(this.activeDevices.audio.stream),this.pushAudioMeetingStateForPermissions(this.getMediaStreamDestinationNode().stream),yield(ve=this.transform)===null||ve===void 0?void 0:ve.device.mute(this.muted),this.getMediaStreamDestinationNode().stream):(this.publishAudioInputDidChangeEvent(this.activeDevices.audio.stream),this.activeDevices.audio.stream)}catch(be){throw be}})}stopAudioInput(){return C(this,void 0,void 0,function*(){return this.audioInputTaskQueue.add(()=>this.stopAudioInputTask())})}stopAudioInputTask(){return C(this,void 0,void 0,function*(){try{if(this.useWebAudio){this.releaseAudioTransformStream();return}this.stopTracksAndRemoveCallbacks("audio")}finally{this.watchForDeviceChangesIfNecessary(),this.publishAudioInputDidChangeEvent(void 0)}})}chooseAudioTransformInputDevice(he){var ve;return C(this,void 0,void 0,function*(){if(((ve=this.transform)===null||ve===void 0?void 0:ve.device)===he)return;if(!this.useWebAudio)throw new Error("Cannot apply transform device without enabling Web Audio.");const be=ki.getAudioContext();if(!(be instanceof OfflineAudioContext))switch(be.state){case"running":break;case"closed":throw new Error("Cannot choose a transform device with a closed audio context.");case"suspended":yield be.resume()}let Se;try{Se=yield he.createAudioNode(be)}catch(Ae){throw this.logger.error(`Unable to create transform device node: ${Ae}.`),Ae}const Re=yield he.intrinsicDevice();yield this.chooseInputIntrinsicDevice("audio",Re),this.logger.debug(`Got inner stream: ${Re}.`),this.setTransform(he,Se)})}chooseVideoTransformInputDevice(he){var ve;return C(this,void 0,void 0,function*(){if(this.eventController&&he instanceof T.default&&he.passEventControllerToProcessors(this.eventController),he===this.chosenVideoTransformDevice){this.logger.info("Reselecting same VideoTransformDevice");return}const be=this.chosenVideoTransformDevice;be&&this.logger.info("Switched from previous VideoTransformDevice");const Se=!!be,Re=yield he.intrinsicDevice();if(!this.isMediaStreamReusableByDeviceId((ve=this.activeDevices.video)===null||ve===void 0?void 0:ve.stream,Re)){this.logger.info("video transform device needs new intrinsic device"),Se&&be.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=he,this.activeDevices.video=null,yield this.chooseInputIntrinsicDevice("video",Re),this.logger.info("apply processors to transform"),yield this.chosenVideoTransformDevice.transformStream(this.activeDevices.video.stream);return}this.chosenVideoTransformDevice=he,this.logger.info("video transform device uses previous stream"),this.logger.info("apply processors to transform"),yield he.transformStream(this.activeDevices.video.stream)})}startVideoInput(he){return C(this,void 0,void 0,function*(){return yield this.videoInputTaskQueue.add(()=>this.startVideoInputTask(he))})}startVideoInputTask(he){return C(this,void 0,void 0,function*(){if(!he){this.logger.error("Invalid video input device");return}try{return de.isVideoTransformDevice(he)?(this.logger.info(`Choosing video transform device ${he}`),yield this.chooseVideoTransformInputDevice(he),this.publishVideoInputDidChangeEvent(this.chosenVideoTransformDevice.outputMediaStream),this.chosenVideoTransformDevice.outputMediaStream):(this.chosenVideoInputIsTransformDevice()&&(this.chosenVideoTransformDevice.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=null),yield this.chooseInputIntrinsicDevice("video",he),this.trace("startVideoInputDevice",he),this.publishVideoInputDidChangeEvent(this.activeDevices.video.stream),this.activeDevices.video.stream)}catch(ve){throw ve}})}stopVideoInput(){return C(this,void 0,void 0,function*(){return this.videoInputTaskQueue.add(()=>this.stopVideoInputTask())})}stopVideoInputTask(){return C(this,void 0,void 0,function*(){try{if(this.chosenVideoInputIsTransformDevice()){this.releaseVideoTransformStream();return}this.stopTracksAndRemoveCallbacks("video")}finally{this.watchForDeviceChangesIfNecessary(),this.publishVideoInputDidChangeEvent(void 0)}})}chooseAudioOutput(he){return C(this,void 0,void 0,function*(){this.audioOutputDeviceId=he,this.watchForDeviceChangesIfNecessary();const ve=this.deviceInfoFromDeviceId("audiooutput",this.audioOutputDeviceId);this.publishAudioOutputDidChangeEvent(ve),this.trace("chooseAudioOutput",he,null)})}addDeviceChangeObserver(he){this.logger.info("adding device change observer"),this.deviceChangeObservers.add(he),this.watchForDeviceChangesIfNecessary(),this.trace("addDeviceChangeObserver")}removeDeviceChangeObserver(he){this.logger.info("removing device change observer"),this.deviceChangeObservers.delete(he),this.watchForDeviceChangesIfNecessary(),this.trace("removeDeviceChangeObserver")}createAnalyserNodeForAudioInput(){var he,ve;if(!this.activeDevices.audio)return null;const be=(ve=(he=this.transform)===null||he===void 0?void 0:he.nodes)===null||ve===void 0?void 0:ve.end;if(be){const Se=be.context.createAnalyser();return Se.removeOriginalInputs=()=>{try{be.disconnect(Se)}catch{}},be.connect(Se),Se}return this.createAnalyserNodeForRawAudioInput()}createAnalyserNodeForRawAudioInput(){return this.activeDevices.audio?this.createAnalyserNodeForStream(this.activeDevices.audio.stream):null}createAnalyserNodeForStream(he){const ve=ki.getAudioContext(),be=ve.createAnalyser(),Se=ve.createMediaStreamSource(he);return Se.connect(be),this.trace("createAnalyserNodeForAudioInput"),be.removeOriginalInputs=()=>{try{Se.disconnect(be)}catch{}},be}startVideoPreviewForVideoInput(he){if(!this.activeDevices.video){this.logger.warn("cannot bind video preview since video input device has not been chosen"),this.trace("startVideoPreviewForVideoInput",he.id);return}_.default.connectVideoStreamToVideoElement(this.chosenVideoTransformDevice?this.chosenVideoTransformDevice.outputMediaStream:this.activeDevices.video.stream,he,!0),this.trace("startVideoPreviewForVideoInput",he.id)}stopVideoPreviewForVideoInput(he){_.default.disconnectVideoStreamFromVideoElement(he,!1),this.trace("stopVideoPreviewForVideoInput",he.id)}setDeviceLabelTrigger(he){if(this.deviceInfoCache){for(const ve of this.deviceInfoCache)if(!ve.label){this.deviceInfoCache=null;break}}this.deviceLabelTrigger=he,this.trace("setDeviceLabelTrigger")}mixIntoAudioInput(he){let ve=null;return this.useWebAudio?(ve=ki.getAudioContext().createMediaStreamSource(he),ve.connect(this.getMediaStreamOutputNode())):this.logger.warn("WebAudio is not enabled, mixIntoAudioInput will not work"),this.trace("mixIntoAudioInput",he.id),ve}chooseVideoInputQuality(he,ve,be){const Se=this.browserBehavior.requiresResolutionAlignment(he,ve);this.videoInputQualitySettings=new le.default(Se[0],Se[1],be)}getVideoInputQualitySettings(){return this.videoInputQualitySettings}acquireAudioInputStream(){return C(this,void 0,void 0,function*(){return this.activeDevices.audio||(this.logger.info("No audio device chosen, creating empty audio device"),yield this.startAudioInput(null)),this.useWebAudio?this.getMediaStreamDestinationNode().stream:this.activeDevices.audio.stream})}acquireVideoInputStream(){return C(this,void 0,void 0,function*(){if(!this.activeDevices.video)throw new Error("No video device chosen");return this.chosenVideoInputIsTransformDevice()?this.chosenVideoTransformDevice.outputMediaStream:this.activeDevices.video.stream})}acquireDisplayInputStream(he){return C(this,void 0,void 0,function*(){throw new Error("unsupported")})}releaseAudioTransformStream(){this.logger.info("Stopping audio track for Web Audio graph"),this.stopTracksAndRemoveCallbacks("audio"),this.logger.info("Removing audio transform, if there is one."),this.removeTransform(),this.audioInputSourceNode&&(this.audioInputSourceNode.disconnect(),this.audioInputSourceNode=void 0),this.audioInputDestinationNode&&(this.audioInputDestinationNode.disconnect(),this.audioInputDestinationNode=void 0)}releaseVideoTransformStream(){this.logger.info("Stopping video track for transform"),this.stopTracksAndRemoveCallbacks("video"),this.logger.info("Disconnecting video transform"),this.chosenVideoTransformDevice.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=null}stopTracksAndRemoveCallbacks(he){const ve=this.activeDevices[he];if(!ve)return;const be=ve.endedCallback,Se=ve.trackMuteCallback,Re=ve.trackUnmuteCallback;for(const Ae of ve.stream.getTracks())Ae.stop(),be&&Ae.removeEventListener("ended",be),Se&&Ae.removeEventListener("mute",Se),Re&&Ae.removeEventListener("unmute",Re),delete ve.endedCallback,delete ve.trackMuteCallback,delete ve.trackUnmuteCallback,delete this.activeDevices[he]}chosenVideoInputIsTransformDevice(){return!!this.chosenVideoTransformDevice}muteLocalAudioInputStream(){this.toggleLocalAudioInputStream(!1)}unmuteLocalAudioInputStream(){this.toggleLocalAudioInputStream(!0)}toggleLocalAudioInputStream(he){var ve;let be=this.activeDevices.audio;if(this.useWebAudio&&(be=this.getMediaStreamDestinationNode()),!!be){for(const Se of be.stream.getTracks())Se.enabled!==he&&(Se.enabled=he);this.muted!==!he&&(this.muted=!he,(ve=this.transform)===null||ve===void 0||ve.device.mute(this.muted))}}static getIntrinsicDeviceId(he){if(!he)return;if(typeof he=="string")return he;if(he.id)return he.id;const ve=he.deviceId;if(!ve)return;if(typeof ve=="string"||Array.isArray(ve))return ve;const be=ve;if(typeof be.exact=="string"||Array.isArray(be.exact))return be.exact}static createEmptyAudioDevice(){return ki.synthesizeAudioDevice(0)}static synthesizeAudioDevice(he){const ve=ki.getAudioContext(),be=ve.createMediaStreamDestination();if(he){const Se=ve.createGain();Se.gain.value=.1,Se.connect(be);const Re=ve.createOscillator();Re.frequency.value=he,Re.connect(Se),Re.start()}else{const Se=ve.createBufferSource();try{Se.buffer=ve.createBuffer(1,ve.sampleRate*5,ve.sampleRate)}catch(Re){if(Re&&Re.name==="NotSupportedError")Se.buffer=ve.createBuffer(1,ki.defaultSampleRate*5,ki.defaultSampleRate);else throw Re}Se.buffer.getChannelData(0)[0]=3e-4,Se.loop=!0,Se.connect(be),Se.start()}return be.stream}listDevicesOfKind(he,ve){return C(this,void 0,void 0,function*(){return(ve||this.deviceInfoCache===null||!this.isWatchingForDeviceChanges())&&(yield this.updateDeviceInfoCacheFromBrowser()),this.listCachedDevicesOfKind(he)})}updateDeviceInfoCacheFromBrowser(){var he;return C(this,void 0,void 0,function*(){if(typeof MediaDeviceInfo>"u"){this.deviceInfoCache=[];return}let ve=yield navigator.mediaDevices.enumerateDevices(),be=!0;for(const Se of ve)if(!Se.label){be=!1;break}if(!be)try{this.logger.info("attempting to trigger media device labels since they are hidden");const Se=yield this.deviceLabelTrigger();ve=yield navigator.mediaDevices.enumerateDevices();for(const Re of Se.getTracks())Re.stop()}catch(Se){this.logger.info("unable to get media device labels"),(he=this.eventController)===null||he===void 0||he.publishEvent("deviceLabelTriggerFailed",{deviceLabelTriggerErrorMessage:this.getErrorMessage(Se)})}this.logger.debug(`Update device info cache with devices: ${JSON.stringify(ve)}`),this.deviceInfoCache=ve})}listCachedDevicesOfKind(he){const ve=[];if(this.deviceInfoCache)for(const be of this.deviceInfoCache)be.kind===he&&ve.push(be);return ve}handleDeviceChange(){return C(this,void 0,void 0,function*(){if(this.deviceInfoCache===null)return;if(this.alreadyHandlingDeviceChange){M.default.nextTick(()=>{this.handleDeviceChange()});return}this.alreadyHandlingDeviceChange=!0;const he=this.listCachedDevicesOfKind("audioinput"),ve=this.listCachedDevicesOfKind("videoinput"),be=this.listCachedDevicesOfKind("audiooutput");yield this.updateDeviceInfoCacheFromBrowser();const Se=this.listCachedDevicesOfKind("audioinput"),Re=this.listCachedDevicesOfKind("videoinput"),Ae=this.listCachedDevicesOfKind("audiooutput");this.forEachObserver(Me=>{this.areDeviceListsEqual(he,Se)||S.Maybe.of(Me.audioInputsChanged).map(Be=>Be.bind(Me)(Se)),this.areDeviceListsEqual(ve,Re)||S.Maybe.of(Me.videoInputsChanged).map(Be=>Be.bind(Me)(Re)),this.areDeviceListsEqual(be,Ae)||S.Maybe.of(Me.audioOutputsChanged).map(Be=>Be.bind(Me)(Ae))}),this.alreadyHandlingDeviceChange=!1})}handleDeviceStreamEnded(he,ve){return C(this,void 0,void 0,function*(){try{he==="audio"?(this.logger.warn("Audio input device which was active is no longer available, resetting to null device"),yield this.startAudioInput(null)):(this.logger.warn("Video input device which was active is no longer available, stopping video"),yield this.stopVideoInput())}catch{this.logger.error("Failed to choose null device after stream ended.")}he==="audio"?this.forEachObserver(be=>{S.Maybe.of(be.audioInputStreamEnded).map(Se=>Se.bind(be)(ve))}):this.forEachObserver(be=>{S.Maybe.of(be.videoInputStreamEnded).map(Se=>Se.bind(be)(ve))})})}forEachObserver(he){for(const ve of this.deviceChangeObservers)M.default.nextTick(()=>{this.deviceChangeObservers.has(ve)&&he(ve)})}forEachMediaStreamBrokerObserver(he){for(const ve of this.mediaStreamBrokerObservers)M.default.nextTick(()=>{this.mediaStreamBrokerObservers.has(ve)&&he(ve)})}areDeviceListsEqual(he,ve){return JSON.stringify(he.map(be=>JSON.stringify(be)).sort())===JSON.stringify(ve.map(be=>JSON.stringify(be)).sort())}intrinsicDeviceAsMediaStream(he){return he&&he.id?he:null}hasSameMediaStreamId(he,ve,be){var Se,Re,Ae,Me;let Be;return he==="audio"?(Be=be==null?void 0:be.audio.streamId,!!Be&&Be===((Re=(Se=ve.constraints)===null||Se===void 0?void 0:Se.audio)===null||Re===void 0?void 0:Re.streamId)):(Be=be==null?void 0:be.video.streamId,!!Be&&Be===((Me=(Ae=ve==null?void 0:ve.constraints)===null||Ae===void 0?void 0:Ae.video)===null||Me===void 0?void 0:Me.streamId))}hasSameGroupId(he,ve,be){if(he==="")return!0;const Se=ki.getIntrinsicDeviceId(be);return this.logger.debug(`Checking deviceIds ${Se} of type ${typeof Se} with groupId ${he}`),typeof Se=="string"&&he===this.getGroupIdFromDeviceId(ve,Se)}getGroupIdFromDeviceId(he,ve){if(this.deviceInfoCache!==null){const be=this.listCachedDevicesOfKind(`${he}input`).find(Se=>Se.deviceId===ve);if(be&&be.groupId)return this.logger.debug(`GroupId of deviceId ${ve} found in cache is ${be.groupId}`),be.groupId}return this.logger.debug(`GroupId of deviceId ${ve} found in cache is empty`),""}handleGetUserMediaError(he,ve){if(!he)throw new ee.default(he);switch(he.name){case"NotReadableError":case"TrackStartError":throw new ne.default(he);case"NotFoundError":case"DevicesNotFoundError":throw new ie.default(he);case"NotAllowedError":case"PermissionDeniedError":case"SecurityError":throw ve&&ve<ki.permissionDeniedOriginDetectionThresholdMs?new oe.default(he,"Permission denied by browser"):new oe.default(he,"Permission denied by user");case"OverconstrainedError":case"ConstraintNotSatisfiedError":throw new re.default(he);case"TypeError":throw new ae.default(he);case"AbortError":default:throw new ee.default(he)}}matchesDeviceSelection(he,ve,be,Se){return be&&be.stream.active&&(this.hasSameMediaStreamId(he,be,Se)||be.groupId!==null&&this.hasSameGroupId(be.groupId,he,ve))?(this.logger.debug(`Compare current device constraint ${JSON.stringify(be.constraints)} to proposed constraints ${JSON.stringify(Se)}`),be.matchesConstraints(Se)):!1}chooseInputIntrinsicDevice(he,ve){var be,Se;return C(this,void 0,void 0,function*(){const Re=this.getMediaStreamConstraints(he,ve);if(this.matchesDeviceSelection(he,ve,this.activeDevices[he],Re)){this.logger.info(`reusing existing ${he} input device`);return}this.activeDevices[he]&&this.activeDevices[he].stream&&this.stopTracksAndRemoveCallbacks(he);const Ae=Date.now(),Me=new Y.default;try{this.logger.info(`requesting new ${he} device with constraint ${JSON.stringify(Re)}`);const Be=this.intrinsicDeviceAsMediaStream(ve);he==="audio"&&ve===null?(Me.stream=ki.createEmptyAudioDevice(),Me.constraints=null):Be?(this.logger.info(`using media stream ${Be.id} for ${he} device`),Me.stream=Be,Me.constraints=Re):(Me.stream=yield navigator.mediaDevices.getUserMedia(Re),Me.constraints=Re),yield this.handleNewInputDevice(he,Me)}catch(Be){const Qe=this.getErrorMessage(Be);he==="audio"?(be=this.eventController)===null||be===void 0||be.publishEvent("audioInputFailed",{audioInputErrorMessage:Qe}):(Se=this.eventController)===null||Se===void 0||Se.publishEvent("videoInputFailed",{videoInputErrorMessage:Qe}),this.logger.error(`failed to get ${he} device for constraints ${JSON.stringify(Re)}: ${Qe}`);let Pe=!0;if(Be&&"constraint"in Be&&(this.logger.error(`Over-constrained by constraint: ${Be.constraint}`),this.useMediaConstraintsFallback)){const je=this.getMediaStreamConstraints(he,ve,!0),Dt=JSON.stringify(je);if(Dt!==JSON.stringify(Re)){this.logger.info(`retry requesting new ${he} device with minimal constraint ${Dt}`);try{Me.stream=yield navigator.mediaDevices.getUserMedia(je),Me.constraints=je,yield this.handleNewInputDevice(he,Me),Pe=!1}catch(Xe){this.logger.error(`failed to get ${he} device for constraints ${Dt}: ${this.getErrorMessage(Xe)}`)}}}if(Pe){if(he==="audio"){this.logger.info(`choosing null ${he} device instead`);try{Me.stream=ki.createEmptyAudioDevice(),Me.constraints=null,yield this.handleNewInputDevice(he,Me)}catch(je){this.logger.error(`failed to choose null ${he} device. ${je.name}: ${je.message}`)}}this.handleGetUserMediaError(Be,Date.now()-Ae)}}finally{this.watchForDeviceChangesIfNecessary()}})}getErrorMessage(he){return he?he.name&&he.message?`${he.name}: ${he.message}`:he.name?he.name:he.message?he.message:"UnknownError":"UnknownError"}handleNewInputDevice(he,ve){var be;return C(this,void 0,void 0,function*(){this.logger.info(`got ${he} device for constraints ${JSON.stringify(ve.constraints)}`);const Se=(be=this.getMediaTrackSettings(ve.stream))===null||be===void 0?void 0:be.deviceId;ve.groupId=Se?this.getGroupIdFromDeviceId(he,Se):"",this.activeDevices[he]=ve,this.logger.debug(`Set activeDevice to ${JSON.stringify(ve)}`),this.watchForDeviceChangesIfNecessary();const Re=ve.stream.getTracks()[0];if(Re&&(ve.endedCallback=()=>{this.activeDevices[he]&&this.activeDevices[he].stream===ve.stream&&(this.handleDeviceStreamEnded(he,Se),delete ve.endedCallback)},Re.addEventListener("ended",ve.endedCallback,{once:!0})),he==="audio"){const Ae=ve.stream.getAudioTracks()[0];if(Ae){const Me=Ae.getSettings().deviceId||ve.stream;ve.trackMuteCallback=()=>{this.mediaStreamMuteObserver(Me,!0)},ve.trackUnmuteCallback=()=>{this.mediaStreamMuteObserver(Me,!1)},Ae.addEventListener("mute",ve.trackMuteCallback,{once:!1}),Ae.addEventListener("unmute",ve.trackUnmuteCallback,{once:!1}),this.logger.debug("Notifying mute state after selection"),Ae.muted?ve.trackMuteCallback():ve.trackUnmuteCallback()}}})}calculateMediaStreamConstraints(he,ve,be,Se){if(Se&&this.listCachedDevicesOfKind(`${he}input`).length===1)return!0;const Re={};return this.browserBehavior.requiresNoExactMediaStreamConstraints()?Re.deviceId=ve:Re.deviceId={exact:ve},be&&(Re.groupId=be),Se?Re:he==="video"?(Re.width={ideal:this.videoInputQualitySettings.videoWidth},Re.height={ideal:this.videoInputQualitySettings.videoHeight},Re.frameRate={ideal:this.videoInputQualitySettings.videoFrameRate},Re):(this.supportSampleRateConstraint()&&(Re.sampleRate={ideal:ki.defaultSampleRate}),this.supportSampleSizeConstraint()&&(Re.sampleSize={ideal:ki.defaultSampleSize}),this.supportChannelCountConstraint()&&(Re.channelCount={ideal:ki.defaultChannelCount}),Object.assign({echoCancellation:!0,googEchoCancellation:!0,googEchoCancellation2:!0,googAutoGainControl:!0,googAutoGainControl2:!0,googNoiseSuppression:!0,googNoiseSuppression2:!0,googHighpassFilter:!0},Re))}getMediaStreamConstraintsFromTrackConstraints(he,ve){return he==="audio"?{audio:ve}:{video:ve}}getMediaStreamConstraints(he,ve,be=!1){let Se={};if(!ve)return null;const Re=this.intrinsicDeviceAsMediaStream(ve);if(Re)return Se.streamId=Re.id,this.getMediaStreamConstraintsFromTrackConstraints(he,Se);if(typeof ve=="string"){let Ae="";return this.browserBehavior.requiresGroupIdMediaStreamConstraints()&&(this.deviceInfoCache!==null?Ae=this.getGroupIdFromDeviceId(he,ve):this.logger.error("Device cache is not populated. Please make sure to call list devices first")),Se=this.calculateMediaStreamConstraints(he,ve,Ae,be),this.getMediaStreamConstraintsFromTrackConstraints(he,Se)}return fe(ve)?(Se=this.calculateMediaStreamConstraints(he,ve.deviceId,ve.groupId,be),this.getMediaStreamConstraintsFromTrackConstraints(he,Se)):(Se=ve,this.getMediaStreamConstraintsFromTrackConstraints(he,Se))}deviceInfoFromDeviceId(he,ve){if(this.deviceInfoCache===null)return null;for(const be of this.deviceInfoCache)if(be.kind===he&&be.deviceId===ve)return be;return null}hasAppliedTransform(){return!!this.transform}isMediaStreamReusableByDeviceId(he,ve){if(!he||!he.active||!ve)return!1;if(ve.id)return he.id===ve.id;const be=this.getMediaTrackSettings(he);if(!be.deviceId)return!1;const Se=ki.getIntrinsicDeviceId(ve);return typeof Se=="string"?be.deviceId===Se:!1}getMediaTrackSettings(he){var ve;return(ve=he.getTracks()[0])===null||ve===void 0?void 0:ve.getSettings()}reconnectAudioInputs(){if(!this.audioInputSourceNode)return;this.audioInputSourceNode.disconnect();const he=this.getMediaStreamOutputNode();this.audioInputSourceNode.connect(he)}setTransform(he,ve){var be,Se;(Se=(be=this.transform)===null||be===void 0?void 0:be.nodes)===null||Se===void 0||Se.end.disconnect(),this.transform={nodes:ve,device:he};const Re=ve==null?void 0:ve.end,Ae=this.getMediaStreamDestinationNode();this.logger.debug(`Connecting transform node ${Re} to destination ${Ae}.`),Re==null||Re.connect(Ae),this.reconnectAudioInputs()}removeTransform(){var he;const ve=this.transform;if(ve)return(he=this.transform.nodes)===null||he===void 0||he.end.disconnect(),this.transform=void 0,this.reconnectAudioInputs(),ve}attachAudioInputStreamToAudioContext(he){var ve;(ve=this.audioInputSourceNode)===null||ve===void 0||ve.disconnect(),this.audioInputSourceNode=ki.getAudioContext().createMediaStreamSource(he);const be=this.getMediaStreamOutputNode();this.audioInputSourceNode.connect(be)}getMediaStreamDestinationNode(){return this.audioInputDestinationNode||(this.audioInputDestinationNode=ki.getAudioContext().createMediaStreamDestination()),this.audioInputDestinationNode}getMediaStreamOutputNode(){var he,ve;return((ve=(he=this.transform)===null||he===void 0?void 0:he.nodes)===null||ve===void 0?void 0:ve.start)||this.getMediaStreamDestinationNode()}static setDefaultLatencyHint(he){ki.defaultLatencyHint=he}static getAudioContext(){if(!ki.audioContext){const he={};navigator.mediaDevices.getSupportedConstraints().sampleRate&&(he.sampleRate=ki.defaultSampleRate),new w.default().requiresPlaybackLatencyHintForAudioContext()&&(he.latencyHint="playback"),ki.defaultLatencyHint&&(he.latencyHint=ki.defaultLatencyHint),ki.audioContext=new(window.AudioContext||window.webkitAudioContext)(he)}return ki.audioContext}static suspendAudioContext(){return C(this,void 0,void 0,function*(){return ki.audioContext?ki.audioContext.suspend():Promise.resolve()})}static resumeAudioContext(){return C(this,void 0,void 0,function*(){return ki.audioContext?ki.audioContext.resume():Promise.resolve()})}static closeAudioContext(){if(ki.audioContext)try{ki.audioContext.close()}catch{}ki.audioContext=null}addMediaStreamBrokerObserver(he){this.mediaStreamBrokerObservers.add(he)}removeMediaStreamBrokerObserver(he){this.mediaStreamBrokerObservers.delete(he)}publishVideoInputDidChangeEvent(he){this.forEachMediaStreamBrokerObserver(ve=>{ve.videoInputDidChange&&ve.videoInputDidChange(he)}),this.pushVideoMeetingStateForPermissions(he)}publishAudioInputDidChangeEvent(he){this.forEachMediaStreamBrokerObserver(ve=>{ve.audioInputDidChange&&ve.audioInputDidChange(he)}),this.pushAudioMeetingStateForPermissions(he)}publishAudioOutputDidChangeEvent(he){this.forEachMediaStreamBrokerObserver(ve=>{ve.audioOutputDidChange&&ve.audioOutputDidChange(he)})}supportSampleRateConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().sampleRate}supportSampleSizeConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().sampleSize}supportChannelCountConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().channelCount}trace(he,ve,be){let Se=`API/DefaultDeviceController/${he}`;typeof ve<"u"&&(Se+=` ${JSON.stringify(ve)}`),typeof be<"u"&&(Se+=` -> ${JSON.stringify(be)}`),this.logger.info(Se)}};DefaultDeviceController.default=me,me.permissionDeniedOriginDetectionThresholdMs=500,me.defaultVideoWidth=960,me.defaultVideoHeight=540,me.defaultVideoFrameRate=15,me.defaultSampleRate=48e3,me.defaultSampleSize=16,me.defaultChannelCount=1,me.audioContext=null;function fe(ge){return typeof ge=="object"&&"deviceId"in ge&&"groupId"in ge&&"kind"in ge&&"label"in ge}return DefaultDeviceController}var hasRequiredContentShareMediaStreamBroker;function requireContentShareMediaStreamBroker(){if(hasRequiredContentShareMediaStreamBroker)return ContentShareMediaStreamBroker;hasRequiredContentShareMediaStreamBroker=1;var C=ContentShareMediaStreamBroker&&ContentShareMediaStreamBroker.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=ContentShareMediaStreamBroker&&ContentShareMediaStreamBroker.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(ContentShareMediaStreamBroker,"__esModule",{value:!0});const w=E(requireDefaultBrowserBehavior()),R=E(requireDefaultDeviceController());let M=class $d{constructor(S){this.logger=S}get mediaStream(){return this._mediaStream}set mediaStream(S){this._mediaStream=S}acquireAudioInputStream(){return C(this,void 0,void 0,function*(){return this._mediaStream.getAudioTracks().length===0?(this.logger.info("No audio stream available. Synthesizing an audio stream."),R.default.synthesizeAudioDevice(0)):this._mediaStream})}acquireVideoInputStream(){return C(this,void 0,void 0,function*(){return this._mediaStream})}acquireDisplayInputStream(S){return C(this,void 0,void 0,function*(){return S&&S.video&&S.video.mandatory&&S.video.mandatory.chromeMediaSource&&S.video.mandatory.chromeMediaSourceId?navigator.mediaDevices.getUserMedia(S):navigator.mediaDevices.getDisplayMedia(S)})}acquireScreenCaptureDisplayInputStream(S,T){return C(this,void 0,void 0,function*(){return this.acquireDisplayInputStream(this.screenCaptureDisplayMediaConstraints(S,T))})}screenCaptureDisplayMediaConstraints(S,T){return{audio:!!(!S&&new w.default().getDisplayMediaAudioCaptureSupport()),video:Object.assign(Object.assign({},!S&&{frameRate:{max:T||$d.defaultFrameRate}}),S&&{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:S,maxFrameRate:T||$d.defaultFrameRate}})}}toggleMediaStream(S){let T=!1;if(this.mediaStream)for(let _=0;_<this.mediaStream.getTracks().length;_++)this.mediaStream.getTracks()[_].enabled!==S&&(this.mediaStream.getTracks()[_].enabled=S,T=!0);return T}cleanup(){if(this.mediaStream)for(let S=0;S<this.mediaStream.getTracks().length;S++)this.mediaStream.getTracks()[S].stop();this.mediaStream=null}muteLocalAudioInputStream(){throw new Error("unsupported")}unmuteLocalAudioInputStream(){throw new Error("unsupported")}addMediaStreamBrokerObserver(S){}removeMediaStreamBrokerObserver(S){}};return ContentShareMediaStreamBroker.default=M,M.defaultFrameRate=15,ContentShareMediaStreamBroker}var CreatePeerConnectionTask={},hasRequiredCreatePeerConnectionTask;function requireCreatePeerConnectionTask(){if(hasRequiredCreatePeerConnectionTask)return CreatePeerConnectionTask;hasRequiredCreatePeerConnectionTask=1;var C=CreatePeerConnectionTask&&CreatePeerConnectionTask.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})},E=CreatePeerConnectionTask&&CreatePeerConnectionTask.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(CreatePeerConnectionTask,"__esModule",{value:!0});const w=E(requireBaseTask());let R=class extends w.default{constructor(M){super(M.logger),this.context=M,this.taskName="CreatePeerConnectionTask",this.removeTrackAddedEventListener=null,this.removeTrackRemovedEventListeners={},this.trackEvents=["ended","mute","unmute","isolationchange","overconstrained"],this.removeVideoTrackEventListeners={},this.trackAddedHandler=x=>{const S=x.track;if(this.context.logger.info(`received track event: kind=${S.kind} id=${S.id} label=${S.label}`),x.transceiver&&x.transceiver.currentDirection==="inactive")return;if(x.streams.length===0){this.context.logger.warn("Track event but no stream");return}const T=x.streams[0];S.kind==="audio"?this.context.audioMixController.bindAudioStream(T):S.kind==="video"&&!this.trackIsVideoInput(S)&&this.addRemoteVideoTrack(S,T)}}removeObserver(){this.removeTrackAddedEventListener&&this.removeTrackAddedEventListener();for(const M in this.removeTrackRemovedEventListeners)this.removeTrackRemovedEventListeners[M]()}addPeerConnectionEventLogger(){const M=this.context.peer;M.addEventListener("connectionstatechange",()=>{this.context.logger.info(`peer connection state changed: ${M.connectionState}`)}),M.addEventListener("negotiationneeded",()=>{this.context.logger.info("peer connection negotiation is needed")}),M.addEventListener("icegatheringstatechange",()=>{this.context.logger.info(`peer connection ice gathering state changed: ${M.iceGatheringState}`)}),M.addEventListener("icecandidate",x=>{this.context.logger.info(`peer connection ice candidate: ${x.candidate?x.candidate.candidate:"(null)"}`)}),M.addEventListener("iceconnectionstatechange",()=>{this.context.logger.info(`peer connection ice connection state changed: ${M.iceConnectionState}`)})}run(){return C(this,void 0,void 0,function*(){this.context.removableObservers.push(this);const M=this.context.turnCredentials&&this.context.turnCredentials.uris.length>0?{iceServers:[{urls:this.context.turnCredentials.uris,username:this.context.turnCredentials.username,credential:this.context.turnCredentials.password,credentialType:"password"}],iceTransportPolicy:"relay"}:{};M.bundlePolicy=this.context.browserBehavior.requiresBundlePolicy(),M.sdpSemantics="unified-plan",M.encodedInsertableStreams=this.context.audioProfile.hasRedundancyEnabled(),this.context.peer?this.context.logger.info("reusing peer connection"):(this.context.logger.info("creating new peer connection"),this.context.peer=new RTCPeerConnection(M),this.addPeerConnectionEventLogger()),this.removeTrackAddedEventListener=()=>{this.context.peer&&this.context.peer.removeEventListener("track",this.trackAddedHandler),this.removeTrackAddedEventListener=null},this.context.peer.addEventListener("track",this.trackAddedHandler)})}trackIsVideoInput(M){return this.context.transceiverController.useTransceivers()?(this.logger.debug(()=>"getting video track type"),this.context.transceiverController.trackIsVideoInput(M)):!1}addRemoteVideoTrack(M,x){var S;const T=x.id,_=this.context.videoStreamIndex.attendeeIdForTrack(T);let D,Y;if(this.context.videoTileController.getVideoTileForAttendeeId?(Y=this.context.videoTileController.getVideoTileForAttendeeId(_),D=!!(!((S=Y==null?void 0:Y.state())===null||S===void 0)&&S.boundVideoStream)):D=this.context.videoTileController.haveVideoTileForAttendeeId(_),D){this.context.logger.info(`Not adding remote track. Already have tile for attendeeId:  ${_}`);return}Y||(Y=this.context.videoTileController.addVideoTile(),this.logger.info(`Created video tile ${Y.id()}`));let ee=this.context.videoStreamIndex.streamIdForTrack(T);typeof ee>"u"&&(this.logger.warn(`stream not found for tile=${Y.id()} track=${T}`),ee=null);let ie=this.context.videoStreamIndex.groupIdForStreamId(ee);ie===void 0&&(ie=null);for(let me=0;me<this.trackEvents.length;me++){const fe=this.trackEvents[me],ge=x.getVideoTracks();if(ge&&ge.length){const he=ge[0],ve=()=>{this.context.logger.info(`received the ${fe} event for tile=${Y.id()} id=${M.id} streamId=${ee}`),fe==="ended"&&this.removeRemoteVideoTrack(M,Y.state())};he.addEventListener(fe,ve),this.removeVideoTrackEventListeners[M.id]||(this.removeVideoTrackEventListeners[M.id]=[]),this.removeVideoTrackEventListeners[M.id].push(()=>{he.removeEventListener(fe,ve)})}}let ne,re;if(M.getSettings){const me=M.getSettings();ne=me.width,re=me.height}else{const me=M.getCapabilities();ne=me.width,re=me.height}const oe=this.context.videoStreamIndex.externalUserIdForTrack(T);Y.bindVideoStream(_,!1,x,ne,re,ee,oe,ie),this.logger.info(`video track added, use tile=${Y.id()} track=${T} streamId=${ee} groupId=${ie}`);const ae="removetrack",le=x,de=()=>this.removeRemoteVideoTrack(M,Y.state());this.removeTrackRemovedEventListeners[M.id]=()=>{le.removeEventListener(ae,de),delete this.removeTrackRemovedEventListeners[M.id]},le.addEventListener(ae,de)}removeRemoteVideoTrack(M,x){if(this.removeTrackRemovedEventListeners.hasOwnProperty(M.id)){this.removeTrackRemovedEventListeners[M.id]();for(const S of this.removeVideoTrackEventListeners[M.id])S();delete this.removeVideoTrackEventListeners[M.id]}this.logger.info(`video track ended, removing tile=${x.tileId} id=${M.id} stream=${x.streamId}`),x.streamId?this.context.videosPaused.remove(x.streamId):this.logger.warn(`no stream found for tile=${x.tileId}`),this.context.videoTileController.removeVideoTile(x.tileId)}};return CreatePeerConnectionTask.default=R,R.REMOVE_HANDLER_INTERVAL_MS=1e4,CreatePeerConnectionTask}var CreateSDPTask={},MeetingSessionStatusCode={},hasRequiredMeetingSessionStatusCode;function requireMeetingSessionStatusCode(){return hasRequiredMeetingSessionStatusCode||(hasRequiredMeetingSessionStatusCode=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.MeetingSessionStatusCode=void 0;var E;(function(w){w[w.OK=0]="OK",w[w.Left=1]="Left",w[w.AudioJoinedFromAnotherDevice=2]="AudioJoinedFromAnotherDevice",w[w.AudioAuthenticationRejected=3]="AudioAuthenticationRejected",w[w.AudioCallAtCapacity=4]="AudioCallAtCapacity",w[w.MeetingEnded=5]="MeetingEnded",w[w.AudioInternalServerError=6]="AudioInternalServerError",w[w.AudioServiceUnavailable=7]="AudioServiceUnavailable",w[w.AudioDisconnected=8]="AudioDisconnected",w[w.VideoCallSwitchToViewOnly=9]="VideoCallSwitchToViewOnly",w[w.VideoCallAtSourceCapacity=10]="VideoCallAtSourceCapacity",w[w.SignalingBadRequest=11]="SignalingBadRequest",w[w.SignalingInternalServerError=12]="SignalingInternalServerError",w[w.SignalingRequestFailed=13]="SignalingRequestFailed",w[w.ICEGatheringTimeoutWorkaround=14]="ICEGatheringTimeoutWorkaround",w[w.ConnectionHealthReconnect=15]="ConnectionHealthReconnect",w[w.RealtimeApiFailed=16]="RealtimeApiFailed",w[w.TaskFailed=17]="TaskFailed",w[w.IncompatibleSDP=18]="IncompatibleSDP",w[w.TURNCredentialsForbidden=19]="TURNCredentialsForbidden",w[w.NoAttendeePresent=20]="NoAttendeePresent",w[w.AudioAttendeeRemoved=21]="AudioAttendeeRemoved",w[w.AudioVideoWasRemovedFromPrimaryMeeting=22]="AudioVideoWasRemovedFromPrimaryMeeting",w[w.AudioVideoDisconnectedWhilePromoted=23]="AudioVideoDisconnectedWhilePromoted",w[w.AudioDisconnectAudio=24]="AudioDisconnectAudio"})(E=C.MeetingSessionStatusCode||(C.MeetingSessionStatusCode={})),C.default=E}(MeetingSessionStatusCode)),MeetingSessionStatusCode}var SDP={},SDPCandidateType={},hasRequiredSDPCandidateType;function requireSDPCandidateType(){return hasRequiredSDPCandidateType||(hasRequiredSDPCandidateType=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.SDPCandidateType=void 0;var E;(function(w){w.Host="host",w.ServerReflexive="srflx",w.PeerReflexive="prflx",w.Relay="relay"})(E=C.SDPCandidateType||(C.SDPCandidateType={})),C.default=E}(SDPCandidateType)),SDPCandidateType}var SDPMediaSection={},hasRequiredSDPMediaSection;function requireSDPMediaSection(){if(hasRequiredSDPMediaSection)return SDPMediaSection;hasRequiredSDPMediaSection=1,Object.defineProperty(SDPMediaSection,"__esModule",{value:!0});let C=class{};return SDPMediaSection.default=C,SDPMediaSection}var VideoCodecCapability={},hasRequiredVideoCodecCapability;function requireVideoCodecCapability(){if(hasRequiredVideoCodecCapability)return VideoCodecCapability;hasRequiredVideoCodecCapability=1,Object.defineProperty(VideoCodecCapability,"__esModule",{value:!0});const C=requireSignalingProtocol();let E=class on{constructor(R,M){this.codecName=R,this.codecCapability=M}equals(R){return R!==void 0&&this.codecName===R.codecName&&this.codecCapability.mimeType===R.codecCapability.mimeType&&this.codecCapability.clockRate===R.codecCapability.clockRate&&this.codecCapability.sdpFmtpLine===R.codecCapability.sdpFmtpLine}fmtpLineMatches(R,M){const x=this.codecCapability.sdpFmtpLine;if(!x)return!1;if(this.codecName==="H264"){const S=/profile-level-id=([0-9a-f]{4})[0-9a-f]{2}/i,T=x.replace(S,"profile-level-id=$1");return R.replace(S,"profile-level-id=$1").startsWith(`a=fmtp:${M} ${T}`)}return R.startsWith(`a=fmtp:${M} ${x}`)}static vp8(){return new on("VP8",{clockRate:9e4,mimeType:"video/VP8"})}static h264BaselineProfile(){return new on("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f"})}static h264ConstrainedBaselineProfile(){return new on("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f"})}static h264MainProfile(){return new on("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=4d001f"})}static h264HighProfile(){return new on("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=64001f"})}static h264ConstrainedHighProfile(){return new on("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=640c1f"})}static h264(){return on.h264ConstrainedBaselineProfile()}static vp9Profile0(){return new on("VP9",{clockRate:9e4,mimeType:"video/VP9",sdpFmtpLine:"profile-id=0"})}static vp9(){return on.vp9Profile0()}static av1Main(){return new on("AV1",{clockRate:9e4,mimeType:"video/AV1"})}static av1(){return on.av1Main()}static fromSignaled(R){switch(R){case C.SdkVideoCodecCapability.VP8:return on.vp8();case C.SdkVideoCodecCapability.H264_BASELINE_PROFILE:return on.h264BaselineProfile();case C.SdkVideoCodecCapability.H264_CONSTRAINED_BASELINE_PROFILE:return on.h264ConstrainedBaselineProfile();case C.SdkVideoCodecCapability.H264_MAIN_PROFILE:return on.h264MainProfile();case C.SdkVideoCodecCapability.H264_HIGH_PROFILE:return on.h264HighProfile();case C.SdkVideoCodecCapability.H264_CONSTRAINED_HIGH_PROFILE:return on.h264ConstrainedHighProfile();case C.SdkVideoCodecCapability.VP9_PROFILE_0:return on.vp9Profile0();case C.SdkVideoCodecCapability.AV1_MAIN_PROFILE:return on.av1Main();default:return}}};return VideoCodecCapability.default=E,VideoCodecCapability}var hasRequiredSDP;function requireSDP(){if(hasRequiredSDP)return SDP;hasRequiredSDP=1;var C=SDP&&SDP.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(SDP,"__esModule",{value:!0});const E=C(requireSDPCandidateType()),w=C(requireSDPMediaSection()),R=C(requireVideoCodecCapability());let M=class Zt{constructor(S){this.sdp=S}clone(){return new Zt(this.sdp)}static isRTPCandidate(S){const T=/candidate[:](\S+) (\d+)/g.exec(S);return!(T===null||T[2]!=="1")}static linesToSDP(S){return new Zt(S.join(Zt.CRLF))}static candidateTypeFromString(S){switch(S){case E.default.Host:return E.default.Host;case E.default.ServerReflexive:return E.default.ServerReflexive;case E.default.PeerReflexive:return E.default.PeerReflexive;case E.default.Relay:return E.default.Relay}return null}static candidateType(S){const T=/a[=]candidate[:].* typ ([a-z]+) /g.exec(S);return T===null?null:Zt.candidateTypeFromString(T[1])}static mediaType(S){const T=/m=(audio|video)/g.exec(S);if(T!==null)return T[1]}static mid(S){if(S.includes("a=mid:"))return S.replace(/^(a=mid:)/,"")}static direction(S){const T=/a=(sendrecv|sendonly|recvonly|inactive)/g.exec(S);if(T!==null)return T[1]}static splitLines(S){return S.trim().split(`
`).map(T=>T.trim())}static splitSections(S){return S.split(`
m=`).map((T,_)=>(_>0?"m="+T:T).trim()+Zt.CRLF)}static findActiveCameraSection(S){let T=0,_=!1;for(const D of S){if(/^m=video/.test(D)&&(D.indexOf("sendrecv")>-1||D.indexOf("sendonly")===-1&&D.indexOf("recvonly")===-1&&D.indexOf("inactive")===-1)){_=!0;break}T++}return _===!1&&(T=-1),T}static extractSSRCsFromFIDGroupLine(S){return/^a=ssrc-group:FID\s(.+)/.exec(S)[1]}static matchPrefix(S,T){return Zt.splitLines(S).filter(_=>_.indexOf(T)===0)}lines(){return this.sdp.split(Zt.CRLF)}hasVideo(){return/^m=video/gm.exec(this.sdp)!==null}hasCandidates(){return/a[=]candidate[:]/g.exec(this.sdp)!==null}hasCandidatesForAllMLines(){return!(this.sdp.indexOf("c=IN IP4 0.0.0.0")>-1)}withoutCandidateType(S){return Zt.linesToSDP(this.lines().filter(T=>Zt.candidateType(T)!==S))}withoutServerReflexiveCandidates(){return this.withoutCandidateType(E.default.ServerReflexive)}withAudioMaxAverageBitrate(S){if(!S)return this.clone();S=Math.trunc(Math.min(Math.max(S,Zt.rfc7587LowestBitrate),Zt.rfc7587HighestBitrate));const T=this.lines(),_=Zt.findOpusFmtpAttributes(T),D=Zt.updateOpusFmtpAttributes(T,_,[`maxaveragebitrate=${S}`]);return Zt.linesToSDP(D)}withStereoAudio(){const S=this.lines(),T=Zt.findOpusFmtpAttributes(S),_=Zt.updateOpusFmtpAttributes(S,T,["stereo=1","sprop-stereo=1"]);return Zt.linesToSDP(_)}static findOpusFmtpAttributes(S){const T=/^a=rtpmap:\s*(\d+)\s+opus\/48000/;let _=!1;const D=[];for(const Y of S)if(Y.startsWith("m=audio")&&(D.push(null),_=!0),Y.startsWith("m=video")&&(_=!1),_){const ee=T.exec(Y);ee!==null&&(D[D.length-1]=`a=fmtp:${ee[1]} `)}return D}static updateOpusFmtpAttributes(S,T,_){const D=[];let Y=0,ee=null;for(const ie of S)if(ie.startsWith("m=audio")&&(ee=T[Y],Y++),ie.startsWith("m=video")&&(ee=null),ee&&ie.startsWith(ee)){const ne=ie.slice(ee.length).split(";"),re=[];for(const oe of ne)_.findIndex(ae=>ae.startsWith(oe.split("=")[0]))<0&&re.push(oe);for(const oe of _)re.push(oe);D.push(ee+re.join(";"))}else D.push(ie);return D}withUnifiedPlanFormat(){let S=this.sdp;return S.includes("mozilla")?this.clone():(S=S.replace("o=-","o=mozilla-chrome"),new Zt(S))}getUniqueRtpHeaderExtensionId(S){const T=[];for(const D of S)if(/^a=extmap:/.test(D.trim())){const Y=+D.split("a=extmap:")[1].split(" ")[0];T.includes(Y)||T.push(Y)}T.sort((D,Y)=>D-Y);let _=0;for(const D of T){if(D-_>1)return _+1;_=D}return _===14?-1:_+1}withVideoLayersAllocationRtpHeaderExtension(S){return this.withRtpHeaderExtension(S,Zt.videoLayersAllocationRtpHeaderExtensionUrl)}withDependencyDescriptorRtpHeaderExtension(S){return this.withRtpHeaderExtension(S,Zt.dependencyDescriptorRtpHeaderExtensionUrl)}withoutDependencyDescriptorRtpHeaderExtension(){const S=Zt.splitLines(this.sdp).filter(T=>!T.includes(Zt.dependencyDescriptorRtpHeaderExtensionUrl));return new Zt(S.join(Zt.CRLF)+Zt.CRLF)}withRtpHeaderExtension(S,T){const _=S?S.getRtpHeaderExtensionId(T):-1,D=_===-1?this.getUniqueRtpHeaderExtensionId(Zt.splitLines(this.sdp)):_,Y=Zt.splitSections(this.sdp),ee=[];for(let ne of Y){if(/^m=video/.test(ne)&&Zt.getRtpHeaderExtensionIdInSection(ne,T)===-1){const re=Zt.splitLines(ne),oe=[];if(D===-1||this.hasRtpHeaderExtensionId(D)){ee.push(ne);continue}for(const ae of re)if(oe.push(ae),/^a=sendrecv/.test(ae.trim())){const le="a=extmap:"+D+" "+T;oe.push(le)}ne=oe.join(Zt.CRLF)+Zt.CRLF}else if(_!==-1&&/^m=video/.test(ne)&&Zt.getRtpHeaderExtensionIdInSection(ne,T)!==_){const re=Zt.splitLines(ne),oe=[];for(const ae of re){if(/^a=extmap:/.test(ae.trim())&&ae.split("a=extmap:")[1].split(" ")[1]===T){if(!this.hasRtpHeaderExtensionId(_)){const le="a=extmap:"+_+" "+T;oe.push(le)}continue}oe.push(ae)}ne=oe.join(Zt.CRLF)+Zt.CRLF}ee.push(ne)}const ie=ee.join("");return new Zt(ie)}ssrcForVideoSendingSection(){const S=this.sdp,T=Zt.splitSections(S);if(T.length<2)return"";const _=Zt.findActiveCameraSection(T);if(_===-1)return"";const D=Zt.matchPrefix(T[_],"a=ssrc-group:FID ");if(D.length<1)return"";const Y=Zt.extractSSRCsFromFIDGroupLine(D[0]),[ee]=Y.split(" ").map(ie=>parseInt(ie,10));return ee.toString()}videoSendSectionHasDifferentSSRC(S){const T=this.ssrcForVideoSendingSection(),_=S.ssrcForVideoSendingSection();if(T===""||_==="")return!1;const D=parseInt(T,10),Y=parseInt(_,10);return D!==Y}removeH264SupportFromSendSection(){const S=this.sdp,T=Zt.splitSections(S),_=Zt.findActiveCameraSection(T);if(_===-1)return new Zt(this.sdp);const D=T[_],Y=Zt.splitLines(D),ee=[],ie=new Map;Y.forEach(ae=>{if(/^a=rtpmap:/.test(ae)){const le=/^a=rtpmap:([0-9]+)\s/.exec(ae);le&&ae.toLowerCase().includes("h264")&&ee.push(parseInt(le[1],10))}if(/^a=fmtp:/.test(ae)){const le=/^a=fmtp:([0-9]+) apt=([0-9]+)/.exec(ae);if(le&&le.length===3){const de=parseInt(le[1],10),me=parseInt(le[2],10);ie.has(me)?ie.get(me).push(de):ie.set(me,[de])}}});const ne=new Set;for(const ae of ee){ne.add(ae);const le=ie.get(ae);if(le)for(const de of le)ne.add(de)}if(ee.length>0){const ae=Y[0].split(" ");Y[0]=ae.filter(le=>!ne.has(parseInt(le))).join(" ")}const re=Y.filter(ae=>{if(!ae.includes("rtpmap")&&!ae.includes("rtcp-fb")&&!ae.includes("fmtp"))return!0;for(const le of ne)if(ae.includes(le.toString()))return!1;return!0});T[_]=re.join(Zt.CRLF)+Zt.CRLF;const oe=T.join("");return new Zt(oe)}mediaSections(){const S=Zt.splitSections(this.sdp);if(S.length<2)return[];const T=[];for(let _=1;_<S.length;_++){const D=new w.default,Y=Zt.splitLines(S[_]);for(const ee of Y){const ie=Zt.mediaType(ee);if(ie!==void 0){D.mediaType=ie;continue}const ne=Zt.direction(ee);if(ne!==void 0){D.direction=ne;continue}const re=Zt.mid(ee);if(re!==void 0){D.mid=re;continue}}T.push(D)}return T}static getRtpHeaderExtensionIdInSection(S,T){const _=Zt.splitLines(S);for(const D of _)if(/^a=extmap:/.test(D.trim())){const Y=D.split("a=extmap:")[1].split(" "),ee=+Y[0];if(Y[1]===T)return ee}return-1}getRtpHeaderExtensionId(S){const T=Zt.splitSections(this.sdp);for(const _ of T)if(/^m=video/.test(_)){const D=Zt.getRtpHeaderExtensionIdInSection(_,S);if(D!==-1)return D}return-1}hasRtpHeaderExtensionId(S){const T=Zt.splitLines(this.sdp);for(const _ of T)if(/^a=extmap:/.test(_.trim())&&+_.split("a=extmap:")[1].split(" ")[0]===S)return!0;return!1}withVideoSendCodecPreferences(S){const T=this.sdp,_=Zt.splitSections(T),D=Zt.findActiveCameraSection(_);if(D===-1)return new Zt(this.sdp);_[D]=this.sectionWithCodecPreferences(_[D],S);const Y=_.join("");return new Zt(Y)}sectionWithCodecPreferences(S,T){const _=new Map,D=Zt.splitLines(S);D.forEach(ne=>{if(!ne.startsWith("a=rtpmap:"))return;const re=/^a=rtpmap:(\d+)\s/.exec(ne);if(!re)return;const oe=re[1];for(const ae of T){if(!ne.includes(`${ae.codecName}/${ae.codecCapability.clockRate}`))continue;let le=!1;if(ae.codecCapability.sdpFmtpLine!==void 0){let de=!1;for(const me of D){if(ae.fmtpLineMatches(me,parseInt(oe))){le=!0;break}de||(de=me.startsWith(`a=fmtp:${oe} profile-id=`))}ae.equals(R.default.vp9Profile0())&&!de&&(le=!0)}else le=!0;if(le){_.set(oe,ae);break}}});const Y=new Set(_.keys()),ee=D[0].split(" ").filter(ne=>!Y.has(ne)),ie=Array.from(_.entries()).sort(([ne,re],[oe,ae])=>{const le=T.indexOf(re),de=T.indexOf(ae);return le-de}).map(([ne,re])=>ne);return ee.splice(3,0,...ie),D[0]=ee.join(" "),D.join(Zt.CRLF)+Zt.CRLF}highestPriorityVideoSendCodec(){const S=this.prioritizedSendVideoCodecCapabilities();return S.length>0?S[0]:void 0}prioritizedSendVideoCodecCapabilities(){const S=this.sdp,T=Zt.splitSections(S),_=Zt.findActiveCameraSection(T);if(_===-1)return[];const D=Zt.splitLines(T[_]),Y=D[0].split(" ");return Y.length<4?[]:Y.slice(3).map(ee=>this.videoCodecCapabilityForPayloadType(D,ee)).filter(ee=>ee!==void 0&&["VP8","H264","VP9","AV1"].includes(ee.codecName))}videoCodecCapabilityForPayloadType(S,T){let _,D,Y;for(const ee of S){const ie=/^a=rtpmap:([0-9]+)\s/.exec(ee);if(ie&&ie[1]===T){const ne=ee.split(" ")[1].split("/");ne.length>=2&&(_=ne[0],D=ne[1])}ee.startsWith(`a=fmtp:${T} `)&&(Y=ee.split(" ")[1])}if(_!==void 0)return new R.default(_,{clockRate:parseInt(D),mimeType:`video/${_}`,sdpFmtpLine:Y})}getAudioPayloadTypes(){const S=new Map,T=this.sdp,_=Zt.splitSections(T);return S.set("opus",Zt.findAudioPayloadType("opus",_)),S.set("red",Zt.findAudioPayloadType("red",_)),S}static findAudioPayloadType(S,T){const _=`a=rtpmap:\\s*(\\d+)\\s+${S}\\/48000`,D=new RegExp(_);for(const Y of T)if(/^m=audio/.test(Y)){const ee=D.exec(Y);if(ee!==null)return Number(ee[1])}return 0}withStartingVideoSendBitrate(S){const T=Zt.splitSections(this.sdp),_=Zt.findActiveCameraSection(T);if(_===-1)return this;const D=Zt.splitLines(T[_]),Y=[];for(const ie of D)if(/^a=fmtp:\d*/.test(ie)){const ne=ie+`;x-google-start-bitrate=${S*1e3}`;Y.push(ne)}else Y.push(ie);T[_]=Y.join(Zt.CRLF)+Zt.CRLF;const ee=T.join("");return new Zt(ee)}};return SDP.default=M,M.CRLF=`\r
`,M.rfc7587LowestBitrate=6e3,M.rfc7587HighestBitrate=51e4,M.dependencyDescriptorRtpHeaderExtensionUrl="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension",M.videoLayersAllocationRtpHeaderExtensionUrl="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00",SDP}var hasRequiredCreateSDPTask;function requireCreateSDPTask(){if(hasRequiredCreateSDPTask)return CreateSDPTask;hasRequiredCreateSDPTask=1;var C=CreateSDPTask&&CreateSDPTask.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=CreateSDPTask&&CreateSDPTask.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(CreateSDPTask,"__esModule",{value:!0});const w=E(requireMeetingSessionStatusCode()),R=E(requireSDP()),M=E(requireBaseTask());let x=class extends M.default{constructor(S){super(S.logger),this.context=S,this.taskName="CreateSDPTask"}cancel(){if(this.cancelPromise){const S=new Error(`canceling ${this.name()}`);this.cancelPromise(S),delete this.cancelPromise}}sessionUsesAudio(){var S,T;return!!(!((T=(S=this.context.meetingSessionConfiguration)===null||S===void 0?void 0:S.urls)===null||T===void 0)&&T.audioHostURL)}sessionUsesVideo(){let S;this.context.transceiverController.useTransceivers()?S=this.context.transceiverController.hasVideoInput():S=this.context.videoTileController.hasStartedLocalVideoTile();const T=!!this.context.videosToReceive&&!this.context.videosToReceive.empty(),_=S||T;return this.context.logger.info(`uses video: ${_} (enabled: true, sending: ${S}, receiving: ${T})`),_}run(){return C(this,void 0,void 0,function*(){const S={offerToReceiveAudio:this.sessionUsesAudio(),offerToReceiveVideo:this.sessionUsesVideo()};this.logger.info(`peer connection offerOptions: ${JSON.stringify(S)}`),yield new Promise((T,_)=>C(this,void 0,void 0,function*(){this.cancelPromise=D=>{_(D)};try{if(this.context.sdpOfferInit=yield this.context.peer.createOffer(S),this.context.logger.info("peer connection created offer"),this.context.previousSdpOffer&&new R.default(this.context.sdpOfferInit.sdp).videoSendSectionHasDifferentSSRC(this.context.previousSdpOffer)){const D=new Error(`canceling ${this.name()} due to the meeting status code: ${w.default.IncompatibleSDP}`);this.context.previousSdpOffer=null,_(D);return}T()}catch(D){_(D)}finally{delete this.cancelPromise}}))})}};return CreateSDPTask.default=x,CreateSDPTask}var DataMessage={},hasRequiredDataMessage;function requireDataMessage(){if(hasRequiredDataMessage)return DataMessage;hasRequiredDataMessage=1,Object.defineProperty(DataMessage,"__esModule",{value:!0});let C=class{constructor(E,w,R,M,x,S){this.timestampMs=E,this.topic=w,this.data=R,this.senderAttendeeId=M,this.senderExternalUserId=x,this.throttled=!!S}text(){return new TextDecoder().decode(this.data)}json(){return JSON.parse(new TextDecoder().decode(this.data))}};return DataMessage.default=C,DataMessage}var DefaultActiveSpeakerDetector={},hasRequiredDefaultActiveSpeakerDetector;function requireDefaultActiveSpeakerDetector(){if(hasRequiredDefaultActiveSpeakerDetector)return DefaultActiveSpeakerDetector;hasRequiredDefaultActiveSpeakerDetector=1;var C=DefaultActiveSpeakerDetector&&DefaultActiveSpeakerDetector.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})},E=DefaultActiveSpeakerDetector&&DefaultActiveSpeakerDetector.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(DefaultActiveSpeakerDetector,"__esModule",{value:!0});const w=E(requireIntervalScheduler());let R=class{constructor(M,x,S,T=1e3,_=200){this.realtimeController=M,this.selfAttendeeId=x,this.hasBandwidthPriorityCallback=S,this.waitIntervalMs=T,this.updateIntervalMs=_,this.speakerScores={},this.speakerMuteState={},this.detectorCallbackToHandler=new Map,this.detectorCallbackToScoresTimer=new Map,this.detectorCallbackToActivityTimer=new Map,this.hasBandwidthPriority=!1,this.mostRecentUpdateTimestamp={}}needUpdate(M){return this.activeSpeakers?this.speakerScores[M]===0&&this.activeSpeakers.includes(M)||this.speakerScores[M]>0&&!this.activeSpeakers.includes(M):!0}updateActiveSpeakers(M,x,S){if(!this.needUpdate(S))return;const T=[],_=Object.keys(this.speakerScores);for(let ee=0;ee<_.length;ee++){const ie=_[ee];T.push({attendeeId:ie,activeScore:this.speakerScores[ie]})}const D=T.sort((ee,ie)=>ie.activeScore-ee.activeScore).filter(function(ee){return ee.activeScore>0}).map(function(ee){return ee.attendeeId});this.activeSpeakers=D,x(D);const Y=D.length>0&&D[0]===this.selfAttendeeId&&M.prioritizeVideoSendBandwidthForActiveSpeaker();this.hasBandwidthPriority!==Y&&(this.hasBandwidthPriority=Y,this.hasBandwidthPriorityCallback(Y))}updateScore(M,x,S,T,_){const D=M.calculateScore(S,T,_);this.speakerScores[S]!==D&&(this.speakerScores[S]=D,this.mostRecentUpdateTimestamp[S]=Date.now(),this.updateActiveSpeakers(M,x,S))}subscribe(M,x,S,T){const _=(Y,ee)=>{if(!ee){this.speakerScores[Y]=0,this.mostRecentUpdateTimestamp[Y]=Date.now(),this.updateActiveSpeakers(M,x,Y);return}this.realtimeController.realtimeSubscribeToVolumeIndicator(Y,(ie,ne,re,oe)=>{this.mostRecentUpdateTimestamp[ie]=Date.now(),re!==null&&(this.speakerMuteState[ie]=re),this.updateScore(M,x,ie,ne,re)})};this.detectorCallbackToHandler.set(x,_);const D=new w.default(this.updateIntervalMs);if(D.start(()=>{for(const Y in this.speakerScores)Date.now()-this.mostRecentUpdateTimestamp[Y]>this.waitIntervalMs&&this.updateScore(M,x,Y,0,this.speakerMuteState[Y])}),this.detectorCallbackToActivityTimer.set(x,D),S&&T){const Y=new w.default(T);Y.start(()=>{S(this.speakerScores)}),this.detectorCallbackToScoresTimer.set(x,Y)}this.realtimeController.realtimeSubscribeToAttendeeIdPresence(_)}unsubscribe(M){const x=this.detectorCallbackToHandler.get(M);this.detectorCallbackToHandler.delete(M),x&&this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(x);const S=this.detectorCallbackToActivityTimer.get(M);S&&(S.stop(),this.detectorCallbackToActivityTimer.delete(M));const T=this.detectorCallbackToScoresTimer.get(M);T&&(T.stop(),this.detectorCallbackToHandler.delete(M))}destroy(){return C(this,void 0,void 0,function*(){for(const M of this.detectorCallbackToHandler.values())this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(M);for(const M of this.detectorCallbackToActivityTimer.values())M.stop();for(const M of this.detectorCallbackToScoresTimer.values())M.stop();this.detectorCallbackToHandler.clear(),this.detectorCallbackToActivityTimer.clear(),this.detectorCallbackToScoresTimer.clear()})}};return DefaultActiveSpeakerDetector.default=R,DefaultActiveSpeakerDetector}var DefaultActiveSpeakerPolicy={},hasRequiredDefaultActiveSpeakerPolicy;function requireDefaultActiveSpeakerPolicy(){if(hasRequiredDefaultActiveSpeakerPolicy)return DefaultActiveSpeakerPolicy;hasRequiredDefaultActiveSpeakerPolicy=1,Object.defineProperty(DefaultActiveSpeakerPolicy,"__esModule",{value:!0});let C=class{constructor(E=.9,w=.01,R=.2,M=.2){this.speakerWeight=E,this.cutoffThreshold=w,this.silenceThreshold=R,this.takeoverRate=M,this.volumes={}}calculateScore(E,w,R){(R||w===null)&&(w=0),this.volumes.hasOwnProperty(E)||(this.volumes[E]=0),w>this.silenceThreshold?w=1:w=0;const M=this.volumes[E]*this.speakerWeight+w*(1-this.speakerWeight);this.volumes[E]=M;for(const x in this.volumes)x!==E&&(this.volumes[x]=Math.max(this.volumes[x]-this.takeoverRate*w,0));return M<this.cutoffThreshold?0:M}prioritizeVideoSendBandwidthForActiveSpeaker(){return!0}};return DefaultActiveSpeakerPolicy.default=C,DefaultActiveSpeakerPolicy}var DefaultAudioMixController={},hasRequiredDefaultAudioMixController;function requireDefaultAudioMixController(){if(hasRequiredDefaultAudioMixController)return DefaultAudioMixController;hasRequiredDefaultAudioMixController=1;var C=DefaultAudioMixController&&DefaultAudioMixController.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=DefaultAudioMixController&&DefaultAudioMixController.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(DefaultAudioMixController,"__esModule",{value:!0});const w=E(requireDefaultBrowserBehavior()),R=E(requireAsyncScheduler());let M=class{constructor(x){this.logger=x,this.audioDevice=null,this.audioElement=null,this.audioStream=null,this.browserBehavior=new w.default,this.observers=new Set}bindAudioElement(x){return C(this,void 0,void 0,function*(){if(!x)throw new Error(`Cannot bind audio element: ${x}`);return this.audioElement=x,this.audioElement.autoplay=!0,this.bindAudioMix()})}unbindAudioElement(){this.audioElement&&(this.audioElement.srcObject=null,this.audioElement=null,this.forEachObserver(x=>{this.audioStream&&x.meetingAudioStreamBecameInactive(this.audioStream)}))}bindAudioStream(x){return C(this,void 0,void 0,function*(){if(x){this.audioStream=x;try{yield this.bindAudioMix()}catch(S){this.logger&&this.logger.warn(`Failed to bind audio stream: ${S}`)}}})}bindAudioDevice(x){return C(this,void 0,void 0,function*(){if(x&&!this.browserBehavior.supportsSetSinkId())throw new Error("Cannot select audio output device. This browser does not support setSinkId.");return this.audioDevice=x,this.bindAudioMix()})}forEachObserver(x){for(const S of this.observers)R.default.nextTick(()=>{x(S)})}bindAudioMix(){var x,S;return C(this,void 0,void 0,function*(){if(!this.audioElement)return;const T=this.audioElement.srcObject;this.audioStream&&(this.audioElement.srcObject=this.audioStream),T!==this.audioStream&&this.forEachObserver(ne=>{T&&ne.meetingAudioStreamBecameInactive(T),this.audioStream&&ne.meetingAudioStreamBecameActive(this.audioStream)});const _=((x=this.audioDevice)===null||x===void 0?void 0:x.deviceId)!==this.audioElement.sinkId;if(_&&typeof this.audioElement.sinkId>"u")throw new Error("Cannot select audio output device. This browser does not support setSinkId.");const D=this.audioDevice?this.audioDevice.deviceId:"",Y=this.audioElement.sinkId;if(D===Y)return;const ee=this.audioElement,ie=this.audioStream;if(this.browserBehavior.hasChromiumWebRTC()&&(ee.srcObject=null),_)try{yield ee.setSinkId(D)}catch(ne){throw(S=this.logger)===null||S===void 0||S.error(`Failed to set sinkId for audio element: ${ne}`),ne}this.browserBehavior.hasChromiumWebRTC()&&(ee.srcObject=ie)})}getCurrentMeetingAudioStream(){return C(this,void 0,void 0,function*(){return this.audioStream})}addAudioMixObserver(x){return C(this,void 0,void 0,function*(){this.observers.add(x)})}removeAudioMixObserver(x){return C(this,void 0,void 0,function*(){this.observers.delete(x)})}audioOutputDidChange(x){return C(this,void 0,void 0,function*(){return this.logger.info("Receive an audio output change event"),this.bindAudioDevice(x)})}};return DefaultAudioMixController.default=M,DefaultAudioMixController}var DefaultAudioVideoController={},SignalingAndMetricsConnectionMonitor={},hasRequiredSignalingAndMetricsConnectionMonitor;function requireSignalingAndMetricsConnectionMonitor(){if(hasRequiredSignalingAndMetricsConnectionMonitor)return SignalingAndMetricsConnectionMonitor;hasRequiredSignalingAndMetricsConnectionMonitor=1,Object.defineProperty(SignalingAndMetricsConnectionMonitor,"__esModule",{value:!0});const C=requireTypes$1();let E=class{constructor(w,R,M,x,S){this.audioVideoController=w,this.realtimeController=R,this.connectionHealthData=M,this.pingPong=x,this.statsCollector=S,this.isActive=!1,this.hasSeenValidCandidatePairMetricsBefore=!1,this.lastTotalBytesReceived=0,this.lastTotalStunMessagesReceived=0,this.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(T=>{this.isActive&&this.receiveSignalStrengthChange(T)})}start(){this.isActive=!0,this.pingPong.addObserver(this),this.pingPong.start(),this.audioVideoController.addObserver(this)}stop(){this.isActive=!1,this.pingPong.removeObserver(this),this.pingPong.stop(),this.audioVideoController.removeObserver(this)}receiveSignalStrengthChange(w){w===0?this.connectionHealthData.setLastNoSignalTimestampMs(Date.now()):w<=.5?this.connectionHealthData.setLastWeakSignalTimestampMs(Date.now()):this.connectionHealthData.setLastGoodSignalTimestampMs(Date.now()),this.updateConnectionHealth()}didReceivePong(w,R,M){this.connectionHealthData.setConsecutiveMissedPongs(0),this.statsCollector.logLatency("ping_pong",R),this.statsCollector.logLatency("ping_pong_clock_skew",M),this.updateConnectionHealth()}didMissPongs(){this.connectionHealthData.setConsecutiveMissedPongs(this.connectionHealthData.consecutiveMissedPongs+1),this.updateConnectionHealth()}metricsDidReceive(w){let R=0,M=0;const x=w.getObservableMetrics(),S=x.audioPacketsReceived,T=x.audioPacketsReceivedFractionLoss,_=x.audioSpeakerDelayMs;typeof _=="number"&&!isNaN(_)&&this.connectionHealthData.setAudioSpeakerDelayMs(_);const D=w.getRTCStatsReport();let Y=0,ee=0;D.forEach(re=>{re.type==="candidate-pair"&&(re.bytesReceived&&(Y+=re.bytesReceived),re.requestsReceived&&(ee+=re.requestsReceived),re.responsesReceived&&(ee+=re.responsesReceived))});const ie=Y-this.lastTotalBytesReceived;this.lastTotalBytesReceived=Y;const ne=ee-this.lastTotalStunMessagesReceived;if(this.lastTotalStunMessagesReceived=ee,typeof S=="number"&&typeof T=="number"){if(R=S,M=T,R<0||M<0||ie<0||ne<0)return}else return;this.addToMinuteWindow(this.connectionHealthData.packetsReceivedInLastMinute,R),this.addToMinuteWindow(this.connectionHealthData.fractionPacketsLostInboundInLastMinute,M),ie>0||ne>0?(this.hasSeenValidCandidatePairMetricsBefore=!0,this.connectionHealthData.setConsecutiveStatsWithNoPackets(0)):this.hasSeenValidCandidatePairMetricsBefore&&this.connectionHealthData.setConsecutiveStatsWithNoPackets(this.connectionHealthData.consecutiveStatsWithNoPackets+1),(R===0||M>0)&&this.connectionHealthData.setLastPacketLossInboundTimestampMs(Date.now()),typeof x.audioPacketsSent=="number"&&this.updateAudioPacketsSentInConnectionHealth(x.audioPacketsSent),this.updateVideoEncodingHealth(w),this.updateConnectionHealth()}updateAudioPacketsSentInConnectionHealth(w){w>0?this.connectionHealthData.setConsecutiveStatsWithNoAudioPacketsSent(0):this.connectionHealthData.setConsecutiveStatsWithNoAudioPacketsSent(this.connectionHealthData.consecutiveStatsWithNoAudioPacketsSent+1)}updateVideoEncodingHealth(w){const R=this.audioVideoController.videoTileController.hasStartedLocalVideoTile(),M=w.getVideoUpstreamSsrc();if(!R||M===null){this.connectionHealthData.setIsVideoEncoderHardware(!1),this.connectionHealthData.setVideoEncodingTimeInMs(0),this.connectionHealthData.setCpuLimitationDuration(0),this.connectionHealthData.setVideoInputFps(0),this.connectionHealthData.setVideoEncodeFps(0);return}const x=w.getObservableVideoMetricValue("videoUpstreamEncoderImplementation",M),S=w.getObservableVideoMetricValue("videoUpstreamTotalEncodeTimePerSecond",M),T=w.getObservableVideoMetricValue("videoUpstreamCpuQualityLimitationDurationPerSecond",M),_=w.getObservableVideoMetricValue("videoUpstreamFramesInputPerSecond",M),D=w.getObservableVideoMetricValue("videoUpstreamFramesEncodedPerSecond",M);this.connectionHealthData.setIsVideoEncoderHardware(!!x),this.connectionHealthData.setVideoEncodingTimeInMs(S),this.connectionHealthData.setCpuLimitationDuration(T),this.connectionHealthData.setVideoInputFps(_),this.connectionHealthData.setVideoEncodeFps(D)}addToMinuteWindow(w,R){w.unshift(R),w.length>60&&w.pop()}updateConnectionHealth(){this.audioVideoController.forEachObserver(w=>{C.Maybe.of(w.connectionHealthDidChange).map(R=>R.bind(w)(this.connectionHealthData.clone()))})}};return SignalingAndMetricsConnectionMonitor.default=E,SignalingAndMetricsConnectionMonitor}var MeetingSessionStatus={},hasRequiredMeetingSessionStatus;function requireMeetingSessionStatus(){if(hasRequiredMeetingSessionStatus)return MeetingSessionStatus;hasRequiredMeetingSessionStatus=1;var C=MeetingSessionStatus&&MeetingSessionStatus.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(MeetingSessionStatus,"__esModule",{value:!0});const E=requireSignalingProtocol(),w=C(requireMeetingSessionStatusCode());let R=class Wi{constructor(x){this._statusCode=x}statusCode(){return this._statusCode}isFailure(){switch(this._statusCode){case w.default.AudioAuthenticationRejected:case w.default.AudioCallAtCapacity:case w.default.AudioInternalServerError:case w.default.AudioServiceUnavailable:case w.default.AudioDisconnected:case w.default.VideoCallAtSourceCapacity:case w.default.SignalingBadRequest:case w.default.SignalingInternalServerError:case w.default.SignalingRequestFailed:case w.default.ICEGatheringTimeoutWorkaround:case w.default.ConnectionHealthReconnect:case w.default.RealtimeApiFailed:case w.default.TaskFailed:case w.default.NoAttendeePresent:return!0;default:return!1}}isTerminal(){switch(this._statusCode){case w.default.Left:case w.default.AudioJoinedFromAnotherDevice:case w.default.AudioAuthenticationRejected:case w.default.AudioCallAtCapacity:case w.default.MeetingEnded:case w.default.AudioDisconnected:case w.default.TURNCredentialsForbidden:case w.default.SignalingBadRequest:case w.default.SignalingRequestFailed:case w.default.VideoCallAtSourceCapacity:case w.default.RealtimeApiFailed:case w.default.AudioAttendeeRemoved:return!0;default:return!1}}isAudioConnectionFailure(){switch(this._statusCode){case w.default.AudioAuthenticationRejected:case w.default.AudioInternalServerError:case w.default.AudioServiceUnavailable:case w.default.ICEGatheringTimeoutWorkaround:case w.default.SignalingBadRequest:case w.default.SignalingInternalServerError:case w.default.SignalingRequestFailed:case w.default.RealtimeApiFailed:case w.default.NoAttendeePresent:return!0;default:return!1}}toString(){switch(this._statusCode){case w.default.OK:return"Everything is OK so far.";case w.default.Left:return"The attendee left the meeting.";case w.default.AudioJoinedFromAnotherDevice:return"The attendee joined from another device.";case w.default.AudioAuthenticationRejected:return"The meeting rejected the attendee.";case w.default.AudioCallAtCapacity:return"The attendee couldn't join because the meeting was at capacity.";case w.default.MeetingEnded:return"The meeting ended.";case w.default.AudioInternalServerError:case w.default.AudioServiceUnavailable:case w.default.AudioDisconnected:return"The audio connection failed.";case w.default.VideoCallSwitchToViewOnly:return"The attendee couldn't start the local video because the maximum video capacity was reached.";case w.default.VideoCallAtSourceCapacity:return"The connection failed due to an internal server error.";case w.default.SignalingBadRequest:case w.default.SignalingInternalServerError:case w.default.SignalingRequestFailed:return"The signaling connection failed.";case w.default.ICEGatheringTimeoutWorkaround:return"Gathering ICE candidates timed out. In Chrome, this might indicate that the browser is in a bad state after reconnecting to VPN.";case w.default.ConnectionHealthReconnect:return"The meeting was reconnected.";case w.default.RealtimeApiFailed:return"The real-time API failed. This status code might indicate that the callback you passed to the real-time API threw an exception.";case w.default.TaskFailed:return"The connection failed. See the error message for more details.";case w.default.IncompatibleSDP:return"The connection failed due to incompatible SDP.";case w.default.TURNCredentialsForbidden:return"The meeting ended, or the attendee was removed.";case w.default.NoAttendeePresent:return"The attendee was not present.";case w.default.AudioAttendeeRemoved:return"The meeting ended because attendee removed.";case w.default.AudioVideoWasRemovedFromPrimaryMeeting:return"The Primary meeting credentials provided are no longer valid. chime::DeleteAttendee may have been called on them.";case w.default.AudioVideoDisconnectedWhilePromoted:return"The client disconnected while promoted, which will automatically demote. The attendee must promote again to participate.";case w.default.AudioDisconnectAudio:return"The audio connection failed.";default:{const x=this._statusCode;throw new Error(`Unhandled case: ${x}`)}}}static fromSignalFrame(x){return x.error&&x.error.status?this.fromSignalingStatus(x.error.status):x.type===E.SdkSignalFrame.Type.AUDIO_STATUS?x.audioStatus?this.fromAudioStatus(x.audioStatus.audioStatus):new Wi(w.default.SignalingRequestFailed):x.type===E.SdkSignalFrame.Type.PRIMARY_MEETING_LEAVE?new Wi(w.default.AudioVideoWasRemovedFromPrimaryMeeting):new Wi(w.default.OK)}static fromAudioStatus(x){switch(x){case 200:return new Wi(w.default.OK);case 301:return new Wi(w.default.AudioJoinedFromAnotherDevice);case 302:return new Wi(w.default.AudioDisconnectAudio);case 403:return new Wi(w.default.AudioAuthenticationRejected);case 409:return new Wi(w.default.AudioCallAtCapacity);case 410:return new Wi(w.default.MeetingEnded);case 411:return new Wi(w.default.AudioAttendeeRemoved);case 500:return new Wi(w.default.AudioInternalServerError);case 503:return new Wi(w.default.AudioServiceUnavailable);default:switch(Math.floor(x/100)){case 2:return new Wi(w.default.OK);default:return new Wi(w.default.AudioDisconnected)}}}static fromSignalingStatus(x){switch(x){case 206:return new Wi(w.default.VideoCallSwitchToViewOnly);case 509:return new Wi(w.default.VideoCallAtSourceCapacity);case 403:return new Wi(w.default.AudioAuthenticationRejected);case 409:return new Wi(w.default.AudioCallAtCapacity);default:switch(Math.floor(x/100)){case 2:return new Wi(w.default.OK);case 4:return new Wi(w.default.SignalingBadRequest);case 5:return new Wi(w.default.SignalingInternalServerError);default:return new Wi(w.default.SignalingRequestFailed)}}}};return MeetingSessionStatus.default=R,MeetingSessionStatus}var MeetingSessionVideoAvailability={},hasRequiredMeetingSessionVideoAvailability;function requireMeetingSessionVideoAvailability(){if(hasRequiredMeetingSessionVideoAvailability)return MeetingSessionVideoAvailability;hasRequiredMeetingSessionVideoAvailability=1,Object.defineProperty(MeetingSessionVideoAvailability,"__esModule",{value:!0});let C=class tm{constructor(){this.remoteVideoAvailable=!1,this.canStartLocalVideo=!1}equal(w){return this.remoteVideoAvailable===w.remoteVideoAvailable&&this.canStartLocalVideo===w.canStartLocalVideo}clone(){const w=new tm;return w.remoteVideoAvailable=this.remoteVideoAvailable,w.canStartLocalVideo=this.canStartLocalVideo,w}};return MeetingSessionVideoAvailability.default=C,MeetingSessionVideoAvailability}var DefaultPingPong={},hasRequiredDefaultPingPong;function requireDefaultPingPong(){if(hasRequiredDefaultPingPong)return DefaultPingPong;hasRequiredDefaultPingPong=1;var C=DefaultPingPong&&DefaultPingPong.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(DefaultPingPong,"__esModule",{value:!0});const E=C(requireAsyncScheduler()),w=C(requireIntervalScheduler()),R=C(requireSignalingClientEventType()),M=requireSignalingProtocol(),x=requireTypes$1();let S=class{constructor(T,_,D){this.signalingClient=T,this.intervalMs=_,this.logger=D,this.observerQueue=new Set,this.consecutivePongsUnaccountedFor=0,this.intervalScheduler=new w.default(this.intervalMs),this.pingId=0}addObserver(T){this.logger.info("adding a ping-pong observer"),this.observerQueue.add(T)}removeObserver(T){this.logger.info("removing a ping-pong observer"),this.observerQueue.delete(T)}forEachObserver(T){for(const _ of this.observerQueue)E.default.nextTick(()=>{this.observerQueue.has(_)&&T(_)})}start(){this.stop(),this.signalingClient.registerObserver(this),this.signalingClient.ready()&&this.startPingInterval()}stop(){this.stopPingInterval(),this.signalingClient.removeObserver(this)}startPingInterval(){this.intervalScheduler.start(()=>{this.ping()}),this.ping()}stopPingInterval(){this.intervalScheduler.stop(),this.pingId=0,this.consecutivePongsUnaccountedFor=0}ping(){this.consecutivePongsUnaccountedFor>0&&(this.logger.warn(`missed pong ${this.consecutivePongsUnaccountedFor} time(s)`),this.forEachObserver(_=>{x.Maybe.of(_.didMissPongs).map(D=>D.bind(_)(this.consecutivePongsUnaccountedFor))})),this.consecutivePongsUnaccountedFor+=1,this.pingId=this.pingId+1&4294967295;const T=M.SdkPingPongFrame.create();T.pingId=this.pingId,T.type=M.SdkPingPongType.PING,this.pingTimestampLocalMs=this.signalingClient.pingPong(T),this.logger.debug(()=>`sent ping ${this.pingId}`)}pong(T){const _=M.SdkPingPongFrame.create();_.pingId=T,_.type=M.SdkPingPongType.PONG,this.signalingClient.pingPong(_)}handleSignalingClientEvent(T){switch(T.type){case R.default.WebSocketOpen:this.startPingInterval();break;case R.default.WebSocketFailed:case R.default.WebSocketError:this.logger.warn(`stopped pinging (${R.default[T.type]})`),this.stopPingInterval();break;case R.default.WebSocketClosing:case R.default.WebSocketClosed:this.logger.info(`stopped pinging (${R.default[T.type]})`),this.stopPingInterval();break;case R.default.ReceivedSignalFrame:if(T.message.type!==M.SdkSignalFrame.Type.PING_PONG)break;if(T.message.pingPong.type===M.SdkPingPongType.PONG){const _=T.message.pingPong.pingId;if(_!==this.pingId){this.logger.warn(`unexpected ping id ${_} (expected ${this.pingId})`);break}this.consecutivePongsUnaccountedFor=0;let D;if(typeof T.message.timestampMs=="number")D=T.message.timestampMs;else break;this.logger.debug(()=>`received pong ${_} with timestamp ${D}`);const Y=T.timestampMs-this.pingTimestampLocalMs,ee=Math.round(D-Y/2),ie=this.pingTimestampLocalMs-ee;this.logger.info(`local clock skew estimate=${ie}ms from ping-pong time=${Y}ms`),this.forEachObserver(ne=>{x.Maybe.of(ne.didReceivePong).map(re=>re.bind(ne)(_,ie,Y))})}else this.pong(T.message.pingPong.pingId);break}}};return DefaultPingPong.default=S,DefaultPingPong}var DefaultRealtimeController={},DefaultTranscriptionController={},TranscriptEvent={},Transcript={},hasRequiredTranscript;function requireTranscript(){if(hasRequiredTranscript)return Transcript;hasRequiredTranscript=1,Object.defineProperty(Transcript,"__esModule",{value:!0});let C=class{};return Transcript.default=C,Transcript}var TranscriptionStatus={},hasRequiredTranscriptionStatus;function requireTranscriptionStatus(){if(hasRequiredTranscriptionStatus)return TranscriptionStatus;hasRequiredTranscriptionStatus=1,Object.defineProperty(TranscriptionStatus,"__esModule",{value:!0});let C=class{};return TranscriptionStatus.default=C,TranscriptionStatus}var TranscriptionStatusType={},hasRequiredTranscriptionStatusType;function requireTranscriptionStatusType(){if(hasRequiredTranscriptionStatusType)return TranscriptionStatusType;hasRequiredTranscriptionStatusType=1,Object.defineProperty(TranscriptionStatusType,"__esModule",{value:!0});var C;return function(E){E.STARTED="started",E.INTERRUPTED="interrupted",E.RESUMED="resumed",E.STOPPED="stopped",E.FAILED="failed"}(C||(C={})),TranscriptionStatusType.default=C,TranscriptionStatusType}var TranscriptItemType={},hasRequiredTranscriptItemType;function requireTranscriptItemType(){if(hasRequiredTranscriptItemType)return TranscriptItemType;hasRequiredTranscriptItemType=1,Object.defineProperty(TranscriptItemType,"__esModule",{value:!0});var C;return function(E){E.PRONUNCIATION="pronunciation",E.PUNCTUATION="punctuation"}(C||(C={})),TranscriptItemType.default=C,TranscriptItemType}var hasRequiredTranscriptEvent;function requireTranscriptEvent(){if(hasRequiredTranscriptEvent)return TranscriptEvent;hasRequiredTranscriptEvent=1;var C=TranscriptEvent&&TranscriptEvent.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(TranscriptEvent,"__esModule",{value:!0}),TranscriptEvent.TranscriptEventConverter=void 0;const E=requireSignalingProtocol(),w=C(requireTranscript()),R=C(requireTranscriptionStatus()),M=C(requireTranscriptionStatusType()),x=C(requireTranscriptItemType()),S={[E.SdkTranscriptionStatus.Type.STARTED]:M.default.STARTED,[E.SdkTranscriptionStatus.Type.INTERRUPTED]:M.default.INTERRUPTED,[E.SdkTranscriptionStatus.Type.RESUMED]:M.default.RESUMED,[E.SdkTranscriptionStatus.Type.STOPPED]:M.default.STOPPED,[E.SdkTranscriptionStatus.Type.FAILED]:M.default.FAILED};class T{static from(D){let Y;try{Y=E.SdkTranscriptFrame.decode(D.data)}catch(ie){throw new Error("Cannot decode transcript data message: "+ie)}const ee=[];for(const ie of Y.events)if(ie.status){const ne=S[ie.status.type];if(!ne)continue;const re=new R.default;re.type=ne,re.eventTimeMs=ie.status.eventTime,re.transcriptionRegion=ie.status.transcriptionRegion,re.transcriptionConfiguration=ie.status.transcriptionConfiguration,ie.status.message&&(re.message=ie.status.message),ee.push(re)}else if(ie.transcript){const ne=new w.default;ne.results=[];for(const re of ie.transcript.results){const oe={channelId:re.channelId,isPartial:re.isPartial,resultId:re.resultId,startTimeMs:re.startTime,endTimeMs:re.endTime,alternatives:[]};if(re.languageCode&&(oe.languageCode=re.languageCode),re.languageIdentification&&re.languageIdentification.length>0){oe.languageIdentification=[];for(const ae of re.languageIdentification){const le={languageCode:ae.languageCode,score:ae.score};oe.languageIdentification.push(le)}}for(const ae of re.alternatives){const le={items:[],transcript:ae.transcript};for(const de of ae.items){const me={content:de.content,attendee:{attendeeId:de.speakerAttendeeId,externalUserId:de.speakerExternalUserId},startTimeMs:de.startTime,endTimeMs:de.endTime,type:null};switch(de.vocabularyFilterMatch&&(me.vocabularyFilterMatch=de.vocabularyFilterMatch),de.hasOwnProperty("stable")&&(me.stable=de.stable),de.hasOwnProperty("confidence")&&(me.confidence=de.confidence),de.type){case E.SdkTranscriptItem.Type.PRONUNCIATION:me.type=x.default.PRONUNCIATION;break;case E.SdkTranscriptItem.Type.PUNCTUATION:me.type=x.default.PUNCTUATION;break}le.items.push(me)}for(const de of ae.entities){le.entities||(le.entities=[]);const me={category:de.category,confidence:de.confidence,content:de.content,startTimeMs:de.startTime,endTimeMs:de.endTime};de.type&&(me.type=de.type),le.entities.push(me)}oe.alternatives.push(le)}ne.results.push(oe)}ee.push(ne)}return ee}}return TranscriptEvent.TranscriptEventConverter=T,TranscriptEvent}var hasRequiredDefaultTranscriptionController;function requireDefaultTranscriptionController(){return hasRequiredDefaultTranscriptionController||(hasRequiredDefaultTranscriptionController=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.TRANSCRIPTION_DATA_MESSAGE_TOPIC=void 0;const E=requireTranscriptEvent();C.TRANSCRIPTION_DATA_MESSAGE_TOPIC="aws:chime:transcription";class w{constructor(M){this.realtimeController=M,this.transcriptEventCallbacks=new Set}subscribeToTranscriptEvent(M){this.transcriptEventCallbacks.size===0&&this.realtimeController.realtimeSubscribeToReceiveDataMessage(C.TRANSCRIPTION_DATA_MESSAGE_TOPIC,x=>{for(const S of E.TranscriptEventConverter.from(x))for(const T of this.transcriptEventCallbacks)T(S)}),this.transcriptEventCallbacks.add(M)}unsubscribeFromTranscriptEvent(M){this.transcriptEventCallbacks.delete(M),this.transcriptEventCallbacks.size===0&&this.realtimeController.realtimeUnsubscribeFromReceiveDataMessage(C.TRANSCRIPTION_DATA_MESSAGE_TOPIC)}}C.default=w}(DefaultTranscriptionController)),DefaultTranscriptionController}var RealtimeState={},hasRequiredRealtimeState;function requireRealtimeState(){if(hasRequiredRealtimeState)return RealtimeState;hasRequiredRealtimeState=1,Object.defineProperty(RealtimeState,"__esModule",{value:!0});let C=class{constructor(){this.localAttendeeId=null,this.localExternalUserId=null,this.attendeeIdChangesCallbacks=[],this.canUnmute=!0,this.setCanUnmuteLocalAudioCallbacks=[],this.muted=!1,this.muteAndUnmuteLocalAudioCallbacks=[],this.volumeIndicatorState={},this.attendeeIdToExternalUserId={},this.volumeIndicatorCallbacks={},this.localSignalStrengthChangeCallbacks=[],this.fatalErrorCallbacks=[],this.sendDataMessageCallbacks=[],this.receiveDataMessageCallbacks=new Map}};return RealtimeState.default=C,RealtimeState}var RealtimeVolumeIndicator={},hasRequiredRealtimeVolumeIndicator;function requireRealtimeVolumeIndicator(){if(hasRequiredRealtimeVolumeIndicator)return RealtimeVolumeIndicator;hasRequiredRealtimeVolumeIndicator=1,Object.defineProperty(RealtimeVolumeIndicator,"__esModule",{value:!0});let C=class{constructor(){this.volume=null,this.muted=null,this.signalStrength=null}};return RealtimeVolumeIndicator.default=C,RealtimeVolumeIndicator}var hasRequiredDefaultRealtimeController;function requireDefaultRealtimeController(){if(hasRequiredDefaultRealtimeController)return DefaultRealtimeController;hasRequiredDefaultRealtimeController=1;var C=DefaultRealtimeController&&DefaultRealtimeController.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(DefaultRealtimeController,"__esModule",{value:!0});const E=C(requireDefaultTranscriptionController()),w=C(requireRealtimeState()),R=C(requireRealtimeVolumeIndicator());let M=class{constructor(x,S){this.mediaStreamBroker=x,this.state=new w.default,this._transcriptionController=S||new E.default(this)}realtimeSetLocalAttendeeId(x,S){this.state.localAttendeeId=x,this.state.localExternalUserId=S}realtimeSetAttendeeIdPresence(x,S,T,_,D){try{S&&(this.state.attendeeIdToExternalUserId[x]=T);for(const Y of this.state.attendeeIdChangesCallbacks)Y(x,S,T,_,D)}catch(Y){this.onError(Y)}}realtimeSubscribeToAttendeeIdPresence(x){try{this.state.attendeeIdChangesCallbacks.push(x)}catch(S){this.onError(S)}}realtimeUnsubscribeToAttendeeIdPresence(x){try{const S=this.state.attendeeIdChangesCallbacks.indexOf(x);S!==-1&&this.state.attendeeIdChangesCallbacks.splice(S,1)}catch(S){this.onError(S)}}realtimeSetCanUnmuteLocalAudio(x){try{if(this.state.canUnmute===x)return;this.state.canUnmute=x;for(const S of this.state.setCanUnmuteLocalAudioCallbacks)S(x)}catch(S){this.onError(S)}}realtimeSubscribeToSetCanUnmuteLocalAudio(x){try{this.state.setCanUnmuteLocalAudioCallbacks.push(x)}catch(S){this.onError(S)}}realtimeUnsubscribeToSetCanUnmuteLocalAudio(x){try{const S=this.state.setCanUnmuteLocalAudioCallbacks.indexOf(x);S!==-1&&this.state.setCanUnmuteLocalAudioCallbacks.splice(S,1)}catch(S){this.onError(S)}}realtimeCanUnmuteLocalAudio(){return this.state.canUnmute}realtimeMuteLocalAudio(){if(!this.state.muted)try{this.setAudioInputEnabled(!1),this.state.muted=!0,this.realtimeUpdateVolumeIndicator(this.state.localAttendeeId,null,null,null,this.state.localExternalUserId);for(const x of this.state.muteAndUnmuteLocalAudioCallbacks)x(!0)}catch(x){this.onError(x)}}realtimeUnmuteLocalAudio(){if(!this.state.muted)return!0;if(!this.state.canUnmute)return!1;try{this.setAudioInputEnabled(!0),this.state.muted=!1,this.realtimeUpdateVolumeIndicator(this.state.localAttendeeId,null,null,null,this.state.localExternalUserId);for(const x of this.state.muteAndUnmuteLocalAudioCallbacks)x(!1);return!0}catch(x){return this.onError(x),!1}}realtimeSubscribeToMuteAndUnmuteLocalAudio(x){try{this.state.muteAndUnmuteLocalAudioCallbacks.push(x)}catch(S){this.onError(S)}}realtimeUnsubscribeToMuteAndUnmuteLocalAudio(x){try{const S=this.state.muteAndUnmuteLocalAudioCallbacks.indexOf(x);S!==-1&&this.state.muteAndUnmuteLocalAudioCallbacks.splice(S,1)}catch(S){this.onError(S)}}realtimeIsLocalAudioMuted(){return this.state.muted}realtimeSubscribeToVolumeIndicator(x,S){try{this.state.volumeIndicatorCallbacks.hasOwnProperty(x)||(this.state.volumeIndicatorCallbacks[x]=[]),this.state.volumeIndicatorCallbacks[x].push(S),this.sendVolumeIndicatorChange(x,!0,!0,!0,this.state.attendeeIdToExternalUserId[x])}catch(T){this.onError(T)}}realtimeUnsubscribeFromVolumeIndicator(x,S){if(this.state.volumeIndicatorCallbacks[x])if(S){const T=this.state.volumeIndicatorCallbacks[x].indexOf(S);T>=0&&this.state.volumeIndicatorCallbacks[x].splice(T,1)}else delete this.state.volumeIndicatorCallbacks[x]}realtimeUpdateVolumeIndicator(x,S,T,_,D){try{T=this.applyLocalMuteOverride(x,T);const Y=this.getVolumeIndicatorState(x);let ee=!1,ie=!1,ne=!1;T!==null&&Y.muted!==T&&(Y.muted=T,ie=!0,Y.muted&&Y.volume!==0&&(Y.volume=0,ee=!0)),!Y.muted&&S!==null&&(Y.volume!==S&&(Y.volume=S,ee=!0),Y.muted===null&&(Y.muted=!1,ie=!0)),_!==null&&Y.signalStrength!==_&&(Y.signalStrength=_,ne=!0),this.sendVolumeIndicatorChange(x,ee,ie,ne,D)}catch(Y){this.onError(Y)}}realtimeSubscribeToLocalSignalStrengthChange(x){try{if(this.state.localSignalStrengthChangeCallbacks.push(x),this.state.localAttendeeId===null)return;this.sendLocalSignalStrengthChange(this.state.localAttendeeId,!0)}catch(S){this.onError(S)}}realtimeUnsubscribeToLocalSignalStrengthChange(x){try{const S=this.state.localSignalStrengthChangeCallbacks.indexOf(x);S!==-1&&this.state.localSignalStrengthChangeCallbacks.splice(S,1)}catch(S){this.onError(S)}}realtimeSubscribeToSendDataMessage(x){try{this.state.sendDataMessageCallbacks.push(x)}catch(S){this.onError(S)}}realtimeUnsubscribeFromSendDataMessage(x){try{const S=this.state.sendDataMessageCallbacks.indexOf(x);S!==-1&&this.state.sendDataMessageCallbacks.splice(S,1)}catch(S){this.onError(S)}}realtimeSendDataMessage(x,S,T){try{for(const _ of this.state.sendDataMessageCallbacks)_(x,S,T)}catch(_){this.onError(_)}}realtimeSubscribeToReceiveDataMessage(x,S){try{this.state.receiveDataMessageCallbacks.has(x)?this.state.receiveDataMessageCallbacks.get(x).push(S):this.state.receiveDataMessageCallbacks.set(x,[S])}catch(T){this.onError(T)}}realtimeUnsubscribeFromReceiveDataMessage(x){try{this.state.receiveDataMessageCallbacks.delete(x)}catch(S){this.onError(S)}}realtimeReceiveDataMessage(x){try{if(this.state.receiveDataMessageCallbacks.has(x.topic))for(const S of this.state.receiveDataMessageCallbacks.get(x.topic))S(x)}catch(S){this.onError(S)}}realtimeSubscribeToFatalError(x){try{this.state.fatalErrorCallbacks.push(x)}catch(S){this.onError(S)}}realtimeUnsubscribeToFatalError(x){try{const S=this.state.fatalErrorCallbacks.indexOf(x);S!==-1&&this.state.fatalErrorCallbacks.splice(S,1)}catch(S){this.onError(S)}}get transcriptionController(){return this._transcriptionController}setAudioInputEnabled(x){x?this.mediaStreamBroker.unmuteLocalAudioInputStream():this.mediaStreamBroker.muteLocalAudioInputStream()}applyLocalMuteOverride(x,S){const T=this.state.localAttendeeId,_=this.state.muted;return x!==T||!("activeDevices"in this.mediaStreamBroker&&this.mediaStreamBroker.activeDevices.audio)?S:_}sendVolumeIndicatorChange(x,S,T,_,D){if(this.sendLocalSignalStrengthChange(x,_),!this.state.volumeIndicatorCallbacks.hasOwnProperty(x))return;const Y=this.getVolumeIndicatorState(x),ee=new R.default;if(S&&(ee.volume=Y.volume),T&&(ee.muted=Y.muted),_&&(ee.signalStrength=Y.signalStrength),!this.stateIsEmpty(ee))for(const ie of this.state.volumeIndicatorCallbacks[x])ie(x,ee.volume,ee.muted,ee.signalStrength,D)}sendLocalSignalStrengthChange(x,S){if(!S||x!==this.state.localAttendeeId)return;const T=this.getVolumeIndicatorState(x).signalStrength;if(T!==null)for(const _ of this.state.localSignalStrengthChangeCallbacks)_(T)}getVolumeIndicatorState(x){return this.state.volumeIndicatorState.hasOwnProperty(x)||(this.state.volumeIndicatorState[x]=new R.default),this.state.volumeIndicatorState[x]}stateIsEmpty(x){return x.volume===null&&x.muted===null&&x.signalStrength===null}onError(x){try{for(const S of this.state.fatalErrorCallbacks)S(x)}catch(S){try{console.error(x),console.error(S)}catch{}}}};return DefaultRealtimeController.default=M,DefaultRealtimeController}var DefaultSessionStateController={},SessionStateControllerAction={},hasRequiredSessionStateControllerAction;function requireSessionStateControllerAction(){return hasRequiredSessionStateControllerAction||(hasRequiredSessionStateControllerAction=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.SessionStateControllerAction=void 0;var E;(function(w){w[w.Connect=0]="Connect",w[w.FinishConnecting=1]="FinishConnecting",w[w.Update=2]="Update",w[w.FinishUpdating=3]="FinishUpdating",w[w.Reconnect=4]="Reconnect",w[w.Disconnect=5]="Disconnect",w[w.Fail=6]="Fail",w[w.FinishDisconnecting=7]="FinishDisconnecting"})(E=C.SessionStateControllerAction||(C.SessionStateControllerAction={})),C.default=E}(SessionStateControllerAction)),SessionStateControllerAction}var SessionStateControllerDeferPriority={},hasRequiredSessionStateControllerDeferPriority;function requireSessionStateControllerDeferPriority(){return hasRequiredSessionStateControllerDeferPriority||(hasRequiredSessionStateControllerDeferPriority=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.SessionStateControllerDeferPriority=void 0;var E;(function(w){w[w.DoNotDefer=0]="DoNotDefer",w[w.Low=1]="Low",w[w.Medium=2]="Medium",w[w.High=3]="High",w[w.VeryHigh=4]="VeryHigh"})(E=C.SessionStateControllerDeferPriority||(C.SessionStateControllerDeferPriority={})),C.default=E}(SessionStateControllerDeferPriority)),SessionStateControllerDeferPriority}var SessionStateControllerState={},hasRequiredSessionStateControllerState;function requireSessionStateControllerState(){return hasRequiredSessionStateControllerState||(hasRequiredSessionStateControllerState=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.SessionStateControllerState=void 0;var E;(function(w){w[w.NotConnected=0]="NotConnected",w[w.Connecting=1]="Connecting",w[w.Connected=2]="Connected",w[w.Updating=3]="Updating",w[w.Disconnecting=4]="Disconnecting"})(E=C.SessionStateControllerState||(C.SessionStateControllerState={})),C.default=E}(SessionStateControllerState)),SessionStateControllerState}var SessionStateControllerTransitionResult={},hasRequiredSessionStateControllerTransitionResult;function requireSessionStateControllerTransitionResult(){return hasRequiredSessionStateControllerTransitionResult||(hasRequiredSessionStateControllerTransitionResult=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.SessionStateControllerTransitionResult=void 0;var E;(function(w){w[w.Transitioned=0]="Transitioned",w[w.NoTransitionAvailable=1]="NoTransitionAvailable",w[w.DeferredTransition=2]="DeferredTransition",w[w.TransitionFailed=3]="TransitionFailed"})(E=C.SessionStateControllerTransitionResult||(C.SessionStateControllerTransitionResult={})),C.default=E}(SessionStateControllerTransitionResult)),SessionStateControllerTransitionResult}var hasRequiredDefaultSessionStateController;function requireDefaultSessionStateController(){if(hasRequiredDefaultSessionStateController)return DefaultSessionStateController;hasRequiredDefaultSessionStateController=1,Object.defineProperty(DefaultSessionStateController,"__esModule",{value:!0});const C=requireSessionStateControllerAction(),E=requireSessionStateControllerDeferPriority(),w=requireSessionStateControllerState(),R=requireSessionStateControllerTransitionResult();let M=class{constructor(x){this.logger=x,this.currentState=w.SessionStateControllerState.NotConnected,this.deferredAction=null,this.deferredWork=null}perform(x,S){const T=this.currentState;if(T===w.SessionStateControllerState.NotConnected&&x===C.SessionStateControllerAction.Connect)this.transition(w.SessionStateControllerState.Connecting,x);else if(T===w.SessionStateControllerState.Connecting&&x===C.SessionStateControllerAction.Fail)this.transition(w.SessionStateControllerState.Disconnecting,x);else if(T===w.SessionStateControllerState.Connecting&&x===C.SessionStateControllerAction.FinishConnecting)this.transition(w.SessionStateControllerState.Connected,x);else if(T===w.SessionStateControllerState.Connected&&x===C.SessionStateControllerAction.Disconnect)this.transition(w.SessionStateControllerState.Disconnecting,x);else if(T===w.SessionStateControllerState.Connected&&x===C.SessionStateControllerAction.Reconnect)this.transition(w.SessionStateControllerState.Connecting,x);else if(T===w.SessionStateControllerState.Connected&&x===C.SessionStateControllerAction.Fail)this.transition(w.SessionStateControllerState.Disconnecting,x);else if(T===w.SessionStateControllerState.Connected&&x===C.SessionStateControllerAction.Update)this.transition(w.SessionStateControllerState.Updating,x);else if(T===w.SessionStateControllerState.Updating&&x===C.SessionStateControllerAction.Fail)this.transition(w.SessionStateControllerState.Disconnecting,x);else if(T===w.SessionStateControllerState.Updating&&x===C.SessionStateControllerAction.FinishUpdating)this.transition(w.SessionStateControllerState.Connected,x);else if(T===w.SessionStateControllerState.Disconnecting&&x===C.SessionStateControllerAction.FinishDisconnecting)this.transition(w.SessionStateControllerState.NotConnected,x);else return this.canDefer(x)?(this.logger.info(`deferring transition from ${w.SessionStateControllerState[this.currentState]} with ${C.SessionStateControllerAction[x]}`),this.deferAction(x,S),R.SessionStateControllerTransitionResult.DeferredTransition):(this.logger.warn(`no transition found from ${w.SessionStateControllerState[this.currentState]} with ${C.SessionStateControllerAction[x]}`),R.SessionStateControllerTransitionResult.NoTransitionAvailable);try{S()}catch(_){return this.logger.error(`error during state ${w.SessionStateControllerState[this.currentState]} with action ${C.SessionStateControllerAction[x]}: ${_}`),this.logger.info(`rolling back transition to ${w.SessionStateControllerState[T]}`),this.currentState=T,R.SessionStateControllerTransitionResult.TransitionFailed}return this.performDeferredAction(),R.SessionStateControllerTransitionResult.Transitioned}state(){return this.currentState}transition(x,S){this.logger.info(`transitioning from ${w.SessionStateControllerState[this.currentState]} to ${w.SessionStateControllerState[x]} with ${C.SessionStateControllerAction[S]}`),this.currentState=x}deferPriority(x){switch(x){case C.SessionStateControllerAction.Disconnect:return E.SessionStateControllerDeferPriority.VeryHigh;case C.SessionStateControllerAction.Fail:return E.SessionStateControllerDeferPriority.High;case C.SessionStateControllerAction.Reconnect:return E.SessionStateControllerDeferPriority.Medium;case C.SessionStateControllerAction.Update:return E.SessionStateControllerDeferPriority.Low;default:return E.SessionStateControllerDeferPriority.DoNotDefer}}deferAction(x,S){this.deferredAction!==null&&this.deferPriority(this.deferredAction)>this.deferPriority(x)||(this.deferredAction=x,this.deferredWork=S)}canDefer(x){return this.deferPriority(x)!==E.SessionStateControllerDeferPriority.DoNotDefer&&(this.currentState===w.SessionStateControllerState.Connecting||this.currentState===w.SessionStateControllerState.Updating)}performDeferredAction(){if(!this.deferredAction)return;const x=this.deferredAction,S=this.deferredWork;this.deferredAction=null,this.deferredWork=null,this.logger.info(`performing deferred action ${C.SessionStateControllerAction[x]}`),this.perform(x,S)!==R.SessionStateControllerTransitionResult.Transitioned&&this.logger.info(`unable to perform deferred action ${C.SessionStateControllerAction[x]} in state ${w.SessionStateControllerState[this.currentState]}`)}};return DefaultSessionStateController.default=M,DefaultSessionStateController}var DefaultSignalingClient={},Utils$1={},hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return Utils$1;hasRequiredUtils=1;var C=Utils$1&&Utils$1.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(Utils$1,"__esModule",{value:!0}),Utils$1.getRandomValues=Utils$1.getFormattedOffset=Utils$1.getDefaultAssetSpec=Utils$1.toLowerCasePropertyNames=Utils$1.isIFramed=Utils$1.wait=void 0;const E=C(requireVersioning());function w(_){return new Promise(D=>setTimeout(D,_))}Utils$1.wait=w;function R(){var _;try{return((_=window.frameElement)===null||_===void 0?void 0:_.nodeName)==="IFRAME"||parent!==top}catch{return!0}}Utils$1.isIFramed=R;function M(_){return _===null?null:typeof _!="object"?_:Array.isArray(_)?_.map(M):Object.keys(_).reduce((D,Y)=>{const ee=_[Y],ie=typeof ee=="object"?M(ee):ee;return D[Y.toLowerCase()]=ie,D},{})}Utils$1.toLowerCasePropertyNames=M;function x(){const _=E.default.sdkVersionSemVer;return{assetGroup:`sdk-${_.major}.${_.minor}`}}Utils$1.getDefaultAssetSpec=x;function S(_){const D=Math.abs(_),Y=_<=0?"+":"-",ee=Math.floor(D/60).toString().padStart(2,"0"),ie=Math.floor(D%60).toString().padStart(2,"0");return`${Y}${ee}:${ie}`}Utils$1.getFormattedOffset=S;function T(_){try{window.crypto.getRandomValues(_)}catch{new DataView(_.buffer).setUint32(0,Math.trunc(Math.random()*Math.pow(2,32)),!0)}}return Utils$1.getRandomValues=T,Utils$1}var VideoQualityAdaptationPreference={},hasRequiredVideoQualityAdaptationPreference;function requireVideoQualityAdaptationPreference(){return hasRequiredVideoQualityAdaptationPreference||(hasRequiredVideoQualityAdaptationPreference=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.VideoQualityAdaptationPreference=void 0;var E;(function(w){w[w.Balanced=0]="Balanced",w[w.MaintainFramerate=1]="MaintainFramerate",w[w.MaintainResolution=2]="MaintainResolution"})(E=C.VideoQualityAdaptationPreference||(C.VideoQualityAdaptationPreference={})),C.default=E}(VideoQualityAdaptationPreference)),VideoQualityAdaptationPreference}var WebSocketReadyState={},hasRequiredWebSocketReadyState;function requireWebSocketReadyState(){return hasRequiredWebSocketReadyState||(hasRequiredWebSocketReadyState=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.WebSocketReadyState=void 0;var E;(function(w){w[w.None=0]="None",w[w.Connecting=1]="Connecting",w[w.Open=2]="Open",w[w.Closing=3]="Closing",w[w.Closed=4]="Closed"})(E=C.WebSocketReadyState||(C.WebSocketReadyState={})),C.default=E}(WebSocketReadyState)),WebSocketReadyState}var ServerSideNetworkAdaption={},hasRequiredServerSideNetworkAdaption;function requireServerSideNetworkAdaption(){return hasRequiredServerSideNetworkAdaption||(hasRequiredServerSideNetworkAdaption=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.convertServerSideNetworkAdaptionEnumToSignaled=C.convertServerSideNetworkAdaptionEnumFromSignaled=C.serverSideNetworkAdaptionIsNoneOrDefault=C.ServerSideNetworkAdaption=void 0;const E=requireSignalingProtocol();var w;(function(S){S[S.Default=0]="Default",S[S.None=1]="None",S[S.BandwidthProbing=2]="BandwidthProbing",S[S.BandwidthProbingAndRemoteVideoQualityAdaption=3]="BandwidthProbingAndRemoteVideoQualityAdaption"})(w=C.ServerSideNetworkAdaption||(C.ServerSideNetworkAdaption={})),C.default=w;function R(S){return S===w.None||S===w.Default}C.serverSideNetworkAdaptionIsNoneOrDefault=R;function M(S){switch(S){case E.SdkServerSideNetworkAdaption.DEFAULT:return w.Default;case E.SdkServerSideNetworkAdaption.NONE:return w.None;case E.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING:return w.BandwidthProbing;case E.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION:return w.BandwidthProbingAndRemoteVideoQualityAdaption}}C.convertServerSideNetworkAdaptionEnumFromSignaled=M;function x(S){switch(S){case w.Default:return E.SdkServerSideNetworkAdaption.DEFAULT;case w.None:return E.SdkServerSideNetworkAdaption.NONE;case w.BandwidthProbing:return E.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING;case w.BandwidthProbingAndRemoteVideoQualityAdaption:return E.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION}}C.convertServerSideNetworkAdaptionEnumToSignaled=x}(ServerSideNetworkAdaption)),ServerSideNetworkAdaption}var SignalingClientEvent={},hasRequiredSignalingClientEvent;function requireSignalingClientEvent(){if(hasRequiredSignalingClientEvent)return SignalingClientEvent;hasRequiredSignalingClientEvent=1;var C=SignalingClientEvent&&SignalingClientEvent.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(SignalingClientEvent,"__esModule",{value:!0});const E=C(requireSignalingClientEventType());let w=class{constructor(R,M,x,S,T){this.client=R,this.type=M,this.message=x,this.closeCode=S,this.closeReason=T,this.timestampMs=Date.now()}isConnectionTerminated(){switch(this.type){case E.default.WebSocketFailed:case E.default.WebSocketError:case E.default.WebSocketClosing:case E.default.WebSocketClosed:return!0;default:return!1}}};return SignalingClientEvent.default=w,SignalingClientEvent}var hasRequiredDefaultSignalingClient;function requireDefaultSignalingClient(){if(hasRequiredDefaultSignalingClient)return DefaultSignalingClient;hasRequiredDefaultSignalingClient=1;var C=DefaultSignalingClient&&DefaultSignalingClient.__importDefault||function(ie){return ie&&ie.__esModule?ie:{default:ie}};Object.defineProperty(DefaultSignalingClient,"__esModule",{value:!0});const E=C(requireDefaultBrowserBehavior()),w=C(requireTimeoutScheduler()),R=requireSignalingProtocol(),M=requireUtils(),x=C(requireVersioning()),S=C(requireVideoQualityAdaptationPreference()),T=C(requireWebSocketReadyState()),_=requireServerSideNetworkAdaption(),D=C(requireSignalingClientEvent()),Y=C(requireSignalingClientEventType());let ee=class Vs{constructor(ne,re){this.webSocket=ne,this.logger=re,this.unloadHandler=null,this.closeEventHandler=oe=>{this.deactivatePageUnloadHandler(),this.resetConnection(),this.sendEvent(new D.default(this,Y.default.WebSocketClosed,null,oe.code,oe.reason)),this.serviceConnectionRequestQueue()},this.observerQueue=new Set,this.connectionRequestQueue=[],this.resetConnection(),this.logger.debug(()=>"signaling client init"),this.audioSessionId=this.generateNewAudioSessionId()}registerObserver(ne){this.logger.debug(()=>"registering signaling client observer"),this.observerQueue.add(ne)}removeObserver(ne){this.logger.debug(()=>"removing signaling client observer"),this.observerQueue.delete(ne)}openConnection(ne){this.logger.info("adding connection request to queue: "+ne.url()),this.connectionRequestQueue.push(ne),this.closeConnection()}pingPong(ne){this.logger.debug(()=>"sending ping");const re=R.SdkSignalFrame.create();return re.type=R.SdkSignalFrame.Type.PING_PONG,re.pingPong=ne,this.sendMessage(re),re.timestampMs}join(ne){this.logger.info("sending join");const re=R.SdkJoinFrame.create();re.protocolVersion=2,re.flags=R.SdkJoinFlags.HAS_STREAM_UPDATE;const oe=new E.default,ae={platformName:oe.name(),platformVersion:oe.version(),clientSource:x.default.sdkName,chimeSdkVersion:x.default.sdkVersion,clientUtcOffset:M.getFormattedOffset(new Date().getTimezoneOffset())};if(ne.applicationMetadata){const{appName:de,appVersion:me}=ne.applicationMetadata;ae.appName=de,ae.appVersion=me}re.clientDetails=R.SdkClientDetails.create(ae),re.audioSessionId=this.audioSessionId,re.wantsCompressedSdp=Vs.CLIENT_SUPPORTS_COMPRESSION,re.disablePeriodicKeyframeRequestOnContentSender=ne.disablePeriodicKeyframeRequestOnContentSender,re.serverSideNetworkAdaption=_.convertServerSideNetworkAdaptionEnumToSignaled(ne.serverSideNetworkAdaption),re.supportedServerSideNetworkAdaptions=ne.supportedServerSideNetworkAdaptions.map(_.convertServerSideNetworkAdaptionEnumToSignaled),re.wantsAllTemporalLayersInIndex=ne.wantsAllTemporalLayersInIndex;const le=R.SdkSignalFrame.create();le.type=R.SdkSignalFrame.Type.JOIN,le.join=re,this.sendMessage(le)}subscribe(ne){const re=R.SdkSubscribeFrame.create();if(re.sendStreams=[],re.sdpOffer=ne.sdpOffer,ne.connectionTypeHasVideo&&(re.receiveStreamIds=ne.receiveStreamIds),ne.audioHost&&(re.audioCheckin=ne.audioCheckin,re.audioHost=ne.audioHost,re.audioMuted=ne.audioMuted,!ne.audioCheckin)){const ae=R.SdkStreamDescriptor.create();ae.mediaType=R.SdkStreamMediaType.AUDIO,ae.trackLabel="AmazonChimeExpressAudio",ae.attendeeId=ne.attendeeId,ae.streamId=1,ae.groupId=1,ae.framerate=15,ae.maxBitrateKbps=600,ae.avgBitrateBps=4e5,re.sendStreams.push(ae)}if(re.compressedSdpOffer=ne.compressedSdpOffer,re.duplex=R.SdkStreamServiceType.RX,ne.localVideoEnabled){re.duplex=R.SdkStreamServiceType.DUPLEX;for(let ae=0;ae<ne.videoStreamDescriptions.length;ae++){const le=ne.videoStreamDescriptions[ae].clone();le.attendeeId=ne.attendeeId,re.sendStreams.push(le.toStreamDescriptor())}}ne.videoSubscriptionConfiguration.length>0&&(re.videoSubscriptionConfiguration=ne.videoSubscriptionConfiguration.map(this.convertSignalingClientVideoSubscriptionConfiguration));const oe=R.SdkSignalFrame.create();oe.type=R.SdkSignalFrame.Type.SUBSCRIBE,oe.sub=re,this.sendMessage(oe)}remoteVideoUpdate(ne,re){const oe=R.SdkRemoteVideoUpdateFrame.create();oe.addedOrUpdatedVideoSubscriptions=ne.map(this.convertSignalingClientVideoSubscriptionConfiguration),oe.removedVideoSubscriptionMids=re;const ae=R.SdkSignalFrame.create();ae.type=R.SdkSignalFrame.Type.REMOTE_VIDEO_UPDATE,ae.remoteVideoUpdate=oe,this.sendMessage(ae)}convertSignalingClientVideoSubscriptionConfiguration(ne){const re=new R.SdkVideoSubscriptionConfiguration;switch(re.mid=ne.mid,re.attendeeId=ne.attendeeId,re.streamId=ne.streamId,re.groupId=ne.groupId,re.priority=ne.priority,re.targetBitrateKbps=ne.targetBitrateKbps,ne.qualityAdaptationPreference){case S.default.Balanced:re.qualityAdaptationPreference=R.SdkVideoQualityAdaptationPreference.BALANCED;break;case S.default.MaintainFramerate:re.qualityAdaptationPreference=R.SdkVideoQualityAdaptationPreference.MAINTAIN_FRAMERATE;break;case S.default.MaintainResolution:re.qualityAdaptationPreference=R.SdkVideoQualityAdaptationPreference.MAINTAIN_RESOLUTION;break;default:re.qualityAdaptationPreference=R.SdkVideoQualityAdaptationPreference.BALANCED}return re}leave(){const ne=R.SdkSignalFrame.create();ne.type=R.SdkSignalFrame.Type.LEAVE,ne.leave=R.SdkLeaveFrame.create(),this.sendMessage(ne),this.logger.debug(()=>"sent leave")}sendClientMetrics(ne){const re=R.SdkSignalFrame.create();re.type=R.SdkSignalFrame.Type.CLIENT_METRIC,re.clientMetric=ne,this.sendMessage(re)}sendDataMessage(ne){const re=R.SdkSignalFrame.create();re.type=R.SdkSignalFrame.Type.DATA_MESSAGE,re.dataMessage=ne,this.sendMessage(re)}closeConnection(){var ne,re;if(this.webSocket.readyState()!==T.default.None&&this.webSocket.readyState()!==T.default.Closed){this.isClosing=!0,this.sendEvent(new D.default(this,Y.default.WebSocketClosing,null));const oe=new w.default(Vs.CLOSE_EVENT_TIMEOUT_MS),ae=le=>{var de,me;(me=(de=this.webSocket).removeEventListener)===null||me===void 0||me.call(de,"close",ae),oe.stop(),this.closeEventHandler(le)};(re=(ne=this.webSocket).removeEventListener)===null||re===void 0||re.call(ne,"close",this.closeEventHandler),this.webSocket.addEventListener("close",ae),oe.start(()=>{ae(new CloseEvent("close",{wasClean:!1,code:1006,reason:"",bubbles:!1}))}),this.webSocket.close(),this.deactivatePageUnloadHandler()}else this.logger.info("no existing signaling client connection needs closing"),this.serviceConnectionRequestQueue()}ready(){return this.webSocket.readyState()===T.default.Open&&!this.isClosing&&this.wasOpened}mute(ne){const re=R.SdkSignalFrame.create();re.type=R.SdkSignalFrame.Type.AUDIO_CONTROL;const oe=R.SdkAudioControlFrame.create();oe.muted=ne,re.audioControl=oe,this.sendMessage(re)}pause(ne){const re=R.SdkSignalFrame.create();re.type=R.SdkSignalFrame.Type.PAUSE,re.pause=R.SdkPauseResumeFrame.create(),re.pause.streamIds=ne,this.sendMessage(re)}resume(ne){const re=R.SdkSignalFrame.create();re.type=R.SdkSignalFrame.Type.RESUME,re.pause=R.SdkPauseResumeFrame.create(),re.pause.streamIds=ne,this.sendMessage(re)}resetConnection(){this.webSocket.destroy(),this.wasOpened=!1}sendMessage(ne){ne.timestampMs=Date.now(),this.logger.debug(()=>`sending: ${JSON.stringify(ne)}`);const re=this.prependWithFrameTypeRTC(R.SdkSignalFrame.encode(ne).finish());if(this.ready()){if(!this.webSocket.send(re)){this.sendEvent(new D.default(this,Y.default.WebSocketSendMessageFailure,null));return}this.sendEvent(new D.default(this,Y.default.WebSocketSentMessage,null))}else this.sendEvent(new D.default(this,Y.default.WebSocketSkippedMessage,null))}receiveMessage(ne){let re;try{re=R.SdkSignalFrame.decode(ne)}catch{this.logger.info(`failed to decode: ${ne}`),this.sendEvent(new D.default(this,Y.default.ProtocolDecodeFailure,null));return}this.logger.debug(()=>`received: ${JSON.stringify(re)}`),this.webSocket.readyState()===T.default.Open?this.sendEvent(new D.default(this,Y.default.ReceivedSignalFrame,re)):this.logger.info(`skipping notification of message since WebSocket is not open: ${JSON.stringify(re)}`)}stripFrameTypeRTC(ne){const re=ne[0];return re!==Vs.FRAME_TYPE_RTC&&re!==2&&this.logger.warn(`expected FrameTypeRTC for message but got ${re}`),ne.slice(1)}prependWithFrameTypeRTC(ne){const re=new Uint8Array(ne.length+1);return re[0]=Vs.FRAME_TYPE_RTC,re.set(ne,1),re}serviceConnectionRequestQueue(){if(this.connectionRequestQueue.length===0){this.logger.info("no connection requests to service");return}const ne=this.connectionRequestQueue.shift();this.logger.info(`opening connection to ${ne.url()}`),this.isClosing=!1,this.webSocket.create(ne.url(),ne.protocols()),this.setUpEventListeners(),this.sendEvent(new D.default(this,Y.default.WebSocketConnecting,null))}sendEvent(ne){switch(ne.type){case Y.default.WebSocketMessage:case Y.default.ReceivedSignalFrame:case Y.default.WebSocketSentMessage:this.logger.debug(()=>`notifying event: ${Y.default[ne.type]}`);break;case Y.default.WebSocketSkippedMessage:this.logger.debug(()=>`notifying event: ${Y.default[ne.type]}, websocket state=${T.default[this.webSocket.readyState()]}`);break;default:this.logger.info(`notifying event: ${Y.default[ne.type]}`);break}for(const re of this.observerQueue)re.handleSignalingClientEvent(ne)}setUpEventListeners(){this.webSocket.addEventListener("open",()=>{this.activatePageUnloadHandler(),this.wasOpened=!0,this.sendEvent(new D.default(this,Y.default.WebSocketOpen,null))}),this.webSocket.addEventListener("message",ne=>{this.sendEvent(new D.default(this,Y.default.WebSocketMessage,null)),this.receiveMessage(this.stripFrameTypeRTC(new Uint8Array(ne.data)))}),this.webSocket.addEventListener("close",this.closeEventHandler),this.webSocket.addEventListener("error",()=>{if(this.isClosing&&!this.wasOpened){this.logger.info("ignoring error closing signaling while connecting");return}this.wasOpened?(this.logger.error("received error while connected"),this.sendEvent(new D.default(this,Y.default.WebSocketError,null))):(this.logger.error("failed to connect"),this.sendEvent(new D.default(this,Y.default.WebSocketFailed,null)))})}activatePageUnloadHandler(){this.unloadHandler=()=>{this.leave()};const ne=commonjsGlobal;ne.window&&ne.window.addEventListener&&window.addEventListener("unload",this.unloadHandler)}deactivatePageUnloadHandler(){const ne=commonjsGlobal;ne.window&&ne.window.removeEventListener&&window.removeEventListener("unload",this.unloadHandler),this.unloadHandler=null}generateNewAudioSessionId(){const ne=new Uint32Array(1);return M.getRandomValues(ne),ne[0]}promoteToPrimaryMeeting(ne){const re=R.SdkMeetingSessionCredentials.create();re.attendeeId=ne.attendeeId,re.externalUserId=ne.externalUserId,re.joinToken=ne.joinToken;const oe=R.SdkPrimaryMeetingJoinFrame.create();oe.credentials=re;const ae=R.SdkSignalFrame.create();ae.type=R.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN,ae.primaryMeetingJoin=oe,this.sendMessage(ae)}demoteFromPrimaryMeeting(){const ne=R.SdkPrimaryMeetingLeaveFrame.create(),re=R.SdkSignalFrame.create();re.type=R.SdkSignalFrame.Type.PRIMARY_MEETING_LEAVE,re.primaryMeetingLeave=ne,this.sendMessage(re)}};return DefaultSignalingClient.default=ee,ee.FRAME_TYPE_RTC=5,ee.CLOSE_EVENT_TIMEOUT_MS=2e3,ee.CLIENT_SUPPORTS_COMPRESSION=!0,DefaultSignalingClient}var SignalingClientVideoSubscriptionConfiguration={},hasRequiredSignalingClientVideoSubscriptionConfiguration;function requireSignalingClientVideoSubscriptionConfiguration(){if(hasRequiredSignalingClientVideoSubscriptionConfiguration)return SignalingClientVideoSubscriptionConfiguration;hasRequiredSignalingClientVideoSubscriptionConfiguration=1,Object.defineProperty(SignalingClientVideoSubscriptionConfiguration,"__esModule",{value:!0});let C=class{equals(E){return E!==void 0&&this.mid===E.mid&&this.attendeeId===E.attendeeId&&this.streamId===E.streamId&&this.groupId===E.groupId&&this.priority===E.priority&&this.targetBitrateKbps===E.targetBitrateKbps&&this.qualityAdaptationPreference===E.qualityAdaptationPreference}};return SignalingClientVideoSubscriptionConfiguration.default=C,SignalingClientVideoSubscriptionConfiguration}var StatsCollector={},RedundantAudioRecoveryMetricReport={},hasRequiredRedundantAudioRecoveryMetricReport;function requireRedundantAudioRecoveryMetricReport(){if(hasRequiredRedundantAudioRecoveryMetricReport)return RedundantAudioRecoveryMetricReport;hasRequiredRedundantAudioRecoveryMetricReport=1,Object.defineProperty(RedundantAudioRecoveryMetricReport,"__esModule",{value:!0});let C=class{constructor(){this.currentTimestampMs=0,this.ssrc=0,this.totalAudioPacketsLost=0,this.totalAudioPacketsExpected=0,this.totalAudioPacketsRecoveredRed=0,this.totalAudioPacketsRecoveredFec=0}};return RedundantAudioRecoveryMetricReport.default=C,RedundantAudioRecoveryMetricReport}var StreamMetricReport={},hasRequiredStreamMetricReport;function requireStreamMetricReport(){if(hasRequiredStreamMetricReport)return StreamMetricReport;hasRequiredStreamMetricReport=1,Object.defineProperty(StreamMetricReport,"__esModule",{value:!0});let C=class{constructor(){this.previousMetrics={},this.currentMetrics={},this.currentStringMetrics={},this.previousObjectMetrics={},this.currentObjectMetrics={}}};return StreamMetricReport.default=C,StreamMetricReport}var MeetingSessionLifecycleEvent={},hasRequiredMeetingSessionLifecycleEvent;function requireMeetingSessionLifecycleEvent(){return hasRequiredMeetingSessionLifecycleEvent||(hasRequiredMeetingSessionLifecycleEvent=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.MeetingSessionLifecycleEvent=void 0;var E;(function(w){w[w.Connecting=0]="Connecting",w[w.Started=1]="Started",w[w.Stopped=2]="Stopped"})(E=C.MeetingSessionLifecycleEvent||(C.MeetingSessionLifecycleEvent={})),C.default=E}(MeetingSessionLifecycleEvent)),MeetingSessionLifecycleEvent}var MeetingSessionLifecycleEventCondition={},hasRequiredMeetingSessionLifecycleEventCondition;function requireMeetingSessionLifecycleEventCondition(){return hasRequiredMeetingSessionLifecycleEventCondition||(hasRequiredMeetingSessionLifecycleEventCondition=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.MeetingSessionLifecycleEventCondition=void 0;var E;(function(w){w[w.ConnectingNew=0]="ConnectingNew",w[w.ReconnectingExisting=1]="ReconnectingExisting",w[w.StartedNew=2]="StartedNew",w[w.StartedExisting=3]="StartedExisting",w[w.StartedAfterReconnect=4]="StartedAfterReconnect",w[w.StoppedCleanly=5]="StoppedCleanly",w[w.StoppedWithFailure=6]="StoppedWithFailure"})(E=C.MeetingSessionLifecycleEventCondition||(C.MeetingSessionLifecycleEventCondition={})),C.default=E}(MeetingSessionLifecycleEventCondition)),MeetingSessionLifecycleEventCondition}var hasRequiredStatsCollector;function requireStatsCollector(){if(hasRequiredStatsCollector)return StatsCollector;hasRequiredStatsCollector=1;var C=StatsCollector&&StatsCollector.__awaiter||function(oe,ae,le,de){function me(fe){return fe instanceof le?fe:new le(function(ge){ge(fe)})}return new(le||(le=Promise))(function(fe,ge){function he(Se){try{be(de.next(Se))}catch(Re){ge(Re)}}function ve(Se){try{be(de.throw(Se))}catch(Re){ge(Re)}}function be(Se){Se.done?fe(Se.value):me(Se.value).then(he,ve)}be((de=de.apply(oe,ae||[])).next())})},E=StatsCollector&&StatsCollector.__importDefault||function(oe){return oe&&oe.__esModule?oe:{default:oe}};Object.defineProperty(StatsCollector,"__esModule",{value:!0});const w=E(requireClientMetricReport()),R=E(requireClientMetricReportDirection()),M=E(requireClientMetricReportMediaType()),x=E(requireRedundantAudioRecoveryMetricReport()),S=E(requireStreamMetricReport()),T=E(requireMeetingSessionLifecycleEvent()),_=E(requireMeetingSessionLifecycleEventCondition()),D=E(requireIntervalScheduler()),Y=requireSignalingProtocol(),ee=requireTypes$1(),ie=E(requireAudioLogEvent()),ne=E(requireVideoLogEvent());let re=class du{constructor(ae,le,de=du.INTERVAL_MS){this.audioVideoController=ae,this.logger=le,this.interval=de,this.intervalScheduler=null,this.redRecoveryMetricReport=new x.default,this.lastRedRecoveryMetricReportConsumedTimestampMs=0,this.videoCodecDegradationHighEncodeCpuCount=0,this.videoCodecDegradationEncodeFailureCount=0,this.metricsAddTime=(me,fe,ge)=>{},this.metricsLogEvent=(me,fe)=>{}}toAttribute(ae){return this.toSuffix(ae).substring(1)}toSuffix(ae){return ae.toLowerCase()===ae?`_${ae}`:ae.toUpperCase()===ae?`_${ae.toLowerCase()}`:ae.replace(/([A-Z][a-z]+)/g,function(le){return`_${le}`}).replace(/([A-Z][A-Z]+)/g,function(le){return`_${le}`}).toLowerCase()}logLatency(ae,le,de){const me=this.toSuffix(ae);this.logEventTime("meeting"+me,le,de)}logStateTimeout(ae,le){const de=this.toSuffix(ae);this.logEvent("meeting_session_state_timeout",Object.assign(Object.assign({},le),{state:`state${de}`}))}logAudioEvent(ae,le){const de="audio"+this.toSuffix(ie.default[ae]);this.logEvent(de,le)}logVideoEvent(ae,le){const de="video"+this.toSuffix(ne.default[ae]);this.logEvent(de,le)}logEventTime(ae,le,de={}){const me=Object.assign(Object.assign({},de),{call_id:this.audioVideoController.configuration.meetingId,client_type:du.CLIENT_TYPE,metric_type:"latency"});this.logger.debug(()=>`[StatsCollector] ${ae}: ${JSON.stringify(me)}`),this.metricsAddTime(ae,le,me)}logMeetingSessionStatus(ae){const le=`${ae.statusCode()}`;this.logEvent(le);const de={status:le,status_code:`${ae.statusCode()}`};this.logEvent("meeting_session_status",de),ae.isTerminal()&&this.logEvent("meeting_session_stopped",de),ae.isAudioConnectionFailure()&&this.logEvent("meeting_session_audio_failed",de),ae.isFailure()&&this.logEvent("meeting_session_failed",de)}logLifecycleEvent(ae,le){const de={lifecycle_event:`lifecycle${this.toSuffix(T.default[ae])}`,lifecycle_event_code:`${ae}`,lifecycle_event_condition:`condition${this.toSuffix(_.default[le])}`,lifecycle_event_condition_code:`${le}`};this.logEvent("meeting_session_lifecycle",de)}logEvent(ae,le={}){const de=Object.assign(Object.assign({},le),{call_id:this.audioVideoController.configuration.meetingId,client_type:du.CLIENT_TYPE});this.logger.debug(()=>`[StatsCollector] ${ae}: ${JSON.stringify(de)}`),this.metricsLogEvent(ae,de)}start(ae,le){return this.intervalScheduler?!1:(this.logger.info("Starting StatsCollector"),this.signalingClient=ae,this.videoStreamIndex=le,this.clientMetricReport=new w.default(this.logger,this.videoStreamIndex,this.audioVideoController.configuration.credentials.attendeeId),this.intervalScheduler=new D.default(this.interval),this.intervalScheduler.start(()=>C(this,void 0,void 0,function*(){yield this.getStatsWrapper()})),!0)}stop(){this.logger.info("Stopping StatsCollector"),this.intervalScheduler&&this.intervalScheduler.stop(),this.intervalScheduler=null}updateMetricValues(ae,le){const de=le?this.clientMetricReport.streamMetricReports[Number(ae.ssrc)]:this.clientMetricReport.globalMetricReport;let me;le?me=this.clientMetricReport.getMetricMap(de.mediaType,de.direction):me=this.clientMetricReport.getMetricMap();for(const fe in ae)fe in me&&(typeof ae[fe]=="number"?(de.previousMetrics[fe]=de.currentMetrics[fe],de.currentMetrics[fe]=ae[fe]):typeof ae[fe]=="string"?de.currentStringMetrics[fe]=ae[fe]:typeof ae[fe]=="object"?(de.previousObjectMetrics[fe]=de.currentObjectMetrics[fe]===void 0?ae[fe]:de.currentObjectMetrics[fe],de.currentObjectMetrics[fe]=ae[fe]):this.logger.error(`Unknown metric value type ${typeof ae[fe]} for metric ${fe}`))}processRawMetricReports(ae){this.clientMetricReport.currentSsrcs={};const le=Date.now();for(const de of ae){const me=this.isStreamRawMetricReport(de.type);if(me){const fe=this.clientMetricReport.streamMetricReports[Number(de.ssrc)];if(fe)fe.mediaType===M.default.VIDEO&&fe.direction===R.default.UPSTREAM?fe.streamId=this.videoStreamIndex.sendVideoStreamIdFromRid(de.rid):fe.streamId=this.videoStreamIndex.streamIdForSSRC(Number(de.ssrc));else{const ge=new S.default;ge.mediaType=this.getMediaType(de),ge.direction=this.getDirectionType(de),ge.mediaType===M.default.VIDEO&&ge.direction===R.default.UPSTREAM?ge.streamId=this.videoStreamIndex.sendVideoStreamIdFromRid(de.rid):this.videoStreamIndex.allStreams().empty()||(ge.streamId=this.videoStreamIndex.streamIdForSSRC(Number(de.ssrc)),this.videoStreamIndex.groupIdForSSRC!==void 0&&(ge.groupId=this.videoStreamIndex.groupIdForSSRC(Number(de.ssrc)))),this.clientMetricReport.streamMetricReports[Number(de.ssrc)]=ge}this.clientMetricReport.currentSsrcs[Number(de.ssrc)]=1}this.updateMetricValues(de,me)}this.clientMetricReport.removeDestroyedSsrcs(),this.clientMetricReport.previousTimestampMs=this.clientMetricReport.currentTimestampMs,this.clientMetricReport.currentTimestampMs=le,this.clientMetricReport.print()}addStreamMetricDimensionFrames(ae,le){const de=this.clientMetricReport.getStreamDimensionMap();for(const me in le.currentStringMetrics)if(me in de){const fe=Y.SdkStreamDimension.create();fe.type=de[me];const ge=Y.SdkDimensionValue.create();ge.stringValue=le.currentStringMetrics[me],fe.value=ge,ae.dimensions.push(fe)}}addMetricFrame(ae,le,de,me){const fe=de.type,ge=de.transform,he=de.source,ve=le.streamMetricFrames.length,be=le.streamMetricFrames[ve-1];if(fe){const Se=Y.SdkMetric.create();Se.type=fe,Se.value=ge(he||ae,me),me?be.metrics.push(Se):le.globalMetrics.push(Se)}}addGlobalMetricsToProtobuf(ae){const le=this.clientMetricReport.getMetricMap();for(const de in this.clientMetricReport.globalMetricReport.currentMetrics)this.addMetricFrame(de,ae,le[de])}addStreamMetricsToProtobuf(ae){for(const le in this.clientMetricReport.streamMetricReports){const de=this.clientMetricReport.streamMetricReports[le],me=Y.SdkStreamMetricFrame.create();me.streamId=de.streamId,me.metrics=[],this.addStreamMetricDimensionFrames(me,de),ae.streamMetricFrames.push(me);const fe=this.clientMetricReport.getMetricMap(de.mediaType,de.direction);for(const ge in de.currentMetrics)this.addMetricFrame(ge,ae,fe[ge],Number(le));for(const ge in de.currentStringMetrics)this.addMetricFrame(ge,ae,fe[ge],Number(le));for(const ge in de.currentObjectMetrics)this.addMetricFrame(ge,ae,fe[ge],Number(le))}}makeClientMetricProtobuf(){const ae=Y.SdkClientMetricFrame.create();return ae.globalMetrics=[],ae.streamMetricFrames=[],this.addGlobalMetricsToProtobuf(ae),this.addStreamMetricsToProtobuf(ae),ae}sendClientMetricProtobuf(ae){this.signalingClient.sendClientMetrics(ae)}isStreamRawMetricReport(ae){return["inbound-rtp","inbound-rtp-red","outbound-rtp","remote-inbound-rtp","remote-outbound-rtp"].includes(ae)}getMediaType(ae){return ae.kind==="audio"?M.default.AUDIO:M.default.VIDEO}getDirectionType(ae){const{type:le}=ae;return le==="inbound-rtp"||le==="remote-outbound-rtp"||le==="inbound-rtp-red"?R.default.DOWNSTREAM:R.default.UPSTREAM}isValidStandardRawMetric(ae){return ae.type==="inbound-rtp"||ae.type==="inbound-rtp-red"||ae.type==="outbound-rtp"||ae.type==="remote-inbound-rtp"||ae.type==="remote-outbound-rtp"||ae.type==="candidate-pair"&&ae.state==="succeeded"||ae.type==="media-source"&&ae.kind==="audio"}isValidSsrc(ae){let le=!0;return this.isStreamRawMetricReport(ae.type)&&this.getDirectionType(ae)===R.default.DOWNSTREAM&&this.getMediaType(ae)===M.default.VIDEO&&(le=this.videoStreamIndex.streamIdForSSRC(Number(ae.ssrc))>0),le}isValidRawMetricReport(ae){return this.isValidStandardRawMetric(ae)&&this.isValidSsrc(ae)}filterRawMetricReports(ae){const le=[];for(const de of ae)this.isValidRawMetricReport(de)&&le.push(de);return le}handleRawMetricReports(ae){const le=this.filterRawMetricReports(ae);this.logger.debug(()=>`Filtered raw metrics : ${JSON.stringify(le)}`);const de=[];this.maybeAddRedRecoveryMetrics(de),this.addVideoCodecDegradationMetrics(de),this.clientMetricReport.customStatsReports=de,le.push(...de),this.processRawMetricReports(le);const me=this.makeClientMetricProtobuf();this.sendClientMetricProtobuf(me),this.audioVideoController.forEachObserver(fe=>{ee.Maybe.of(fe.metricsDidReceive).map(ge=>ge.bind(fe)(this.clientMetricReport.clone()))})}getStatsWrapper(){return C(this,void 0,void 0,function*(){if(!this.audioVideoController.rtcPeerConnection)return;const ae=[];try{const le=yield this.audioVideoController.rtcPeerConnection.getStats();this.clientMetricReport.rtcStatsReport=le,le.forEach(de=>{ae.push(de)}),this.handleRawMetricReports(ae)}catch(le){this.logger.error(le.message)}})}overrideObservableMetric(ae,le){this.clientMetricReport.overrideObservableMetric(ae,le)}recoveryMetricsDidReceive(ae){this.redRecoveryMetricReport=ae}maybeAddRedRecoveryMetrics(ae){this.redRecoveryMetricReport.currentTimestampMs!==this.lastRedRecoveryMetricReportConsumedTimestampMs&&(ae.push({kind:"audio",type:"inbound-rtp-red",ssrc:this.redRecoveryMetricReport.ssrc,timestamp:this.redRecoveryMetricReport.currentTimestampMs,totalAudioPacketsLost:this.redRecoveryMetricReport.totalAudioPacketsLost,totalAudioPacketsExpected:this.redRecoveryMetricReport.totalAudioPacketsExpected,totalAudioPacketsRecoveredRed:this.redRecoveryMetricReport.totalAudioPacketsRecoveredRed,totalAudioPacketsRecoveredFec:this.redRecoveryMetricReport.totalAudioPacketsRecoveredFec}),this.lastRedRecoveryMetricReportConsumedTimestampMs=this.redRecoveryMetricReport.currentTimestampMs)}videoCodecDegradationHighEncodeCpuDidReceive(){this.videoCodecDegradationHighEncodeCpuCount+=1}videoCodecDegradationEncodeFailureDidReceive(){this.videoCodecDegradationEncodeFailureCount+=1}addVideoCodecDegradationMetrics(ae){const le=this.clientMetricReport.getVideoUpstreamSsrc();le!==null&&ae.push({kind:"video",type:"outbound-rtp",ssrc:le,timestamp:Date.now(),videoCodecDegradationHighEncodeCpu:this.videoCodecDegradationHighEncodeCpuCount,videoCodecDegradationEncodeFailure:this.videoCodecDegradationEncodeFailureCount}),this.videoCodecDegradationHighEncodeCpuCount=0,this.videoCodecDegradationEncodeFailureCount=0}};return StatsCollector.default=re,re.INTERVAL_MS=1e3,re.CLIENT_TYPE="amazon-chime-sdk-js",StatsCollector}var FinishGatheringICECandidatesTask={},hasRequiredFinishGatheringICECandidatesTask;function requireFinishGatheringICECandidatesTask(){if(hasRequiredFinishGatheringICECandidatesTask)return FinishGatheringICECandidatesTask;hasRequiredFinishGatheringICECandidatesTask=1;var C=FinishGatheringICECandidatesTask&&FinishGatheringICECandidatesTask.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=FinishGatheringICECandidatesTask&&FinishGatheringICECandidatesTask.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(FinishGatheringICECandidatesTask,"__esModule",{value:!0});const w=E(requireMeetingSessionStatusCode()),R=E(requireSDP()),M=E(requireBaseTask());let x=class im extends M.default{constructor(T,_=im.CHROME_VPN_TIMEOUT_MS){super(T.logger),this.context=T,this.chromeVpnTimeoutMs=_,this.taskName="FinishGatheringICECandidatesTask"}removeEventListener(){this.context.peer&&(this.context.peer.removeEventListener("icecandidate",this.context.iceCandidateHandler),this.context.turnCredentials||this.context.peer.removeEventListener("icegatheringstatechange",this.context.iceGatheringStateEventHandler))}cancel(){let T;this.context.browserBehavior.requiresIceCandidateGatheringTimeoutWorkaround()&&this.chromeVpnTimeoutMs<this.context.meetingSessionConfiguration.connectionTimeoutMs&&Date.now()-this.startTimestampMs>this.chromeVpnTimeoutMs&&(T=new Error(`canceling ${this.name()} due to the meeting status code: ${w.default.ICEGatheringTimeoutWorkaround}`)),this.cancelPromise&&(T=T||new Error(`canceling ${this.name()}`),this.cancelPromise(T),delete this.cancelPromise)}run(){return C(this,void 0,void 0,function*(){if(this.context.peer||this.logAndThrow("session does not have peer connection; bypass ice gathering"),this.context.browserBehavior.requiresCheckForSdpConnectionAttributes()){if(new R.default(this.context.peer.localDescription.sdp).hasCandidatesForAllMLines()){this.context.logger.info(`ice gathering already complete; bypass gathering, current local description ${this.context.peer.localDescription.sdp}`);return}}else this.context.logger.info(`iOS device does not require checking for connection attributes in SDP, current local description ${this.context.peer.localDescription.sdp}`);if((this.context.browserBehavior.hasFirefoxWebRTC()||this.context.peer.iceGatheringState==="complete")&&new R.default(this.context.peer.localDescription.sdp).hasCandidates()){this.context.logger.info("ice gathering state is complete and candidates are in SDP; bypass gathering");return}try{yield new Promise((T,_)=>{this.cancelPromise=D=>{this.removeEventListener(),_(D)},this.context.turnCredentials||(this.context.iceGatheringStateEventHandler=()=>{if(this.context.peer.iceGatheringState==="complete"){this.removeEventListener(),T(),delete this.cancelPromise;return}},this.context.peer.addEventListener("icegatheringstatechange",this.context.iceGatheringStateEventHandler)),this.context.iceCandidateHandler=D=>{if(this.context.logger.info(`ice candidate: ${D.candidate?D.candidate.candidate:"(null)"} state: ${this.context.peer.iceGatheringState}`),D.candidate&&(R.default.isRTPCandidate(D.candidate.candidate)&&this.context.iceCandidates.push(D.candidate),this.context.turnCredentials&&this.context.iceCandidates.length>=1)){this.context.logger.info("gathered at least one relay candidate"),this.removeEventListener(),T(),delete this.cancelPromise;return}this.context.peer.iceGatheringState==="complete"&&(this.context.logger.info("done gathering ice candidates"),this.removeEventListener(),!new R.default(this.context.peer.localDescription.sdp).hasCandidates()||this.context.iceCandidates.length===0?(_(new Error("no ice candidates were gathered")),delete this.cancelPromise):(T(),delete this.cancelPromise))},this.context.peer.addEventListener("icecandidate",this.context.iceCandidateHandler),this.startTimestampMs=Date.now()})}catch(T){throw T}finally{this.startTimestampMs&&(this.context.iceGatheringDurationMs=Math.round(Date.now()-this.startTimestampMs))}})}};return FinishGatheringICECandidatesTask.default=x,x.CHROME_VPN_TIMEOUT_MS=5e3,FinishGatheringICECandidatesTask}var JoinAndReceiveIndexTask={},MeetingSessionTURNCredentials={},hasRequiredMeetingSessionTURNCredentials;function requireMeetingSessionTURNCredentials(){if(hasRequiredMeetingSessionTURNCredentials)return MeetingSessionTURNCredentials;hasRequiredMeetingSessionTURNCredentials=1,Object.defineProperty(MeetingSessionTURNCredentials,"__esModule",{value:!0});let C=class{constructor(){this.username=null,this.password=null,this.ttl=null,this.uris=null}};return MeetingSessionTURNCredentials.default=C,MeetingSessionTURNCredentials}var SignalingClientJoin={},hasRequiredSignalingClientJoin;function requireSignalingClientJoin(){if(hasRequiredSignalingClientJoin)return SignalingClientJoin;hasRequiredSignalingClientJoin=1;var C=SignalingClientJoin&&SignalingClientJoin.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(SignalingClientJoin,"__esModule",{value:!0});const E=C(requireServerSideNetworkAdaption());let w=class{constructor(R){this.applicationMetadata=R,this.serverSideNetworkAdaption=E.default.Default,this.supportedServerSideNetworkAdaptions=[],this.wantsAllTemporalLayersInIndex=!1,this.disablePeriodicKeyframeRequestOnContentSender=!1}};return SignalingClientJoin.default=w,SignalingClientJoin}var hasRequiredJoinAndReceiveIndexTask;function requireJoinAndReceiveIndexTask(){if(hasRequiredJoinAndReceiveIndexTask)return JoinAndReceiveIndexTask;hasRequiredJoinAndReceiveIndexTask=1;var C=JoinAndReceiveIndexTask&&JoinAndReceiveIndexTask.__createBinding||(Object.create?function(re,oe,ae,le){le===void 0&&(le=ae),Object.defineProperty(re,le,{enumerable:!0,get:function(){return oe[ae]}})}:function(re,oe,ae,le){le===void 0&&(le=ae),re[le]=oe[ae]}),E=JoinAndReceiveIndexTask&&JoinAndReceiveIndexTask.__setModuleDefault||(Object.create?function(re,oe){Object.defineProperty(re,"default",{enumerable:!0,value:oe})}:function(re,oe){re.default=oe}),w=JoinAndReceiveIndexTask&&JoinAndReceiveIndexTask.__importStar||function(re){if(re&&re.__esModule)return re;var oe={};if(re!=null)for(var ae in re)ae!=="default"&&Object.prototype.hasOwnProperty.call(re,ae)&&C(oe,re,ae);return E(oe,re),oe},R=JoinAndReceiveIndexTask&&JoinAndReceiveIndexTask.__awaiter||function(re,oe,ae,le){function de(me){return me instanceof ae?me:new ae(function(fe){fe(me)})}return new(ae||(ae=Promise))(function(me,fe){function ge(be){try{ve(le.next(be))}catch(Se){fe(Se)}}function he(be){try{ve(le.throw(be))}catch(Se){fe(Se)}}function ve(be){be.done?me(be.value):de(be.value).then(ge,he)}ve((le=le.apply(re,oe||[])).next())})},M=JoinAndReceiveIndexTask&&JoinAndReceiveIndexTask.__importDefault||function(re){return re&&re.__esModule?re:{default:re}};Object.defineProperty(JoinAndReceiveIndexTask,"__esModule",{value:!0});const x=M(requireMeetingSessionStatus()),S=M(requireMeetingSessionStatusCode()),T=M(requireMeetingSessionTURNCredentials()),_=w(requireServerSideNetworkAdaption()),D=M(requireSignalingClientEventType()),Y=M(requireSignalingClientJoin()),ee=requireSignalingProtocol(),ie=M(requireBaseTask());let ne=class extends ie.default{constructor(re){super(re.logger),this.context=re,this.taskName="JoinAndReceiveIndexTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return R(this,void 0,void 0,function*(){const re=yield new Promise((oe,ae)=>{const le=this.context;le.turnCredentials=null;class de{constructor(he){this.signalingClient=he}cancel(){this.signalingClient.removeObserver(this),ae(new Error("JoinAndReceiveIndexTask got canceled while waiting for SdkIndexFrame"))}handleSignalingClientEvent(he){if(he.type===D.default.WebSocketClosed){let be=`The signaling connection was closed with code ${he.closeCode} and reason: ${he.closeReason}`;le.logger.warn(be);let Se=S.default.SignalingBadRequest;he.closeCode===4410?(be="The meeting already ended.",le.logger.warn(be),Se=S.default.MeetingEnded):he.closeCode>=4500&&he.closeCode<4600&&(Se=S.default.SignalingInternalServerError),le.audioVideoController.handleMeetingSessionStatus(new x.default(Se),new Error(be));return}if(he.type!==D.default.ReceivedSignalFrame)return;if(he.message.type===ee.SdkSignalFrame.Type.JOIN_ACK){const be=he.message.joinack;if(!be){le.audioVideoController.handleMeetingSessionStatus(new x.default(S.default.SignalingRequestFailed),new Error("Join ACK message did not include expected frame"));return}if(be.videoSubscriptionLimit&&(le.videoSubscriptionLimit=be.videoSubscriptionLimit),le.serverSupportsCompression=be.wantsCompressedSdp,be.defaultServerSideNetworkAdaption!==void 0&&be.defaultServerSideNetworkAdaption!==_.default.Default&&le.videoDownlinkBandwidthPolicy.setServerSideNetworkAdaption!==void 0){const Se=be.defaultServerSideNetworkAdaption;le.logger.info(`Overriding server side network adaption value to ${Se}`),le.videoDownlinkBandwidthPolicy.setServerSideNetworkAdaption(_.convertServerSideNetworkAdaptionEnumFromSignaled(Se))}be&&be.turnCredentials?(le.turnCredentials=new T.default,le.turnCredentials.username=be.turnCredentials.username,le.turnCredentials.password=be.turnCredentials.password,le.turnCredentials.ttl=be.turnCredentials.ttl,le.turnCredentials.uris=be.turnCredentials.uris.map(Se=>le.meetingSessionConfiguration.urls.urlRewriter(Se)).filter(Se=>!!Se)):le.logger.error("missing TURN credentials in JoinAckFrame");return}if(he.message.type!==ee.SdkSignalFrame.Type.INDEX)return;this.signalingClient.removeObserver(this);const ve=he.message.index;oe(ve)}}const me=new de(this.context.signalingClient);this.context.signalingClient.registerObserver(me),this.taskCanceler=me,this.context.previousSdpAnswerAsString="",this.context.previousSdpOffer=null,this.context.serverSupportsCompression=!1;const fe=new Y.default(this.context.meetingSessionConfiguration.applicationMetadata);this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption!==void 0&&this.context.videoDownlinkBandwidthPolicy.supportedServerSideNetworkAdaptions!==void 0&&(fe.serverSideNetworkAdaption=this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption(),fe.supportedServerSideNetworkAdaptions=this.context.videoDownlinkBandwidthPolicy.supportedServerSideNetworkAdaptions()),this.context.videoDownlinkBandwidthPolicy.wantsAllTemporalLayersInIndex!==void 0&&(fe.wantsAllTemporalLayersInIndex=this.context.videoDownlinkBandwidthPolicy.wantsAllTemporalLayersInIndex()),fe.disablePeriodicKeyframeRequestOnContentSender=this.context.meetingSessionConfiguration.disablePeriodicKeyframeRequestOnContentSender,this.context.signalingClient.join(fe)});this.context.logger.info(`received first index ${JSON.stringify(re)}`),this.context.indexFrame=re})}};return JoinAndReceiveIndexTask.default=ne,JoinAndReceiveIndexTask}var LeaveAndReceiveLeaveAckTask={},hasRequiredLeaveAndReceiveLeaveAckTask;function requireLeaveAndReceiveLeaveAckTask(){if(hasRequiredLeaveAndReceiveLeaveAckTask)return LeaveAndReceiveLeaveAckTask;hasRequiredLeaveAndReceiveLeaveAckTask=1;var C=LeaveAndReceiveLeaveAckTask&&LeaveAndReceiveLeaveAckTask.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=LeaveAndReceiveLeaveAckTask&&LeaveAndReceiveLeaveAckTask.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(LeaveAndReceiveLeaveAckTask,"__esModule",{value:!0});const w=E(requireSignalingClientEventType()),R=requireSignalingProtocol(),M=E(requireBaseTask());let x=class extends M.default{constructor(S){super(S.logger),this.context=S,this.taskName="LeaveAndReceiveLeaveAckTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return C(this,void 0,void 0,function*(){this.context.signalingClient.ready()&&(this.context.signalingClient.leave(),this.context.logger.info("sent leave"),yield this.receiveLeaveAck())})}receiveLeaveAck(){return new Promise((S,T)=>{class _{constructor(ee,ie){this.signalingClient=ee,this.logger=ie}cancel(){this.signalingClient.removeObserver(this),T(new Error("LeaveAndReceiveLeaveAckTask got canceled while waiting for IndexFrame"))}handleSignalingClientEvent(ee){if(ee.isConnectionTerminated()){this.signalingClient.removeObserver(this),this.logger.info("LeaveAndReceiveLeaveAckTask connection terminated"),S();return}ee.type===w.default.ReceivedSignalFrame&&ee.message.type===R.SdkSignalFrame.Type.LEAVE_ACK&&(this.signalingClient.removeObserver(this),this.logger.info("got leave ack"),S())}}const D=new _(this.context.signalingClient,this.context.logger);this.taskCanceler=D,this.context.signalingClient.registerObserver(D)})}};return LeaveAndReceiveLeaveAckTask.default=x,LeaveAndReceiveLeaveAckTask}var ListenForVolumeIndicatorsTask={},hasRequiredListenForVolumeIndicatorsTask;function requireListenForVolumeIndicatorsTask(){if(hasRequiredListenForVolumeIndicatorsTask)return ListenForVolumeIndicatorsTask;hasRequiredListenForVolumeIndicatorsTask=1;var C=ListenForVolumeIndicatorsTask&&ListenForVolumeIndicatorsTask.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=ListenForVolumeIndicatorsTask&&ListenForVolumeIndicatorsTask.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(ListenForVolumeIndicatorsTask,"__esModule",{value:!0});const w=E(requireSignalingClientEventType()),R=requireSignalingProtocol(),M=E(requireBaseTask());let x=class extends M.default{constructor(S){super(S.logger),this.context=S,this.taskName="ListenForVolumeIndicatorsTask",this.realtimeMuteAndUnmuteHandler=T=>{this.context.signalingClient.mute(T)}}run(){return C(this,void 0,void 0,function*(){this.context.removableObservers.push(this),this.context.signalingClient.registerObserver(this),this.context.realtimeController.realtimeSubscribeToMuteAndUnmuteLocalAudio(this.realtimeMuteAndUnmuteHandler)})}removeObserver(){this.context.realtimeController.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(this.realtimeMuteAndUnmuteHandler),this.context.signalingClient.removeObserver(this)}handleSignalingClientEvent(S){if(S.type===w.default.ReceivedSignalFrame){if(S.message.type===R.SdkSignalFrame.Type.AUDIO_STREAM_ID_INFO){const T=S.message.audioStreamIdInfo;this.context.volumeIndicatorAdapter.sendRealtimeUpdatesForAudioStreamIdInfo(T)}else if(S.message.type===R.SdkSignalFrame.Type.AUDIO_METADATA){const T=S.message.audioMetadata;this.context.volumeIndicatorAdapter.sendRealtimeUpdatesForAudioMetadata(T)}}}};return ListenForVolumeIndicatorsTask.default=x,ListenForVolumeIndicatorsTask}var MonitorTask={},ReconnectionHealthPolicy={},hasRequiredReconnectionHealthPolicy;function requireReconnectionHealthPolicy(){if(hasRequiredReconnectionHealthPolicy)return ReconnectionHealthPolicy;hasRequiredReconnectionHealthPolicy=1;var C=ReconnectionHealthPolicy&&ReconnectionHealthPolicy.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(ReconnectionHealthPolicy,"__esModule",{value:!0});const E=C(requireBaseConnectionHealthPolicy());let w=class Kn extends E.default{constructor(M,x,S){super(x,S,"Reconnection Health"),this.logger=M,this.audioDelayPointsOverMaximum=0,Kn.CONNECTION_UNHEALTHY_THRESHOLD=x.connectionUnhealthyThreshold,Kn.CONNECTION_WAIT_TIME_MS=x.connectionWaitTimeMs,Kn.MISSED_PONGS_THRESHOLD=x.missedPongsUpperThreshold,Kn.MAXIMUM_AUDIO_DELAY_MS=x.maximumAudioDelayMs,Kn.MAXIMUM_AUDIO_DELAY_DATA_POINTS=x.maximumAudioDelayDataPoints}health(){if(this.currentData.isConnectionStartRecent(Kn.CONNECTION_WAIT_TIME_MS))return 1;const M=this.currentData.consecutiveStatsWithNoPackets>=Kn.CONNECTION_UNHEALTHY_THRESHOLD,x=this.currentData.consecutiveMissedPongs>=Kn.MISSED_PONGS_THRESHOLD;this.currentData.audioSpeakerDelayMs>Kn.MAXIMUM_AUDIO_DELAY_MS?this.audioDelayPointsOverMaximum+=1:this.audioDelayPointsOverMaximum=0;const S=this.audioDelayPointsOverMaximum>Kn.MAXIMUM_AUDIO_DELAY_DATA_POINTS;return S&&(this.audioDelayPointsOverMaximum=0),M||x||S?(this.logger.warn(`reconnection recommended due to: no packets received: ${M}, missed pongs: ${x}, bad audio delay: ${S}`),0):1}};return ReconnectionHealthPolicy.default=w,ReconnectionHealthPolicy}var SendingAudioFailureConnectionHealthPolicy={},hasRequiredSendingAudioFailureConnectionHealthPolicy;function requireSendingAudioFailureConnectionHealthPolicy(){if(hasRequiredSendingAudioFailureConnectionHealthPolicy)return SendingAudioFailureConnectionHealthPolicy;hasRequiredSendingAudioFailureConnectionHealthPolicy=1;var C=SendingAudioFailureConnectionHealthPolicy&&SendingAudioFailureConnectionHealthPolicy.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(SendingAudioFailureConnectionHealthPolicy,"__esModule",{value:!0});const E=C(requireBaseConnectionHealthPolicy());let w=class extends E.default{constructor(R,M,x){super(M,x,"Sending Audio Health"),this.logger=R,this.sendingAudioFailureSamplesToConsider=M.sendingAudioFailureSamplesToConsider>0?M.sendingAudioFailureSamplesToConsider:1,this.sendingAudioFailureInitialWaitTimeMs=M.sendingAudioFailureInitialWaitTimeMs,this.maximumTimesToWarn=M.maximumTimesToWarn,this.coolDownTimeMs=M.cooldownTimeMs,this.lastWarnTimestampMs=0,this.warnCount=0}isSendingAudioUnhealthy(){const R=!this.currentData.isConnectionStartRecent(this.sendingAudioFailureInitialWaitTimeMs),M=this.currentData.consecutiveStatsWithNoAudioPacketsSent>=this.sendingAudioFailureSamplesToConsider;return R&&M}health(){if(this.isSendingAudioUnhealthy()){const R=Date.now()-this.lastWarnTimestampMs<this.coolDownTimeMs;return this.currentHealth>this.minimumHealth()&&!R?(this.logger.warn(`Sending Audio is unhealthy for ${this.sendingAudioFailureSamplesToConsider} seconds consecutively.`),this.warnCount++,this.warnCount>this.maximumTimesToWarn?(this.logger.warn("SendingAudioFailure health policy maximum warnings breached. Falling back to reporting healthy."),this.maximumHealth()):(this.lastWarnTimestampMs=Date.now(),this.minimumHealth())):this.currentHealth}return this.maximumHealth()}};return SendingAudioFailureConnectionHealthPolicy.default=w,SendingAudioFailureConnectionHealthPolicy}var UnusableAudioWarningConnectionHealthPolicy={},hasRequiredUnusableAudioWarningConnectionHealthPolicy;function requireUnusableAudioWarningConnectionHealthPolicy(){if(hasRequiredUnusableAudioWarningConnectionHealthPolicy)return UnusableAudioWarningConnectionHealthPolicy;hasRequiredUnusableAudioWarningConnectionHealthPolicy=1;var C=UnusableAudioWarningConnectionHealthPolicy&&UnusableAudioWarningConnectionHealthPolicy.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(UnusableAudioWarningConnectionHealthPolicy,"__esModule",{value:!0});const E=C(requireBaseConnectionHealthPolicy());let w=class extends E.default{constructor(R,M){super(R,M,"Unusable Audio Warning"),this.coolDownTimeMs=R.cooldownTimeMs,this.pastSamplesToConsider=R.pastSamplesToConsider,this.fractionalLoss=R.fractionalLoss,this.packetsExpected=R.packetsExpected,this.maximumTimesToWarn=R.maximumTimesToWarn,this.lastWarnTimestampMs=0,this.warnCount=0}calculateFractionalLoss(){if(this.currentData.packetsReceivedInLastMinute.length<this.pastSamplesToConsider)return 0;const R=this.pastSamplesToConsider,M=R*this.packetsExpected;let x=0;for(let S=0;S<R;S++)x+=this.currentData.packetsReceivedInLastMinute[S];return Math.min(Math.max(1-x/M,0),1)}health(){return Date.now()-this.lastWarnTimestampMs<this.coolDownTimeMs?this.currentHealth:this.calculateFractionalLoss()>=this.fractionalLoss?this.currentHealth!==0&&(this.lastWarnTimestampMs=Date.now(),this.warnCount++,this.warnCount>this.maximumTimesToWarn)?1:0:1}};return UnusableAudioWarningConnectionHealthPolicy.default=w,UnusableAudioWarningConnectionHealthPolicy}var hasRequiredMonitorTask;function requireMonitorTask(){if(hasRequiredMonitorTask)return MonitorTask;hasRequiredMonitorTask=1;var C=MonitorTask&&MonitorTask.__awaiter||function(le,de,me,fe){function ge(he){return he instanceof me?he:new me(function(ve){ve(he)})}return new(me||(me=Promise))(function(he,ve){function be(Ae){try{Re(fe.next(Ae))}catch(Me){ve(Me)}}function Se(Ae){try{Re(fe.throw(Ae))}catch(Me){ve(Me)}}function Re(Ae){Ae.done?he(Ae.value):ge(Ae.value).then(be,Se)}Re((fe=fe.apply(le,de||[])).next())})},E=MonitorTask&&MonitorTask.__importDefault||function(le){return le&&le.__esModule?le:{default:le}};Object.defineProperty(MonitorTask,"__esModule",{value:!0});const w=E(requireClientMetricReportDirection()),R=E(requireClientMetricReportMediaType()),M=E(requireReconnectionHealthPolicy()),x=E(requireSendingAudioFailureConnectionHealthPolicy()),S=E(requireUnusableAudioWarningConnectionHealthPolicy()),T=E(requireVideoEncodingConnectionHealthPolicyName()),_=E(requireMeetingSessionStatus()),D=E(requireMeetingSessionStatusCode()),Y=E(requireVideoCodecCapability()),ee=E(requireSignalingClientEventType()),ie=requireSignalingProtocol(),ne=E(requireAudioLogEvent()),re=requireTypes$1(),oe=E(requireBaseTask());let ae=class extends oe.default{constructor(le,de,me){super(le.logger),this.context=le,this.initialConnectionHealthData=me,this.taskName="MonitorTask",this.prevSignalStrength=1,this.currentAvailableStreamAvgBitrates=null,this.hasSignalingError=!1,this.presenceHandlerCalled=!1,this.isResubscribeCheckPaused=!1,this.pendingMetricsReport=void 0,this.isMeetingConnected=!1,this.videoEncodingHealthPolicies=[],this.checkAndSendWeakSignalEvent=fe=>{const ge=fe<1,he=this.prevSignalStrength<1,ve=ge?he?null:ne.default.RedmicStartLoss:he?ne.default.RedmicEndLoss:null;ve&&this.context.statsCollector.logAudioEvent(ve),this.prevSignalStrength=fe},this.realtimeFatalErrorCallback=fe=>{this.logger.error(`realtime error: ${fe}: ${fe.stack}`),this.context.audioVideoController.handleMeetingSessionStatus(new _.default(D.default.RealtimeApiFailed),fe)},this.realtimeAttendeeIdPresenceHandler=(fe,ge)=>{var he;const ve=this.context.meetingSessionConfiguration.credentials.attendeeId;this.logger.info(`attendeePresenceReceived: ${ve}`),ve===fe&&ge&&!this.presenceHandlerCalled&&(this.presenceHandlerCalled=!0,this.context.attendeePresenceDurationMs=Date.now()-this.context.startAudioVideoTimestamp,(he=this.context.eventController)===null||he===void 0||he.publishEvent("attendeePresenceReceived",{attendeePresenceDurationMs:this.context.attendeePresenceDurationMs}))},this.generateBaseAudioVideoEventAttributes=()=>{const{signalingOpenDurationMs:fe,startTimeMs:ge,iceGatheringDurationMs:he,attendeePresenceDurationMs:ve,meetingStartDurationMs:be}=this.context;return{meetingDurationMs:ge===null?0:Math.round(Date.now()-ge),signalingOpenDurationMs:fe,iceGatheringDurationMs:he,attendeePresenceDurationMs:ve,meetingStartDurationMs:be}},this.generateAudioVideoEventAttributesForReceivingAudioDropped=()=>{const fe=this.generateBaseAudioVideoEventAttributes();return Object.assign(Object.assign({},fe),{maxVideoTileCount:this.context.maxVideoTileCount,poorConnectionCount:this.context.poorConnectionCount})},this.reconnectionHealthPolicy=new M.default(le.logger,Object.assign({},de),this.initialConnectionHealthData.clone()),this.unusableAudioWarningHealthPolicy=new S.default(Object.assign({},de),this.initialConnectionHealthData.clone()),this.sendingAudioFailureHealthPolicy=new x.default(le.logger,Object.assign({},de),this.initialConnectionHealthData.clone());for(const fe of de.videoEncodingHealthPolicies)this.videoEncodingHealthPolicies.push(new fe(Object.assign({},de),this.initialConnectionHealthData.clone()))}removeObserver(){this.context.audioVideoController.removeObserver(this),this.context.realtimeController.realtimeUnsubscribeToFatalError(this.realtimeFatalErrorCallback),this.context.realtimeController.realtimeUnsubscribeToLocalSignalStrengthChange(this.checkAndSendWeakSignalEvent),this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(this.realtimeAttendeeIdPresenceHandler),this.context.signalingClient.removeObserver(this)}run(){return C(this,void 0,void 0,function*(){this.context.removableObservers.push(this),this.context.audioVideoController.addObserver(this),this.context.realtimeController.realtimeSubscribeToFatalError(this.realtimeFatalErrorCallback),this.context.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(this.checkAndSendWeakSignalEvent),this.context.realtimeController.realtimeSubscribeToAttendeeIdPresence(this.realtimeAttendeeIdPresenceHandler),this.context.connectionMonitor.start(),this.context.statsCollector.start(this.context.signalingClient,this.context.videoStreamIndex),this.context.signalingClient.registerObserver(this)})}pauseResubscribeCheck(){this.isResubscribeCheckPaused=!0}resumeResubscribeCheck(){this.isResubscribeCheckPaused&&(this.isResubscribeCheckPaused=!1,this.pendingMetricsReport&&(this.context.logger.info("Resuming resubscribe check with pending metrics report"),this.checkResubscribe(this.pendingMetricsReport)&&this.context.audioVideoController.update({needsRenegotiation:!1})))}videoTileDidUpdate(le){this.context.maxVideoTileCount=Math.max(this.context.maxVideoTileCount,this.context.videoTileController.getAllVideoTiles().length)}checkResubscribe(le){if(this.isResubscribeCheckPaused){this.context.logger.info("Resubscribe check is paused, setting incoming client metric report as pending"),this.pendingMetricsReport=le;return}else this.pendingMetricsReport=void 0;const de=le.getObservableMetrics(),me=de.availableOutgoingBitrate,fe=de.nackCountReceivedPerSecond;let ge=!1;this.context.videoDownlinkBandwidthPolicy.updateMetrics(le);const he=this.context.videoDownlinkBandwidthPolicy.wantsResubscribe();if(ge=ge||he,he){const ve=this.context.videoDownlinkBandwidthPolicy.chooseSubscriptions();this.context.videosToReceive=ve.truncate(this.context.videoSubscriptionLimit),ve.size()>this.context.videosToReceive.size()&&this.logger.warn(`Video receive limit exceeded. Limiting the videos to ${this.context.videosToReceive.size()}. Please consider using AllHighestVideoBandwidthPolicy or VideoPriorityBasedPolicy along with chooseRemoteVideoSources api to select the video sources to be displayed.`),this.logger.info(`trigger resubscribe for down=${he}; videosToReceive=[${this.context.videosToReceive.array()}]`)}if(this.context.videoTileController.hasStartedLocalVideoTile()){this.context.videoUplinkBandwidthPolicy.updateConnectionMetric({uplinkKbps:me/1e3,nackCountPerSecond:fe});const ve=this.context.videoUplinkBandwidthPolicy.wantsResubscribe();ge=ge||ve,ve&&(this.logger.info(`trigger resubscribe for up=${ve}; videosToReceive=[${this.context.videosToReceive.array()}]`),this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters())}return ge}metricsDidReceive(le){if(this.checkResubscribe(le)&&this.context.audioVideoController.update({needsRenegotiation:!1}),!this.currentAvailableStreamAvgBitrates)return;const de=le.streamMetricReports,me=new Map;for(const fe in de)de[fe].mediaType===R.default.VIDEO&&de[fe].direction===w.default.DOWNSTREAM&&me.set(de[fe].streamId,de[fe])}connectionHealthDidChange(le){le.consecutiveMissedPongs===0&&this.context.reconnectController&&this.context.reconnectController.setLastActiveTimestampMs(Date.now()),this.applyHealthPolicy(this.reconnectionHealthPolicy,le,()=>{this.context.audioVideoController.handleMeetingSessionStatus(new _.default(D.default.ConnectionHealthReconnect),null)}),this.applyHealthPolicy(this.unusableAudioWarningHealthPolicy,le,()=>{var de;this.context.poorConnectionCount+=1;const me=this.generateAudioVideoEventAttributesForReceivingAudioDropped();(de=this.context.eventController)===null||de===void 0||de.publishEvent("receivingAudioDropped",me),this.context.videoTileController.haveVideoTilesWithStreams()?this.context.audioVideoController.forEachObserver(fe=>{re.Maybe.of(fe.connectionDidSuggestStopVideo).map(ge=>ge.bind(fe)())}):this.context.audioVideoController.forEachObserver(fe=>{re.Maybe.of(fe.connectionDidBecomePoor).map(ge=>ge.bind(fe)())})},()=>{this.context.audioVideoController.forEachObserver(de=>{re.Maybe.of(de.connectionDidBecomeGood).map(me=>me.bind(de)())})});for(const de of this.videoEncodingHealthPolicies)this.applyHealthPolicy(de,le,()=>{switch(this.degradeVideoCodec(de.name),de.name){case T.default.VideoEncodingCpuHealth:this.context.statsCollector.videoCodecDegradationHighEncodeCpuDidReceive();break;case T.default.VideoEncodingFramerateHealth:this.context.statsCollector.videoCodecDegradationEncodeFailureDidReceive();break}});this.isMeetingConnected&&this.applyHealthPolicy(this.sendingAudioFailureHealthPolicy,le,()=>{var de;const me=this.generateBaseAudioVideoEventAttributes();(de=this.context.eventController)===null||de===void 0||de.publishEvent("sendingAudioFailed",me)},()=>{var de;const me=this.generateBaseAudioVideoEventAttributes();(de=this.context.eventController)===null||de===void 0||de.publishEvent("sendingAudioRecovered",me)})}audioVideoDidStart(){this.isMeetingConnected=!0}audioVideoDidStartConnecting(le){this.isMeetingConnected=!1}audioVideoDidStop(le){this.isMeetingConnected=!1}applyHealthPolicy(le,de,me,fe){le.update(de);const ge=le.healthIfChanged();ge!==null&&(this.logger.info(`${le.name} value is now ${ge}`),ge<=le.minimumHealth()?re.Maybe.of(me).map(he=>he.bind(this)()):re.Maybe.of(fe).map(he=>he.bind(this)()))}handleBitrateFrame(le){this.currentAvailableStreamAvgBitrates=le,le.serverAvailableOutgoingBitrate>0&&(this.logger.info(`Received server side estimation of available incoming bitrate ${le.serverAvailableOutgoingBitrate}kbps`),this.context.statsCollector.overrideObservableMetric("availableIncomingBitrate",le.serverAvailableOutgoingBitrate*1e3))}handleSignalingClientEvent(le){var de;if(le.type===ee.default.WebSocketClosed&&(le.closeCode===4410||le.closeCode>=4500&&le.closeCode<4600)||le.type===ee.default.WebSocketError||le.type===ee.default.WebSocketFailed){if(!this.hasSignalingError){const me=this.generateAudioVideoEventAttributesForReceivingAudioDropped();(de=this.context.eventController)===null||de===void 0||de.publishEvent("signalingDropped",me),this.hasSignalingError=!0}}else le.type===ee.default.WebSocketOpen&&(this.hasSignalingError=!1);if(le.type===ee.default.ReceivedSignalFrame){if(le.message.type===ie.SdkSignalFrame.Type.NOTIFICATION){switch(le.message.notification.level){case ie.SdkNotificationFrame.NotificationLevel.INFO:this.logger.info(`Received notification from server: ${le.message.notification.message}`);break;case ie.SdkNotificationFrame.NotificationLevel.WARNING:this.logger.warn(`Received warning from server: ${le.message.notification.message}`);break;case ie.SdkNotificationFrame.NotificationLevel.ERROR:this.logger.error(`Received error from server: ${le.message.notification.message}`);break;default:this.logger.error(`Received notification from server with unknown level ${le.message.notification.level}: ${le.message.notification.message}`);break}return}if(le.message.bitrates){const fe=le.message.bitrates;this.context.videoStreamIndex.integrateBitratesFrame(fe),this.context.videoDownlinkBandwidthPolicy.updateIndex(this.context.videoStreamIndex),this.handleBitrateFrame(le.message.bitrates)}const me=_.default.fromSignalFrame(le.message);le.message.type!==ie.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN_ACK&&me.statusCode()!==D.default.OK&&this.context.audioVideoController.handleMeetingSessionStatus(me,null)}}degradeVideoCodec(le){if(this.context.meetingSupportedVideoSendCodecPreferences!==void 0&&this.context.meetingSupportedVideoSendCodecPreferences.length>1&&!(this.context.meetingSupportedVideoSendCodecPreferences[0].equals(Y.default.h264ConstrainedBaselineProfile())||this.context.meetingSupportedVideoSendCodecPreferences[0].equals(Y.default.vp8()))){const de=[];for(const me of this.context.videoSendCodecPreferences)me.equals(this.context.meetingSupportedVideoSendCodecPreferences[0])||de.push(me);de.length>0?(this.context.logger.info(`Downgrading codec from ${this.context.meetingSupportedVideoSendCodecPreferences[0].codecName} to ${de[0].codecName} due to ${le}`),this.context.degradedVideoSendCodecs.push(this.context.meetingSupportedVideoSendCodecPreferences[0]),this.context.meetingSupportedVideoSendCodecPreferences=de,this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs&&this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs(this.context.meetingSupportedVideoSendCodecPreferences,this.context.videoSendCodecPreferences),this.context.audioVideoController.update({needsRenegotiation:!0})):this.context.logger.warn(`Degrading video codec failed since there is no alternative codec to select. Currently degraded codecs: ${this.context.degradedVideoSendCodecs.map(me=>me.codecName).join(",")}`)}}};return MonitorTask.default=ae,MonitorTask}var OpenSignalingConnectionTask={},SignalingClientConnectionRequest={},hasRequiredSignalingClientConnectionRequest;function requireSignalingClientConnectionRequest(){if(hasRequiredSignalingClientConnectionRequest)return SignalingClientConnectionRequest;hasRequiredSignalingClientConnectionRequest=1,Object.defineProperty(SignalingClientConnectionRequest,"__esModule",{value:!0});let C=class{constructor(E,w){this.signalingURL=E,this.joinToken=w}url(){return this.signalingURL+"?X-Chime-Control-Protocol-Version=3&X-Amzn-Chime-Send-Close-On-Error=1"}protocols(){return["_aws_wt_session",this.joinToken]}};return SignalingClientConnectionRequest.default=C,SignalingClientConnectionRequest}var hasRequiredOpenSignalingConnectionTask;function requireOpenSignalingConnectionTask(){if(hasRequiredOpenSignalingConnectionTask)return OpenSignalingConnectionTask;hasRequiredOpenSignalingConnectionTask=1;var C=OpenSignalingConnectionTask&&OpenSignalingConnectionTask.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=OpenSignalingConnectionTask&&OpenSignalingConnectionTask.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(OpenSignalingConnectionTask,"__esModule",{value:!0});const w=E(requireSignalingClientConnectionRequest()),R=E(requireSignalingClientEventType()),M=E(requireBaseTask());let x=class extends M.default{constructor(S){super(S.logger),this.context=S,this.taskName="OpenSignalingConnectionTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return C(this,void 0,void 0,function*(){const S=this.context.meetingSessionConfiguration;this.context.signalingClient.openConnection(new w.default(S.urls.signalingURL,S.credentials.joinToken));const T=Date.now();try{yield new Promise((_,D)=>{class Y{constructor(ne){this.signalingClient=ne}cancel(){this.signalingClient.removeObserver(this),D(new Error("OpenSignalingConnectionTask got canceled while waiting to open signaling connection"))}handleSignalingClientEvent(ne){switch(ne.type){case R.default.WebSocketOpen:this.signalingClient.removeObserver(this),_();break;case R.default.WebSocketFailed:this.signalingClient.removeObserver(this),D(new Error("WebSocket connection failed"));break}}}const ee=new Y(this.context.signalingClient);this.context.signalingClient.registerObserver(ee),this.taskCanceler=ee})}catch(_){throw _}finally{this.context.signalingOpenDurationMs=Math.round(Date.now()-T),this.logger.info(`Opening signaling connection took ${this.context.signalingOpenDurationMs} ms`)}})}};return OpenSignalingConnectionTask.default=x,OpenSignalingConnectionTask}var ParallelGroupTask={},hasRequiredParallelGroupTask;function requireParallelGroupTask(){if(hasRequiredParallelGroupTask)return ParallelGroupTask;hasRequiredParallelGroupTask=1;var C=ParallelGroupTask&&ParallelGroupTask.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})},E=ParallelGroupTask&&ParallelGroupTask.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(ParallelGroupTask,"__esModule",{value:!0});const w=E(requireBaseTask());let R=class extends w.default{constructor(M,x,S){super(M),this.taskName=x,this.tasksToRunParallel=S;for(const T of S)T.setParent(this)}cancel(){for(const M of this.tasksToRunParallel)this.logger.info(`canceling parallel group task ${this.name()} subtask ${M.name()}`),M.cancel()}run(){return C(this,void 0,void 0,function*(){const M=[];for(const S of this.tasksToRunParallel)this.logger.info(`parallel group task ${this.name()} running subtask ${S.name()}`),M.push(S.run());const x=[];for(let S=0;S<M.length;S++){try{yield M[S]}catch(T){x.push(`task ${this.tasksToRunParallel[S].name()} failed: ${T.message}`)}this.logger.info(`parallel group task ${this.name()} completed subtask ${this.tasksToRunParallel[S].name()}`)}if(x.length>0){const S=x.join(", ");this.logAndThrow(`parallel group task ${this.name()} failed for tasks: ${S}`)}this.logger.info(`parallel group task ${this.name()} completed`)})}};return ParallelGroupTask.default=R,ParallelGroupTask}var PromoteToPrimaryMeetingTask={},hasRequiredPromoteToPrimaryMeetingTask;function requirePromoteToPrimaryMeetingTask(){if(hasRequiredPromoteToPrimaryMeetingTask)return PromoteToPrimaryMeetingTask;hasRequiredPromoteToPrimaryMeetingTask=1;var C=PromoteToPrimaryMeetingTask&&PromoteToPrimaryMeetingTask.__awaiter||function(T,_,D,Y){function ee(ie){return ie instanceof D?ie:new D(function(ne){ne(ie)})}return new(D||(D=Promise))(function(ie,ne){function re(le){try{ae(Y.next(le))}catch(de){ne(de)}}function oe(le){try{ae(Y.throw(le))}catch(de){ne(de)}}function ae(le){le.done?ie(le.value):ee(le.value).then(re,oe)}ae((Y=Y.apply(T,_||[])).next())})},E=PromoteToPrimaryMeetingTask&&PromoteToPrimaryMeetingTask.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(PromoteToPrimaryMeetingTask,"__esModule",{value:!0});const w=requireBuild(),R=E(requireSignalingClientEventType()),M=requireSignalingProtocol(),x=E(requireBaseTask());let S=class extends x.default{constructor(T,_,D){super(T.logger),this.context=T,this.credentials=_,this.completionCallback=D,this.taskName="PromoteToPrimaryMeetingTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return C(this,void 0,void 0,function*(){this.context.signalingClient.ready()?(this.context.signalingClient.promoteToPrimaryMeeting(this.credentials),this.context.logger.info("Sent request to join primary meeting"),yield this.receivePrimaryMeetingJoinAck()):this.completionCallback(new w.MeetingSessionStatus(w.MeetingSessionStatusCode.SignalingRequestFailed))})}receivePrimaryMeetingJoinAck(){return new Promise((T,_)=>{class D{constructor(ie,ne,re){this.signalingClient=ie,this.completionCallback=ne,this.logger=re}cancel(){this.signalingClient.removeObserver(this),this.completionCallback(new w.MeetingSessionStatus(w.MeetingSessionStatusCode.SignalingRequestFailed)),T()}handleSignalingClientEvent(ie){ie.isConnectionTerminated()&&(this.signalingClient.removeObserver(this),this.logger.info("PromoteToPrimaryMeetingTask connection terminated"),this.completionCallback(new w.MeetingSessionStatus(w.MeetingSessionStatusCode.SignalingRequestFailed)),T()),ie.type===R.default.ReceivedSignalFrame&&ie.message.type===M.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN_ACK&&(this.signalingClient.removeObserver(this),this.logger.info("Got a primary meeting join ACK"),this.completionCallback(w.MeetingSessionStatus.fromSignalFrame(ie.message)),T())}}const Y=new D(this.context.signalingClient,this.completionCallback,this.context.logger);this.taskCanceler=Y,this.context.signalingClient.registerObserver(Y)})}};return PromoteToPrimaryMeetingTask.default=S,PromoteToPrimaryMeetingTask}var ReceiveAudioInputTask={},hasRequiredReceiveAudioInputTask;function requireReceiveAudioInputTask(){if(hasRequiredReceiveAudioInputTask)return ReceiveAudioInputTask;hasRequiredReceiveAudioInputTask=1;var C=ReceiveAudioInputTask&&ReceiveAudioInputTask.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})},E=ReceiveAudioInputTask&&ReceiveAudioInputTask.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(ReceiveAudioInputTask,"__esModule",{value:!0});const w=E(requireBaseTask());let R=class extends w.default{constructor(M){super(M.logger),this.context=M,this.taskName="ReceiveAudioInputTask"}run(){var M,x;return C(this,void 0,void 0,function*(){if(!(!((x=(M=this.context.meetingSessionConfiguration)===null||M===void 0?void 0:M.urls)===null||x===void 0)&&x.audioHostURL)){this.context.logger.info("No audio connection: not acquiring audio input");return}if(this.context.activeAudioInput){this.context.logger.info("an active audio input exists");return}let S;try{S=yield this.context.mediaStreamBroker.acquireAudioInputStream()}catch{this.context.logger.warn("could not acquire audio input from current device")}S?this.context.activeAudioInput=S:this.context.logger.warn("an audio input is not available")})}};return ReceiveAudioInputTask.default=R,ReceiveAudioInputTask}var ReceiveRemoteVideoPauseResumeTask={},hasRequiredReceiveRemoteVideoPauseResumeTask;function requireReceiveRemoteVideoPauseResumeTask(){if(hasRequiredReceiveRemoteVideoPauseResumeTask)return ReceiveRemoteVideoPauseResumeTask;hasRequiredReceiveRemoteVideoPauseResumeTask=1;var C=ReceiveRemoteVideoPauseResumeTask&&ReceiveRemoteVideoPauseResumeTask.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=ReceiveRemoteVideoPauseResumeTask&&ReceiveRemoteVideoPauseResumeTask.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(ReceiveRemoteVideoPauseResumeTask,"__esModule",{value:!0});const w=E(requireSignalingClientEventType()),R=requireSignalingProtocol(),M=E(requireBaseTask());class x extends M.default{constructor(T){super(T.logger),this.context=T,this.taskName="ReceiveRemoteVideoPauseResume",this.serverPausedVideoTileIds=new Set}removeObserver(){this.context.signalingClient.removeObserver(this)}run(){return C(this,void 0,void 0,function*(){this.context.signalingClient.registerObserver(this),this.context.removableObservers.push(this)})}updateSubscribedGroupdIds(T){const _=new Set;for(const D of T){const Y=this.context.videoStreamIndex.attendeeIdForGroupId(D);if(Y.length===0){this.logger.warn(`Could not find attendee ID for newly subscribed group ID ${D}`);continue}let ee=this.context.videoTileController.getVideoTileForAttendeeId(Y);ee===void 0&&(this.logger.info(`No existing video tile for attendee ID ${Y} with new group ID ${D}. Creating new one.`),ee=this.context.videoTileController.addVideoTile(),ee.bindVideoStream(Y,!1,null,0,0,0,null)),_.add(ee.id())}this.serverPausedVideoTileIds.forEach(D=>{_.has(D)||this.serverPausedVideoTileIds.delete(D)})}handleSignalingClientEvent(T){if(T.type!==w.default.ReceivedSignalFrame||T.message.type!==R.SdkSignalFrame.Type.PAUSE&&T.message.type!==R.SdkSignalFrame.Type.RESUME)return;const _=T.message.pause,D=T.message.type;if(this.logger.info(`Received new ${D===R.SdkSignalFrame.Type.PAUSE?"pause":"resume"} frame: ${JSON.stringify(_)}`),!_||this.context.videoTileController.getVideoTileForAttendeeId===void 0||this.context.videoDownlinkBandwidthPolicy.forEachObserver===void 0||this.context.videoStreamIndex.attendeeIdForGroupId===void 0)return;const Y=_.groupIds.map(ee=>{const ie=this.context.videoStreamIndex.attendeeIdForGroupId(ee);if(ie.length===0){this.logger.warn(`Could not find attendee ID for paused group ID ${ee}`);return}return this.context.videoTileController.getVideoTileForAttendeeId(ie)});for(const ee of Y)ee!==void 0&&(D===R.SdkSignalFrame.Type.PAUSE?ee.state().paused||(this.serverPausedVideoTileIds.add(ee.id()),this.context.videoDownlinkBandwidthPolicy.forEachObserver(ie=>{ie.tileWillBePausedByDownlinkPolicy(ee.id())}),ee.pause()):ee.state().paused&&this.serverPausedVideoTileIds.has(ee.id())&&(this.serverPausedVideoTileIds.delete(ee.id()),this.context.videoDownlinkBandwidthPolicy.forEachObserver(ie=>{ie.tileWillBeUnpausedByDownlinkPolicy(ee.id())}),ee.unpause()))}}return ReceiveRemoteVideoPauseResumeTask.default=x,ReceiveRemoteVideoPauseResumeTask}var ReceiveVideoInputTask={},hasRequiredReceiveVideoInputTask;function requireReceiveVideoInputTask(){if(hasRequiredReceiveVideoInputTask)return ReceiveVideoInputTask;hasRequiredReceiveVideoInputTask=1;var C=ReceiveVideoInputTask&&ReceiveVideoInputTask.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=ReceiveVideoInputTask&&ReceiveVideoInputTask.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(ReceiveVideoInputTask,"__esModule",{value:!0});const w=E(requireDefaultModality()),R=requireSignalingProtocol(),M=E(requireBaseTask());let x=class extends M.default{constructor(S){super(S.logger),this.context=S,this.taskName="ReceiveVideoInputTask"}checkAndApplyVideoConstraint(S,T,_,D,Y){return C(this,void 0,void 0,function*(){const ee=T.getSettings();let ie;if(S?ie=this.context.meetingSessionConfiguration.meetingFeatures.contentMaxResolution:ie=this.context.meetingSessionConfiguration.meetingFeatures.videoMaxResolution,_>ie.videoWidth||D>ie.videoHeight||Y>ie.videoFrameRate){const ne={width:{ideal:ie.videoWidth},height:{ideal:ie.videoHeight},frameRate:{ideal:ie.videoFrameRate}};this.context.logger.warn(`Video track (content = ${S}) will be constrained to: ${JSON.stringify(ne)} to remain below configured video quality settings, trackSettings: ${JSON.stringify(ee)}`);try{yield T.applyConstraints(ne)}catch{this.context.logger.info(`Could not apply constraint for video track (content = ${S})`)}}})}run(){return C(this,void 0,void 0,function*(){const S=this.context.videoDuplexMode===R.SdkStreamServiceType.RX||this.context.videoDuplexMode===R.SdkStreamServiceType.DUPLEX;if(this.context.videoTileController.hasStartedLocalVideoTile()?this.context.videoDuplexMode=S?R.SdkStreamServiceType.DUPLEX:R.SdkStreamServiceType.TX:this.context.videoDuplexMode=S?R.SdkStreamServiceType.RX:0,this.context.videoCaptureAndEncodeParameter=this.context.videoUplinkBandwidthPolicy.chooseCaptureAndEncodeParameters(),!this.context.videoTileController.hasStartedLocalVideoTile()){this.context.logger.info("has not started local video tile"),this.context.activeVideoInput&&(this.context.activeVideoInput=void 0,this.context.videoStreamIndex.integrateUplinkPolicyDecision([]));return}const T=this.context.videoTileController.getLocalVideoTile();let _;try{_=yield this.context.mediaStreamBroker.acquireVideoInputStream()}catch{this.context.logger.warn("could not acquire video input from current device"),this.context.videoTileController.stopLocalVideoTile()}if(this.context.enableSimulcast){const D=this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters();this.context.videoStreamIndex.integrateUplinkPolicyDecision(Array.from(D.values()))}if(this.context.activeVideoInput=_,_){const D=_.getVideoTracks();if(!D||D.length===0)return;const Y=this.context.meetingSessionConfiguration.credentials.attendeeId,ee=new w.default(Y).hasModality(w.default.MODALITY_CONTENT),ie=D[0].getSettings();this.checkAndApplyVideoConstraint(ee,D[0],ie.width,ie.height,ie.frameRate);const ne=this.context.audioVideoController.configuration.credentials.externalUserId;T.bindVideoStream(Y,!0,_,ie.width,ie.height,null,ne);for(const re of D)this.logger.info(`Using video device label=${re.label} id=${re.id}`),this.context.videoDeviceInformation.current_camera_name=re.label,this.context.videoDeviceInformation.current_camera_id=re.id}})}};return ReceiveVideoInputTask.default=x,ReceiveVideoInputTask}var ReceiveVideoStreamIndexTask={},hasRequiredReceiveVideoStreamIndexTask;function requireReceiveVideoStreamIndexTask(){if(hasRequiredReceiveVideoStreamIndexTask)return ReceiveVideoStreamIndexTask;hasRequiredReceiveVideoStreamIndexTask=1;var C=ReceiveVideoStreamIndexTask&&ReceiveVideoStreamIndexTask.__awaiter||function(Y,ee,ie,ne){function re(oe){return oe instanceof ie?oe:new ie(function(ae){ae(oe)})}return new(ie||(ie=Promise))(function(oe,ae){function le(fe){try{me(ne.next(fe))}catch(ge){ae(ge)}}function de(fe){try{me(ne.throw(fe))}catch(ge){ae(ge)}}function me(fe){fe.done?oe(fe.value):re(fe.value).then(le,de)}me((ne=ne.apply(Y,ee||[])).next())})},E=ReceiveVideoStreamIndexTask&&ReceiveVideoStreamIndexTask.__importDefault||function(Y){return Y&&Y.__esModule?Y:{default:Y}};Object.defineProperty(ReceiveVideoStreamIndexTask,"__esModule",{value:!0});const w=E(requireMeetingSessionVideoAvailability()),R=E(requireDefaultModality()),M=E(requireVideoCodecCapability()),x=E(requireSignalingClientEventType()),S=requireSignalingProtocol(),T=requireTypes$1(),_=E(requireBaseTask());let D=class extends _.default{constructor(Y){super(Y.logger),this.context=Y,this.taskName="ReceiveVideoStreamIndexTask",this.isIngestionPaused=!1,this.pendingIndex=null}removeObserver(){this.context.signalingClient.removeObserver(this)}run(){return C(this,void 0,void 0,function*(){this.handleIndexFrame(this.context.indexFrame),this.context.signalingClient.registerObserver(this),this.context.removableObservers.push(this)})}handleSignalingClientEvent(Y){if(Y.type!==x.default.ReceivedSignalFrame||Y.message.type!==S.SdkSignalFrame.Type.INDEX)return;const ee=Y.message.index;this.context.logger.info(`received new index ${JSON.stringify(ee)}`),this.handleIndexFrame(ee)}pauseIngestion(){this.isIngestionPaused=!0}resumeIngestion(){this.isIngestionPaused&&(this.isIngestionPaused=!1,this.pendingIndex&&(this.context.logger.info("Resuming index ingestion with pending index"),this.handleIndexFrame(this.pendingIndex)))}handleIndexFrame(Y){if(!Y)return;if(this.isIngestionPaused){this.context.logger.info("Index ingestion is paused, setting most recent index as pending"),this.pendingIndex=Y;return}else this.pendingIndex=null;const ee=this.context.audioVideoController.configuration.credentials.attendeeId;Y.sources=Y.sources.filter(le=>{const de=new R.default(le.attendeeId);return!(de.base()===ee&&de.hasModality(R.default.MODALITY_CONTENT))});const{videoStreamIndex:ie,videoDownlinkBandwidthPolicy:ne,videoUplinkBandwidthPolicy:re}=this.context,oe=ie.allVideoSendingSourcesExcludingSelf(ee);ie.integrateIndexFrame(Y),ne.updateIndex(ie),re.updateIndex(ie),this.resubscribe(ne,re),this.updateVideoAvailability(Y),this.handleIndexVideosPausedAtSource(),Y.supportedReceiveCodecIntersection.length>0&&this.handleSupportedVideoReceiveCodecIntersection(Y);const ae=ie.allVideoSendingSourcesExcludingSelf(ee);this.areVideoSourcesEqual(oe,ae)||this.context.audioVideoController.forEachObserver(le=>{T.Maybe.of(le.remoteVideoSourcesDidChange).map(de=>de.bind(le)(ae))})}areVideoSourcesEqual(Y,ee){if(Y.length!==ee.length)return!1;const ie=(oe,ae)=>oe.attendee.attendeeId.localeCompare(ae.attendee.attendeeId),ne=[...Y].sort(ie),re=[...ee].sort(ie);for(let oe=0;oe<ne.length;oe++)if(ne[oe].attendee.attendeeId!==re[oe].attendee.attendeeId)return!1;return!0}resubscribe(Y,ee){const ie=Y.wantsResubscribe(),ne=(this.context.videoDuplexMode===S.SdkStreamServiceType.TX||this.context.videoDuplexMode===S.SdkStreamServiceType.DUPLEX)&&ee.wantsResubscribe(),re=ie||ne;if(this.logger.info(`should resubscribe: ${re} (downlink: ${ie} uplink: ${ne})`),!re)return;const oe=Y.chooseSubscriptions();this.context.videosToReceive=oe.truncate(this.context.videoSubscriptionLimit),oe.size()>this.context.videosToReceive.size()&&this.logger.warn(`Video receive limit exceeded. Limiting the videos to ${this.context.videosToReceive.size()}. Please consider using AllHighestVideoBandwidthPolicy or VideoPriorityBasedPolicy along with chooseRemoteVideoSources api to select the video sources to be displayed.`),this.context.videoCaptureAndEncodeParameter=ee.chooseCaptureAndEncodeParameters(),this.logger.info(`trigger resubscribe for up=${ne} down=${ie}; videosToReceive=[${this.context.videosToReceive.array()}] captureParams=${JSON.stringify(this.context.videoCaptureAndEncodeParameter)}`),this.context.audioVideoController.update({needsRenegotiation:!1})}updateVideoAvailability(Y){if(!this.context.videosToReceive){this.logger.error("videosToReceive must be set in the meeting context.");return}const ee=new w.default;ee.remoteVideoAvailable=!this.context.videosToReceive.empty(),ee.canStartLocalVideo=!Y.atCapacity,(!this.context.lastKnownVideoAvailability||!this.context.lastKnownVideoAvailability.equal(ee))&&(this.context.lastKnownVideoAvailability=ee.clone(),this.context.audioVideoController.forEachObserver(ie=>{T.Maybe.of(ie.videoAvailabilityDidChange).map(ne=>ne.bind(ie)(ee.clone()))}))}handleSupportedVideoReceiveCodecIntersection(Y){if(this.context.videoSendCodecPreferences===void 0)return;const ee=[];let ie=!1;for(const ne of this.context.videoSendCodecPreferences){if(this.context.degradedVideoSendCodecs.some(re=>ne.equals(re))){this.logger.info(`Skipping ${ne.codecName} since the codec has been identfied as degraded`);continue}for(const re of Y.supportedReceiveCodecIntersection)if(ne.equals(M.default.fromSignaled(re))){ee.push(ne);break}}if(ee.length>0){const ne=ee.find(re=>this.context.prioritizedSendVideoCodecCapabilities.some(oe=>re.equals(oe)));this.context.currentVideoSendCodec!==void 0&&(ne===void 0||!this.context.currentVideoSendCodec.equals(ne))&&(ie=!0),this.context.meetingSupportedVideoSendCodecPreferences=ee}else this.logger.warn("Interesection of meeting receive codec support and send codec preferences has no overlap, falling back to just values provided in `setVideoCodecSendPreferences`"),this.context.meetingSupportedVideoSendCodecPreferences=void 0;this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs&&this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs(this.context.meetingSupportedVideoSendCodecPreferences,this.context.videoSendCodecPreferences),ie&&this.context.audioVideoController.update({needsRenegotiation:!0})}handleIndexVideosPausedAtSource(){const Y=this.context.videoStreamIndex.streamsPausedAtSource();for(const ee of this.context.videoTileController.getAllVideoTiles()){const ie=ee.state();Y.contain(ie.streamId)?ee.markPoorConnection()&&this.logger.info(`marks the tile ${ie.tileId} as having a poor connection`):ee.unmarkPoorConnection()&&this.logger.info(`unmarks the tile ${ie.tileId} as having a poor connection`)}}};return ReceiveVideoStreamIndexTask.default=D,ReceiveVideoStreamIndexTask}var SendAndReceiveDataMessagesTask={},hasRequiredSendAndReceiveDataMessagesTask;function requireSendAndReceiveDataMessagesTask(){if(hasRequiredSendAndReceiveDataMessagesTask)return SendAndReceiveDataMessagesTask;hasRequiredSendAndReceiveDataMessagesTask=1;var C=SendAndReceiveDataMessagesTask&&SendAndReceiveDataMessagesTask.__awaiter||function(T,_,D,Y){function ee(ie){return ie instanceof D?ie:new D(function(ne){ne(ie)})}return new(D||(D=Promise))(function(ie,ne){function re(le){try{ae(Y.next(le))}catch(de){ne(de)}}function oe(le){try{ae(Y.throw(le))}catch(de){ne(de)}}function ae(le){le.done?ie(le.value):ee(le.value).then(re,oe)}ae((Y=Y.apply(T,_||[])).next())})},E=SendAndReceiveDataMessagesTask&&SendAndReceiveDataMessagesTask.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(SendAndReceiveDataMessagesTask,"__esModule",{value:!0});const w=E(requireDataMessage()),R=E(requireSignalingClientEventType()),M=requireSignalingProtocol(),x=E(requireBaseTask());let S=class Gd extends x.default{constructor(_){super(_.logger),this.context=_,this.taskName="SendAndReceiveDataMessagesTask",this.sendDataMessageHandler=(D,Y,ee)=>{if(this.context.signalingClient.ready()){let ie;Y instanceof Uint8Array?ie=Y:typeof Y=="string"?ie=new TextEncoder().encode(Y):ie=new TextEncoder().encode(JSON.stringify(Y)),this.validateDataMessage(D,ie,ee);const ne=M.SdkDataMessagePayload.create();ne.topic=D,ne.lifetimeMs=ee,ne.data=ie;const re=M.SdkDataMessageFrame.create();re.messages=[ne],this.context.signalingClient.sendDataMessage(re)}else this.context.logger.error("Signaling client is not ready")}}run(){return C(this,void 0,void 0,function*(){this.context.removableObservers.push(this),this.context.signalingClient.registerObserver(this),this.context.realtimeController.realtimeSubscribeToSendDataMessage(this.sendDataMessageHandler)})}removeObserver(){this.context.realtimeController.realtimeUnsubscribeFromSendDataMessage(this.sendDataMessageHandler),this.context.signalingClient.removeObserver(this)}handleSignalingClientEvent(_){if(_.type===R.default.ReceivedSignalFrame&&_.message.type===M.SdkSignalFrame.Type.DATA_MESSAGE)for(const D of _.message.dataMessage.messages){const Y=new w.default(D.ingestTimeNs/1e6,D.topic,D.data,D.senderAttendeeId,D.senderExternalUserId,D.ingestTimeNs===0);this.context.realtimeController.realtimeReceiveDataMessage(Y)}}validateDataMessage(_,D,Y){if(!Gd.TOPIC_REGEX.test(_))throw new Error("Invalid topic");if(D.length>Gd.DATA_SIZE)throw new Error("Data size has to be less than 2048 bytes");if(Y&&Y<0)throw new Error("The life time of the message has to be non negative")}};return SendAndReceiveDataMessagesTask.default=S,S.TOPIC_REGEX=new RegExp(/^[a-zA-Z0-9_-]{1,36}$/),S.DATA_SIZE=2048,SendAndReceiveDataMessagesTask}var SerialGroupTask={},hasRequiredSerialGroupTask;function requireSerialGroupTask(){if(hasRequiredSerialGroupTask)return SerialGroupTask;hasRequiredSerialGroupTask=1;var C=SerialGroupTask&&SerialGroupTask.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=SerialGroupTask&&SerialGroupTask.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(SerialGroupTask,"__esModule",{value:!0});const w=E(requireBaseTask()),R=E(requireTaskStatus());let M=class extends w.default{constructor(x,S,T){super(x),this.taskName=S,this.tasksToRunSerially=T,this.currentTask=null;for(const _ of T)_.setParent(this)}cancel(){this.currentTask&&(this.logger.info(`canceling serial group task ${this.name()} subtask ${this.currentTask.name()}`),this.currentTask.cancel())}run(){return C(this,void 0,void 0,function*(){for(const x of this.tasksToRunSerially){this.getStatus()===R.default.CANCELED&&this.logAndThrow(`serial group task ${this.name()} was canceled`);try{this.logger.info(`serial group task ${this.name()} running subtask ${x.name()}`),this.currentTask=x,yield x.run(),this.logger.info(`serial group task ${this.name()} completed subtask ${x.name()}`)}catch(S){this.logAndThrow(`serial group task ${this.name()} was canceled due to subtask ${this.currentTask.name()} error: ${S.message}`)}finally{this.currentTask=null}}this.logger.info(`serial group task ${this.name()} completed`)})}};return SerialGroupTask.default=M,SerialGroupTask}var SetLocalDescriptionTask={},hasRequiredSetLocalDescriptionTask;function requireSetLocalDescriptionTask(){if(hasRequiredSetLocalDescriptionTask)return SetLocalDescriptionTask;hasRequiredSetLocalDescriptionTask=1;var C=SetLocalDescriptionTask&&SetLocalDescriptionTask.__awaiter||function(T,_,D,Y){function ee(ie){return ie instanceof D?ie:new D(function(ne){ne(ie)})}return new(D||(D=Promise))(function(ie,ne){function re(le){try{ae(Y.next(le))}catch(de){ne(de)}}function oe(le){try{ae(Y.throw(le))}catch(de){ne(de)}}function ae(le){le.done?ie(le.value):ee(le.value).then(re,oe)}ae((Y=Y.apply(T,_||[])).next())})},E=SetLocalDescriptionTask&&SetLocalDescriptionTask.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(SetLocalDescriptionTask,"__esModule",{value:!0});const w=E(requireDefaultBrowserBehavior()),R=E(requireDefaultModality()),M=E(requireSDP()),x=E(requireBaseTask());let S=class extends x.default{constructor(T){super(T.logger),this.context=T,this.taskName="SetLocalDescriptionTask"}cancel(){if(this.cancelPromise){const T=new Error(`canceling ${this.name()}`);this.cancelPromise(T),delete this.cancelPromise}}run(){return C(this,void 0,void 0,function*(){const T=this.context.peer;let _=this.context.sdpOfferInit.sdp;this.context.browserBehavior.supportsVideoLayersAllocationRtpHeaderExtension()&&(_=new M.default(_).withVideoLayersAllocationRtpHeaderExtension(this.context.previousSdpOffer).sdp),this.context.browserBehavior.supportsDependencyDescriptorRtpHeaderExtension()&&this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension!==void 0&&this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension()&&(_=new M.default(_).withDependencyDescriptorRtpHeaderExtension(this.context.previousSdpOffer).sdp),new w.default().requiresDisablingH264Encoding()&&(_=new M.default(_).removeH264SupportFromSendSection().sdp);const D=this.context.audioVideoController.configuration.credentials.attendeeId;if(new R.default(D).hasModality(R.default.MODALITY_CONTENT)&&this.context.audioVideoController.configuration.enableSVC&&(_=new M.default(_).withStartingVideoSendBitrate(100).sdp),this.context.videoSendCodecPreferences!==void 0&&this.context.videoSendCodecPreferences.length>0&&(_=new M.default(_).withVideoSendCodecPreferences(this.context.meetingSupportedVideoSendCodecPreferences!==void 0?this.context.meetingSupportedVideoSendCodecPreferences:this.context.videoSendCodecPreferences).sdp),this.context.audioProfile&&(_=new M.default(_).withAudioMaxAverageBitrate(this.context.audioProfile.audioBitrateBps).sdp,this.context.audioProfile.isStereo()&&(_=new M.default(_).withStereoAudio().sdp),this.context.audioProfile.hasRedundancyEnabled())){const ee=new M.default(_).getAudioPayloadTypes();this.context.transceiverController&&this.context.transceiverController.setAudioPayloadTypes&&this.context.transceiverController.setAudioPayloadTypes(ee)}this.logger.debug(()=>`local description is >>>${_}<<<`);const Y={type:"offer",sdp:_,toJSON:null};yield new Promise((ee,ie)=>C(this,void 0,void 0,function*(){this.cancelPromise=ne=>{ie(ne)};try{yield T.setLocalDescription(Y),ee()}catch(ne){ie(ne)}finally{delete this.cancelPromise}})),this.context.logger.info("set local description")})}};return SetLocalDescriptionTask.default=S,SetLocalDescriptionTask}var SetRemoteDescriptionTask={},hasRequiredSetRemoteDescriptionTask;function requireSetRemoteDescriptionTask(){if(hasRequiredSetRemoteDescriptionTask)return SetRemoteDescriptionTask;hasRequiredSetRemoteDescriptionTask=1;var C=SetRemoteDescriptionTask&&SetRemoteDescriptionTask.__awaiter||function(T,_,D,Y){function ee(ie){return ie instanceof D?ie:new D(function(ne){ne(ie)})}return new(D||(D=Promise))(function(ie,ne){function re(le){try{ae(Y.next(le))}catch(de){ne(de)}}function oe(le){try{ae(Y.throw(le))}catch(de){ne(de)}}function ae(le){le.done?ie(le.value):ee(le.value).then(re,oe)}ae((Y=Y.apply(T,_||[])).next())})},E=SetRemoteDescriptionTask&&SetRemoteDescriptionTask.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(SetRemoteDescriptionTask,"__esModule",{value:!0});const w=E(requireDefaultModality()),R=E(requireSDP()),M=E(requireVideoCodecCapability()),x=E(requireBaseTask());let S=class extends x.default{constructor(T){super(T.logger),this.context=T,this.taskName="SetRemoteDescriptionTask"}cancel(){this.cancelICEPromise&&this.cancelICEPromise()}run(){var T;return C(this,void 0,void 0,function*(){this.context.peer||this.logAndThrow("session does not have peer connection; bypass set remote description");let _=this.context.sdpAnswer;_=new R.default(_).withoutServerReflexiveCandidates().sdp,this.context.audioProfile&&(_=new R.default(_).withAudioMaxAverageBitrate(this.context.audioProfile.audioBitrateBps).sdp,this.context.audioProfile.isStereo()&&(_=new R.default(_).withStereoAudio().sdp)),this.context.videoSendCodecPreferences!==void 0&&this.context.videoSendCodecPreferences.length>0&&(_=new R.default(_).withVideoSendCodecPreferences(this.context.meetingSupportedVideoSendCodecPreferences!==void 0?this.context.meetingSupportedVideoSendCodecPreferences:this.context.videoSendCodecPreferences).sdp),this.context.prioritizedSendVideoCodecCapabilities=new R.default(_).prioritizedSendVideoCodecCapabilities(),this.context.currentVideoSendCodec=this.context.prioritizedSendVideoCodecCapabilities.length>0?this.context.prioritizedSendVideoCodecCapabilities[0]:void 0;const D=this.context.activeVideoInput;if(D!==void 0){const ee=this.context.audioVideoController.configuration.credentials.attendeeId,ie=new w.default(ee).hasModality(w.default.MODALITY_CONTENT),ne=D.getVideoTracks()[0];ie&&(((T=this.context.currentVideoSendCodec)===null||T===void 0?void 0:T.codecName)===M.default.av1Main().codecName?(ne.contentHint="text",this.logger.info(`Setting content hint to text for AV1, attendee: ${ee}`)):this.context.audioVideoController.configuration.enableSVC&&(ne.contentHint="motion",this.logger.info(`Setting content hint to motion to enable SVC, attendee: ${ee}`)))}this.logger.info(`processed remote description is >>>${_}<<<`);const Y={type:"answer",sdp:_,toJSON:null};try{yield this.createICEConnectionCompletedPromise(Y)}catch(ee){throw ee}})}createICEConnectionCompletedPromise(T){return new Promise((_,D)=>C(this,void 0,void 0,function*(){const Y=()=>{(this.context.peer.iceConnectionState==="connected"||this.context.peer.iceConnectionState==="completed")&&(this.context.peer.removeEventListener("iceconnectionstatechange",Y),_())};this.cancelICEPromise=()=>{this.context.peer&&this.context.peer.removeEventListener("iceconnectionstatechange",Y),D(new Error(`${this.name()} got canceled while waiting for the ICE connection state`))},this.context.peer.addEventListener("iceconnectionstatechange",Y);try{yield this.context.peer.setRemoteDescription(T),this.logger.info("set remote description, waiting for ICE connection"),Y()}catch(ee){D(ee)}}))}};return SetRemoteDescriptionTask.default=S,SetRemoteDescriptionTask}var SubscribeAndReceiveSubscribeAckTask={},ZLIBTextCompressor={},pako={},deflate$1={},deflate={},trees={},hasRequiredTrees;function requireTrees(){if(hasRequiredTrees)return trees;hasRequiredTrees=1;const C=4,E=0,w=1,R=2;function M(Ee){let ct=Ee.length;for(;--ct>=0;)Ee[ct]=0}const x=0,S=1,T=2,_=3,D=258,Y=29,ee=256,ie=ee+1+Y,ne=30,re=19,oe=2*ie+1,ae=15,le=16,de=7,me=256,fe=16,ge=17,he=18,ve=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),be=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Se=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Re=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ae=512,Me=new Array((ie+2)*2);M(Me);const Be=new Array(ne*2);M(Be);const Qe=new Array(Ae);M(Qe);const Pe=new Array(D-_+1);M(Pe);const je=new Array(Y);M(je);const Dt=new Array(ne);M(Dt);function Xe(Ee,ct,dt,St,ft){this.static_tree=Ee,this.extra_bits=ct,this.extra_base=dt,this.elems=St,this.max_length=ft,this.has_stree=Ee&&Ee.length}let zt,xe,$e;function We(Ee,ct){this.dyn_tree=Ee,this.max_code=0,this.stat_desc=ct}const He=Ee=>Ee<256?Qe[Ee]:Qe[256+(Ee>>>7)],Je=(Ee,ct)=>{Ee.pending_buf[Ee.pending++]=ct&255,Ee.pending_buf[Ee.pending++]=ct>>>8&255},Rt=(Ee,ct,dt)=>{Ee.bi_valid>le-dt?(Ee.bi_buf|=ct<<Ee.bi_valid&65535,Je(Ee,Ee.bi_buf),Ee.bi_buf=ct>>le-Ee.bi_valid,Ee.bi_valid+=dt-le):(Ee.bi_buf|=ct<<Ee.bi_valid&65535,Ee.bi_valid+=dt)},jt=(Ee,ct,dt)=>{Rt(Ee,dt[ct*2],dt[ct*2+1])},hi=(Ee,ct)=>{let dt=0;do dt|=Ee&1,Ee>>>=1,dt<<=1;while(--ct>0);return dt>>>1},Jt=Ee=>{Ee.bi_valid===16?(Je(Ee,Ee.bi_buf),Ee.bi_buf=0,Ee.bi_valid=0):Ee.bi_valid>=8&&(Ee.pending_buf[Ee.pending++]=Ee.bi_buf&255,Ee.bi_buf>>=8,Ee.bi_valid-=8)},si=(Ee,ct)=>{const dt=ct.dyn_tree,St=ct.max_code,ft=ct.stat_desc.static_tree,Ie=ct.stat_desc.has_stree,Ye=ct.stat_desc.extra_bits,Ce=ct.stat_desc.extra_base,ke=ct.stat_desc.max_length;let Ne,Le,ai,et,Kt,qe,Ge=0;for(et=0;et<=ae;et++)Ee.bl_count[et]=0;for(dt[Ee.heap[Ee.heap_max]*2+1]=0,Ne=Ee.heap_max+1;Ne<oe;Ne++)Le=Ee.heap[Ne],et=dt[dt[Le*2+1]*2+1]+1,et>ke&&(et=ke,Ge++),dt[Le*2+1]=et,!(Le>St)&&(Ee.bl_count[et]++,Kt=0,Le>=Ce&&(Kt=Ye[Le-Ce]),qe=dt[Le*2],Ee.opt_len+=qe*(et+Kt),Ie&&(Ee.static_len+=qe*(ft[Le*2+1]+Kt)));if(Ge!==0){do{for(et=ke-1;Ee.bl_count[et]===0;)et--;Ee.bl_count[et]--,Ee.bl_count[et+1]+=2,Ee.bl_count[ke]--,Ge-=2}while(Ge>0);for(et=ke;et!==0;et--)for(Le=Ee.bl_count[et];Le!==0;)ai=Ee.heap[--Ne],!(ai>St)&&(dt[ai*2+1]!==et&&(Ee.opt_len+=(et-dt[ai*2+1])*dt[ai*2],dt[ai*2+1]=et),Le--)}},ri=(Ee,ct,dt)=>{const St=new Array(ae+1);let ft=0,Ie,Ye;for(Ie=1;Ie<=ae;Ie++)ft=ft+dt[Ie-1]<<1,St[Ie]=ft;for(Ye=0;Ye<=ct;Ye++){let Ce=Ee[Ye*2+1];Ce!==0&&(Ee[Ye*2]=hi(St[Ce]++,Ce))}},ni=()=>{let Ee,ct,dt,St,ft;const Ie=new Array(ae+1);for(dt=0,St=0;St<Y-1;St++)for(je[St]=dt,Ee=0;Ee<1<<ve[St];Ee++)Pe[dt++]=St;for(Pe[dt-1]=St,ft=0,St=0;St<16;St++)for(Dt[St]=ft,Ee=0;Ee<1<<be[St];Ee++)Qe[ft++]=St;for(ft>>=7;St<ne;St++)for(Dt[St]=ft<<7,Ee=0;Ee<1<<be[St]-7;Ee++)Qe[256+ft++]=St;for(ct=0;ct<=ae;ct++)Ie[ct]=0;for(Ee=0;Ee<=143;)Me[Ee*2+1]=8,Ee++,Ie[8]++;for(;Ee<=255;)Me[Ee*2+1]=9,Ee++,Ie[9]++;for(;Ee<=279;)Me[Ee*2+1]=7,Ee++,Ie[7]++;for(;Ee<=287;)Me[Ee*2+1]=8,Ee++,Ie[8]++;for(ri(Me,ie+1,Ie),Ee=0;Ee<ne;Ee++)Be[Ee*2+1]=5,Be[Ee*2]=hi(Ee,5);zt=new Xe(Me,ve,ee+1,ie,ae),xe=new Xe(Be,be,0,ne,ae),$e=new Xe(new Array(0),Se,0,re,de)},Pi=Ee=>{let ct;for(ct=0;ct<ie;ct++)Ee.dyn_ltree[ct*2]=0;for(ct=0;ct<ne;ct++)Ee.dyn_dtree[ct*2]=0;for(ct=0;ct<re;ct++)Ee.bl_tree[ct*2]=0;Ee.dyn_ltree[me*2]=1,Ee.opt_len=Ee.static_len=0,Ee.sym_next=Ee.matches=0},Ci=Ee=>{Ee.bi_valid>8?Je(Ee,Ee.bi_buf):Ee.bi_valid>0&&(Ee.pending_buf[Ee.pending++]=Ee.bi_buf),Ee.bi_buf=0,Ee.bi_valid=0},qi=(Ee,ct,dt,St)=>{const ft=ct*2,Ie=dt*2;return Ee[ft]<Ee[Ie]||Ee[ft]===Ee[Ie]&&St[ct]<=St[dt]},vi=(Ee,ct,dt)=>{const St=Ee.heap[dt];let ft=dt<<1;for(;ft<=Ee.heap_len&&(ft<Ee.heap_len&&qi(ct,Ee.heap[ft+1],Ee.heap[ft],Ee.depth)&&ft++,!qi(ct,St,Ee.heap[ft],Ee.depth));)Ee.heap[dt]=Ee.heap[ft],dt=ft,ft<<=1;Ee.heap[dt]=St},Ki=(Ee,ct,dt)=>{let St,ft,Ie=0,Ye,Ce;if(Ee.sym_next!==0)do St=Ee.pending_buf[Ee.sym_buf+Ie++]&255,St+=(Ee.pending_buf[Ee.sym_buf+Ie++]&255)<<8,ft=Ee.pending_buf[Ee.sym_buf+Ie++],St===0?jt(Ee,ft,ct):(Ye=Pe[ft],jt(Ee,Ye+ee+1,ct),Ce=ve[Ye],Ce!==0&&(ft-=je[Ye],Rt(Ee,ft,Ce)),St--,Ye=He(St),jt(Ee,Ye,dt),Ce=be[Ye],Ce!==0&&(St-=Dt[Ye],Rt(Ee,St,Ce)));while(Ie<Ee.sym_next);jt(Ee,me,ct)},Vi=(Ee,ct)=>{const dt=ct.dyn_tree,St=ct.stat_desc.static_tree,ft=ct.stat_desc.has_stree,Ie=ct.stat_desc.elems;let Ye,Ce,ke=-1,Ne;for(Ee.heap_len=0,Ee.heap_max=oe,Ye=0;Ye<Ie;Ye++)dt[Ye*2]!==0?(Ee.heap[++Ee.heap_len]=ke=Ye,Ee.depth[Ye]=0):dt[Ye*2+1]=0;for(;Ee.heap_len<2;)Ne=Ee.heap[++Ee.heap_len]=ke<2?++ke:0,dt[Ne*2]=1,Ee.depth[Ne]=0,Ee.opt_len--,ft&&(Ee.static_len-=St[Ne*2+1]);for(ct.max_code=ke,Ye=Ee.heap_len>>1;Ye>=1;Ye--)vi(Ee,dt,Ye);Ne=Ie;do Ye=Ee.heap[1],Ee.heap[1]=Ee.heap[Ee.heap_len--],vi(Ee,dt,1),Ce=Ee.heap[1],Ee.heap[--Ee.heap_max]=Ye,Ee.heap[--Ee.heap_max]=Ce,dt[Ne*2]=dt[Ye*2]+dt[Ce*2],Ee.depth[Ne]=(Ee.depth[Ye]>=Ee.depth[Ce]?Ee.depth[Ye]:Ee.depth[Ce])+1,dt[Ye*2+1]=dt[Ce*2+1]=Ne,Ee.heap[1]=Ne++,vi(Ee,dt,1);while(Ee.heap_len>=2);Ee.heap[--Ee.heap_max]=Ee.heap[1],si(Ee,ct),ri(dt,ke,Ee.bl_count)},zi=(Ee,ct,dt)=>{let St,ft=-1,Ie,Ye=ct[0*2+1],Ce=0,ke=7,Ne=4;for(Ye===0&&(ke=138,Ne=3),ct[(dt+1)*2+1]=65535,St=0;St<=dt;St++)Ie=Ye,Ye=ct[(St+1)*2+1],!(++Ce<ke&&Ie===Ye)&&(Ce<Ne?Ee.bl_tree[Ie*2]+=Ce:Ie!==0?(Ie!==ft&&Ee.bl_tree[Ie*2]++,Ee.bl_tree[fe*2]++):Ce<=10?Ee.bl_tree[ge*2]++:Ee.bl_tree[he*2]++,Ce=0,ft=Ie,Ye===0?(ke=138,Ne=3):Ie===Ye?(ke=6,Ne=3):(ke=7,Ne=4))},xi=(Ee,ct,dt)=>{let St,ft=-1,Ie,Ye=ct[0*2+1],Ce=0,ke=7,Ne=4;for(Ye===0&&(ke=138,Ne=3),St=0;St<=dt;St++)if(Ie=Ye,Ye=ct[(St+1)*2+1],!(++Ce<ke&&Ie===Ye)){if(Ce<Ne)do jt(Ee,Ie,Ee.bl_tree);while(--Ce!==0);else Ie!==0?(Ie!==ft&&(jt(Ee,Ie,Ee.bl_tree),Ce--),jt(Ee,fe,Ee.bl_tree),Rt(Ee,Ce-3,2)):Ce<=10?(jt(Ee,ge,Ee.bl_tree),Rt(Ee,Ce-3,3)):(jt(Ee,he,Ee.bl_tree),Rt(Ee,Ce-11,7));Ce=0,ft=Ie,Ye===0?(ke=138,Ne=3):Ie===Ye?(ke=6,Ne=3):(ke=7,Ne=4)}},Di=Ee=>{let ct;for(zi(Ee,Ee.dyn_ltree,Ee.l_desc.max_code),zi(Ee,Ee.dyn_dtree,Ee.d_desc.max_code),Vi(Ee,Ee.bl_desc),ct=re-1;ct>=3&&Ee.bl_tree[Re[ct]*2+1]===0;ct--);return Ee.opt_len+=3*(ct+1)+5+5+4,ct},bi=(Ee,ct,dt,St)=>{let ft;for(Rt(Ee,ct-257,5),Rt(Ee,dt-1,5),Rt(Ee,St-4,4),ft=0;ft<St;ft++)Rt(Ee,Ee.bl_tree[Re[ft]*2+1],3);xi(Ee,Ee.dyn_ltree,ct-1),xi(Ee,Ee.dyn_dtree,dt-1)},mi=Ee=>{let ct=4093624447,dt;for(dt=0;dt<=31;dt++,ct>>>=1)if(ct&1&&Ee.dyn_ltree[dt*2]!==0)return E;if(Ee.dyn_ltree[9*2]!==0||Ee.dyn_ltree[10*2]!==0||Ee.dyn_ltree[13*2]!==0)return w;for(dt=32;dt<ee;dt++)if(Ee.dyn_ltree[dt*2]!==0)return w;return E};let Oi=!1;const Bi=Ee=>{Oi||(ni(),Oi=!0),Ee.l_desc=new We(Ee.dyn_ltree,zt),Ee.d_desc=new We(Ee.dyn_dtree,xe),Ee.bl_desc=new We(Ee.bl_tree,$e),Ee.bi_buf=0,Ee.bi_valid=0,Pi(Ee)},Ji=(Ee,ct,dt,St)=>{Rt(Ee,(x<<1)+(St?1:0),3),Ci(Ee),Je(Ee,dt),Je(Ee,~dt),dt&&Ee.pending_buf.set(Ee.window.subarray(ct,ct+dt),Ee.pending),Ee.pending+=dt},Bt=Ee=>{Rt(Ee,S<<1,3),jt(Ee,me,Me),Jt(Ee)},it=(Ee,ct,dt,St)=>{let ft,Ie,Ye=0;Ee.level>0?(Ee.strm.data_type===R&&(Ee.strm.data_type=mi(Ee)),Vi(Ee,Ee.l_desc),Vi(Ee,Ee.d_desc),Ye=Di(Ee),ft=Ee.opt_len+3+7>>>3,Ie=Ee.static_len+3+7>>>3,Ie<=ft&&(ft=Ie)):ft=Ie=dt+5,dt+4<=ft&&ct!==-1?Ji(Ee,ct,dt,St):Ee.strategy===C||Ie===ft?(Rt(Ee,(S<<1)+(St?1:0),3),Ki(Ee,Me,Be)):(Rt(Ee,(T<<1)+(St?1:0),3),bi(Ee,Ee.l_desc.max_code+1,Ee.d_desc.max_code+1,Ye+1),Ki(Ee,Ee.dyn_ltree,Ee.dyn_dtree)),Pi(Ee),St&&Ci(Ee)},ti=(Ee,ct,dt)=>(Ee.pending_buf[Ee.sym_buf+Ee.sym_next++]=ct,Ee.pending_buf[Ee.sym_buf+Ee.sym_next++]=ct>>8,Ee.pending_buf[Ee.sym_buf+Ee.sym_next++]=dt,ct===0?Ee.dyn_ltree[dt*2]++:(Ee.matches++,ct--,Ee.dyn_ltree[(Pe[dt]+ee+1)*2]++,Ee.dyn_dtree[He(ct)*2]++),Ee.sym_next===Ee.sym_end);return trees._tr_init=Bi,trees._tr_stored_block=Ji,trees._tr_flush_block=it,trees._tr_tally=ti,trees._tr_align=Bt,trees}var adler32_1,hasRequiredAdler32;function requireAdler32(){return hasRequiredAdler32||(hasRequiredAdler32=1,adler32_1=(C,E,w,R)=>{let M=C&65535|0,x=C>>>16&65535|0,S=0;for(;w!==0;){S=w>2e3?2e3:w,w-=S;do M=M+E[R++]|0,x=x+M|0;while(--S);M%=65521,x%=65521}return M|x<<16|0}),adler32_1}var crc32_1,hasRequiredCrc32;function requireCrc32(){if(hasRequiredCrc32)return crc32_1;hasRequiredCrc32=1;const C=()=>{let w,R=[];for(var M=0;M<256;M++){w=M;for(var x=0;x<8;x++)w=w&1?3988292384^w>>>1:w>>>1;R[M]=w}return R},E=new Uint32Array(C());return crc32_1=(w,R,M,x)=>{const S=E,T=x+M;w^=-1;for(let _=x;_<T;_++)w=w>>>8^S[(w^R[_])&255];return w^-1},crc32_1}var messages,hasRequiredMessages;function requireMessages(){return hasRequiredMessages||(hasRequiredMessages=1,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),messages}var constants$1,hasRequiredConstants$1;function requireConstants$1(){return hasRequiredConstants$1||(hasRequiredConstants$1=1,constants$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),constants$1}var hasRequiredDeflate$1;function requireDeflate$1(){if(hasRequiredDeflate$1)return deflate;hasRequiredDeflate$1=1;const{_tr_init:C,_tr_stored_block:E,_tr_flush_block:w,_tr_tally:R,_tr_align:M}=requireTrees(),x=requireAdler32(),S=requireCrc32(),T=requireMessages(),{Z_NO_FLUSH:_,Z_PARTIAL_FLUSH:D,Z_FULL_FLUSH:Y,Z_FINISH:ee,Z_BLOCK:ie,Z_OK:ne,Z_STREAM_END:re,Z_STREAM_ERROR:oe,Z_DATA_ERROR:ae,Z_BUF_ERROR:le,Z_DEFAULT_COMPRESSION:de,Z_FILTERED:me,Z_HUFFMAN_ONLY:fe,Z_RLE:ge,Z_FIXED:he,Z_DEFAULT_STRATEGY:ve,Z_UNKNOWN:be,Z_DEFLATED:Se}=requireConstants$1(),Re=9,Ae=15,Me=8,Be=286,Qe=30,Pe=19,je=2*Be+1,Dt=15,Xe=3,zt=258,xe=zt+Xe+1,$e=32,We=42,He=57,Je=69,Rt=73,jt=91,hi=103,Jt=113,si=666,ri=1,ni=2,Pi=3,Ci=4,qi=3,vi=(pe,Ve)=>(pe.msg=T[Ve],Ve),Ki=pe=>pe*2-(pe>4?9:0),Vi=pe=>{let Ve=pe.length;for(;--Ve>=0;)pe[Ve]=0},zi=pe=>{let Ve,we,ze,Ze=pe.w_size;Ve=pe.hash_size,ze=Ve;do we=pe.head[--ze],pe.head[ze]=we>=Ze?we-Ze:0;while(--Ve);Ve=Ze,ze=Ve;do we=pe.prev[--ze],pe.prev[ze]=we>=Ze?we-Ze:0;while(--Ve)};let xi=(pe,Ve,we)=>(Ve<<pe.hash_shift^we)&pe.hash_mask;const Di=pe=>{const Ve=pe.state;let we=Ve.pending;we>pe.avail_out&&(we=pe.avail_out),we!==0&&(pe.output.set(Ve.pending_buf.subarray(Ve.pending_out,Ve.pending_out+we),pe.next_out),pe.next_out+=we,Ve.pending_out+=we,pe.total_out+=we,pe.avail_out-=we,Ve.pending-=we,Ve.pending===0&&(Ve.pending_out=0))},bi=(pe,Ve)=>{w(pe,pe.block_start>=0?pe.block_start:-1,pe.strstart-pe.block_start,Ve),pe.block_start=pe.strstart,Di(pe.strm)},mi=(pe,Ve)=>{pe.pending_buf[pe.pending++]=Ve},Oi=(pe,Ve)=>{pe.pending_buf[pe.pending++]=Ve>>>8&255,pe.pending_buf[pe.pending++]=Ve&255},Bi=(pe,Ve,we,ze)=>{let Ze=pe.avail_in;return Ze>ze&&(Ze=ze),Ze===0?0:(pe.avail_in-=Ze,Ve.set(pe.input.subarray(pe.next_in,pe.next_in+Ze),we),pe.state.wrap===1?pe.adler=x(pe.adler,Ve,Ze,we):pe.state.wrap===2&&(pe.adler=S(pe.adler,Ve,Ze,we)),pe.next_in+=Ze,pe.total_in+=Ze,Ze)},Ji=(pe,Ve)=>{let we=pe.max_chain_length,ze=pe.strstart,Ze,$t,ii=pe.prev_length,Yt=pe.nice_match;const Ni=pe.strstart>pe.w_size-xe?pe.strstart-(pe.w_size-xe):0,pi=pe.window,qn=pe.w_mask,Jn=pe.prev,Ti=pe.strstart+zt;let _i=pi[ze+ii-1],Ei=pi[ze+ii];pe.prev_length>=pe.good_match&&(we>>=2),Yt>pe.lookahead&&(Yt=pe.lookahead);do if(Ze=Ve,!(pi[Ze+ii]!==Ei||pi[Ze+ii-1]!==_i||pi[Ze]!==pi[ze]||pi[++Ze]!==pi[ze+1])){ze+=2,Ze++;do;while(pi[++ze]===pi[++Ze]&&pi[++ze]===pi[++Ze]&&pi[++ze]===pi[++Ze]&&pi[++ze]===pi[++Ze]&&pi[++ze]===pi[++Ze]&&pi[++ze]===pi[++Ze]&&pi[++ze]===pi[++Ze]&&pi[++ze]===pi[++Ze]&&ze<Ti);if($t=zt-(Ti-ze),ze=Ti-zt,$t>ii){if(pe.match_start=Ve,ii=$t,$t>=Yt)break;_i=pi[ze+ii-1],Ei=pi[ze+ii]}}while((Ve=Jn[Ve&qn])>Ni&&--we!==0);return ii<=pe.lookahead?ii:pe.lookahead},Bt=pe=>{const Ve=pe.w_size;let we,ze,Ze;do{if(ze=pe.window_size-pe.lookahead-pe.strstart,pe.strstart>=Ve+(Ve-xe)&&(pe.window.set(pe.window.subarray(Ve,Ve+Ve-ze),0),pe.match_start-=Ve,pe.strstart-=Ve,pe.block_start-=Ve,pe.insert>pe.strstart&&(pe.insert=pe.strstart),zi(pe),ze+=Ve),pe.strm.avail_in===0)break;if(we=Bi(pe.strm,pe.window,pe.strstart+pe.lookahead,ze),pe.lookahead+=we,pe.lookahead+pe.insert>=Xe)for(Ze=pe.strstart-pe.insert,pe.ins_h=pe.window[Ze],pe.ins_h=xi(pe,pe.ins_h,pe.window[Ze+1]);pe.insert&&(pe.ins_h=xi(pe,pe.ins_h,pe.window[Ze+Xe-1]),pe.prev[Ze&pe.w_mask]=pe.head[pe.ins_h],pe.head[pe.ins_h]=Ze,Ze++,pe.insert--,!(pe.lookahead+pe.insert<Xe)););}while(pe.lookahead<xe&&pe.strm.avail_in!==0)},it=(pe,Ve)=>{let we=pe.pending_buf_size-5>pe.w_size?pe.w_size:pe.pending_buf_size-5,ze,Ze,$t,ii=0,Yt=pe.strm.avail_in;do{if(ze=65535,$t=pe.bi_valid+42>>3,pe.strm.avail_out<$t||($t=pe.strm.avail_out-$t,Ze=pe.strstart-pe.block_start,ze>Ze+pe.strm.avail_in&&(ze=Ze+pe.strm.avail_in),ze>$t&&(ze=$t),ze<we&&(ze===0&&Ve!==ee||Ve===_||ze!==Ze+pe.strm.avail_in)))break;ii=Ve===ee&&ze===Ze+pe.strm.avail_in?1:0,E(pe,0,0,ii),pe.pending_buf[pe.pending-4]=ze,pe.pending_buf[pe.pending-3]=ze>>8,pe.pending_buf[pe.pending-2]=~ze,pe.pending_buf[pe.pending-1]=~ze>>8,Di(pe.strm),Ze&&(Ze>ze&&(Ze=ze),pe.strm.output.set(pe.window.subarray(pe.block_start,pe.block_start+Ze),pe.strm.next_out),pe.strm.next_out+=Ze,pe.strm.avail_out-=Ze,pe.strm.total_out+=Ze,pe.block_start+=Ze,ze-=Ze),ze&&(Bi(pe.strm,pe.strm.output,pe.strm.next_out,ze),pe.strm.next_out+=ze,pe.strm.avail_out-=ze,pe.strm.total_out+=ze)}while(ii===0);return Yt-=pe.strm.avail_in,Yt&&(Yt>=pe.w_size?(pe.matches=2,pe.window.set(pe.strm.input.subarray(pe.strm.next_in-pe.w_size,pe.strm.next_in),0),pe.strstart=pe.w_size,pe.insert=pe.strstart):(pe.window_size-pe.strstart<=Yt&&(pe.strstart-=pe.w_size,pe.window.set(pe.window.subarray(pe.w_size,pe.w_size+pe.strstart),0),pe.matches<2&&pe.matches++,pe.insert>pe.strstart&&(pe.insert=pe.strstart)),pe.window.set(pe.strm.input.subarray(pe.strm.next_in-Yt,pe.strm.next_in),pe.strstart),pe.strstart+=Yt,pe.insert+=Yt>pe.w_size-pe.insert?pe.w_size-pe.insert:Yt),pe.block_start=pe.strstart),pe.high_water<pe.strstart&&(pe.high_water=pe.strstart),ii?Ci:Ve!==_&&Ve!==ee&&pe.strm.avail_in===0&&pe.strstart===pe.block_start?ni:($t=pe.window_size-pe.strstart,pe.strm.avail_in>$t&&pe.block_start>=pe.w_size&&(pe.block_start-=pe.w_size,pe.strstart-=pe.w_size,pe.window.set(pe.window.subarray(pe.w_size,pe.w_size+pe.strstart),0),pe.matches<2&&pe.matches++,$t+=pe.w_size,pe.insert>pe.strstart&&(pe.insert=pe.strstart)),$t>pe.strm.avail_in&&($t=pe.strm.avail_in),$t&&(Bi(pe.strm,pe.window,pe.strstart,$t),pe.strstart+=$t,pe.insert+=$t>pe.w_size-pe.insert?pe.w_size-pe.insert:$t),pe.high_water<pe.strstart&&(pe.high_water=pe.strstart),$t=pe.bi_valid+42>>3,$t=pe.pending_buf_size-$t>65535?65535:pe.pending_buf_size-$t,we=$t>pe.w_size?pe.w_size:$t,Ze=pe.strstart-pe.block_start,(Ze>=we||(Ze||Ve===ee)&&Ve!==_&&pe.strm.avail_in===0&&Ze<=$t)&&(ze=Ze>$t?$t:Ze,ii=Ve===ee&&pe.strm.avail_in===0&&ze===Ze?1:0,E(pe,pe.block_start,ze,ii),pe.block_start+=ze,Di(pe.strm)),ii?Pi:ri)},ti=(pe,Ve)=>{let we,ze;for(;;){if(pe.lookahead<xe){if(Bt(pe),pe.lookahead<xe&&Ve===_)return ri;if(pe.lookahead===0)break}if(we=0,pe.lookahead>=Xe&&(pe.ins_h=xi(pe,pe.ins_h,pe.window[pe.strstart+Xe-1]),we=pe.prev[pe.strstart&pe.w_mask]=pe.head[pe.ins_h],pe.head[pe.ins_h]=pe.strstart),we!==0&&pe.strstart-we<=pe.w_size-xe&&(pe.match_length=Ji(pe,we)),pe.match_length>=Xe)if(ze=R(pe,pe.strstart-pe.match_start,pe.match_length-Xe),pe.lookahead-=pe.match_length,pe.match_length<=pe.max_lazy_match&&pe.lookahead>=Xe){pe.match_length--;do pe.strstart++,pe.ins_h=xi(pe,pe.ins_h,pe.window[pe.strstart+Xe-1]),we=pe.prev[pe.strstart&pe.w_mask]=pe.head[pe.ins_h],pe.head[pe.ins_h]=pe.strstart;while(--pe.match_length!==0);pe.strstart++}else pe.strstart+=pe.match_length,pe.match_length=0,pe.ins_h=pe.window[pe.strstart],pe.ins_h=xi(pe,pe.ins_h,pe.window[pe.strstart+1]);else ze=R(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++;if(ze&&(bi(pe,!1),pe.strm.avail_out===0))return ri}return pe.insert=pe.strstart<Xe-1?pe.strstart:Xe-1,Ve===ee?(bi(pe,!0),pe.strm.avail_out===0?Pi:Ci):pe.sym_next&&(bi(pe,!1),pe.strm.avail_out===0)?ri:ni},Ee=(pe,Ve)=>{let we,ze,Ze;for(;;){if(pe.lookahead<xe){if(Bt(pe),pe.lookahead<xe&&Ve===_)return ri;if(pe.lookahead===0)break}if(we=0,pe.lookahead>=Xe&&(pe.ins_h=xi(pe,pe.ins_h,pe.window[pe.strstart+Xe-1]),we=pe.prev[pe.strstart&pe.w_mask]=pe.head[pe.ins_h],pe.head[pe.ins_h]=pe.strstart),pe.prev_length=pe.match_length,pe.prev_match=pe.match_start,pe.match_length=Xe-1,we!==0&&pe.prev_length<pe.max_lazy_match&&pe.strstart-we<=pe.w_size-xe&&(pe.match_length=Ji(pe,we),pe.match_length<=5&&(pe.strategy===me||pe.match_length===Xe&&pe.strstart-pe.match_start>4096)&&(pe.match_length=Xe-1)),pe.prev_length>=Xe&&pe.match_length<=pe.prev_length){Ze=pe.strstart+pe.lookahead-Xe,ze=R(pe,pe.strstart-1-pe.prev_match,pe.prev_length-Xe),pe.lookahead-=pe.prev_length-1,pe.prev_length-=2;do++pe.strstart<=Ze&&(pe.ins_h=xi(pe,pe.ins_h,pe.window[pe.strstart+Xe-1]),we=pe.prev[pe.strstart&pe.w_mask]=pe.head[pe.ins_h],pe.head[pe.ins_h]=pe.strstart);while(--pe.prev_length!==0);if(pe.match_available=0,pe.match_length=Xe-1,pe.strstart++,ze&&(bi(pe,!1),pe.strm.avail_out===0))return ri}else if(pe.match_available){if(ze=R(pe,0,pe.window[pe.strstart-1]),ze&&bi(pe,!1),pe.strstart++,pe.lookahead--,pe.strm.avail_out===0)return ri}else pe.match_available=1,pe.strstart++,pe.lookahead--}return pe.match_available&&(ze=R(pe,0,pe.window[pe.strstart-1]),pe.match_available=0),pe.insert=pe.strstart<Xe-1?pe.strstart:Xe-1,Ve===ee?(bi(pe,!0),pe.strm.avail_out===0?Pi:Ci):pe.sym_next&&(bi(pe,!1),pe.strm.avail_out===0)?ri:ni},ct=(pe,Ve)=>{let we,ze,Ze,$t;const ii=pe.window;for(;;){if(pe.lookahead<=zt){if(Bt(pe),pe.lookahead<=zt&&Ve===_)return ri;if(pe.lookahead===0)break}if(pe.match_length=0,pe.lookahead>=Xe&&pe.strstart>0&&(Ze=pe.strstart-1,ze=ii[Ze],ze===ii[++Ze]&&ze===ii[++Ze]&&ze===ii[++Ze])){$t=pe.strstart+zt;do;while(ze===ii[++Ze]&&ze===ii[++Ze]&&ze===ii[++Ze]&&ze===ii[++Ze]&&ze===ii[++Ze]&&ze===ii[++Ze]&&ze===ii[++Ze]&&ze===ii[++Ze]&&Ze<$t);pe.match_length=zt-($t-Ze),pe.match_length>pe.lookahead&&(pe.match_length=pe.lookahead)}if(pe.match_length>=Xe?(we=R(pe,1,pe.match_length-Xe),pe.lookahead-=pe.match_length,pe.strstart+=pe.match_length,pe.match_length=0):(we=R(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++),we&&(bi(pe,!1),pe.strm.avail_out===0))return ri}return pe.insert=0,Ve===ee?(bi(pe,!0),pe.strm.avail_out===0?Pi:Ci):pe.sym_next&&(bi(pe,!1),pe.strm.avail_out===0)?ri:ni},dt=(pe,Ve)=>{let we;for(;;){if(pe.lookahead===0&&(Bt(pe),pe.lookahead===0)){if(Ve===_)return ri;break}if(pe.match_length=0,we=R(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++,we&&(bi(pe,!1),pe.strm.avail_out===0))return ri}return pe.insert=0,Ve===ee?(bi(pe,!0),pe.strm.avail_out===0?Pi:Ci):pe.sym_next&&(bi(pe,!1),pe.strm.avail_out===0)?ri:ni};function St(pe,Ve,we,ze,Ze){this.good_length=pe,this.max_lazy=Ve,this.nice_length=we,this.max_chain=ze,this.func=Ze}const ft=[new St(0,0,0,0,it),new St(4,4,8,4,ti),new St(4,5,16,8,ti),new St(4,6,32,32,ti),new St(4,4,16,16,Ee),new St(8,16,32,32,Ee),new St(8,16,128,128,Ee),new St(8,32,128,256,Ee),new St(32,128,258,1024,Ee),new St(32,258,258,4096,Ee)],Ie=pe=>{pe.window_size=2*pe.w_size,Vi(pe.head),pe.max_lazy_match=ft[pe.level].max_lazy,pe.good_match=ft[pe.level].good_length,pe.nice_match=ft[pe.level].nice_length,pe.max_chain_length=ft[pe.level].max_chain,pe.strstart=0,pe.block_start=0,pe.lookahead=0,pe.insert=0,pe.match_length=pe.prev_length=Xe-1,pe.match_available=0,pe.ins_h=0};function Ye(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Se,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(je*2),this.dyn_dtree=new Uint16Array((2*Qe+1)*2),this.bl_tree=new Uint16Array((2*Pe+1)*2),Vi(this.dyn_ltree),Vi(this.dyn_dtree),Vi(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Dt+1),this.heap=new Uint16Array(2*Be+1),Vi(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Be+1),Vi(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ce=pe=>{if(!pe)return 1;const Ve=pe.state;return!Ve||Ve.strm!==pe||Ve.status!==We&&Ve.status!==He&&Ve.status!==Je&&Ve.status!==Rt&&Ve.status!==jt&&Ve.status!==hi&&Ve.status!==Jt&&Ve.status!==si?1:0},ke=pe=>{if(Ce(pe))return vi(pe,oe);pe.total_in=pe.total_out=0,pe.data_type=be;const Ve=pe.state;return Ve.pending=0,Ve.pending_out=0,Ve.wrap<0&&(Ve.wrap=-Ve.wrap),Ve.status=Ve.wrap===2?He:Ve.wrap?We:Jt,pe.adler=Ve.wrap===2?0:1,Ve.last_flush=-2,C(Ve),ne},Ne=pe=>{const Ve=ke(pe);return Ve===ne&&Ie(pe.state),Ve},Le=(pe,Ve)=>Ce(pe)||pe.state.wrap!==2?oe:(pe.state.gzhead=Ve,ne),ai=(pe,Ve,we,ze,Ze,$t)=>{if(!pe)return oe;let ii=1;if(Ve===de&&(Ve=6),ze<0?(ii=0,ze=-ze):ze>15&&(ii=2,ze-=16),Ze<1||Ze>Re||we!==Se||ze<8||ze>15||Ve<0||Ve>9||$t<0||$t>he||ze===8&&ii!==1)return vi(pe,oe);ze===8&&(ze=9);const Yt=new Ye;return pe.state=Yt,Yt.strm=pe,Yt.status=We,Yt.wrap=ii,Yt.gzhead=null,Yt.w_bits=ze,Yt.w_size=1<<Yt.w_bits,Yt.w_mask=Yt.w_size-1,Yt.hash_bits=Ze+7,Yt.hash_size=1<<Yt.hash_bits,Yt.hash_mask=Yt.hash_size-1,Yt.hash_shift=~~((Yt.hash_bits+Xe-1)/Xe),Yt.window=new Uint8Array(Yt.w_size*2),Yt.head=new Uint16Array(Yt.hash_size),Yt.prev=new Uint16Array(Yt.w_size),Yt.lit_bufsize=1<<Ze+6,Yt.pending_buf_size=Yt.lit_bufsize*4,Yt.pending_buf=new Uint8Array(Yt.pending_buf_size),Yt.sym_buf=Yt.lit_bufsize,Yt.sym_end=(Yt.lit_bufsize-1)*3,Yt.level=Ve,Yt.strategy=$t,Yt.method=we,Ne(pe)},et=(pe,Ve)=>ai(pe,Ve,Se,Ae,Me,ve),Kt=(pe,Ve)=>{if(Ce(pe)||Ve>ie||Ve<0)return pe?vi(pe,oe):oe;const we=pe.state;if(!pe.output||pe.avail_in!==0&&!pe.input||we.status===si&&Ve!==ee)return vi(pe,pe.avail_out===0?le:oe);const ze=we.last_flush;if(we.last_flush=Ve,we.pending!==0){if(Di(pe),pe.avail_out===0)return we.last_flush=-1,ne}else if(pe.avail_in===0&&Ki(Ve)<=Ki(ze)&&Ve!==ee)return vi(pe,le);if(we.status===si&&pe.avail_in!==0)return vi(pe,le);if(we.status===We&&we.wrap===0&&(we.status=Jt),we.status===We){let Ze=Se+(we.w_bits-8<<4)<<8,$t=-1;if(we.strategy>=fe||we.level<2?$t=0:we.level<6?$t=1:we.level===6?$t=2:$t=3,Ze|=$t<<6,we.strstart!==0&&(Ze|=$e),Ze+=31-Ze%31,Oi(we,Ze),we.strstart!==0&&(Oi(we,pe.adler>>>16),Oi(we,pe.adler&65535)),pe.adler=1,we.status=Jt,Di(pe),we.pending!==0)return we.last_flush=-1,ne}if(we.status===He){if(pe.adler=0,mi(we,31),mi(we,139),mi(we,8),we.gzhead)mi(we,(we.gzhead.text?1:0)+(we.gzhead.hcrc?2:0)+(we.gzhead.extra?4:0)+(we.gzhead.name?8:0)+(we.gzhead.comment?16:0)),mi(we,we.gzhead.time&255),mi(we,we.gzhead.time>>8&255),mi(we,we.gzhead.time>>16&255),mi(we,we.gzhead.time>>24&255),mi(we,we.level===9?2:we.strategy>=fe||we.level<2?4:0),mi(we,we.gzhead.os&255),we.gzhead.extra&&we.gzhead.extra.length&&(mi(we,we.gzhead.extra.length&255),mi(we,we.gzhead.extra.length>>8&255)),we.gzhead.hcrc&&(pe.adler=S(pe.adler,we.pending_buf,we.pending,0)),we.gzindex=0,we.status=Je;else if(mi(we,0),mi(we,0),mi(we,0),mi(we,0),mi(we,0),mi(we,we.level===9?2:we.strategy>=fe||we.level<2?4:0),mi(we,qi),we.status=Jt,Di(pe),we.pending!==0)return we.last_flush=-1,ne}if(we.status===Je){if(we.gzhead.extra){let Ze=we.pending,$t=(we.gzhead.extra.length&65535)-we.gzindex;for(;we.pending+$t>we.pending_buf_size;){let Yt=we.pending_buf_size-we.pending;if(we.pending_buf.set(we.gzhead.extra.subarray(we.gzindex,we.gzindex+Yt),we.pending),we.pending=we.pending_buf_size,we.gzhead.hcrc&&we.pending>Ze&&(pe.adler=S(pe.adler,we.pending_buf,we.pending-Ze,Ze)),we.gzindex+=Yt,Di(pe),we.pending!==0)return we.last_flush=-1,ne;Ze=0,$t-=Yt}let ii=new Uint8Array(we.gzhead.extra);we.pending_buf.set(ii.subarray(we.gzindex,we.gzindex+$t),we.pending),we.pending+=$t,we.gzhead.hcrc&&we.pending>Ze&&(pe.adler=S(pe.adler,we.pending_buf,we.pending-Ze,Ze)),we.gzindex=0}we.status=Rt}if(we.status===Rt){if(we.gzhead.name){let Ze=we.pending,$t;do{if(we.pending===we.pending_buf_size){if(we.gzhead.hcrc&&we.pending>Ze&&(pe.adler=S(pe.adler,we.pending_buf,we.pending-Ze,Ze)),Di(pe),we.pending!==0)return we.last_flush=-1,ne;Ze=0}we.gzindex<we.gzhead.name.length?$t=we.gzhead.name.charCodeAt(we.gzindex++)&255:$t=0,mi(we,$t)}while($t!==0);we.gzhead.hcrc&&we.pending>Ze&&(pe.adler=S(pe.adler,we.pending_buf,we.pending-Ze,Ze)),we.gzindex=0}we.status=jt}if(we.status===jt){if(we.gzhead.comment){let Ze=we.pending,$t;do{if(we.pending===we.pending_buf_size){if(we.gzhead.hcrc&&we.pending>Ze&&(pe.adler=S(pe.adler,we.pending_buf,we.pending-Ze,Ze)),Di(pe),we.pending!==0)return we.last_flush=-1,ne;Ze=0}we.gzindex<we.gzhead.comment.length?$t=we.gzhead.comment.charCodeAt(we.gzindex++)&255:$t=0,mi(we,$t)}while($t!==0);we.gzhead.hcrc&&we.pending>Ze&&(pe.adler=S(pe.adler,we.pending_buf,we.pending-Ze,Ze))}we.status=hi}if(we.status===hi){if(we.gzhead.hcrc){if(we.pending+2>we.pending_buf_size&&(Di(pe),we.pending!==0))return we.last_flush=-1,ne;mi(we,pe.adler&255),mi(we,pe.adler>>8&255),pe.adler=0}if(we.status=Jt,Di(pe),we.pending!==0)return we.last_flush=-1,ne}if(pe.avail_in!==0||we.lookahead!==0||Ve!==_&&we.status!==si){let Ze=we.level===0?it(we,Ve):we.strategy===fe?dt(we,Ve):we.strategy===ge?ct(we,Ve):ft[we.level].func(we,Ve);if((Ze===Pi||Ze===Ci)&&(we.status=si),Ze===ri||Ze===Pi)return pe.avail_out===0&&(we.last_flush=-1),ne;if(Ze===ni&&(Ve===D?M(we):Ve!==ie&&(E(we,0,0,!1),Ve===Y&&(Vi(we.head),we.lookahead===0&&(we.strstart=0,we.block_start=0,we.insert=0))),Di(pe),pe.avail_out===0))return we.last_flush=-1,ne}return Ve!==ee?ne:we.wrap<=0?re:(we.wrap===2?(mi(we,pe.adler&255),mi(we,pe.adler>>8&255),mi(we,pe.adler>>16&255),mi(we,pe.adler>>24&255),mi(we,pe.total_in&255),mi(we,pe.total_in>>8&255),mi(we,pe.total_in>>16&255),mi(we,pe.total_in>>24&255)):(Oi(we,pe.adler>>>16),Oi(we,pe.adler&65535)),Di(pe),we.wrap>0&&(we.wrap=-we.wrap),we.pending!==0?ne:re)},qe=pe=>{if(Ce(pe))return oe;const Ve=pe.state.status;return pe.state=null,Ve===Jt?vi(pe,ae):ne},Ge=(pe,Ve)=>{let we=Ve.length;if(Ce(pe))return oe;const ze=pe.state,Ze=ze.wrap;if(Ze===2||Ze===1&&ze.status!==We||ze.lookahead)return oe;if(Ze===1&&(pe.adler=x(pe.adler,Ve,we,0)),ze.wrap=0,we>=ze.w_size){Ze===0&&(Vi(ze.head),ze.strstart=0,ze.block_start=0,ze.insert=0);let Ni=new Uint8Array(ze.w_size);Ni.set(Ve.subarray(we-ze.w_size,we),0),Ve=Ni,we=ze.w_size}const $t=pe.avail_in,ii=pe.next_in,Yt=pe.input;for(pe.avail_in=we,pe.next_in=0,pe.input=Ve,Bt(ze);ze.lookahead>=Xe;){let Ni=ze.strstart,pi=ze.lookahead-(Xe-1);do ze.ins_h=xi(ze,ze.ins_h,ze.window[Ni+Xe-1]),ze.prev[Ni&ze.w_mask]=ze.head[ze.ins_h],ze.head[ze.ins_h]=Ni,Ni++;while(--pi);ze.strstart=Ni,ze.lookahead=Xe-1,Bt(ze)}return ze.strstart+=ze.lookahead,ze.block_start=ze.strstart,ze.insert=ze.lookahead,ze.lookahead=0,ze.match_length=ze.prev_length=Xe-1,ze.match_available=0,pe.next_in=ii,pe.input=Yt,pe.avail_in=$t,ze.wrap=Ze,ne};return deflate.deflateInit=et,deflate.deflateInit2=ai,deflate.deflateReset=Ne,deflate.deflateResetKeep=ke,deflate.deflateSetHeader=Le,deflate.deflate=Kt,deflate.deflateEnd=qe,deflate.deflateSetDictionary=Ge,deflate.deflateInfo="pako deflate (from Nodeca project)",deflate}var common={},hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;const C=(E,w)=>Object.prototype.hasOwnProperty.call(E,w);return common.assign=function(E){const w=Array.prototype.slice.call(arguments,1);for(;w.length;){const R=w.shift();if(R){if(typeof R!="object")throw new TypeError(R+"must be non-object");for(const M in R)C(R,M)&&(E[M]=R[M])}}return E},common.flattenChunks=E=>{let w=0;for(let M=0,x=E.length;M<x;M++)w+=E[M].length;const R=new Uint8Array(w);for(let M=0,x=0,S=E.length;M<S;M++){let T=E[M];R.set(T,x),x+=T.length}return R},common}var strings={},hasRequiredStrings;function requireStrings(){if(hasRequiredStrings)return strings;hasRequiredStrings=1;let C=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{C=!1}const E=new Uint8Array(256);for(let R=0;R<256;R++)E[R]=R>=252?6:R>=248?5:R>=240?4:R>=224?3:R>=192?2:1;E[254]=E[254]=1,strings.string2buf=R=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(R);let M,x,S,T,_,D=R.length,Y=0;for(T=0;T<D;T++)x=R.charCodeAt(T),(x&64512)===55296&&T+1<D&&(S=R.charCodeAt(T+1),(S&64512)===56320&&(x=65536+(x-55296<<10)+(S-56320),T++)),Y+=x<128?1:x<2048?2:x<65536?3:4;for(M=new Uint8Array(Y),_=0,T=0;_<Y;T++)x=R.charCodeAt(T),(x&64512)===55296&&T+1<D&&(S=R.charCodeAt(T+1),(S&64512)===56320&&(x=65536+(x-55296<<10)+(S-56320),T++)),x<128?M[_++]=x:x<2048?(M[_++]=192|x>>>6,M[_++]=128|x&63):x<65536?(M[_++]=224|x>>>12,M[_++]=128|x>>>6&63,M[_++]=128|x&63):(M[_++]=240|x>>>18,M[_++]=128|x>>>12&63,M[_++]=128|x>>>6&63,M[_++]=128|x&63);return M};const w=(R,M)=>{if(M<65534&&R.subarray&&C)return String.fromCharCode.apply(null,R.length===M?R:R.subarray(0,M));let x="";for(let S=0;S<M;S++)x+=String.fromCharCode(R[S]);return x};return strings.buf2string=(R,M)=>{const x=M||R.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(R.subarray(0,M));let S,T;const _=new Array(x*2);for(T=0,S=0;S<x;){let D=R[S++];if(D<128){_[T++]=D;continue}let Y=E[D];if(Y>4){_[T++]=65533,S+=Y-1;continue}for(D&=Y===2?31:Y===3?15:7;Y>1&&S<x;)D=D<<6|R[S++]&63,Y--;if(Y>1){_[T++]=65533;continue}D<65536?_[T++]=D:(D-=65536,_[T++]=55296|D>>10&1023,_[T++]=56320|D&1023)}return w(_,T)},strings.utf8border=(R,M)=>{M=M||R.length,M>R.length&&(M=R.length);let x=M-1;for(;x>=0&&(R[x]&192)===128;)x--;return x<0||x===0?M:x+E[R[x]]>M?x:M},strings}var zstream,hasRequiredZstream;function requireZstream(){if(hasRequiredZstream)return zstream;hasRequiredZstream=1;function C(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return zstream=C,zstream}var hasRequiredDeflate;function requireDeflate(){if(hasRequiredDeflate)return deflate$1;hasRequiredDeflate=1;const C=requireDeflate$1(),E=requireCommon(),w=requireStrings(),R=requireMessages(),M=requireZstream(),x=Object.prototype.toString,{Z_NO_FLUSH:S,Z_SYNC_FLUSH:T,Z_FULL_FLUSH:_,Z_FINISH:D,Z_OK:Y,Z_STREAM_END:ee,Z_DEFAULT_COMPRESSION:ie,Z_DEFAULT_STRATEGY:ne,Z_DEFLATED:re}=requireConstants$1();function oe(me){this.options=E.assign({level:ie,method:re,chunkSize:16384,windowBits:15,memLevel:8,strategy:ne},me||{});let fe=this.options;fe.raw&&fe.windowBits>0?fe.windowBits=-fe.windowBits:fe.gzip&&fe.windowBits>0&&fe.windowBits<16&&(fe.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;let ge=C.deflateInit2(this.strm,fe.level,fe.method,fe.windowBits,fe.memLevel,fe.strategy);if(ge!==Y)throw new Error(R[ge]);if(fe.header&&C.deflateSetHeader(this.strm,fe.header),fe.dictionary){let he;if(typeof fe.dictionary=="string"?he=w.string2buf(fe.dictionary):x.call(fe.dictionary)==="[object ArrayBuffer]"?he=new Uint8Array(fe.dictionary):he=fe.dictionary,ge=C.deflateSetDictionary(this.strm,he),ge!==Y)throw new Error(R[ge]);this._dict_set=!0}}oe.prototype.push=function(me,fe){const ge=this.strm,he=this.options.chunkSize;let ve,be;if(this.ended)return!1;for(fe===~~fe?be=fe:be=fe===!0?D:S,typeof me=="string"?ge.input=w.string2buf(me):x.call(me)==="[object ArrayBuffer]"?ge.input=new Uint8Array(me):ge.input=me,ge.next_in=0,ge.avail_in=ge.input.length;;){if(ge.avail_out===0&&(ge.output=new Uint8Array(he),ge.next_out=0,ge.avail_out=he),(be===T||be===_)&&ge.avail_out<=6){this.onData(ge.output.subarray(0,ge.next_out)),ge.avail_out=0;continue}if(ve=C.deflate(ge,be),ve===ee)return ge.next_out>0&&this.onData(ge.output.subarray(0,ge.next_out)),ve=C.deflateEnd(this.strm),this.onEnd(ve),this.ended=!0,ve===Y;if(ge.avail_out===0){this.onData(ge.output);continue}if(be>0&&ge.next_out>0){this.onData(ge.output.subarray(0,ge.next_out)),ge.avail_out=0;continue}if(ge.avail_in===0)break}return!0},oe.prototype.onData=function(me){this.chunks.push(me)},oe.prototype.onEnd=function(me){me===Y&&(this.result=E.flattenChunks(this.chunks)),this.chunks=[],this.err=me,this.msg=this.strm.msg};function ae(me,fe){const ge=new oe(fe);if(ge.push(me,!0),ge.err)throw ge.msg||R[ge.err];return ge.result}function le(me,fe){return fe=fe||{},fe.raw=!0,ae(me,fe)}function de(me,fe){return fe=fe||{},fe.gzip=!0,ae(me,fe)}return deflate$1.Deflate=oe,deflate$1.deflate=ae,deflate$1.deflateRaw=le,deflate$1.gzip=de,deflate$1.constants=requireConstants$1(),deflate$1}var inflate$1={},inflate={},inffast,hasRequiredInffast;function requireInffast(){if(hasRequiredInffast)return inffast;hasRequiredInffast=1;const C=16209,E=16191;return inffast=function(w,R){let M,x,S,T,_,D,Y,ee,ie,ne,re,oe,ae,le,de,me,fe,ge,he,ve,be,Se,Re,Ae;const Me=w.state;M=w.next_in,Re=w.input,x=M+(w.avail_in-5),S=w.next_out,Ae=w.output,T=S-(R-w.avail_out),_=S+(w.avail_out-257),D=Me.dmax,Y=Me.wsize,ee=Me.whave,ie=Me.wnext,ne=Me.window,re=Me.hold,oe=Me.bits,ae=Me.lencode,le=Me.distcode,de=(1<<Me.lenbits)-1,me=(1<<Me.distbits)-1;e:do{oe<15&&(re+=Re[M++]<<oe,oe+=8,re+=Re[M++]<<oe,oe+=8),fe=ae[re&de];t:for(;;){if(ge=fe>>>24,re>>>=ge,oe-=ge,ge=fe>>>16&255,ge===0)Ae[S++]=fe&65535;else if(ge&16){he=fe&65535,ge&=15,ge&&(oe<ge&&(re+=Re[M++]<<oe,oe+=8),he+=re&(1<<ge)-1,re>>>=ge,oe-=ge),oe<15&&(re+=Re[M++]<<oe,oe+=8,re+=Re[M++]<<oe,oe+=8),fe=le[re&me];i:for(;;){if(ge=fe>>>24,re>>>=ge,oe-=ge,ge=fe>>>16&255,ge&16){if(ve=fe&65535,ge&=15,oe<ge&&(re+=Re[M++]<<oe,oe+=8,oe<ge&&(re+=Re[M++]<<oe,oe+=8)),ve+=re&(1<<ge)-1,ve>D){w.msg="invalid distance too far back",Me.mode=C;break e}if(re>>>=ge,oe-=ge,ge=S-T,ve>ge){if(ge=ve-ge,ge>ee&&Me.sane){w.msg="invalid distance too far back",Me.mode=C;break e}if(be=0,Se=ne,ie===0){if(be+=Y-ge,ge<he){he-=ge;do Ae[S++]=ne[be++];while(--ge);be=S-ve,Se=Ae}}else if(ie<ge){if(be+=Y+ie-ge,ge-=ie,ge<he){he-=ge;do Ae[S++]=ne[be++];while(--ge);if(be=0,ie<he){ge=ie,he-=ge;do Ae[S++]=ne[be++];while(--ge);be=S-ve,Se=Ae}}}else if(be+=ie-ge,ge<he){he-=ge;do Ae[S++]=ne[be++];while(--ge);be=S-ve,Se=Ae}for(;he>2;)Ae[S++]=Se[be++],Ae[S++]=Se[be++],Ae[S++]=Se[be++],he-=3;he&&(Ae[S++]=Se[be++],he>1&&(Ae[S++]=Se[be++]))}else{be=S-ve;do Ae[S++]=Ae[be++],Ae[S++]=Ae[be++],Ae[S++]=Ae[be++],he-=3;while(he>2);he&&(Ae[S++]=Ae[be++],he>1&&(Ae[S++]=Ae[be++]))}}else if(ge&64){w.msg="invalid distance code",Me.mode=C;break e}else{fe=le[(fe&65535)+(re&(1<<ge)-1)];continue i}break}}else if(ge&64)if(ge&32){Me.mode=E;break e}else{w.msg="invalid literal/length code",Me.mode=C;break e}else{fe=ae[(fe&65535)+(re&(1<<ge)-1)];continue t}break}}while(M<x&&S<_);he=oe>>3,M-=he,oe-=he<<3,re&=(1<<oe)-1,w.next_in=M,w.next_out=S,w.avail_in=M<x?5+(x-M):5-(M-x),w.avail_out=S<_?257+(_-S):257-(S-_),Me.hold=re,Me.bits=oe},inffast}var inftrees,hasRequiredInftrees;function requireInftrees(){if(hasRequiredInftrees)return inftrees;hasRequiredInftrees=1;const C=15,E=852,w=592,R=0,M=1,x=2,S=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),T=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),_=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),D=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);return inftrees=(Y,ee,ie,ne,re,oe,ae,le)=>{const de=le.bits;let me=0,fe=0,ge=0,he=0,ve=0,be=0,Se=0,Re=0,Ae=0,Me=0,Be,Qe,Pe,je,Dt,Xe=null,zt;const xe=new Uint16Array(C+1),$e=new Uint16Array(C+1);let We=null,He,Je,Rt;for(me=0;me<=C;me++)xe[me]=0;for(fe=0;fe<ne;fe++)xe[ee[ie+fe]]++;for(ve=de,he=C;he>=1&&xe[he]===0;he--);if(ve>he&&(ve=he),he===0)return re[oe++]=1<<24|64<<16|0,re[oe++]=1<<24|64<<16|0,le.bits=1,0;for(ge=1;ge<he&&xe[ge]===0;ge++);for(ve<ge&&(ve=ge),Re=1,me=1;me<=C;me++)if(Re<<=1,Re-=xe[me],Re<0)return-1;if(Re>0&&(Y===R||he!==1))return-1;for($e[1]=0,me=1;me<C;me++)$e[me+1]=$e[me]+xe[me];for(fe=0;fe<ne;fe++)ee[ie+fe]!==0&&(ae[$e[ee[ie+fe]]++]=fe);if(Y===R?(Xe=We=ae,zt=20):Y===M?(Xe=S,We=T,zt=257):(Xe=_,We=D,zt=0),Me=0,fe=0,me=ge,Dt=oe,be=ve,Se=0,Pe=-1,Ae=1<<ve,je=Ae-1,Y===M&&Ae>E||Y===x&&Ae>w)return 1;for(;;){He=me-Se,ae[fe]+1<zt?(Je=0,Rt=ae[fe]):ae[fe]>=zt?(Je=We[ae[fe]-zt],Rt=Xe[ae[fe]-zt]):(Je=96,Rt=0),Be=1<<me-Se,Qe=1<<be,ge=Qe;do Qe-=Be,re[Dt+(Me>>Se)+Qe]=He<<24|Je<<16|Rt|0;while(Qe!==0);for(Be=1<<me-1;Me&Be;)Be>>=1;if(Be!==0?(Me&=Be-1,Me+=Be):Me=0,fe++,--xe[me]===0){if(me===he)break;me=ee[ie+ae[fe]]}if(me>ve&&(Me&je)!==Pe){for(Se===0&&(Se=ve),Dt+=ge,be=me-Se,Re=1<<be;be+Se<he&&(Re-=xe[be+Se],!(Re<=0));)be++,Re<<=1;if(Ae+=1<<be,Y===M&&Ae>E||Y===x&&Ae>w)return 1;Pe=Me&je,re[Pe]=ve<<24|be<<16|Dt-oe|0}}return Me!==0&&(re[Dt+Me]=me-Se<<24|64<<16|0),le.bits=ve,0},inftrees}var hasRequiredInflate$1;function requireInflate$1(){if(hasRequiredInflate$1)return inflate;hasRequiredInflate$1=1;const C=requireAdler32(),E=requireCrc32(),w=requireInffast(),R=requireInftrees(),M=0,x=1,S=2,{Z_FINISH:T,Z_BLOCK:_,Z_TREES:D,Z_OK:Y,Z_STREAM_END:ee,Z_NEED_DICT:ie,Z_STREAM_ERROR:ne,Z_DATA_ERROR:re,Z_MEM_ERROR:oe,Z_BUF_ERROR:ae,Z_DEFLATED:le}=requireConstants$1(),de=16180,me=16181,fe=16182,ge=16183,he=16184,ve=16185,be=16186,Se=16187,Re=16188,Ae=16189,Me=16190,Be=16191,Qe=16192,Pe=16193,je=16194,Dt=16195,Xe=16196,zt=16197,xe=16198,$e=16199,We=16200,He=16201,Je=16202,Rt=16203,jt=16204,hi=16205,Jt=16206,si=16207,ri=16208,ni=16209,Pi=16210,Ci=16211,qi=852,vi=592,Ki=15,Vi=Ie=>(Ie>>>24&255)+(Ie>>>8&65280)+((Ie&65280)<<8)+((Ie&255)<<24);function zi(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const xi=Ie=>{if(!Ie)return 1;const Ye=Ie.state;return!Ye||Ye.strm!==Ie||Ye.mode<de||Ye.mode>Ci?1:0},Di=Ie=>{if(xi(Ie))return ne;const Ye=Ie.state;return Ie.total_in=Ie.total_out=Ye.total=0,Ie.msg="",Ye.wrap&&(Ie.adler=Ye.wrap&1),Ye.mode=de,Ye.last=0,Ye.havedict=0,Ye.flags=-1,Ye.dmax=32768,Ye.head=null,Ye.hold=0,Ye.bits=0,Ye.lencode=Ye.lendyn=new Int32Array(qi),Ye.distcode=Ye.distdyn=new Int32Array(vi),Ye.sane=1,Ye.back=-1,Y},bi=Ie=>{if(xi(Ie))return ne;const Ye=Ie.state;return Ye.wsize=0,Ye.whave=0,Ye.wnext=0,Di(Ie)},mi=(Ie,Ye)=>{let Ce;if(xi(Ie))return ne;const ke=Ie.state;return Ye<0?(Ce=0,Ye=-Ye):(Ce=(Ye>>4)+5,Ye<48&&(Ye&=15)),Ye&&(Ye<8||Ye>15)?ne:(ke.window!==null&&ke.wbits!==Ye&&(ke.window=null),ke.wrap=Ce,ke.wbits=Ye,bi(Ie))},Oi=(Ie,Ye)=>{if(!Ie)return ne;const Ce=new zi;Ie.state=Ce,Ce.strm=Ie,Ce.window=null,Ce.mode=de;const ke=mi(Ie,Ye);return ke!==Y&&(Ie.state=null),ke},Bi=Ie=>Oi(Ie,Ki);let Ji=!0,Bt,it;const ti=Ie=>{if(Ji){Bt=new Int32Array(512),it=new Int32Array(32);let Ye=0;for(;Ye<144;)Ie.lens[Ye++]=8;for(;Ye<256;)Ie.lens[Ye++]=9;for(;Ye<280;)Ie.lens[Ye++]=7;for(;Ye<288;)Ie.lens[Ye++]=8;for(R(x,Ie.lens,0,288,Bt,0,Ie.work,{bits:9}),Ye=0;Ye<32;)Ie.lens[Ye++]=5;R(S,Ie.lens,0,32,it,0,Ie.work,{bits:5}),Ji=!1}Ie.lencode=Bt,Ie.lenbits=9,Ie.distcode=it,Ie.distbits=5},Ee=(Ie,Ye,Ce,ke)=>{let Ne;const Le=Ie.state;return Le.window===null&&(Le.wsize=1<<Le.wbits,Le.wnext=0,Le.whave=0,Le.window=new Uint8Array(Le.wsize)),ke>=Le.wsize?(Le.window.set(Ye.subarray(Ce-Le.wsize,Ce),0),Le.wnext=0,Le.whave=Le.wsize):(Ne=Le.wsize-Le.wnext,Ne>ke&&(Ne=ke),Le.window.set(Ye.subarray(Ce-ke,Ce-ke+Ne),Le.wnext),ke-=Ne,ke?(Le.window.set(Ye.subarray(Ce-ke,Ce),0),Le.wnext=ke,Le.whave=Le.wsize):(Le.wnext+=Ne,Le.wnext===Le.wsize&&(Le.wnext=0),Le.whave<Le.wsize&&(Le.whave+=Ne))),0},ct=(Ie,Ye)=>{let Ce,ke,Ne,Le,ai,et,Kt,qe,Ge,pe,Ve,we,ze,Ze,$t=0,ii,Yt,Ni,pi,qn,Jn,Ti,_i;const Ei=new Uint8Array(4);let un,gn;const Na=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(xi(Ie)||!Ie.output||!Ie.input&&Ie.avail_in!==0)return ne;Ce=Ie.state,Ce.mode===Be&&(Ce.mode=Qe),ai=Ie.next_out,Ne=Ie.output,Kt=Ie.avail_out,Le=Ie.next_in,ke=Ie.input,et=Ie.avail_in,qe=Ce.hold,Ge=Ce.bits,pe=et,Ve=Kt,_i=Y;e:for(;;)switch(Ce.mode){case de:if(Ce.wrap===0){Ce.mode=Qe;break}for(;Ge<16;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if(Ce.wrap&2&&qe===35615){Ce.wbits===0&&(Ce.wbits=15),Ce.check=0,Ei[0]=qe&255,Ei[1]=qe>>>8&255,Ce.check=E(Ce.check,Ei,2,0),qe=0,Ge=0,Ce.mode=me;break}if(Ce.head&&(Ce.head.done=!1),!(Ce.wrap&1)||(((qe&255)<<8)+(qe>>8))%31){Ie.msg="incorrect header check",Ce.mode=ni;break}if((qe&15)!==le){Ie.msg="unknown compression method",Ce.mode=ni;break}if(qe>>>=4,Ge-=4,Ti=(qe&15)+8,Ce.wbits===0&&(Ce.wbits=Ti),Ti>15||Ti>Ce.wbits){Ie.msg="invalid window size",Ce.mode=ni;break}Ce.dmax=1<<Ce.wbits,Ce.flags=0,Ie.adler=Ce.check=1,Ce.mode=qe&512?Ae:Be,qe=0,Ge=0;break;case me:for(;Ge<16;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if(Ce.flags=qe,(Ce.flags&255)!==le){Ie.msg="unknown compression method",Ce.mode=ni;break}if(Ce.flags&57344){Ie.msg="unknown header flags set",Ce.mode=ni;break}Ce.head&&(Ce.head.text=qe>>8&1),Ce.flags&512&&Ce.wrap&4&&(Ei[0]=qe&255,Ei[1]=qe>>>8&255,Ce.check=E(Ce.check,Ei,2,0)),qe=0,Ge=0,Ce.mode=fe;case fe:for(;Ge<32;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}Ce.head&&(Ce.head.time=qe),Ce.flags&512&&Ce.wrap&4&&(Ei[0]=qe&255,Ei[1]=qe>>>8&255,Ei[2]=qe>>>16&255,Ei[3]=qe>>>24&255,Ce.check=E(Ce.check,Ei,4,0)),qe=0,Ge=0,Ce.mode=ge;case ge:for(;Ge<16;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}Ce.head&&(Ce.head.xflags=qe&255,Ce.head.os=qe>>8),Ce.flags&512&&Ce.wrap&4&&(Ei[0]=qe&255,Ei[1]=qe>>>8&255,Ce.check=E(Ce.check,Ei,2,0)),qe=0,Ge=0,Ce.mode=he;case he:if(Ce.flags&1024){for(;Ge<16;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}Ce.length=qe,Ce.head&&(Ce.head.extra_len=qe),Ce.flags&512&&Ce.wrap&4&&(Ei[0]=qe&255,Ei[1]=qe>>>8&255,Ce.check=E(Ce.check,Ei,2,0)),qe=0,Ge=0}else Ce.head&&(Ce.head.extra=null);Ce.mode=ve;case ve:if(Ce.flags&1024&&(we=Ce.length,we>et&&(we=et),we&&(Ce.head&&(Ti=Ce.head.extra_len-Ce.length,Ce.head.extra||(Ce.head.extra=new Uint8Array(Ce.head.extra_len)),Ce.head.extra.set(ke.subarray(Le,Le+we),Ti)),Ce.flags&512&&Ce.wrap&4&&(Ce.check=E(Ce.check,ke,we,Le)),et-=we,Le+=we,Ce.length-=we),Ce.length))break e;Ce.length=0,Ce.mode=be;case be:if(Ce.flags&2048){if(et===0)break e;we=0;do Ti=ke[Le+we++],Ce.head&&Ti&&Ce.length<65536&&(Ce.head.name+=String.fromCharCode(Ti));while(Ti&&we<et);if(Ce.flags&512&&Ce.wrap&4&&(Ce.check=E(Ce.check,ke,we,Le)),et-=we,Le+=we,Ti)break e}else Ce.head&&(Ce.head.name=null);Ce.length=0,Ce.mode=Se;case Se:if(Ce.flags&4096){if(et===0)break e;we=0;do Ti=ke[Le+we++],Ce.head&&Ti&&Ce.length<65536&&(Ce.head.comment+=String.fromCharCode(Ti));while(Ti&&we<et);if(Ce.flags&512&&Ce.wrap&4&&(Ce.check=E(Ce.check,ke,we,Le)),et-=we,Le+=we,Ti)break e}else Ce.head&&(Ce.head.comment=null);Ce.mode=Re;case Re:if(Ce.flags&512){for(;Ge<16;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if(Ce.wrap&4&&qe!==(Ce.check&65535)){Ie.msg="header crc mismatch",Ce.mode=ni;break}qe=0,Ge=0}Ce.head&&(Ce.head.hcrc=Ce.flags>>9&1,Ce.head.done=!0),Ie.adler=Ce.check=0,Ce.mode=Be;break;case Ae:for(;Ge<32;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}Ie.adler=Ce.check=Vi(qe),qe=0,Ge=0,Ce.mode=Me;case Me:if(Ce.havedict===0)return Ie.next_out=ai,Ie.avail_out=Kt,Ie.next_in=Le,Ie.avail_in=et,Ce.hold=qe,Ce.bits=Ge,ie;Ie.adler=Ce.check=1,Ce.mode=Be;case Be:if(Ye===_||Ye===D)break e;case Qe:if(Ce.last){qe>>>=Ge&7,Ge-=Ge&7,Ce.mode=Jt;break}for(;Ge<3;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}switch(Ce.last=qe&1,qe>>>=1,Ge-=1,qe&3){case 0:Ce.mode=Pe;break;case 1:if(ti(Ce),Ce.mode=$e,Ye===D){qe>>>=2,Ge-=2;break e}break;case 2:Ce.mode=Xe;break;case 3:Ie.msg="invalid block type",Ce.mode=ni}qe>>>=2,Ge-=2;break;case Pe:for(qe>>>=Ge&7,Ge-=Ge&7;Ge<32;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if((qe&65535)!==(qe>>>16^65535)){Ie.msg="invalid stored block lengths",Ce.mode=ni;break}if(Ce.length=qe&65535,qe=0,Ge=0,Ce.mode=je,Ye===D)break e;case je:Ce.mode=Dt;case Dt:if(we=Ce.length,we){if(we>et&&(we=et),we>Kt&&(we=Kt),we===0)break e;Ne.set(ke.subarray(Le,Le+we),ai),et-=we,Le+=we,Kt-=we,ai+=we,Ce.length-=we;break}Ce.mode=Be;break;case Xe:for(;Ge<14;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if(Ce.nlen=(qe&31)+257,qe>>>=5,Ge-=5,Ce.ndist=(qe&31)+1,qe>>>=5,Ge-=5,Ce.ncode=(qe&15)+4,qe>>>=4,Ge-=4,Ce.nlen>286||Ce.ndist>30){Ie.msg="too many length or distance symbols",Ce.mode=ni;break}Ce.have=0,Ce.mode=zt;case zt:for(;Ce.have<Ce.ncode;){for(;Ge<3;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}Ce.lens[Na[Ce.have++]]=qe&7,qe>>>=3,Ge-=3}for(;Ce.have<19;)Ce.lens[Na[Ce.have++]]=0;if(Ce.lencode=Ce.lendyn,Ce.lenbits=7,un={bits:Ce.lenbits},_i=R(M,Ce.lens,0,19,Ce.lencode,0,Ce.work,un),Ce.lenbits=un.bits,_i){Ie.msg="invalid code lengths set",Ce.mode=ni;break}Ce.have=0,Ce.mode=xe;case xe:for(;Ce.have<Ce.nlen+Ce.ndist;){for(;$t=Ce.lencode[qe&(1<<Ce.lenbits)-1],ii=$t>>>24,Yt=$t>>>16&255,Ni=$t&65535,!(ii<=Ge);){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if(Ni<16)qe>>>=ii,Ge-=ii,Ce.lens[Ce.have++]=Ni;else{if(Ni===16){for(gn=ii+2;Ge<gn;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if(qe>>>=ii,Ge-=ii,Ce.have===0){Ie.msg="invalid bit length repeat",Ce.mode=ni;break}Ti=Ce.lens[Ce.have-1],we=3+(qe&3),qe>>>=2,Ge-=2}else if(Ni===17){for(gn=ii+3;Ge<gn;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}qe>>>=ii,Ge-=ii,Ti=0,we=3+(qe&7),qe>>>=3,Ge-=3}else{for(gn=ii+7;Ge<gn;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}qe>>>=ii,Ge-=ii,Ti=0,we=11+(qe&127),qe>>>=7,Ge-=7}if(Ce.have+we>Ce.nlen+Ce.ndist){Ie.msg="invalid bit length repeat",Ce.mode=ni;break}for(;we--;)Ce.lens[Ce.have++]=Ti}}if(Ce.mode===ni)break;if(Ce.lens[256]===0){Ie.msg="invalid code -- missing end-of-block",Ce.mode=ni;break}if(Ce.lenbits=9,un={bits:Ce.lenbits},_i=R(x,Ce.lens,0,Ce.nlen,Ce.lencode,0,Ce.work,un),Ce.lenbits=un.bits,_i){Ie.msg="invalid literal/lengths set",Ce.mode=ni;break}if(Ce.distbits=6,Ce.distcode=Ce.distdyn,un={bits:Ce.distbits},_i=R(S,Ce.lens,Ce.nlen,Ce.ndist,Ce.distcode,0,Ce.work,un),Ce.distbits=un.bits,_i){Ie.msg="invalid distances set",Ce.mode=ni;break}if(Ce.mode=$e,Ye===D)break e;case $e:Ce.mode=We;case We:if(et>=6&&Kt>=258){Ie.next_out=ai,Ie.avail_out=Kt,Ie.next_in=Le,Ie.avail_in=et,Ce.hold=qe,Ce.bits=Ge,w(Ie,Ve),ai=Ie.next_out,Ne=Ie.output,Kt=Ie.avail_out,Le=Ie.next_in,ke=Ie.input,et=Ie.avail_in,qe=Ce.hold,Ge=Ce.bits,Ce.mode===Be&&(Ce.back=-1);break}for(Ce.back=0;$t=Ce.lencode[qe&(1<<Ce.lenbits)-1],ii=$t>>>24,Yt=$t>>>16&255,Ni=$t&65535,!(ii<=Ge);){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if(Yt&&!(Yt&240)){for(pi=ii,qn=Yt,Jn=Ni;$t=Ce.lencode[Jn+((qe&(1<<pi+qn)-1)>>pi)],ii=$t>>>24,Yt=$t>>>16&255,Ni=$t&65535,!(pi+ii<=Ge);){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}qe>>>=pi,Ge-=pi,Ce.back+=pi}if(qe>>>=ii,Ge-=ii,Ce.back+=ii,Ce.length=Ni,Yt===0){Ce.mode=hi;break}if(Yt&32){Ce.back=-1,Ce.mode=Be;break}if(Yt&64){Ie.msg="invalid literal/length code",Ce.mode=ni;break}Ce.extra=Yt&15,Ce.mode=He;case He:if(Ce.extra){for(gn=Ce.extra;Ge<gn;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}Ce.length+=qe&(1<<Ce.extra)-1,qe>>>=Ce.extra,Ge-=Ce.extra,Ce.back+=Ce.extra}Ce.was=Ce.length,Ce.mode=Je;case Je:for(;$t=Ce.distcode[qe&(1<<Ce.distbits)-1],ii=$t>>>24,Yt=$t>>>16&255,Ni=$t&65535,!(ii<=Ge);){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if(!(Yt&240)){for(pi=ii,qn=Yt,Jn=Ni;$t=Ce.distcode[Jn+((qe&(1<<pi+qn)-1)>>pi)],ii=$t>>>24,Yt=$t>>>16&255,Ni=$t&65535,!(pi+ii<=Ge);){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}qe>>>=pi,Ge-=pi,Ce.back+=pi}if(qe>>>=ii,Ge-=ii,Ce.back+=ii,Yt&64){Ie.msg="invalid distance code",Ce.mode=ni;break}Ce.offset=Ni,Ce.extra=Yt&15,Ce.mode=Rt;case Rt:if(Ce.extra){for(gn=Ce.extra;Ge<gn;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}Ce.offset+=qe&(1<<Ce.extra)-1,qe>>>=Ce.extra,Ge-=Ce.extra,Ce.back+=Ce.extra}if(Ce.offset>Ce.dmax){Ie.msg="invalid distance too far back",Ce.mode=ni;break}Ce.mode=jt;case jt:if(Kt===0)break e;if(we=Ve-Kt,Ce.offset>we){if(we=Ce.offset-we,we>Ce.whave&&Ce.sane){Ie.msg="invalid distance too far back",Ce.mode=ni;break}we>Ce.wnext?(we-=Ce.wnext,ze=Ce.wsize-we):ze=Ce.wnext-we,we>Ce.length&&(we=Ce.length),Ze=Ce.window}else Ze=Ne,ze=ai-Ce.offset,we=Ce.length;we>Kt&&(we=Kt),Kt-=we,Ce.length-=we;do Ne[ai++]=Ze[ze++];while(--we);Ce.length===0&&(Ce.mode=We);break;case hi:if(Kt===0)break e;Ne[ai++]=Ce.length,Kt--,Ce.mode=We;break;case Jt:if(Ce.wrap){for(;Ge<32;){if(et===0)break e;et--,qe|=ke[Le++]<<Ge,Ge+=8}if(Ve-=Kt,Ie.total_out+=Ve,Ce.total+=Ve,Ce.wrap&4&&Ve&&(Ie.adler=Ce.check=Ce.flags?E(Ce.check,Ne,Ve,ai-Ve):C(Ce.check,Ne,Ve,ai-Ve)),Ve=Kt,Ce.wrap&4&&(Ce.flags?qe:Vi(qe))!==Ce.check){Ie.msg="incorrect data check",Ce.mode=ni;break}qe=0,Ge=0}Ce.mode=si;case si:if(Ce.wrap&&Ce.flags){for(;Ge<32;){if(et===0)break e;et--,qe+=ke[Le++]<<Ge,Ge+=8}if(Ce.wrap&4&&qe!==(Ce.total&4294967295)){Ie.msg="incorrect length check",Ce.mode=ni;break}qe=0,Ge=0}Ce.mode=ri;case ri:_i=ee;break e;case ni:_i=re;break e;case Pi:return oe;case Ci:default:return ne}return Ie.next_out=ai,Ie.avail_out=Kt,Ie.next_in=Le,Ie.avail_in=et,Ce.hold=qe,Ce.bits=Ge,(Ce.wsize||Ve!==Ie.avail_out&&Ce.mode<ni&&(Ce.mode<Jt||Ye!==T))&&Ee(Ie,Ie.output,Ie.next_out,Ve-Ie.avail_out),pe-=Ie.avail_in,Ve-=Ie.avail_out,Ie.total_in+=pe,Ie.total_out+=Ve,Ce.total+=Ve,Ce.wrap&4&&Ve&&(Ie.adler=Ce.check=Ce.flags?E(Ce.check,Ne,Ve,Ie.next_out-Ve):C(Ce.check,Ne,Ve,Ie.next_out-Ve)),Ie.data_type=Ce.bits+(Ce.last?64:0)+(Ce.mode===Be?128:0)+(Ce.mode===$e||Ce.mode===je?256:0),(pe===0&&Ve===0||Ye===T)&&_i===Y&&(_i=ae),_i},dt=Ie=>{if(xi(Ie))return ne;let Ye=Ie.state;return Ye.window&&(Ye.window=null),Ie.state=null,Y},St=(Ie,Ye)=>{if(xi(Ie))return ne;const Ce=Ie.state;return Ce.wrap&2?(Ce.head=Ye,Ye.done=!1,Y):ne},ft=(Ie,Ye)=>{const Ce=Ye.length;let ke,Ne,Le;return xi(Ie)||(ke=Ie.state,ke.wrap!==0&&ke.mode!==Me)?ne:ke.mode===Me&&(Ne=1,Ne=C(Ne,Ye,Ce,0),Ne!==ke.check)?re:(Le=Ee(Ie,Ye,Ce,Ce),Le?(ke.mode=Pi,oe):(ke.havedict=1,Y))};return inflate.inflateReset=bi,inflate.inflateReset2=mi,inflate.inflateResetKeep=Di,inflate.inflateInit=Bi,inflate.inflateInit2=Oi,inflate.inflate=ct,inflate.inflateEnd=dt,inflate.inflateGetHeader=St,inflate.inflateSetDictionary=ft,inflate.inflateInfo="pako inflate (from Nodeca project)",inflate}var gzheader,hasRequiredGzheader;function requireGzheader(){if(hasRequiredGzheader)return gzheader;hasRequiredGzheader=1;function C(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return gzheader=C,gzheader}var hasRequiredInflate;function requireInflate(){if(hasRequiredInflate)return inflate$1;hasRequiredInflate=1;const C=requireInflate$1(),E=requireCommon(),w=requireStrings(),R=requireMessages(),M=requireZstream(),x=requireGzheader(),S=Object.prototype.toString,{Z_NO_FLUSH:T,Z_FINISH:_,Z_OK:D,Z_STREAM_END:Y,Z_NEED_DICT:ee,Z_STREAM_ERROR:ie,Z_DATA_ERROR:ne,Z_MEM_ERROR:re}=requireConstants$1();function oe(de){this.options=E.assign({chunkSize:1024*64,windowBits:15,to:""},de||{});const me=this.options;me.raw&&me.windowBits>=0&&me.windowBits<16&&(me.windowBits=-me.windowBits,me.windowBits===0&&(me.windowBits=-15)),me.windowBits>=0&&me.windowBits<16&&!(de&&de.windowBits)&&(me.windowBits+=32),me.windowBits>15&&me.windowBits<48&&(me.windowBits&15||(me.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;let fe=C.inflateInit2(this.strm,me.windowBits);if(fe!==D)throw new Error(R[fe]);if(this.header=new x,C.inflateGetHeader(this.strm,this.header),me.dictionary&&(typeof me.dictionary=="string"?me.dictionary=w.string2buf(me.dictionary):S.call(me.dictionary)==="[object ArrayBuffer]"&&(me.dictionary=new Uint8Array(me.dictionary)),me.raw&&(fe=C.inflateSetDictionary(this.strm,me.dictionary),fe!==D)))throw new Error(R[fe])}oe.prototype.push=function(de,me){const fe=this.strm,ge=this.options.chunkSize,he=this.options.dictionary;let ve,be,Se;if(this.ended)return!1;for(me===~~me?be=me:be=me===!0?_:T,S.call(de)==="[object ArrayBuffer]"?fe.input=new Uint8Array(de):fe.input=de,fe.next_in=0,fe.avail_in=fe.input.length;;){for(fe.avail_out===0&&(fe.output=new Uint8Array(ge),fe.next_out=0,fe.avail_out=ge),ve=C.inflate(fe,be),ve===ee&&he&&(ve=C.inflateSetDictionary(fe,he),ve===D?ve=C.inflate(fe,be):ve===ne&&(ve=ee));fe.avail_in>0&&ve===Y&&fe.state.wrap>0&&de[fe.next_in]!==0;)C.inflateReset(fe),ve=C.inflate(fe,be);switch(ve){case ie:case ne:case ee:case re:return this.onEnd(ve),this.ended=!0,!1}if(Se=fe.avail_out,fe.next_out&&(fe.avail_out===0||ve===Y))if(this.options.to==="string"){let Re=w.utf8border(fe.output,fe.next_out),Ae=fe.next_out-Re,Me=w.buf2string(fe.output,Re);fe.next_out=Ae,fe.avail_out=ge-Ae,Ae&&fe.output.set(fe.output.subarray(Re,Re+Ae),0),this.onData(Me)}else this.onData(fe.output.length===fe.next_out?fe.output:fe.output.subarray(0,fe.next_out));if(!(ve===D&&Se===0)){if(ve===Y)return ve=C.inflateEnd(this.strm),this.onEnd(ve),this.ended=!0,!0;if(fe.avail_in===0)break}}return!0},oe.prototype.onData=function(de){this.chunks.push(de)},oe.prototype.onEnd=function(de){de===D&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=E.flattenChunks(this.chunks)),this.chunks=[],this.err=de,this.msg=this.strm.msg};function ae(de,me){const fe=new oe(me);if(fe.push(de),fe.err)throw fe.msg||R[fe.err];return fe.result}function le(de,me){return me=me||{},me.raw=!0,ae(de,me)}return inflate$1.Inflate=oe,inflate$1.inflate=ae,inflate$1.inflateRaw=le,inflate$1.ungzip=ae,inflate$1.constants=requireConstants$1(),inflate$1}var hasRequiredPako;function requirePako(){if(hasRequiredPako)return pako;hasRequiredPako=1;const{Deflate:C,deflate:E,deflateRaw:w,gzip:R}=requireDeflate(),{Inflate:M,inflate:x,inflateRaw:S,ungzip:T}=requireInflate(),_=requireConstants$1();return pako.Deflate=C,pako.deflate=E,pako.deflateRaw=w,pako.gzip=R,pako.Inflate=M,pako.inflate=x,pako.inflateRaw=S,pako.ungzip=T,pako.constants=_,pako}var hasRequiredZLIBTextCompressor;function requireZLIBTextCompressor(){if(hasRequiredZLIBTextCompressor)return ZLIBTextCompressor;hasRequiredZLIBTextCompressor=1,Object.defineProperty(ZLIBTextCompressor,"__esModule",{value:!0});const C=requirePako();let E=class hu{constructor(R){this.logger=R}compress(R,M){if(M.length>0){const S=Math.min(M.length,hu.MAX_DICTIONARY_SIZE);M=M.slice(0,S)}const x={memLevel:hu.Z_MEM_LEVEL,dictionary:M};return C.deflateRaw(R,x)}decompress(R,M){if(M.length>0){const T=Math.min(M.length,hu.MAX_DICTIONARY_SIZE);M=M.slice(0,T)}const x={to:"string",dictionary:M,chunkSize:4096};let S="";try{S=C.inflateRaw(R,x)}catch(T){this.logger.error(`failed to decompress the string with error: [${T}]`)}return S}};return ZLIBTextCompressor.default=E,E.Z_MEM_LEVEL=9,E.MAX_DICTIONARY_SIZE=31744,ZLIBTextCompressor}var SignalingClientSubscribe={},hasRequiredSignalingClientSubscribe;function requireSignalingClientSubscribe(){if(hasRequiredSignalingClientSubscribe)return SignalingClientSubscribe;hasRequiredSignalingClientSubscribe=1,Object.defineProperty(SignalingClientSubscribe,"__esModule",{value:!0});let C=class{constructor(E,w,R,M,x,S,T,_,D,Y){this.attendeeId=E,this.sdpOffer=w,this.audioHost=R,this.audioMuted=M,this.audioCheckin=x,this.receiveStreamIds=S,this.localVideoEnabled=T,this.videoStreamDescriptions=_,this.connectionTypeHasVideo=D,this.compressedSdpOffer=Y,this.videoSubscriptionConfiguration=[]}};return SignalingClientSubscribe.default=C,SignalingClientSubscribe}var VideoPreferences={},hasRequiredVideoPreferences;function requireVideoPreferences(){if(hasRequiredVideoPreferences)return VideoPreferences;hasRequiredVideoPreferences=1;var C=VideoPreferences&&VideoPreferences.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(VideoPreferences,"__esModule",{value:!0}),VideoPreferences.VideoPreferences=VideoPreferences.MutableVideoPreferences=VideoPreferences.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration=void 0;const E=C(requireSignalingClientVideoSubscriptionConfiguration());function w(T,_,D){if(T.transceiverController.getMidForGroupId===void 0||T.videoStreamIndex.attendeeIdForGroupId===void 0||D===void 0)return[];const Y=new Array,ee=new Map,ie=new Map;for(const ne of _){const re=T.transceiverController.getMidForGroupId(ne);if(re===void 0)continue;const oe=T.videoStreamIndex.attendeeIdForGroupId(ne);ee.set(oe,re),ie.set(oe,ne)}for(const ne of D){const re=new E.default,oe=ee.get(ne.attendeeId);oe!==void 0&&(re.mid=oe,re.attendeeId=ne.attendeeId,re.groupId=ie.get(ne.attendeeId),re.priority=Number.MAX_SAFE_INTEGER-ne.priority,re.targetBitrateKbps=ne.targetSizeToBitrateKbps(ne.targetSize),re.qualityAdaptationPreference=ne.degradationPreference,Y.push(re))}return Y}VideoPreferences.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration=w;class R{constructor(_=[]){this.items=_}static default(){return new R([])}[Symbol.iterator](){let _=0;const D=this.items;return{next(){return _<D.length?{done:!1,value:D[_++]}:{done:!0,value:null}}}}first(){return this.items[0]}add(_){this.items.push(_)}replaceFirst(_,D){const Y=this.items.findIndex(D);Y===-1?this.items.push(_):this.has(_)?this.items.splice(Y,1):this.items[Y]=_}remove(_){this.items=this.items.filter(D=>!D.equals(_))}clear(){this.items=[]}isEmpty(){return this.items.length===0}equals(_){if(_===this)return!0;if(_.items.length!==this.items.length)return!1;for(const D of this.items)if(!_.items.some(Y=>Y.equals(D)))return!1;return!0}has(_){return this.items.some(D=>D.equals(_))}some(_){return this.items.some(_)}clone(){return new R([...this.items])}sort(){this.items.sort((_,D)=>_.partialCompare(D))}modify(){return new M(this)}}class M{constructor(_=new R){this.items=_,this.copied=!1}cow(){this.copied||(this.items=this.items.clone(),this.copied=!0)}add(_){this.items.has(_)||(this.cow(),this.items.add(_))}replaceFirst(_,D){this.items.has(_)&&!this.items.some(D)||(this.cow(),this.items.replaceFirst(_,D))}remove(_){this.items.has(_)&&(this.cow(),this.items.remove(_))}some(_){return this.items.some(_)}clear(){this.items.isEmpty()||(this.cow(),this.items.clear())}build(){return this.copied&&this.items.sort(),this.copied=!1,this.items}}class x{constructor(_){this.builder=_}add(_){this.builder.add(_)}replaceFirst(_,D){this.builder.replaceFirst(_,D)}remove(_){this.builder.remove(_)}some(_){return this.builder.some(_)}clear(){this.builder.clear()}build(){return new S(this.builder.build())}}VideoPreferences.MutableVideoPreferences=x;let S=class Wd{constructor(_){this.items=_}static prepare(){return new x(new M)}static default(){return new Wd(R.default())}[Symbol.iterator](){return this.items[Symbol.iterator]()}highestPriority(){var _;return(_=this.items.first())===null||_===void 0?void 0:_.priority}sorted(){return this.items[Symbol.iterator]()}equals(_){return _===this||this.items.equals(_.items)}modify(){return new x(this.items.modify())}some(_){return this.items.some(_)}isEmpty(){return this.items.isEmpty()}clone(){const _=Wd.prepare();for(const D of this.items)_.add(D.clone());return _.build()}};return VideoPreferences.VideoPreferences=S,VideoPreferences.default=S,VideoPreferences}var hasRequiredSubscribeAndReceiveSubscribeAckTask;function requireSubscribeAndReceiveSubscribeAckTask(){if(hasRequiredSubscribeAndReceiveSubscribeAckTask)return SubscribeAndReceiveSubscribeAckTask;hasRequiredSubscribeAndReceiveSubscribeAckTask=1;var C=SubscribeAndReceiveSubscribeAckTask&&SubscribeAndReceiveSubscribeAckTask.__awaiter||function(ne,re,oe,ae){function le(de){return de instanceof oe?de:new oe(function(me){me(de)})}return new(oe||(oe=Promise))(function(de,me){function fe(ve){try{he(ae.next(ve))}catch(be){me(be)}}function ge(ve){try{he(ae.throw(ve))}catch(be){me(be)}}function he(ve){ve.done?de(ve.value):le(ve.value).then(fe,ge)}he((ae=ae.apply(ne,re||[])).next())})},E=SubscribeAndReceiveSubscribeAckTask&&SubscribeAndReceiveSubscribeAckTask.__importDefault||function(ne){return ne&&ne.__esModule?ne:{default:ne}};Object.defineProperty(SubscribeAndReceiveSubscribeAckTask,"__esModule",{value:!0});const w=E(requireMeetingSessionStatus()),R=E(requireMeetingSessionStatusCode()),M=E(requireSDP()),x=E(requireZLIBTextCompressor()),S=requireServerSideNetworkAdaption(),T=E(requireSignalingClientEventType()),_=E(requireSignalingClientSubscribe()),D=requireSignalingProtocol(),Y=requireVideoPreferences(),ee=E(requireBaseTask());let ie=class extends ee.default{constructor(ne){super(ne.logger),this.context=ne,this.taskName="SubscribeAndReceiveSubscribeAckTask",this.taskCanceler=null,this.textCompressor=new x.default(ne.logger)}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return C(this,void 0,void 0,function*(){let ne="";if(this.context.peer&&this.context.peer.localDescription&&(ne=new M.default(this.context.peer.localDescription.sdp).withUnifiedPlanFormat().sdp),!this.context.enableSimulcast){let ge=0,he=0;this.context.videoCaptureAndEncodeParameter&&(ge=this.context.videoCaptureAndEncodeParameter.captureFrameRate(),he=this.context.videoCaptureAndEncodeParameter.encodeBitrates()[0]);const ve={rid:"hi",maxBitrate:he*1e3,maxFramerate:ge,active:!0};this.context.videoStreamIndex.integrateUplinkPolicyDecision([ve])}const re=this.fixUpSubscriptionOrder(ne,this.context.videoSubscriptions),oe=this.context.videoDuplexMode===D.SdkStreamServiceType.TX||this.context.videoDuplexMode===D.SdkStreamServiceType.DUPLEX;let ae,le=ne;if((this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension===void 0||!this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension())&&(le=new M.default(le).withoutDependencyDescriptorRtpHeaderExtension().sdp),this.context.serverSupportsCompression){const ge=this.context.previousSdpOffer?this.context.previousSdpOffer.sdp:"";ae=this.textCompressor.compress(le,ge),this.context.logger.info(`Compressed the SDP message from ${le.length} to ${ae.length} bytes.`),ne=""}this.context.previousSdpOffer=new M.default(ne);const de=new _.default(this.context.meetingSessionConfiguration.credentials.attendeeId,ne,this.context.meetingSessionConfiguration.urls.audioHostURL,this.context.realtimeController.realtimeIsLocalAudioMuted(),!1,re,oe,this.context.videoStreamIndex.localStreamDescriptions(),!0,ae);this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption!==void 0&&!S.serverSideNetworkAdaptionIsNoneOrDefault(this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption())&&this.context.videoDownlinkBandwidthPolicy.getVideoPreferences!==void 0&&(de.videoSubscriptionConfiguration=Y.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration(this.context,re.map(ge=>ge===0?0:this.context.videoStreamIndex.groupIdForStreamId(ge)),this.context.videoDownlinkBandwidthPolicy.getVideoPreferences())),this.context.logger.info(`sending subscribe: ${JSON.stringify(de)}`),this.context.signalingClient.subscribe(de);const me=yield this.receiveSubscribeAck();this.context.logger.info(`got subscribe ack: ${JSON.stringify(me)}`);let fe="";me.compressedSdpAnswer&&me.compressedSdpAnswer.length?(fe=this.textCompressor.decompress(me.compressedSdpAnswer,this.context.previousSdpAnswerAsString),fe.length===0&&(this.context.sdpAnswer="",this.context.previousSdpAnswerAsString="",this.logAndThrow("Error occurred while trying to decompress the SDP answer.")),this.context.logger.info(`Decompressed the SDP message from ${me.compressedSdpAnswer.length} to ${fe.length} bytes.`),this.context.sdpAnswer=fe):this.context.sdpAnswer=me.sdpAnswer,this.context.previousSdpAnswerAsString=this.context.sdpAnswer,this.context.videoStreamIndex.integrateSubscribeAckFrame(me)})}fixUpSubscriptionOrder(ne,re){if(this.context.transceiverController.getMidForStreamId===void 0)return re;const oe=new Map;for(const de of re){const me=this.context.transceiverController.getMidForStreamId(de);if(me===void 0){de!==0&&this.logger.warn(`Could not find MID for stream ID: ${de}`);continue}oe.set(me,de)}const ae=new M.default(ne).mediaSections(),le=[];for(const de of ae)if(de.mediaType==="video")if(de.direction==="recvonly"){const me=oe.get(de.mid);if(me===void 0){this.logger.warn(`Could not find stream ID for MID: ${de.mid}`);continue}le.push(me)}else le.push(0);return this.logger.info(`Fixed up ${JSON.stringify(re)} to ${JSON.stringify(le)} (may be same))}`),le}receiveSubscribeAck(){return new Promise((ne,re)=>{const oe=this.context;class ae{constructor(me){this.signalingClient=me}cancel(){this.signalingClient.removeObserver(this),re(new Error("SubscribeAndReceiveSubscribeAckTask got canceled while waiting for SdkSubscribeAckFrame"))}handleSignalingClientEvent(me){if(me.isConnectionTerminated()){const ge=`SubscribeAndReceiveSubscribeAckTask connection was terminated with code ${me.closeCode} and reason: ${me.closeReason}`;oe.logger.warn(ge);let he=R.default.TaskFailed;me.closeCode>=4500&&me.closeCode<4600&&(he=R.default.SignalingInternalServerError),oe.audioVideoController.handleMeetingSessionStatus(new w.default(he),new Error(ge));return}if(me.type!==T.default.ReceivedSignalFrame||me.message.type!==D.SdkSignalFrame.Type.SUBSCRIBE_ACK)return;this.signalingClient.removeObserver(this);const fe=me.message.suback;ne(fe)}}const le=new ae(this.context.signalingClient);this.context.signalingClient.registerObserver(le),this.taskCanceler=le})}};return SubscribeAndReceiveSubscribeAckTask.default=ie,SubscribeAndReceiveSubscribeAckTask}var TimeoutTask={},hasRequiredTimeoutTask;function requireTimeoutTask(){if(hasRequiredTimeoutTask)return TimeoutTask;hasRequiredTimeoutTask=1;var C=TimeoutTask&&TimeoutTask.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=TimeoutTask&&TimeoutTask.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(TimeoutTask,"__esModule",{value:!0});const w=E(requireTimeoutScheduler()),R=E(requireBaseTask());let M=class extends R.default{constructor(x,S,T){super(x),this.taskToRunBeforeTimeout=S,this.timeoutMs=T,this.taskName=`Timeout${this.timeoutMs}ms`,S.setParent(this)}cancel(){this.logger.info(`canceling timeout task ${this.name()} subtask ${this.taskToRunBeforeTimeout}`),this.taskToRunBeforeTimeout.cancel()}run(){return C(this,void 0,void 0,function*(){const x=new w.default(this.timeoutMs);x.start(()=>{this.logger.info(`timeout reached for task ${this.name()}`),this.taskToRunBeforeTimeout.cancel()});try{yield this.taskToRunBeforeTimeout.run()}finally{x.stop()}this.logger.info(`timeout task ${this.name()} completed`)})}};return TimeoutTask.default=M,TimeoutTask}var WaitForAttendeePresenceTask={},hasRequiredWaitForAttendeePresenceTask;function requireWaitForAttendeePresenceTask(){if(hasRequiredWaitForAttendeePresenceTask)return WaitForAttendeePresenceTask;hasRequiredWaitForAttendeePresenceTask=1;var C=WaitForAttendeePresenceTask&&WaitForAttendeePresenceTask.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=WaitForAttendeePresenceTask&&WaitForAttendeePresenceTask.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(WaitForAttendeePresenceTask,"__esModule",{value:!0});const w=E(requireMeetingSessionStatusCode()),R=E(requireBaseTask());let M=class extends R.default{constructor(x){super(x.logger),this.context=x,this.taskName="WaitForAttendeePresenceTask"}cancel(){if(this.cancelPromise){const x=new Error(`canceling ${this.name()} due to the meeting status code: ${w.default.NoAttendeePresent}`);this.cancelPromise(x),delete this.cancelPromise}}run(){return C(this,void 0,void 0,function*(){const x=this.context.meetingSessionConfiguration.credentials.attendeeId;return new Promise((S,T)=>{const _=(D,Y,ee,ie,ne)=>{x===D&&Y&&(this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(_),S(),delete this.cancelPromise)};this.cancelPromise=D=>{this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(_),T(D)},this.context.realtimeController.realtimeSubscribeToAttendeeIdPresence(_)})})}};return WaitForAttendeePresenceTask.default=M,WaitForAttendeePresenceTask}var DefaultTransceiverController={},RedundantAudioEncoder={},hasRequiredRedundantAudioEncoder;function requireRedundantAudioEncoder(){if(hasRequiredRedundantAudioEncoder)return RedundantAudioEncoder;hasRequiredRedundantAudioEncoder=1,Object.defineProperty(RedundantAudioEncoder,"__esModule",{value:!0});let C=class jn{constructor(){this.maxRedPacketSizeBytes=1024,this.maxAudioPayloadSizeBytes=1e3,this.maxRedTimestampOffset=16384,this.redHeaderSizeBytes=4,this.redLastHeaderSizeBytes=1,this.redPacketizationTime=960,this.redPacketDistance=2,this.maxRedEncodings=2,this.redMaxRecoveryDistance=this.redPacketDistance*this.maxRedEncodings+1,this.maxEncodingHistorySize=10,this.numRedundantEncodings=0,this.redundancyEnabled=!0,this.lossReportInterval=48e3*5,this.maxOutOfOrderPacketDistance=16,this.OPUS_BAD_ARG=-1,this.OPUS_INVALID_PACKET=-4,this.OPUS_MAX_OPUS_FRAMES=48,this.OPUS_MAX_FRAME_SIZE_BYTES=1275,this.encodingHistory=new Array,this.opusPayloadType=0,this.redPayloadType=0,this.initializePacketLogs()}static initializeWorker(){jn.log("Initializing RedundantAudioEncoder");const w=new jn;self.RTCRtpScriptTransformer&&(self.onrtctransform=R=>{R.transformer.options.type==="SenderTransform"?w.setupSenderTransform(R.transformer.readable,R.transformer.writable):R.transformer.options.type==="ReceiverTransform"?w.setupReceiverTransform(R.transformer.readable,R.transformer.writable):R.transformer.options.type==="PassthroughTransform"&&w.setupPassthroughTransform(R.transformer.readable,R.transformer.writable)}),self.onmessage=R=>{R.data.msgType==="StartRedWorker"?(w.setupSenderTransform(R.data.send.readable,R.data.send.writable),w.setupReceiverTransform(R.data.receive.readable,R.data.receive.writable)):R.data.msgType==="PassthroughTransform"?(w.setupPassthroughTransform(R.data.send.readable,R.data.send.writable),w.setupPassthroughTransform(R.data.receive.readable,R.data.receive.writable)):R.data.msgType==="RedPayloadType"?w.setRedPayloadType(R.data.payloadType):R.data.msgType==="OpusPayloadType"?w.setOpusPayloadType(R.data.payloadType):R.data.msgType==="UpdateNumRedundantEncodings"?w.setNumRedundantEncodings(R.data.numRedundantEncodings):R.data.msgType==="Enable"?w.setRedundancyEnabled(!0):R.data.msgType==="Disable"&&w.setRedundancyEnabled(!1)}}static log(w){jn.shouldLog&&self.postMessage({type:"REDWorkerLog",log:`[AudioRed] ${w}`})}static getNumRedundantEncodingsForPacketLoss(w){let R=0,M=!1;return w<=8?R=0:w<=18?R=1:w<=75?R=2:(R=0,M=!0),[R,M]}setupPassthroughTransform(w,R){jn.log("Setting up passthrough transform"),w.pipeTo(R)}setupSenderTransform(w,R){jn.log("Setting up sender RED transform");const M=new TransformStream({transform:this.senderTransform.bind(this)});w.pipeThrough(M).pipeTo(R)}setupReceiverTransform(w,R){jn.log("Setting up receiver RED transform");const M=new TransformStream({transform:this.receivePacketLogTransform.bind(this)});w.pipeThrough(M).pipeTo(R)}setRedPayloadType(w){this.redPayloadType=w,jn.log(`red payload type set to ${this.redPayloadType}`)}setOpusPayloadType(w){this.opusPayloadType=w,jn.log(`opus payload type set to ${this.opusPayloadType}`)}setNumRedundantEncodings(w){this.numRedundantEncodings=w,this.numRedundantEncodings>this.maxRedEncodings&&(this.numRedundantEncodings=this.maxRedEncodings),jn.log(`Updated numRedundantEncodings to ${this.numRedundantEncodings}`)}setRedundancyEnabled(w){this.redundancyEnabled=w,jn.log(`redundancy ${this.redundancyEnabled?"enabled":"disabled"}`)}enqueueAudioFrameIfPayloadSizeIsValid(w,R){w.data.byteLength>this.maxAudioPayloadSizeBytes||R.enqueue(w)}senderTransform(w,R){if(w.getMetadata().payloadType!==this.redPayloadType){this.enqueueAudioFrameIfPayloadSizeIsValid(w,R);return}const M=this.getPrimaryPayload(w.timestamp,w.data);if(!M){this.enqueueAudioFrameIfPayloadSizeIsValid(w,R);return}const x=this.encode(w.timestamp,M);if(!x){this.enqueueAudioFrameIfPayloadSizeIsValid(w,R);return}w.data=x,this.enqueueAudioFrameIfPayloadSizeIsValid(w,R)}getPrimaryPayload(w,R){const M=this.splitEncodings(w,R);return!M||M.length<1?null:M[M.length-1].payload}splitEncodings(w,R,M=!1,x=void 0){const S=new DataView(R);let T=S.byteLength,_=0,D=0,Y=0,ee=0,ie=!1;const ne=new Array,re=new Array,oe=new Array;for(;T>0;)if(ie=(S.getUint8(ee)&128)===0,ie){if((S.getUint8(ee)&127)!==this.opusPayloadType||(_+=this.redLastHeaderSizeBytes,D+=this.redLastHeaderSizeBytes,_>=S.byteLength))return null;Y=S.byteLength-_;break}else{if(T<this.redHeaderSizeBytes)return null;const fe=((S.getUint8(ee+2)&3)<<8)+S.getUint8(ee+3);re.push(fe);const ge=S.getUint16(ee+1)>>2,he=w-ge;oe.push(he),_+=fe+this.redHeaderSizeBytes,D+=this.redHeaderSizeBytes,ee+=this.redHeaderSizeBytes,T-=this.redHeaderSizeBytes}if(!ie)return null;let ae=D;for(let fe=0;fe<oe.length;fe++){const ge=new ArrayBuffer(re[fe]);new Uint8Array(ge).set(new Uint8Array(S.buffer,ae,re[fe]),0);const he={timestamp:oe[fe],payload:ge,isRedundant:!0};M&&(he.hasFec=this.opusPacketHasFec(new DataView(ge),ge.byteLength)),ne.push(he),ae+=re[fe]}const le=S.byteLength-Y,de=new ArrayBuffer(Y);new Uint8Array(de).set(new Uint8Array(S.buffer,le,Y),0);const me={timestamp:w,payload:de,isRedundant:!1,seq:x};return M&&(me.hasFec=this.opusPacketHasFec(new DataView(de),de.byteLength)),ne.push(me),ne}encode(w,R){const M=R.byteLength;if(M===0||M>=this.maxRedPacketSizeBytes||M>=this.maxAudioPayloadSizeBytes)return null;const x=this.numRedundantEncodings;let S=this.redLastHeaderSizeBytes,T=M,_=this.maxAudioPayloadSizeBytes-M-S;const D=new Array,Y=new Array;if(this.redundancyEnabled){let oe=this.uint32WrapAround(w-this.redPacketizationTime*this.redPacketDistance);for(let ae=0;ae<x&&!(this.uint32WrapAround(w-oe)>=this.maxRedTimestampOffset);ae++){let le=oe,de=this.encodingHistory.find(me=>me.timestamp===le);if(de||(le=this.uint32WrapAround(oe-this.redPacketizationTime),de=this.encodingHistory.find(me=>me.timestamp===le)),de){const me=de.payload.byteLength;if(_<this.redHeaderSizeBytes+me)break;_-=this.redHeaderSizeBytes+me,S+=this.redHeaderSizeBytes,T+=me,D.unshift(de.timestamp),Y.unshift(de.payload)}oe-=this.redPacketizationTime*this.redPacketDistance,oe=this.uint32WrapAround(oe)}}const ee=new ArrayBuffer(S+T),ie=new DataView(ee);let ne=0;for(let oe=0;oe<D.length;oe++){const ae=w-D[oe];ie.setUint8(ne,this.opusPayloadType|128),ie.setUint16(ne+1,ae<<2|Y[oe].byteLength>>8),ie.setUint8(ne+3,Y[oe].byteLength&255),ne+=this.redHeaderSizeBytes}ie.setUint8(ne,this.opusPayloadType),ne+=this.redLastHeaderSizeBytes;const re=new Uint8Array(ee);for(let oe=0;oe<Y.length;oe++)re.set(new Uint8Array(Y[oe]),ne),ne+=Y[oe].byteLength;return re.set(new Uint8Array(R),ne),ne+=R.byteLength,ne!==S+T?null:(this.updateEncodingHistory(w,R),ee)}updateEncodingHistory(w,R){for(const x of this.encodingHistory){const S=this.redPacketizationTime*this.redMaxRecoveryDistance;if(w-x.timestamp>=S)this.encodingHistory.shift();else break}const M=new DataView(R);(this.opusPacketIsCeltOnly(M)||this.opusPacketHasVoiceActivity(M,M.byteLength)>0)&&(this.encodingHistory.length+1>this.maxEncodingHistorySize&&(this.encodingHistory.length=0),this.encodingHistory.push({timestamp:w,payload:R}))}initializePacketLogs(){const w=this.maxOutOfOrderPacketDistance+this.redMaxRecoveryDistance;this.primaryPacketLog={window:new Array(w),index:0,windowSize:w},this.redRecoveryLog={window:new Array(w),index:0,windowSize:w},this.fecRecoveryLog={window:new Array(w),index:0,windowSize:w},this.totalAudioPacketsExpected=0,this.totalAudioPacketsLost=0,this.totalAudioPacketsRecoveredRed=0,this.totalAudioPacketsRecoveredFec=0}receivePacketLogTransform(w,R){const M=w.getMetadata();if(M.payloadType!==this.redPayloadType){this.enqueueAudioFrameIfPayloadSizeIsValid(w,R);return}const x=this.splitEncodings(w.timestamp,w.data,!0,M.sequenceNumber);if(!x){this.enqueueAudioFrameIfPayloadSizeIsValid(w,R);return}for(let S=x.length-1;S>=0;S--)this.updateLossStats(x[S])&&(this.updateRedStats(x[S]),this.updateFecStats(x[S]));this.maybeReportLossStats(x[x.length-1].timestamp,M.synchronizationSource),this.enqueueAudioFrameIfPayloadSizeIsValid(w,R)}updateLossStats(w){if(w.isRedundant)return!0;const R=w.timestamp,M=w.seq;if(this.totalAudioPacketsExpected===0)return this.totalAudioPacketsExpected=1,this.newestSequenceNumber=M,this.addTimestamp(this.primaryPacketLog,R),!0;const x=this.int16(M-this.newestSequenceNumber);return x<-this.maxOutOfOrderPacketDistance?!1:(x<0?this.hasTimestamp(this.primaryPacketLog,R)||(this.totalAudioPacketsLost>0&&this.totalAudioPacketsLost--,this.addTimestamp(this.primaryPacketLog,R),this.removeFromRecoveryWindows(R)):x>1&&(this.totalAudioPacketsLost+=x-1),x>0&&(this.totalAudioPacketsExpected+=x,this.newestSequenceNumber=w.seq,this.addTimestamp(this.primaryPacketLog,R)),!0)}updateRedStats(w){if(!w.isRedundant||this.totalAudioPacketsLost===0)return;const R=w.timestamp;this.hasTimestamp(this.primaryPacketLog,R)||(this.hasTimestamp(this.redRecoveryLog,R)||(this.totalAudioPacketsRecoveredRed++,this.addTimestamp(this.redRecoveryLog,R)),this.removeTimestamp(this.fecRecoveryLog,R)&&this.totalAudioPacketsRecoveredFec>0&&this.totalAudioPacketsRecoveredFec--)}updateFecStats(w){if(!w.hasFec||this.totalAudioPacketsLost===0)return;const R=w.timestamp-this.redPacketizationTime;this.hasTimestamp(this.primaryPacketLog,R)||this.hasTimestamp(this.redRecoveryLog,R)||this.hasTimestamp(this.fecRecoveryLog,R)||(this.totalAudioPacketsRecoveredFec++,this.addTimestamp(this.fecRecoveryLog,R))}maybeReportLossStats(w,R){w-this.lastLossReportTimestamp<this.lossReportInterval||(jn.shouldReportStats&&self.postMessage({type:"RedundantAudioEncoderStats",ssrc:R,totalAudioPacketsLost:this.totalAudioPacketsLost,totalAudioPacketsExpected:this.totalAudioPacketsExpected,totalAudioPacketsRecoveredRed:this.totalAudioPacketsRecoveredRed,totalAudioPacketsRecoveredFec:this.totalAudioPacketsRecoveredFec}),this.lastLossReportTimestamp=w)}addTimestamp(w,R){w.window[w.index]=R,w.index=(w.index+1)%w.windowSize}hasTimestamp(w,R){return!!w.window.find(M=>M===R)}removeTimestamp(w,R){const M=w.window.indexOf(R);return M>=0?(w.window[M]=void 0,!0):!1}removeFromRecoveryWindows(w){let R=this.removeTimestamp(this.redRecoveryLog,w);R&&this.totalAudioPacketsRecoveredRed>0&&this.totalAudioPacketsRecoveredRed--,R=this.removeTimestamp(this.fecRecoveryLog,w),R&&this.totalAudioPacketsRecoveredFec>0&&this.totalAudioPacketsRecoveredFec--}uint32WrapAround(w){let R=w;return w>=4294967296?R=w-4294967296:w<0&&(R=4294967296+w),R}int16(w){return w<<16>>16}opusPacketIsCeltOnly(w){return!!(w.getUint8(0)&128)}opusPacketGetSamplesPerFrame(w,R){R=Math.round(R),R=Math.min(Math.max(R,-Math.pow(2,32)),Math.pow(2,32)-1);let M,x;return this.opusPacketIsCeltOnly(w)?(x=w.getUint8(0)>>3&3,M=(R<<x)/400):(w.getUint8(0)&96)===96?M=w.getUint8(0)&8?R/50:R/100:(x=w.getUint8(0)>>3&3,x===3?M=R*60/1e3:M=(R<<x)/100),M}opusNumSilkFrames(w){let R=this.opusPacketGetSamplesPerFrame(w,48e3)/48;switch(R<10&&(R=10),R){case 10:case 20:return 1;case 40:return 2;case 60:return 3;default:return 0}}opusPacketGetNumChannels(w){return w.getUint8(0)&4?2:1}opusParseSize(w,R,M,x){return M<1?(x[0]=-1,-1):w.getUint8(R)<252?(x[0]=w.getUint8(R),1):M<2?(x[0]=-1,-1):(x[0]=4*w.getUint8(R+1)+w.getUint8(R),2)}opusPacketParseImpl(w,R,M,x,S,T,_,D){if(!T||R<0)return this.OPUS_BAD_ARG;if(R===0)return this.OPUS_INVALID_PACKET;let Y,ee,ie=0,ne=!1;const re=w.getUint8(0);x&&(x[0]=re);let oe=R-1,ae=1,le=oe;switch(re&3){case 0:Y=1;break;case 1:if(Y=2,ne=!0,!M){if(oe&1)return this.OPUS_INVALID_PACKET;le=oe/2,T[0][0]=le}break;case 2:if(Y=2,ee=this.opusParseSize(w,ae,oe,T[0]),oe-=ee,T[0][0]<0||T[0][0]>oe)return this.OPUS_INVALID_PACKET;ae+=ee,le=oe-T[0][0];break;default:if(oe<1)return this.OPUS_INVALID_PACKET;const de=w.getUint8(ae++);if(--oe,Y=de&63,Y<=0)return this.OPUS_INVALID_PACKET;if(this.opusPacketGetSamplesPerFrame(w,48e3)*Y>5760)return this.OPUS_INVALID_PACKET;if(de&64){let me,fe;do{if(oe<=0)return this.OPUS_INVALID_PACKET;me=w.getUint8(ae++),--oe,fe=me===255?254:me,oe-=fe,ie+=fe}while(me===255)}if(oe<0)return this.OPUS_INVALID_PACKET;if(ne=!(de&128),ne){if(!M){if(le=Math.trunc(oe/Y),le*Y!==oe)return this.OPUS_INVALID_PACKET;for(let me=0;me<Y-1;++me)T[me][0]=le}}else{le=oe;for(let me=0;me<Y-1;++me){if(ee=this.opusParseSize(w,ae,oe,T[me]),oe-=ee,T[me][0]<0||T[me][0]>oe)return this.OPUS_INVALID_PACKET;ae+=ee,le-=ee+T[me][0]}if(le<0)return this.OPUS_INVALID_PACKET}}if(M){if(ee=this.opusParseSize(w,ae,oe,T[Y-1]),oe-=ee,T[Y-1][0]<0||T[Y-1][0]>oe)return this.OPUS_INVALID_PACKET;if(ae+=ee,ne){if(T[Y-1][0]*Y>oe)return this.OPUS_INVALID_PACKET;for(let de=0;de<Y-1;++de)T[de][0]=T[Y-1][0]}else if(!(ee+T[Y-1][0]<=le))return this.OPUS_INVALID_PACKET}else{if(le>this.OPUS_MAX_FRAME_SIZE_BYTES)return this.OPUS_INVALID_PACKET;T[Y-1][0]=le}_&&(_[0]=ae);for(let de=0;de<Y;++de)S&&(S[de][0]=ae),ae+=T[de][0];return D&&(D[0]=ae+ie),Y}opusPacketParse(w,R,M,x,S,T){return this.opusPacketParseImpl(w,R,!1,M,x,S,T,null)}opusPacketHasVoiceActivity(w,R){if(!w||R<=0)return 0;if(this.opusPacketIsCeltOnly(w))return-1;const M=this.opusNumSilkFrames(w);if(M===0)return-1;const x=new Array(this.OPUS_MAX_OPUS_FRAMES),S=new Array(this.OPUS_MAX_OPUS_FRAMES);for(let _=0;_<this.OPUS_MAX_OPUS_FRAMES;++_)x[_]=[void 0],S[_]=[void 0];const T=this.opusPacketParse(w,R,null,x,S,null);if(T<0)return-1;for(let _=0;_<T;++_)if(!(S[_][0]<1)&&(w.getUint8(x[_][0])>>8-M||this.opusPacketGetNumChannels(w)===2&&w.getUint8(x[_][0])<<M+1>>8-M))return 1;return 0}opusPacketHasFec(w,R){if(!w||R<=0||this.opusPacketIsCeltOnly(w))return!1;const M=new Array(this.OPUS_MAX_OPUS_FRAMES),x=new Array(this.OPUS_MAX_OPUS_FRAMES);for(let _=0;_<this.OPUS_MAX_OPUS_FRAMES;++_)M[_]=[void 0],x[_]=[void 0];if(this.opusPacketParse(w,R,null,M,x,null)<0||x[0][0]<=1)return!1;const S=this.opusNumSilkFrames(w);if(S===0)return!1;const T=this.opusPacketGetNumChannels(w);if(T!==1&&T!==2)return!1;for(let _=0;_<T;_++)if(w.getUint8(M[0][0])&128>>(_+1)*(S+1)-1)return!0;return!1}};return RedundantAudioEncoder.default=C,C.shouldLog=!1,C.shouldReportStats=!1,RedundantAudioEncoder}var RedundantAudioEncoderWorkerCode={},hasRequiredRedundantAudioEncoderWorkerCode;function requireRedundantAudioEncoderWorkerCode(){if(hasRequiredRedundantAudioEncoderWorkerCode)return RedundantAudioEncoderWorkerCode;hasRequiredRedundantAudioEncoderWorkerCode=1,Object.defineProperty(RedundantAudioEncoderWorkerCode,"__esModule",{value:!0});const C=`class RedundantAudioEncoder {
    constructor() {
        // Each payload must be less than 1024 bytes to fit the 10 bit block length
        this.maxRedPacketSizeBytes = 1 << 10;
        // Limit payload to 1000 bytes to handle small MTU. 1000 is chosen because in Chromium-based browsers, writing audio
        // payloads larger than 1000 bytes using the WebRTC Insertable Streams API (which is used to enable dynamic audio
        // redundancy) will cause an error to be thrown and cause audio flow to permanently stop. See
        // https://crbug.com/1248479.
        this.maxAudioPayloadSizeBytes = 1000;
        // Each payload can encode a timestamp delta of 14 bits
        this.maxRedTimestampOffset = 1 << 14;
        // 4 byte RED header
        this.redHeaderSizeBytes = 4;
        // reduced size for last RED header
        this.redLastHeaderSizeBytes = 1;
        // P-Time for Opus 20 msec packets
        // We do not support other p-times or clock rates
        this.redPacketizationTime = 960;
        // distance between redundant payloads, Opus FEC handles a distance of 1
        // TODO(https://issues.amazon.com/issues/ChimeSDKAudio-55):
        // Consider making this dynamic
        this.redPacketDistance = 2;
        // maximum number of redundant payloads per RTP packet
        this.maxRedEncodings = 2;
        // Maximum number of encodings that can be recovered with a single RED packet, assuming the primary and redundant
        // payloads have FEC.
        this.redMaxRecoveryDistance = this.redPacketDistance * this.maxRedEncodings + 1;
        // maximum history of prior payloads to keep
        // generally we will expire old entries based on timestamp
        // this limit is in place just to make sure the history does not
        // grow too large in the case of erroneous timestamp inputs
        this.maxEncodingHistorySize = 10;
        // Current number of encodings we want to send
        // to the remote end. This will be dynamically
        // updated through the setNumEncodingsFromPacketloss API
        this.numRedundantEncodings = 0;
        // Used to enable or disable redundancy
        // in response to very high packet loss events
        this.redundancyEnabled = true;
        // Loss stats are reported to the main thread every 5 seconds.
        // Since timestamp differences between 2 consecutive packets
        // give us the number of samples in each channel, 1 second
        // is equivalent to 48000 samples:
        // P-time * (1000ms/1s)
        // = (960 samples/20ms) * (1000ms/1s)
        // = 48000 samples/s
        this.lossReportInterval = 48000 * 5;
        // Maximum distance of a packet from the most recent packet timestamp
        // that we will consider for recovery.
        this.maxOutOfOrderPacketDistance = 16;
        /**
         * Below are Opus helper methods and constants.
         */
        this.OPUS_BAD_ARG = -1;
        this.OPUS_INVALID_PACKET = -4;
        // Max number of Opus frames in an Opus packet is 48 (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.5).
        this.OPUS_MAX_OPUS_FRAMES = 48;
        // Max number of bytes that any individual Opus frame can have.
        this.OPUS_MAX_FRAME_SIZE_BYTES = 1275;
        this.encodingHistory = new Array();
        this.opusPayloadType = 0;
        this.redPayloadType = 0;
        this.initializePacketLogs();
    }
    /**
     * Creates an instance of RedundantAudioEncoder and sets up callbacks.
     */
    static initializeWorker() {
        RedundantAudioEncoder.log('Initializing RedundantAudioEncoder');
        const encoder = new RedundantAudioEncoder();
        // RED encoding is done using WebRTC Encoded Transform
        // https://github.com/w3c/webrtc-encoded-transform/blob/main/explainer.md
        // Check the DedicatedWorkerGlobalScope for existence of
        // RTCRtpScriptTransformer interface. If exists, then
        // RTCRtpScriptTransform is supported by this browser.
        // @ts-ignore
        if (self.RTCRtpScriptTransformer) {
            // @ts-ignore
            self.onrtctransform = (event) => {
                if (event.transformer.options.type === 'SenderTransform') {
                    encoder.setupSenderTransform(event.transformer.readable, event.transformer.writable);
                }
                else if (event.transformer.options.type === 'ReceiverTransform') {
                    encoder.setupReceiverTransform(event.transformer.readable, event.transformer.writable);
                }
                else if (event.transformer.options.type === 'PassthroughTransform') {
                    encoder.setupPassthroughTransform(event.transformer.readable, event.transformer.writable);
                }
            };
        }
        self.onmessage = (event) => {
            if (event.data.msgType === 'StartRedWorker') {
                encoder.setupSenderTransform(event.data.send.readable, event.data.send.writable);
                encoder.setupReceiverTransform(event.data.receive.readable, event.data.receive.writable);
            }
            else if (event.data.msgType === 'PassthroughTransform') {
                encoder.setupPassthroughTransform(event.data.send.readable, event.data.send.writable);
                encoder.setupPassthroughTransform(event.data.receive.readable, event.data.receive.writable);
            }
            else if (event.data.msgType === 'RedPayloadType') {
                encoder.setRedPayloadType(event.data.payloadType);
            }
            else if (event.data.msgType === 'OpusPayloadType') {
                encoder.setOpusPayloadType(event.data.payloadType);
            }
            else if (event.data.msgType === 'UpdateNumRedundantEncodings') {
                encoder.setNumRedundantEncodings(event.data.numRedundantEncodings);
            }
            else if (event.data.msgType === 'Enable') {
                encoder.setRedundancyEnabled(true);
            }
            else if (event.data.msgType === 'Disable') {
                encoder.setRedundancyEnabled(false);
            }
        };
    }
    /**
     * Post logs to the main thread
     */
    static log(msg) {
        if (RedundantAudioEncoder.shouldLog) {
            // @ts-ignore
            self.postMessage({
                type: 'REDWorkerLog',
                log: \`[AudioRed] \${msg}\`,
            });
        }
    }
    /**
     * Returns the number of encodings based on packetLoss value. This is used by \`DefaultTransceiverController\` to
     * determine when to alert the encoder to update the number of encodings. It also determines if we need to
     * turn off red in cases of very high packet loss to avoid congestion collapse.
     */
    static getNumRedundantEncodingsForPacketLoss(packetLoss) {
        let recommendedRedundantEncodings = 0;
        let shouldTurnOffRed = false;
        if (packetLoss <= 8) {
            recommendedRedundantEncodings = 0;
        }
        else if (packetLoss <= 18) {
            recommendedRedundantEncodings = 1;
        }
        else if (packetLoss <= 75) {
            recommendedRedundantEncodings = 2;
        }
        else {
            recommendedRedundantEncodings = 0;
            shouldTurnOffRed = true;
        }
        return [recommendedRedundantEncodings, shouldTurnOffRed];
    }
    /**
     * Sets up a passthrough (no-op) transform for the given streams.
     */
    setupPassthroughTransform(readable, writable) {
        RedundantAudioEncoder.log('Setting up passthrough transform');
        readable.pipeTo(writable);
    }
    /**
     * Sets up the transform stream and pipes the outgoing encoded audio frames through the transform function.
     */
    setupSenderTransform(readable, writable) {
        RedundantAudioEncoder.log('Setting up sender RED transform');
        const transformStream = new TransformStream({
            transform: this.senderTransform.bind(this),
        });
        readable.pipeThrough(transformStream).pipeTo(writable);
        return;
    }
    /**
     * Sets up the transform stream and pipes the received encoded audio frames through the transform function.
     */
    setupReceiverTransform(readable, writable) {
        RedundantAudioEncoder.log('Setting up receiver RED transform');
        const transformStream = new TransformStream({
            transform: this.receivePacketLogTransform.bind(this),
        });
        readable.pipeThrough(transformStream).pipeTo(writable);
        return;
    }
    /**
     * Set the RED payload type ideally obtained from local offer.
     */
    setRedPayloadType(payloadType) {
        this.redPayloadType = payloadType;
        RedundantAudioEncoder.log(\`red payload type set to \${this.redPayloadType}\`);
    }
    /**
     * Set the opus payload type ideally obtained from local offer.
     */
    setOpusPayloadType(payloadType) {
        this.opusPayloadType = payloadType;
        RedundantAudioEncoder.log(\`opus payload type set to \${this.opusPayloadType}\`);
    }
    /**
     * Set the number of redundant encodings
     */
    setNumRedundantEncodings(numRedundantEncodings) {
        this.numRedundantEncodings = numRedundantEncodings;
        if (this.numRedundantEncodings > this.maxRedEncodings) {
            this.numRedundantEncodings = this.maxRedEncodings;
        }
        RedundantAudioEncoder.log(\`Updated numRedundantEncodings to \${this.numRedundantEncodings}\`);
    }
    /**
     * Enable or disable redundancy in response to
     * high packet loss event.
     */
    setRedundancyEnabled(enabled) {
        this.redundancyEnabled = enabled;
        RedundantAudioEncoder.log(\`redundancy \${this.redundancyEnabled ? 'enabled' : 'disabled'}\`);
    }
    /**
     * Helper function to only enqueue audio frames if they do not exceed the audio payload byte limit imposed by
     * Chromium-based browsers. Chromium will throw an error (https://crbug.com/1248479) if an audio payload larger than
     * 1000 bytes is enqueued. Any controller that attempts to enqueue an audio payload larger than 1000 bytes will
     * encounter this error and will permanently stop sending or receiving audio.
     */
    enqueueAudioFrameIfPayloadSizeIsValid(
    // @ts-ignore
    frame, controller) {
        if (frame.data.byteLength > this.maxAudioPayloadSizeBytes)
            return;
        controller.enqueue(frame);
    }
    /**
     * Receives encoded frames and modifies as needed before sending to transport.
     */
    senderTransform(
    // @ts-ignore
    frame, controller) {
        const frameMetadata = frame.getMetadata();
        // @ts-ignore
        if (frameMetadata.payloadType !== this.redPayloadType) {
            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);
            return;
        }
        const primaryPayloadBuffer = this.getPrimaryPayload(frame.timestamp, frame.data);
        if (!primaryPayloadBuffer) {
            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);
            return;
        }
        const encodedBuffer = this.encode(frame.timestamp, primaryPayloadBuffer);
        /* istanbul ignore next */
        if (!encodedBuffer) {
            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);
            return;
        }
        frame.data = encodedBuffer;
        this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);
        return;
    }
    /**
     * Get the primary payload from encoding
     */
    getPrimaryPayload(primaryTimestamp, frame) {
        const encodings = this.splitEncodings(primaryTimestamp, frame);
        if (!encodings || encodings.length < 1)
            return null;
        return encodings[encodings.length - 1].payload;
    }
    /**
     * Split up the encoding received into primary and redundant encodings
     * These will be ordered oldest to newest which is the same ordering
     * in the RTP red payload.
     */
    splitEncodings(primaryTimestamp, frame, getFecInfo = false, primarySequenceNumber = undefined) {
        // process RED headers (according to RFC 2198)
        //   0                   1                   2                   3
        //   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        //  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        //  |F|   block PT  |  timestamp offset         |   block length    |
        //  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        //
        // last header
        //   0 1 2 3 4 5 6 7
        //  +-+-+-+-+-+-+-+-+
        //  |0|   Block PT  |
        //  +-+-+-+-+-+-+-+-+
        const payload = new DataView(frame);
        let payloadSizeBytes = payload.byteLength;
        let totalPayloadSizeBytes = 0;
        let totalHeaderSizeBytes = 0;
        let primaryPayloadSizeBytes = 0;
        let payloadOffset = 0;
        let gotLastBlock = false;
        const encodings = new Array();
        const redundantEncodingBlockLengths = new Array();
        const redundantEncodingTimestamps = new Array();
        while (payloadSizeBytes > 0) {
            gotLastBlock = (payload.getUint8(payloadOffset) & 0x80) === 0;
            if (gotLastBlock) {
                // Bits 1 through 7 are payload type
                const payloadType = payload.getUint8(payloadOffset) & 0x7f;
                // Unexpected payload type. This is a bad packet.
                if (payloadType !== this.opusPayloadType) {
                    return null;
                }
                totalPayloadSizeBytes += this.redLastHeaderSizeBytes;
                totalHeaderSizeBytes += this.redLastHeaderSizeBytes;
                // Accumulated block lengths are equal to or larger than the buffer, which means there is no primary block. This
                // is a bad packet.
                if (totalPayloadSizeBytes >= payload.byteLength) {
                    return null;
                }
                primaryPayloadSizeBytes = payload.byteLength - totalPayloadSizeBytes;
                break;
            }
            else {
                if (payloadSizeBytes < this.redHeaderSizeBytes) {
                    return null;
                }
                // Bits 22 through 31 are payload length
                const blockLength = ((payload.getUint8(payloadOffset + 2) & 0x03) << 8) + payload.getUint8(payloadOffset + 3);
                redundantEncodingBlockLengths.push(blockLength);
                const timestampOffset = payload.getUint16(payloadOffset + 1) >> 2;
                const timestamp = primaryTimestamp - timestampOffset;
                redundantEncodingTimestamps.push(timestamp);
                totalPayloadSizeBytes += blockLength + this.redHeaderSizeBytes;
                totalHeaderSizeBytes += this.redHeaderSizeBytes;
                payloadOffset += this.redHeaderSizeBytes;
                payloadSizeBytes -= this.redHeaderSizeBytes;
            }
        }
        // The last block was never found. This is a bad packet.
        if (!gotLastBlock) {
            return null;
        }
        let redundantPayloadOffset = totalHeaderSizeBytes;
        for (let i = 0; i < redundantEncodingTimestamps.length; i++) {
            const redundantPayloadBuffer = new ArrayBuffer(redundantEncodingBlockLengths[i]);
            const redundantPayloadArray = new Uint8Array(redundantPayloadBuffer);
            redundantPayloadArray.set(new Uint8Array(payload.buffer, redundantPayloadOffset, redundantEncodingBlockLengths[i]), 0);
            const encoding = {
                timestamp: redundantEncodingTimestamps[i],
                payload: redundantPayloadBuffer,
                isRedundant: true,
            };
            if (getFecInfo) {
                encoding.hasFec = this.opusPacketHasFec(new DataView(redundantPayloadBuffer), redundantPayloadBuffer.byteLength);
            }
            encodings.push(encoding);
            redundantPayloadOffset += redundantEncodingBlockLengths[i];
        }
        const primaryPayloadOffset = payload.byteLength - primaryPayloadSizeBytes;
        const primaryPayloadBuffer = new ArrayBuffer(primaryPayloadSizeBytes);
        const primaryArray = new Uint8Array(primaryPayloadBuffer);
        primaryArray.set(new Uint8Array(payload.buffer, primaryPayloadOffset, primaryPayloadSizeBytes), 0);
        const encoding = {
            timestamp: primaryTimestamp,
            payload: primaryPayloadBuffer,
            isRedundant: false,
            seq: primarySequenceNumber,
        };
        if (getFecInfo) {
            encoding.hasFec = this.opusPacketHasFec(new DataView(primaryPayloadBuffer), primaryPayloadBuffer.byteLength);
        }
        encodings.push(encoding);
        return encodings;
    }
    /**
     * Create a new encoding with current primary payload and the older payloads of choice.
     */
    encode(primaryTimestamp, primaryPayload) {
        const primaryPayloadSize = primaryPayload.byteLength;
        // Payload size needs to be valid.
        if (primaryPayloadSize === 0 ||
            primaryPayloadSize >= this.maxRedPacketSizeBytes ||
            primaryPayloadSize >= this.maxAudioPayloadSizeBytes) {
            return null;
        }
        const numRedundantEncodings = this.numRedundantEncodings;
        let headerSizeBytes = this.redLastHeaderSizeBytes;
        let payloadSizeBytes = primaryPayloadSize;
        let bytesAvailable = this.maxAudioPayloadSizeBytes - primaryPayloadSize - headerSizeBytes;
        const redundantEncodingTimestamps = new Array();
        const redundantEncodingPayloads = new Array();
        // If redundancy is disabled then only send the primary payload
        if (this.redundancyEnabled) {
            // Determine how much redundancy we can fit into our packet
            let redundantTimestamp = this.uint32WrapAround(primaryTimestamp - this.redPacketizationTime * this.redPacketDistance);
            for (let i = 0; i < numRedundantEncodings; i++) {
                // Do not add redundant encodings that are beyond the maximum timestamp offset.
                if (this.uint32WrapAround(primaryTimestamp - redundantTimestamp) >= this.maxRedTimestampOffset) {
                    break;
                }
                let findTimestamp = redundantTimestamp;
                let encoding = this.encodingHistory.find(e => e.timestamp === findTimestamp);
                if (!encoding) {
                    // If not found or not important then look for the previous packet.
                    // The current packet may have included FEC for the previous, so just
                    // use the previous packet instead provided that it has voice activity.
                    findTimestamp = this.uint32WrapAround(redundantTimestamp - this.redPacketizationTime);
                    encoding = this.encodingHistory.find(e => e.timestamp === findTimestamp);
                }
                if (encoding) {
                    const redundantEncodingSizeBytes = encoding.payload.byteLength;
                    // Only add redundancy if there are enough bytes available.
                    if (bytesAvailable < this.redHeaderSizeBytes + redundantEncodingSizeBytes)
                        break;
                    bytesAvailable -= this.redHeaderSizeBytes + redundantEncodingSizeBytes;
                    headerSizeBytes += this.redHeaderSizeBytes;
                    payloadSizeBytes += redundantEncodingSizeBytes;
                    redundantEncodingTimestamps.unshift(encoding.timestamp);
                    redundantEncodingPayloads.unshift(encoding.payload);
                }
                redundantTimestamp -= this.redPacketizationTime * this.redPacketDistance;
                redundantTimestamp = this.uint32WrapAround(redundantTimestamp);
            }
        }
        const redPayloadBuffer = new ArrayBuffer(headerSizeBytes + payloadSizeBytes);
        const redPayloadView = new DataView(redPayloadBuffer);
        // Add redundant encoding header(s) to new buffer
        let redPayloadOffset = 0;
        for (let i = 0; i < redundantEncodingTimestamps.length; i++) {
            const timestampDelta = primaryTimestamp - redundantEncodingTimestamps[i];
            redPayloadView.setUint8(redPayloadOffset, this.opusPayloadType | 0x80);
            redPayloadView.setUint16(redPayloadOffset + 1, (timestampDelta << 2) | (redundantEncodingPayloads[i].byteLength >> 8));
            redPayloadView.setUint8(redPayloadOffset + 3, redundantEncodingPayloads[i].byteLength & 0xff);
            redPayloadOffset += this.redHeaderSizeBytes;
        }
        // Add primary encoding header to new buffer
        redPayloadView.setUint8(redPayloadOffset, this.opusPayloadType);
        redPayloadOffset += this.redLastHeaderSizeBytes;
        // Add redundant payload(s) to new buffer
        const redPayloadArray = new Uint8Array(redPayloadBuffer);
        for (let i = 0; i < redundantEncodingPayloads.length; i++) {
            redPayloadArray.set(new Uint8Array(redundantEncodingPayloads[i]), redPayloadOffset);
            redPayloadOffset += redundantEncodingPayloads[i].byteLength;
        }
        // Add primary payload to new buffer
        redPayloadArray.set(new Uint8Array(primaryPayload), redPayloadOffset);
        redPayloadOffset += primaryPayload.byteLength;
        /* istanbul ignore next */
        // Sanity check that we got the expected total payload size.
        if (redPayloadOffset !== headerSizeBytes + payloadSizeBytes)
            return null;
        this.updateEncodingHistory(primaryTimestamp, primaryPayload);
        return redPayloadBuffer;
    }
    /**
     * Update the encoding history with the latest primary encoding
     */
    updateEncodingHistory(primaryTimestamp, primaryPayload) {
        // Remove encodings from the history if they are too old.
        for (const encoding of this.encodingHistory) {
            const maxTimestampDelta = this.redPacketizationTime * this.redMaxRecoveryDistance;
            if (primaryTimestamp - encoding.timestamp >= maxTimestampDelta) {
                this.encodingHistory.shift();
            }
            else {
                break;
            }
        }
        // Only add an encoding to the history if the encoding is deemed to be important. An encoding is important if it is
        // a CELT-only packet or contains voice activity.
        const packet = new DataView(primaryPayload);
        if (this.opusPacketIsCeltOnly(packet) ||
            this.opusPacketHasVoiceActivity(packet, packet.byteLength) > 0) {
            // Check if adding an encoding will cause the length of the encoding history to exceed the maximum history size.
            // This is not expected to happen but could occur if we get incorrect timestamps. We want to make sure our memory
            // usage is bounded. In this case, just clear the history and start over from empty.
            if (this.encodingHistory.length + 1 > this.maxEncodingHistorySize)
                this.encodingHistory.length = 0;
            this.encodingHistory.push({ timestamp: primaryTimestamp, payload: primaryPayload });
        }
    }
    /**
     * Initialize packet logs and metric values.
     */
    initializePacketLogs() {
        // The extra space from the max RED recovery distance is to ensure that we do not incorrectly count recovery for
        // packets that have already been received but are outside of the max out-of-order distance.
        const packetLogSize = this.maxOutOfOrderPacketDistance + this.redMaxRecoveryDistance;
        this.primaryPacketLog = {
            window: new Array(packetLogSize),
            index: 0,
            windowSize: packetLogSize,
        };
        this.redRecoveryLog = {
            window: new Array(packetLogSize),
            index: 0,
            windowSize: packetLogSize,
        };
        this.fecRecoveryLog = {
            window: new Array(packetLogSize),
            index: 0,
            windowSize: packetLogSize,
        };
        this.totalAudioPacketsExpected = 0;
        this.totalAudioPacketsLost = 0;
        this.totalAudioPacketsRecoveredRed = 0;
        this.totalAudioPacketsRecoveredFec = 0;
    }
    /**
     * Receives encoded frames from the server
     * and adds the timestamps to a packet log
     * to calculate an approximate recovery metric.
     */
    receivePacketLogTransform(
    // @ts-ignore
    frame, controller) {
        const frameMetadata = frame.getMetadata();
        // @ts-ignore
        if (frameMetadata.payloadType !== this.redPayloadType) {
            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);
            return;
        }
        // @ts-ignore
        const encodings = this.splitEncodings(frame.timestamp, frame.data, 
        /*getFecInfo*/ true, frameMetadata.sequenceNumber);
        if (!encodings) {
            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);
            return;
        }
        for (let i = encodings.length - 1; i >= 0; i--) {
            if (this.updateLossStats(encodings[i])) {
                this.updateRedStats(encodings[i]);
                this.updateFecStats(encodings[i]);
            }
        }
        this.maybeReportLossStats(encodings[encodings.length - 1].timestamp, frameMetadata.synchronizationSource);
        this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);
    }
    /**
     * Adds a timestamp to the primary packet log.
     * This also updates totalAudioPacketsLost and totalAudioPacketsExpected by looking
     * at the difference between timestamps.
     *
     * @param encoding : The encoding to be analyzed
     * @returns false if sequence number was greater than max out of order distance
     *          true otherwise
     */
    updateLossStats(encoding) {
        if (encoding.isRedundant)
            return true;
        const timestamp = encoding.timestamp;
        const seq = encoding.seq;
        if (this.totalAudioPacketsExpected === 0) {
            this.totalAudioPacketsExpected = 1;
            this.newestSequenceNumber = seq;
            this.addTimestamp(this.primaryPacketLog, timestamp);
            return true;
        }
        const diff = this.int16(seq - this.newestSequenceNumber);
        if (diff < -this.maxOutOfOrderPacketDistance)
            return false;
        if (diff < 0) {
            if (!this.hasTimestamp(this.primaryPacketLog, timestamp)) {
                if (this.totalAudioPacketsLost > 0)
                    this.totalAudioPacketsLost--;
                this.addTimestamp(this.primaryPacketLog, timestamp);
                this.removeFromRecoveryWindows(timestamp);
            }
        }
        else if (diff > 1) {
            this.totalAudioPacketsLost += diff - 1;
        }
        if (diff > 0) {
            this.totalAudioPacketsExpected += diff;
            this.newestSequenceNumber = encoding.seq;
            this.addTimestamp(this.primaryPacketLog, timestamp);
        }
        return true;
    }
    /**
     * Adds a timestamp to the red recovery log if it is not present in
     * the primary packet log and if it's not too old.
     *
     * @param encoding : The encoding to be analyzed
     */
    updateRedStats(encoding) {
        if (!encoding.isRedundant || this.totalAudioPacketsLost === 0)
            return;
        const timestamp = encoding.timestamp;
        if (!this.hasTimestamp(this.primaryPacketLog, timestamp)) {
            if (!this.hasTimestamp(this.redRecoveryLog, timestamp)) {
                this.totalAudioPacketsRecoveredRed++;
                this.addTimestamp(this.redRecoveryLog, timestamp);
            }
            if (this.removeTimestamp(this.fecRecoveryLog, timestamp)) {
                /* istanbul ignore else */
                if (this.totalAudioPacketsRecoveredFec > 0)
                    this.totalAudioPacketsRecoveredFec--;
            }
        }
    }
    /**
     * Adds a timestamp to the fec recovery log if it is not present in
     * the primary packet log and red recovery log and if it is not too old.
     *
     * @param encoding : The encoding to be analyzed
     */
    updateFecStats(encoding) {
        if (!encoding.hasFec || this.totalAudioPacketsLost === 0)
            return;
        const fecTimestamp = encoding.timestamp - this.redPacketizationTime;
        if (this.hasTimestamp(this.primaryPacketLog, fecTimestamp) ||
            this.hasTimestamp(this.redRecoveryLog, fecTimestamp) ||
            this.hasTimestamp(this.fecRecoveryLog, fecTimestamp)) {
            return;
        }
        this.totalAudioPacketsRecoveredFec++;
        this.addTimestamp(this.fecRecoveryLog, fecTimestamp);
    }
    /**
     * Reports loss metrics to DefaultTransceiverController
     *
     * @param timestamp : Timestamp of most recent primary packet
     */
    maybeReportLossStats(timestamp, ssrc) {
        if (timestamp - this.lastLossReportTimestamp < this.lossReportInterval)
            return;
        /* istanbul ignore next */
        if (RedundantAudioEncoder.shouldReportStats) {
            // @ts-ignore
            self.postMessage({
                type: 'RedundantAudioEncoderStats',
                ssrc,
                totalAudioPacketsLost: this.totalAudioPacketsLost,
                totalAudioPacketsExpected: this.totalAudioPacketsExpected,
                totalAudioPacketsRecoveredRed: this.totalAudioPacketsRecoveredRed,
                totalAudioPacketsRecoveredFec: this.totalAudioPacketsRecoveredFec,
            });
        }
        this.lastLossReportTimestamp = timestamp;
    }
    /**
     * Adds a timestamp to a packet log
     *
     * @param packetLog : The packetlog to add the timestamp to
     * @param timestamp : The timestamp that should be added
     */
    addTimestamp(packetLog, timestamp) {
        packetLog.window[packetLog.index] = timestamp;
        packetLog.index = (packetLog.index + 1) % packetLog.windowSize;
    }
    /**
     * Checks if a timestamp is in a packetlog
     *
     * @param packetLog : The packetlog to search
     * @param timestamp : The timestamp to search for
     * @returns true if timestamp is present, false otherwise
     */
    hasTimestamp(packetLog, timestamp) {
        const element = packetLog.window.find(t => t === timestamp);
        return !!element;
    }
    /**
     * Removes a timestamp from a packet log
     *
     * @param packetLog : The packetlog from which the timestamp should be removed
     * @param timestamp : The timestamp to be removed
     * @returns true if timestamp was present in the log and removed, false otherwise
     */
    removeTimestamp(packetLog, timestamp) {
        const index = packetLog.window.indexOf(timestamp);
        if (index >= 0) {
            packetLog.window[index] = undefined;
            return true;
        }
        return false;
    }
    /**
     * Removes a timestamp from red and fec recovery windows.
     *
     * @param timestamp : The timestamp to be removed
     */
    removeFromRecoveryWindows(timestamp) {
        let removed = this.removeTimestamp(this.redRecoveryLog, timestamp);
        if (removed) {
            if (this.totalAudioPacketsRecoveredRed > 0)
                this.totalAudioPacketsRecoveredRed--;
        }
        removed = this.removeTimestamp(this.fecRecoveryLog, timestamp);
        if (removed) {
            if (this.totalAudioPacketsRecoveredFec > 0)
                this.totalAudioPacketsRecoveredFec--;
        }
    }
    /**
     * Converts the supplied argument to 32-bit unsigned integer
     */
    uint32WrapAround(num) {
        const mod = 4294967296; // 2^32
        let res = num;
        if (num >= mod) {
            res = num - mod;
        }
        else if (num < 0) {
            res = mod + num;
        }
        return res;
    }
    /**
     * Converts the supplied argument to 16-bit signed integer
     */
    int16(num) {
        return (num << 16) >> 16;
    }
    /**
     * Determines if an Opus packet is in CELT-only mode.
     *
     * @param packet Opus packet.
     * @returns \`true\` if the packet is in CELT-only mode.
     */
    opusPacketIsCeltOnly(packet) {
        // TOC byte format (https://www.rfc-editor.org/rfc/rfc6716#section-3.1):
        //  0
        //  0 1 2 3 4 5 6 7
        // +-+-+-+-+-+-+-+-+
        // | config  |s| c |
        // +-+-+-+-+-+-+-+-+
        // Since CELT-only packets are represented using configurations 16 to 31, the highest 'config' bit will always be 1
        // for CELT-only packets.
        return !!(packet.getUint8(0) & 0x80);
    }
    /**
     * Gets the number of samples per frame from an Opus packet.
     *
     * @param packet Opus packet. This must contain at least one byte of data.
     * @param sampleRateHz 32-bit integer sampling rate in Hz. This must be a multiple of 400 or inaccurate results will
     *                     be returned.
     * @returns Number of samples per frame.
     */
    opusPacketGetSamplesPerFrame(packet, sampleRateHz) {
        // Sample rate must be a 32-bit integer.
        sampleRateHz = Math.round(sampleRateHz);
        sampleRateHz = Math.min(Math.max(sampleRateHz, -(Math.pow(2, 32))), Math.pow(2, 32) - 1);
        // TOC byte format (https://www.rfc-editor.org/rfc/rfc6716#section-3.1):
        //  0
        //  0 1 2 3 4 5 6 7
        // +-+-+-+-+-+-+-+-+
        // | config  |s| c |
        // +-+-+-+-+-+-+-+-+
        let numSamples;
        let frameSizeOption;
        // Case for CELT-only packet.
        if (this.opusPacketIsCeltOnly(packet)) {
            // The lower 3 'config' bits indicate the frame size option.
            frameSizeOption = (packet.getUint8(0) >> 3) & 0x3;
            // The frame size options 0, 1, 2, 3 correspond to frame sizes of 2.5, 5, 10, 20 ms. Notice that the frame sizes
            // can be represented as (2.5 * 2^0), (2.5 * 2^1), (2.5 * 2^2), (2.5 * 2^3) ms. So, the number of samples can be
            // calculated as follows:
            // (sample/s) * (1s/1000ms) * (2.5ms) * 2^(frameSizeOption)
            // = (sample/s) * (1s/400) * 2^(frameSizeOption)
            // = (sample/s) * 2^(frameSizeOption) * (1s/400)
            numSamples = (sampleRateHz << frameSizeOption) / 400;
        }
        // Case for Hybrid packet. Since Hybrid packets are represented using configurations 12 to 15, bits 1 and 2 in the
        // above TOC byte diagram will both be 1.
        else if ((packet.getUint8(0) & 0x60) === 0x60) {
            // In the case of configuration 13 or 15, bit 4 in the above TOC byte diagram will be 1. Configurations 13 and 15
            // correspond to a 20ms frame size, so the number of samples is calculated as follows:
            // (sample/s) * (1s/1000ms) * (20ms)
            // = (sample/s) * (1s/50)
            //
            // In the case of configuration 12 or 14, bit 4 in the above TOC byte diagram will be 0. Configurations 12 and 14
            // correspond to a 10ms frame size, so the number of samples is calculated as follows:
            // (sample/s) * (1s/1000ms) * (10ms)
            // = (sample/s) * (1s/100)
            numSamples = packet.getUint8(0) & 0x08 ? sampleRateHz / 50 : sampleRateHz / 100;
        }
        // Case for SILK-only packet.
        else {
            // The lower 3 'config' bits indicate the frame size option for SILK-only packets.
            frameSizeOption = (packet.getUint8(0) >> 3) & 0x3;
            if (frameSizeOption === 3) {
                // Frame size option 3 corresponds to a frame size of 60ms, so the number of samples is calculated as follows:
                // (sample/s) * (1s/1000ms) * (60ms)
                // = (sample/s) * (60ms) * (1s/1000ms)
                numSamples = (sampleRateHz * 60) / 1000;
            }
            else {
                // The frame size options 0, 1, 2 correspond to frame sizes of 10, 20, 40 ms. Notice that the frame sizes can be
                // represented as (10 * 2^0), (10 * 2^1), (10 * 2^2) ms. So, the number of samples can be calculated as follows:
                // (sample/s) * (1s/1000ms) * (10ms) * 2^(frameSizeOption)
                // = (sample/s) * (1s/100) * 2^(frameSizeOption)
                // = (sample/s) * 2^(frameSizeOption) * (1s/100)
                numSamples = (sampleRateHz << frameSizeOption) / 100;
            }
        }
        return numSamples;
    }
    /**
     * Gets the number of SILK frames per Opus frame.
     *
     * @param packet Opus packet.
     * @returns Number of SILK frames per Opus frame.
     */
    opusNumSilkFrames(packet) {
        // For computing the frame length in ms, the sample rate is not important since it cancels out. We use 48 kHz, but
        // any valid sample rate would work.
        //
        // To calculate the length of a frame (with a 48kHz sample rate) in ms:
        // (samples/frame) * (1s/48000 samples) * (1000ms/s)
        // = (samples/frame) * (1000ms/48000 samples)
        // = (samples/frame) * (1ms/48 samples)
        let frameLengthMs = this.opusPacketGetSamplesPerFrame(packet, 48000) / 48;
        if (frameLengthMs < 10)
            frameLengthMs = 10;
        // The number of SILK frames per Opus frame is described in https://www.rfc-editor.org/rfc/rfc6716#section-4.2.2.
        switch (frameLengthMs) {
            case 10:
            case 20:
                return 1;
            case 40:
                return 2;
            case 60:
                return 3;
            // It is not possible to reach the default case since an Opus packet can only encode sizes of 2.5, 5, 10, 20, 40,
            // or 60 ms, so we ignore the default case for test coverage.
            /* istanbul ignore next */
            default:
                return 0;
        }
    }
    /**
     * Gets the number of channels from an Opus packet.
     *
     * @param packet Opus packet.
     * @returns Number of channels.
     */
    opusPacketGetNumChannels(packet) {
        // TOC byte format (https://www.rfc-editor.org/rfc/rfc6716#section-3.1):
        //  0
        //  0 1 2 3 4 5 6 7
        // +-+-+-+-+-+-+-+-+
        // | config  |s| c |
        // +-+-+-+-+-+-+-+-+
        // The 's' bit indicates mono or stereo audio, with 0 indicating mono and 1 indicating stereo.
        return packet.getUint8(0) & 0x4 ? 2 : 1;
    }
    /**
     * Determine the size (in bytes) of an Opus frame.
     *
     * @param packet Opus packet.
     * @param byteOffset Offset (from the start of the packet) to the byte containing the size information.
     * @param remainingBytes Remaining number of bytes to parse from the Opus packet.
     * @param sizeBytes Variable to store the parsed frame size (in bytes).
     * @returns Number of bytes that were parsed to determine the frame size.
     */
    opusParseSize(packet, byteOffset, remainingBytes, sizeBytes) {
        // See https://www.rfc-editor.org/rfc/rfc6716#section-3.2.1 for an explanation of how frame size is represented.
        // If there are no remaining bytes to parse the size from, then the size cannot be determined.
        if (remainingBytes < 1) {
            sizeBytes[0] = -1;
            return -1;
        }
        // If the first byte is in the range 0...251, then this value is the size of the frame.
        else if (packet.getUint8(byteOffset) < 252) {
            sizeBytes[0] = packet.getUint8(byteOffset);
            return 1;
        }
        // If the first byte is in the range 252...255, a second byte is needed. If there is no second byte, then the size
        // cannot be determined.
        else if (remainingBytes < 2) {
            sizeBytes[0] = -1;
            return -1;
        }
        // The total size of the frame given two size bytes is:
        // (4 * secondSizeByte) + firstSizeByte
        else {
            sizeBytes[0] = 4 * packet.getUint8(byteOffset + 1) + packet.getUint8(byteOffset);
            return 2;
        }
    }
    /**
     * Parse binary data containing an Opus packet into one or more Opus frames.
     *
     * @param data Binary data containing an Opus packet to be parsed. The data should begin with the first byte (i.e the
     *             TOC byte) of an Opus packet. Note that the size of the data does not have to equal the size of the
     *             contained Opus packet.
     * @param lenBytes Size of the data (in bytes).
     * @param selfDelimited Indicates if the Opus packet is self-delimiting
     *                      (https://www.rfc-editor.org/rfc/rfc6716#appendix-B).
     * @param tocByte Optional variable to store the TOC (table of contents) byte.
     * @param frameOffsets Optional variable to store the offsets (from the start of the data) to the first bytes of each
     *                     Opus frame.
     * @param frameSizes Required variable to store the sizes (in bytes) of each Opus frame.
     * @param payloadOffset Optional variable to store the offset (from the start of the data) to the first byte of the
     *                      payload.
     * @param packetLenBytes Optional variable to store the length of the Opus packet (in bytes).
     * @returns Number of Opus frames.
     */
    opusPacketParseImpl(data, lenBytes, selfDelimited, tocByte, frameOffsets, frameSizes, payloadOffset, packetLenBytes) {
        if (!frameSizes || lenBytes < 0)
            return this.OPUS_BAD_ARG;
        if (lenBytes === 0)
            return this.OPUS_INVALID_PACKET;
        // The number of Opus frames in the packet.
        let numFrames;
        // Intermediate storage for the number of bytes parsed to determine the size of a frame.
        let numBytesParsed;
        // The number of the padding bytes (excluding the padding count bytes) in the packet.
        let paddingBytes = 0;
        // Indicates whether CBR (constant bitrate) framing is used.
        let cbr = false;
        // The TOC (table of contents) byte (https://www.rfc-editor.org/rfc/rfc6716#section-3.1).
        const toc = data.getUint8(0);
        // Store the TOC byte.
        if (tocByte)
            tocByte[0] = toc;
        // The remaining number of bytes to parse from the packet. Note that the TOC byte has already been parsed, hence the
        // minus 1.
        let remainingBytes = lenBytes - 1;
        // This keeps track of where we are in the packet. This starts at 1 since the TOC byte has already been read.
        let byteOffset = 1;
        // The size of the last Opus frame in bytes.
        let lastSizeBytes = remainingBytes;
        // Read the \`c\` bits (i.e. code bits) from the TOC byte.
        switch (toc & 0x3) {
            // A code 0 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.2) has one frame.
            case 0:
                numFrames = 1;
                break;
            // A code 1 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.3) has two CBR (constant bitrate) frames.
            case 1:
                numFrames = 2;
                cbr = true;
                if (!selfDelimited) {
                    // Undelimited code 1 packets must be an even number of data bytes, otherwise the packet is invalid.
                    if (remainingBytes & 0x1)
                        return this.OPUS_INVALID_PACKET;
                    // The sizes of both frames are equal (i.e. half of the number of data bytes).
                    lastSizeBytes = remainingBytes / 2;
                    // If \`lastSizeBytes\` is too large, we will catch it later.
                    frameSizes[0][0] = lastSizeBytes;
                }
                break;
            // A code 2 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.4) has two VBR (variable bitrate) frames.
            case 2:
                numFrames = 2;
                numBytesParsed = this.opusParseSize(data, byteOffset, remainingBytes, frameSizes[0]);
                remainingBytes -= numBytesParsed;
                // The parsed size of the first frame cannot be larger than the number of remaining bytes in the packet.
                if (frameSizes[0][0] < 0 || frameSizes[0][0] > remainingBytes) {
                    return this.OPUS_INVALID_PACKET;
                }
                byteOffset += numBytesParsed;
                // The size of the second frame is the remaining number of bytes after the first frame.
                lastSizeBytes = remainingBytes - frameSizes[0][0];
                break;
            // A code 3 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.5) has multiple CBR/VBR frames (from 0 to
            // 120 ms).
            default:
                // Code 3 packets must have at least 2 bytes (i.e. at least 1 byte after the TOC byte).
                if (remainingBytes < 1)
                    return this.OPUS_INVALID_PACKET;
                // Frame count byte format:
                //  0
                //  0 1 2 3 4 5 6 7
                // +-+-+-+-+-+-+-+-+
                // |v|p|     M     |
                // +-+-+-+-+-+-+-+-+
                //
                // Read the frame count byte, which immediately follows the TOC byte.
                const frameCountByte = data.getUint8(byteOffset++);
                --remainingBytes;
                // Read the 'M' bits of the frame count byte, which encode the number of frames.
                numFrames = frameCountByte & 0x3f;
                // The number of frames in a code 3 packet must not be 0.
                if (numFrames <= 0)
                    return this.OPUS_INVALID_PACKET;
                const samplesPerFrame = this.opusPacketGetSamplesPerFrame(data, 48000);
                // A single frame can have at most 2880 samples, which happens in the case where 60ms of 48kHz audio is encoded
                // per frame. A code 3 packet cannot contain more than 120ms of audio, so the total number of samples cannot
                // exceed 2880 * 2 = 5760.
                if (samplesPerFrame * numFrames > 5760)
                    return this.OPUS_INVALID_PACKET;
                // Parse padding bytes if the 'p' bit is 1.
                if (frameCountByte & 0x40) {
                    let paddingCountByte;
                    let numPaddingBytes;
                    // Remove padding bytes (including padding count bytes) from the remaining byte count.
                    do {
                        // Sanity check that there are enough bytes to parse and remove the padding.
                        if (remainingBytes <= 0)
                            return this.OPUS_INVALID_PACKET;
                        // Get the next padding count byte.
                        paddingCountByte = data.getUint8(byteOffset++);
                        --remainingBytes;
                        // If the padding count byte has a value in the range 0...254, then the total size of the padding is the
                        // value in the padding count byte.
                        //
                        // If the padding count byte has value 255, then the total size of the padding is 254 plus the value in the
                        // next padding count byte. Therefore, keep reading padding count bytes while the value is 255.
                        numPaddingBytes = paddingCountByte === 255 ? 254 : paddingCountByte;
                        remainingBytes -= numPaddingBytes;
                        paddingBytes += numPaddingBytes;
                    } while (paddingCountByte === 255);
                }
                // Sanity check that the remaining number of bytes is not negative after removing the padding.
                if (remainingBytes < 0)
                    return this.OPUS_INVALID_PACKET;
                // Read the 'v' bit (i.e. VBR bit).
                cbr = !(frameCountByte & 0x80);
                // VBR case
                if (!cbr) {
                    lastSizeBytes = remainingBytes;
                    // Let M be the number of frames. There will be M - 1 frame length indicators (which can be 1 or 2 bytes)
                    // corresponding to the lengths of frames 0 to M - 2. The size of the last frame (i.e. frame M - 1) is the
                    // number of data bytes after the end of frame M - 2 and before the start of the padding bytes.
                    for (let i = 0; i < numFrames - 1; ++i) {
                        numBytesParsed = this.opusParseSize(data, byteOffset, remainingBytes, frameSizes[i]);
                        remainingBytes -= numBytesParsed;
                        // The remaining number of data bytes must be enough to contain each frame.
                        if (frameSizes[i][0] < 0 || frameSizes[i][0] > remainingBytes) {
                            return this.OPUS_INVALID_PACKET;
                        }
                        byteOffset += numBytesParsed;
                        lastSizeBytes -= numBytesParsed + frameSizes[i][0];
                    }
                    // Sanity check that the size of the last frame is not negative.
                    if (lastSizeBytes < 0)
                        return this.OPUS_INVALID_PACKET;
                }
                // CBR case
                else if (!selfDelimited) {
                    // The size of each frame is the number of data bytes divided by the number of frames.
                    lastSizeBytes = Math.trunc(remainingBytes / numFrames);
                    // The number of data bytes must be a non-negative integer multiple of the number of frames.
                    if (lastSizeBytes * numFrames !== remainingBytes)
                        return this.OPUS_INVALID_PACKET;
                    // All frames have equal size in the undelimited CBR case.
                    for (let i = 0; i < numFrames - 1; ++i) {
                        frameSizes[i][0] = lastSizeBytes;
                    }
                }
        }
        // Self-delimited framing uses an extra 1 or 2 bytes, immediately preceding the data bytes, to indicate either the
        // size of the last frame (for code 0, code 2, and VBR code 3 packets) or the size of all the frames (for code 1 and
        // CBR code 3 packets). See https://www.rfc-editor.org/rfc/rfc6716#appendix-B.
        if (selfDelimited) {
            // The extra frame size byte(s) will always indicate the size of the last frame.
            numBytesParsed = this.opusParseSize(data, byteOffset, remainingBytes, frameSizes[numFrames - 1]);
            remainingBytes -= numBytesParsed;
            // There must be enough data bytes for the last frame.
            if (frameSizes[numFrames - 1][0] < 0 || frameSizes[numFrames - 1][0] > remainingBytes) {
                return this.OPUS_INVALID_PACKET;
            }
            byteOffset += numBytesParsed;
            // For CBR packets, the sizes of all the frames are equal.
            if (cbr) {
                // There must be enough data bytes for all the frames.
                if (frameSizes[numFrames - 1][0] * numFrames > remainingBytes) {
                    return this.OPUS_INVALID_PACKET;
                }
                for (let i = 0; i < numFrames - 1; ++i) {
                    frameSizes[i][0] = frameSizes[numFrames - 1][0];
                }
            }
            // At this point, \`lastSizeBytes\` contains the size of the last frame plus the size of the extra frame size
            // byte(s), so sanity check that \`lastSizeBytes\` is the upper bound for the size of the last frame.
            else if (!(numBytesParsed + frameSizes[numFrames - 1][0] <= lastSizeBytes)) {
                return this.OPUS_INVALID_PACKET;
            }
        }
        // Undelimited case
        else {
            // Because the size of the last packet is not encoded explicitly, it is possible that the size of the last packet
            // (or of all the packets, for the CBR case) is larger than maximum frame size.
            if (lastSizeBytes > this.OPUS_MAX_FRAME_SIZE_BYTES)
                return this.OPUS_INVALID_PACKET;
            frameSizes[numFrames - 1][0] = lastSizeBytes;
        }
        // Store the offset to the start of the payload.
        if (payloadOffset)
            payloadOffset[0] = byteOffset;
        // Store the offsets to the start of each frame.
        for (let i = 0; i < numFrames; ++i) {
            if (frameOffsets)
                frameOffsets[i][0] = byteOffset;
            byteOffset += frameSizes[i][0];
        }
        // Store the length of the Opus packet.
        if (packetLenBytes)
            packetLenBytes[0] = byteOffset + paddingBytes;
        return numFrames;
    }
    /**
     * Parse a single undelimited Opus packet into one or more Opus frames.
     *
     * @param packet Opus packet to be parsed.
     * @param lenBytes Size of the packet (in bytes).
     * @param tocByte Optional variable to store the TOC (table of contents) byte.
     * @param frameOffsets Optional variable to store the offsets (from the start of the packet) to the first bytes of
     *                     each Opus frame.
     * @param frameSizes Required variable to store the sizes (in bytes) of each Opus frame.
     * @param payloadOffset Optional variable to store the offset (from the start of the packet) to the first byte of the
     *                      payload.
     * @returns Number of Opus frames.
     */
    opusPacketParse(packet, lenBytes, tocByte, frameOffsets, frameSizes, payloadOffset) {
        return this.opusPacketParseImpl(packet, lenBytes, 
        /* selfDelimited */ false, tocByte, frameOffsets, frameSizes, payloadOffset, null);
    }
    /**
     * This function returns the SILK VAD (voice activity detection) information encoded in the Opus packet. For CELT-only
     * packets that do not have VAD information, it returns -1.
     *
     * @param packet Opus packet.
     * @param lenBytes Size of the packet (in bytes).
     * @returns  0: no frame had the VAD flag set.
     *           1: at least one frame had the VAD flag set.
     *          -1: VAD status could not be determined.
     */
    opusPacketHasVoiceActivity(packet, lenBytes) {
        if (!packet || lenBytes <= 0)
            return 0;
        // In CELT-only mode, we can not determine whether there is VAD.
        if (this.opusPacketIsCeltOnly(packet))
            return -1;
        const numSilkFrames = this.opusNumSilkFrames(packet);
        // It is not possible for \`opusNumSilkFrames()\` to return 0, so we ignore the next sanity check for test coverage.
        /* istanbul ignore next */
        if (numSilkFrames === 0)
            return -1;
        const opusFrameOffsets = new Array(this.OPUS_MAX_OPUS_FRAMES);
        const opusFrameSizes = new Array(this.OPUS_MAX_OPUS_FRAMES);
        for (let i = 0; i < this.OPUS_MAX_OPUS_FRAMES; ++i) {
            opusFrameOffsets[i] = [undefined];
            opusFrameSizes[i] = [undefined];
        }
        // Parse packet to get the Opus frames.
        const numOpusFrames = this.opusPacketParse(packet, lenBytes, null, opusFrameOffsets, opusFrameSizes, null);
        // VAD status cannot be determined for invalid packets.
        if (numOpusFrames < 0)
            return -1;
        // Iterate over all Opus frames, which may contain multiple SILK frames, to determine the VAD status.
        for (let i = 0; i < numOpusFrames; ++i) {
            if (opusFrameSizes[i][0] < 1)
                continue;
            // LP layer header bits format (https://www.rfc-editor.org/rfc/rfc6716#section-4.2.3):
            //
            // Mono case:
            // +-----------------+----------+
            // | 1 to 3 VAD bits | LBRR bit |
            // +-----------------+----------+
            //
            // Stereo case:
            // +---------------------+--------------+----------------------+---------------+
            // | 1 to 3 mid VAD bits | mid LBRR bit | 1 to 3 side VAD bits | side LBRR bit |
            // +---------------------+--------------+----------------------+---------------+
            // The upper 1 to 3 bits (dependent on the number of SILK frames) of the LP layer contain VAD bits. If any of
            // these VAD bits are 1, then voice activity is present.
            if (packet.getUint8(opusFrameOffsets[i][0]) >> (8 - numSilkFrames))
                return 1;
            // In the stereo case, there is a second set of 1 to 3 VAD bits, so also check these VAD bits.
            const channels = this.opusPacketGetNumChannels(packet);
            if (channels === 2 &&
                (packet.getUint8(opusFrameOffsets[i][0]) << (numSilkFrames + 1)) >> (8 - numSilkFrames)) {
                return 1;
            }
        }
        // No voice activity was detected.
        return 0;
    }
    /**
     * This method is based on Definition of the Opus Audio Codec
     * (https://tools.ietf.org/html/rfc6716). Basically, this method is based on
     * parsing the LP layer of an Opus packet, particularly the LBRR flag.
     *
     * @param packet Opus packet.
     * @param lenBytes Size of the packet (in bytes).
     * @returns  true: packet has fec encoding about previous packet.
     *           false: no fec encoding present.
     */
    opusPacketHasFec(packet, lenBytes) {
        if (!packet || lenBytes <= 0)
            return false;
        // In CELT-only mode, packets should not have FEC.
        if (this.opusPacketIsCeltOnly(packet))
            return false;
        const opusFrameOffsets = new Array(this.OPUS_MAX_OPUS_FRAMES);
        const opusFrameSizes = new Array(this.OPUS_MAX_OPUS_FRAMES);
        for (let i = 0; i < this.OPUS_MAX_OPUS_FRAMES; ++i) {
            opusFrameOffsets[i] = [undefined];
            opusFrameSizes[i] = [undefined];
        }
        // Parse packet to get the Opus frames.
        const numOpusFrames = this.opusPacketParse(packet, lenBytes, null, opusFrameOffsets, opusFrameSizes, null);
        if (numOpusFrames < 0)
            return false;
        /* istanbul ignore next */
        if (opusFrameSizes[0][0] <= 1)
            return false;
        const numSilkFrames = this.opusNumSilkFrames(packet);
        /* istanbul ignore next */
        if (numSilkFrames === 0)
            return false;
        const channels = this.opusPacketGetNumChannels(packet);
        /* istanbul ignore next */
        if (channels !== 1 && channels !== 2)
            return false;
        // A frame starts with the LP layer. The LP layer begins with two to eight
        // header bits.These consist of one VAD bit per SILK frame (up to 3),
        // followed by a single flag indicating the presence of LBRR frames.
        // For a stereo packet, these first flags correspond to the mid channel, and
        // a second set of flags is included for the side channel. Because these are
        // the first symbols decoded by the range coder and because they are coded
        // as binary values with uniform probability, they can be extracted directly
        // from the most significant bits of the first byte of compressed data.
        for (let i = 0; i < channels; i++) {
            if (packet.getUint8(opusFrameOffsets[0][0]) & (0x80 >> ((i + 1) * (numSilkFrames + 1) - 1)))
                return true;
        }
        return false;
    }
}
RedundantAudioEncoder.shouldLog = true;
RedundantAudioEncoder.shouldReportStats = true;
RedundantAudioEncoder.initializeWorker();
`;return RedundantAudioEncoderWorkerCode.default=C,RedundantAudioEncoderWorkerCode}var hasRequiredDefaultTransceiverController;function requireDefaultTransceiverController(){if(hasRequiredDefaultTransceiverController)return DefaultTransceiverController;hasRequiredDefaultTransceiverController=1;var C=DefaultTransceiverController&&DefaultTransceiverController.__awaiter||function(_,D,Y,ee){function ie(ne){return ne instanceof Y?ne:new Y(function(re){re(ne)})}return new(Y||(Y=Promise))(function(ne,re){function oe(de){try{le(ee.next(de))}catch(me){re(me)}}function ae(de){try{le(ee.throw(de))}catch(me){re(me)}}function le(de){de.done?ne(de.value):ie(de.value).then(oe,ae)}le((ee=ee.apply(_,D||[])).next())})},E=DefaultTransceiverController&&DefaultTransceiverController.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(DefaultTransceiverController,"__esModule",{value:!0});const w=E(requireAudioProfile()),R=E(requireRedundantAudioRecoveryMetricReport()),M=E(requireRedundantAudioEncoder()),x=E(requireRedundantAudioEncoderWorkerCode()),S=E(requireAsyncScheduler());let T=class{constructor(_,D,Y){this.logger=_,this.browserBehavior=D,this.meetingSessionContext=Y,this._localCameraTransceiver=null,this._localAudioTransceiver=null,this.videoSubscriptions=[],this.defaultMediaStream=null,this.peer=null,this.streamIdToTransceiver=new Map,this.groupIdToTransceiver=new Map,this.audioRedWorker=null,this.audioRedWorkerURL=null,this.audioMetricsHistory=new Array,this.redMetricsObservers=new Set,this.currentNumRedundantEncodings=0,this.lastRedHolddownTimerStartTimestampMs=0,this.lastHighPacketLossEventTimestampMs=0,this.lastAudioRedTurnOffTimestampMs=0,this.maxAudioMetricsHistory=20,this.audioRedPacketLossShortEvalPeriodMs=5*1e3,this.audioRedPacketLossLongEvalPeriodMs=15*1e3,this.audioRedHoldDownTimeMs=5*60*1e3,this.redRecoveryTimeMs=1*60*1e3}setEncodingParameters(_){return C(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||this._localCameraTransceiver.direction!=="sendrecv")return;const D=this._localCameraTransceiver.sender;if(!_||_.size===0)return;const Y=Array.from(_.values()),ee=D.getParameters();if(!ee.encodings||ee.encodings.length===0)ee.encodings=Y;else for(const ie of ee.encodings)for(const ne of Y){if((ie.rid||ne.rid)&&ie.rid!==ne.rid)continue;let re;for(re in ne)re==="rid"||re==="codecPayloadType"||ne.hasOwnProperty(re)&&(ie[re]=ne[re])}yield D.setParameters(ee)})}localAudioTransceiver(){return this._localAudioTransceiver}localVideoTransceiver(){return this._localCameraTransceiver}setVideoSendingBitrateKbps(_){return C(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||this._localCameraTransceiver.direction!=="sendrecv")return;const D=this._localCameraTransceiver.sender;if(!D||_<=0)return;const Y=D.getParameters();Y.encodings||(Y.encodings=[{}]);for(const ee of Y.encodings)ee.maxBitrate=_*1e3;yield D.setParameters(Y)})}setPeer(_){this.peer=_}reset(){this.destroyAudioRedWorkerAndStates(),this._localCameraTransceiver=null,this._localAudioTransceiver=null,this.videoSubscriptions=[],this.defaultMediaStream=null,this.peer=null}useTransceivers(){return!!this.peer&&typeof this.peer.getTransceivers<"u"}hasVideoInput(){return!(!this._localCameraTransceiver||this._localCameraTransceiver.direction!=="sendrecv")}trackIsVideoInput(_){return this._localCameraTransceiver?_===this._localCameraTransceiver.sender.track||_===this._localCameraTransceiver.receiver.track:!1}setupLocalTransceivers(){var _,D;this.useTransceivers()&&(!this.defaultMediaStream&&typeof MediaStream<"u"&&(this.defaultMediaStream=new MediaStream),this._localAudioTransceiver||(this._localAudioTransceiver=this.peer.addTransceiver("audio",{direction:"inactive",streams:[this.defaultMediaStream]}),!((D=(_=this.meetingSessionContext)===null||_===void 0?void 0:_.audioProfile)===null||D===void 0)&&D.hasRedundancyEnabled()&&this.setupAudioRedWorker()),this._localCameraTransceiver||(this._localCameraTransceiver=this.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream]})))}replaceAudioTrack(_){return C(this,void 0,void 0,function*(){return!this._localAudioTransceiver||this._localAudioTransceiver.direction!=="sendrecv"?(this.logger.info("audio transceiver direction is not set up or not activated"),!1):(yield this._localAudioTransceiver.sender.replaceTrack(_),!0)})}setAudioInput(_){return C(this,void 0,void 0,function*(){yield this.setTransceiverInput(this._localAudioTransceiver,_)})}setVideoInput(_){return C(this,void 0,void 0,function*(){yield this.setTransceiverInput(this._localCameraTransceiver,_)})}updateVideoTransceivers(_,D){if(!this.useTransceivers())return D.array();const Y=this.peer.getTransceivers();return this.videoSubscriptions=[0],D=D.clone(),this.updateTransceivers(Y,_,D),this.logger.debug(()=>this.debugDumpTransceivers()),this.videoSubscriptions}updateTransceivers(_,D,Y){const ee=Y.array();_.length!==0&&!_[0].stop?(this.logger.info("Updating transceivers without `stop` function"),this.updateTransceiverWithoutStop(_,D,ee)):_.length!==0&&this.updateTransceiverWithStop(_,D,ee);for(const ie of ee){const ne=this.addTransceiver("video",{direction:"recvonly",streams:[new MediaStream]});this.streamIdToTransceiver.set(ie,ne),this.groupIdToTransceiver.set(D.groupIdForStreamId(ie),ne),this.videoSubscriptions.push(ie),this.logger.info(`adding transceiver mid: ${ne.mid} subscription: ${ie} direction: recvonly`)}}updateTransceiverWithStop(_,D,Y){let ee=1;this.videoSubscriptions=[0];for(const ie of _){if(ie===this._localCameraTransceiver||!this.transceiverIsVideo(ie)||!ie.mid)continue;let ne=!1;const re=D.streamIdForTrack("v_"+ie.mid);if(ie.direction!=="inactive"&&re!==void 0){for(const[oe,ae]of Y.entries())if(D.StreamIdsInSameGroup(re,ae)){ie.direction="recvonly",this.videoSubscriptions[ee]=ae,ne=!0,this.streamIdToTransceiver.delete(re),this.streamIdToTransceiver.set(ae,ie),Y.splice(oe,1);break}}if(!ne){this.videoSubscriptions[ee]=0,this.logger.info(`Stopping MID: ${ie.mid}, direction: ${ie.direction}, current direction: ${ie.currentDirection}`),ie.stop();for(const[oe,ae]of this.streamIdToTransceiver.entries())ie.mid===ae.mid&&(this.streamIdToTransceiver.delete(oe),this.groupIdToTransceiver.delete(D.groupIdForStreamId(oe)))}ee+=1}}updateTransceiverWithoutStop(_,D,Y){let ee=1;for(const ie of _)if(!(ie===this._localCameraTransceiver||!this.transceiverIsVideo(ie))){if(this.videoSubscriptions[ee]=0,ie.direction!=="inactive"){const ne=D.streamIdForTrack("v_"+ie.mid);if(ne!==void 0){for(const[re,oe]of Y.entries())if(D.StreamIdsInSameGroup(ne,oe)){ie.direction="recvonly",this.videoSubscriptions[ee]=oe,this.streamIdToTransceiver.delete(ne),this.streamIdToTransceiver.set(oe,ie),Y.splice(re,1);break}}}ee+=1}ee=1;for(const ie of _)if(!(ie===this._localCameraTransceiver||!this.transceiverIsVideo(ie))){if(ie.direction==="inactive"&&Y.length>0){ie.direction="recvonly";const ne=Y.shift();this.videoSubscriptions[ee]=ne,this.streamIdToTransceiver.set(ne,ie),this.groupIdToTransceiver.set(D.groupIdForStreamId(ne),ie)}else if(this.videoSubscriptions[ee]===0){ie.direction="inactive";for(const[ne,re]of this.streamIdToTransceiver.entries())ie===re&&(this.streamIdToTransceiver.delete(ne),this.groupIdToTransceiver.delete(D.groupIdForStreamId(ne)))}ee+=1}}getMidForStreamId(_){var D;return(D=this.streamIdToTransceiver.get(_))===null||D===void 0?void 0:D.mid}setStreamIdForMid(_,D){for(const[Y,ee]of this.streamIdToTransceiver.entries())if(ee.mid===_){this.streamIdToTransceiver.delete(Y),this.streamIdToTransceiver.set(D,ee);return}}getMidForGroupId(_){var D,Y;return(Y=(D=this.groupIdToTransceiver.get(_))===null||D===void 0?void 0:D.mid)!==null&&Y!==void 0?Y:void 0}transceiverIsVideo(_){return _.receiver&&_.receiver.track&&_.receiver.track.kind==="video"||_.sender&&_.sender.track&&_.sender.track.kind==="video"}debugDumpTransceivers(){let _="",D=0;for(const Y of this.peer.getTransceivers())this.transceiverIsVideo(Y)&&(_+=`transceiver index=${D} mid=${Y.mid} subscription=${this.videoSubscriptions[D]} direction=${Y.direction}
`,D+=1);return _}setTransceiverInput(_,D){return C(this,void 0,void 0,function*(){_&&(D?_.direction="sendrecv":_.direction="inactive",yield _.sender.replaceTrack(D))})}forEachRedMetricsObserver(_){for(const D of this.redMetricsObservers)S.default.nextTick(()=>{this.redMetricsObservers.has(D)&&D.recoveryMetricsDidReceive(_)})}disableAudioRedundancy(){this.meetingSessionContext.audioProfile=new w.default(this.meetingSessionContext.audioProfile.audioBitrateBps,!1),this.meetingSessionContext.audioVideoController.setAudioProfile(this.meetingSessionContext.audioProfile)}setupAudioRedWorker(){var _,D;const Y=!!window.RTCRtpScriptTransform,ee=!!RTCRtpSender.prototype.createEncodedStreams;if(Y)this.logger.info("[AudioRed] Supports encoded insertable streams using RTCRtpScriptTransform");else if(ee)this.logger.info("[AudioRed] Supports encoded insertable streams using TransformStream");else throw this.disableAudioRedundancy(),new Error("[AudioRed] Encoded insertable streams not supported. Recreating peer connection with audio redundancy disabled.");try{this.audioRedWorkerURL=URL.createObjectURL(new Blob([x.default],{type:"application/javascript"})),this.logger.info(`[AudioRed] Redundant audio worker URL ${this.audioRedWorkerURL}`),this.audioRedWorker=new Worker(this.audioRedWorkerURL)}catch(ie){throw this.logger.error(`[AudioRed] Unable to create audio red worker due to ${ie}`),URL.revokeObjectURL(this.audioRedWorkerURL),this.audioRedWorkerURL=null,this.audioRedWorker=null,this.disableAudioRedundancy(),this.logger.info("[AudioRed] Recreating peer connection with audio redundancy disabled"),ie}if(this.audioRedEnabled=!0,this.audioRedWorker.onmessage=ie=>{if(ie.data.type==="REDWorkerLog")this.logger.info(ie.data.log);else if(ie.data.type==="RedundantAudioEncoderStats"){const ne=new R.default;ne.currentTimestampMs=Date.now(),ne.ssrc=ie.data.ssrc,ne.totalAudioPacketsLost=ie.data.totalAudioPacketsLost,ne.totalAudioPacketsExpected=ie.data.totalAudioPacketsExpected,ne.totalAudioPacketsRecoveredRed=ie.data.totalAudioPacketsRecoveredRed,ne.totalAudioPacketsRecoveredFec=ie.data.totalAudioPacketsRecoveredFec,this.forEachRedMetricsObserver(ne)}},Y)this._localAudioTransceiver.sender.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"SenderTransform"}),this._localAudioTransceiver.receiver.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"ReceiverTransform"});else if(ee){const ie=this._localAudioTransceiver.sender.createEncodedStreams(),ne=this._localAudioTransceiver.receiver.createEncodedStreams();this.audioRedWorker.postMessage({msgType:"StartRedWorker",send:ie,receive:ne},[ie.readable,ie.writable,ne.readable,ne.writable])}(_=this.meetingSessionContext)===null||_===void 0||_.audioVideoController.addObserver(this),this.addRedundantAudioRecoveryMetricsObserver((D=this.meetingSessionContext)===null||D===void 0?void 0:D.statsCollector)}addTransceiver(_,D){var Y;const ee=this.peer.addTransceiver(_,D);if(!(!((Y=this.peer.getConfiguration())===null||Y===void 0)&&Y.encodedInsertableStreams)||!this.audioRedWorker)return ee;const ie=!!window.RTCRtpScriptTransform,ne=!!RTCRtpSender.prototype.createEncodedStreams;if(ie)ee.sender.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"PassthroughTransform"}),ee.receiver.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"PassthroughTransform"});else if(ne){const re=ee.sender.createEncodedStreams(),oe=ee.receiver.createEncodedStreams();this.audioRedWorker.postMessage({msgType:"PassthroughTransform",send:re,receive:oe},[re.readable,re.writable,oe.readable,oe.writable])}return ee}destroyAudioRedWorkerAndStates(){var _,D;this.audioRedWorker&&(URL.revokeObjectURL(this.audioRedWorkerURL),this.audioRedWorkerURL=null,this.audioRedWorker.terminate(),this.audioRedWorker=null,this.currentNumRedundantEncodings=0,this.lastRedHolddownTimerStartTimestampMs=0,this.lastAudioRedTurnOffTimestampMs=0,this.lastHighPacketLossEventTimestampMs=0,this.audioRedEnabled=!0,(_=this.meetingSessionContext)===null||_===void 0||_.audioVideoController.removeObserver(this),this.removeRedundantAudioRecoveryMetricsObserver((D=this.meetingSessionContext)===null||D===void 0?void 0:D.statsCollector))}setAudioPayloadTypes(_){this.audioRedWorker&&(this.audioRedWorker.postMessage({msgType:"RedPayloadType",payloadType:_.get("red")}),this.audioRedWorker.postMessage({msgType:"OpusPayloadType",payloadType:_.get("opus")}))}metricsDidReceive(_){const{currentTimestampMs:D}=_,Y=_.getRTCStatsReport();let ee=0,ie=0,ne=0;Y.forEach(me=>{me.kind==="audio"&&(me.type==="outbound-rtp"?ie=me.packetsSent:me.type==="remote-inbound-rtp"&&(ee=me.timestamp,ne=me.packetsLost))}),(this.audioMetricsHistory.length===0||ee>this.audioMetricsHistory[this.audioMetricsHistory.length-1].timestampMs&&ie>this.audioMetricsHistory[this.audioMetricsHistory.length-1].totalPacketsSent)&&this.audioMetricsHistory.push({timestampMs:ee,totalPacketsSent:ie,totalPacketsLost:ne}),this.audioMetricsHistory.length>this.maxAudioMetricsHistory&&this.audioMetricsHistory.shift();const re=this.lossPercent(this.audioRedPacketLossShortEvalPeriodMs),oe=this.lossPercent(this.audioRedPacketLossLongEvalPeriodMs),ae=Math.max(re,oe),[le,de]=M.default.getNumRedundantEncodingsForPacketLoss(ae);if(de){this.lastHighPacketLossEventTimestampMs=D,this.audioRedEnabled&&(this.audioRedWorker&&this.audioRedWorker.postMessage({msgType:"Disable"}),this.audioRedEnabled=!1,this.lastAudioRedTurnOffTimestampMs=D);return}else if(!this.audioRedEnabled){const me=D-this.lastAudioRedTurnOffTimestampMs,fe=D-this.lastHighPacketLossEventTimestampMs;if(me>=this.audioRedPacketLossLongEvalPeriodMs&&fe<this.redRecoveryTimeMs)return;this.audioRedWorker&&this.audioRedWorker.postMessage({msgType:"Enable"}),this.audioRedEnabled=!0,this.maybeResetHoldDownTimer(D)}this.shouldUpdateAudioRedWorkerEncodings(D,le)&&this.audioRedWorker&&this.audioRedWorker.postMessage({msgType:"UpdateNumRedundantEncodings",numRedundantEncodings:le})}maybeResetHoldDownTimer(_){this.currentNumRedundantEncodings>0&&(this.lastRedHolddownTimerStartTimestampMs=_)}lossPercent(_){if(this.audioMetricsHistory.length<2)return 0;const D=this.audioMetricsHistory[this.audioMetricsHistory.length-1].timestampMs,Y=this.audioMetricsHistory[this.audioMetricsHistory.length-1].totalPacketsSent,ee=this.audioMetricsHistory[this.audioMetricsHistory.length-1].totalPacketsLost;for(let ie=this.audioMetricsHistory.length-2;ie>=0;ie--)if(D-this.audioMetricsHistory[ie].timestampMs>=_){const ne=ee-this.audioMetricsHistory[ie].totalPacketsLost,re=Y-this.audioMetricsHistory[ie].totalPacketsSent,oe=100*(ne/re);return Math.max(0,Math.min(oe,100))}return 0}shouldUpdateAudioRedWorkerEncodings(_,D){return this.currentNumRedundantEncodings===D?(this.maybeResetHoldDownTimer(_),!1):D<this.currentNumRedundantEncodings&&_-this.lastRedHolddownTimerStartTimestampMs<this.audioRedHoldDownTimeMs?!1:(this.currentNumRedundantEncodings=D,this.maybeResetHoldDownTimer(_),!0)}addRedundantAudioRecoveryMetricsObserver(_){this.redMetricsObservers.add(_)}removeRedundantAudioRecoveryMetricsObserver(_){this.redMetricsObservers.delete(_)}};return DefaultTransceiverController.default=T,DefaultTransceiverController}var SimulcastContentShareTransceiverController={},SimulcastTransceiverController={},hasRequiredSimulcastTransceiverController;function requireSimulcastTransceiverController(){if(hasRequiredSimulcastTransceiverController)return SimulcastTransceiverController;hasRequiredSimulcastTransceiverController=1;var C=SimulcastTransceiverController&&SimulcastTransceiverController.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})},E=SimulcastTransceiverController&&SimulcastTransceiverController.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(SimulcastTransceiverController,"__esModule",{value:!0});const w=E(requireDefaultTransceiverController());let R=class ir extends w.default{constructor(x,S,T){super(x,S,T),this.videoQualityControlParameterMap=new Map;let _=4;for(let D=0;D<ir.NAME_ARR_ASCENDING.length;D++){const Y=ir.NAME_ARR_ASCENDING[D];this.videoQualityControlParameterMap.set(Y,{rid:Y,scaleResolutionDownBy:_,maxBitrate:ir.BITRATE_ARR_ASCENDING[D]*1e3}),_=_/2}}setEncodingParameters(x){return C(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||this._localCameraTransceiver.direction!=="sendrecv")return;const S=this._localCameraTransceiver.sender,T=Array.from(x.values());if(T.length<=0)return;const _=S.getParameters();if(!_.encodings)_.encodings=T;else for(const D of _.encodings)D.rid===ir.LOW_LEVEL_NAME&&this.copyEncodingParams(x.get(ir.LOW_LEVEL_NAME),D),D.rid===ir.MID_LEVEL_NAME&&this.copyEncodingParams(x.get(ir.MID_LEVEL_NAME),D),D.rid===ir.HIGH_LEVEL_NAME&&this.copyEncodingParams(x.get(ir.HIGH_LEVEL_NAME),D);yield S.setParameters(_),this.logVideoTransceiverParameters()})}setVideoSendingBitrateKbps(x){return C(this,void 0,void 0,function*(){})}setupLocalTransceivers(){var x,S;if(this.useTransceivers()&&(!this.defaultMediaStream&&typeof MediaStream<"u"&&(this.defaultMediaStream=new MediaStream),this._localAudioTransceiver||(this._localAudioTransceiver=this.peer.addTransceiver("audio",{direction:"inactive",streams:[this.defaultMediaStream]}),!((S=(x=this.meetingSessionContext)===null||x===void 0?void 0:x.audioProfile)===null||S===void 0)&&S.hasRedundancyEnabled()&&this.setupAudioRedWorker()),!this._localCameraTransceiver)){const T=Array.from(this.videoQualityControlParameterMap.values());this._localCameraTransceiver=this.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream],sendEncodings:T})}}logVideoTransceiverParameters(){const x=this._localCameraTransceiver.sender.getParameters().encodings;let S=`simulcast: current encoding parameters 
`;for(const T of x)S+=`rid=${T.rid} maxBitrate=${T.maxBitrate} active=${T.active} scaleDownBy=${T.scaleResolutionDownBy} maxFrameRate = ${T.maxFramerate} 
`;this.logger.info(S)}copyEncodingParams(x,S){S.active=x.active,S.maxBitrate=x.maxBitrate,S.scaleResolutionDownBy=x.scaleResolutionDownBy,S.maxFramerate=x.maxFramerate}};return SimulcastTransceiverController.default=R,R.LOW_LEVEL_NAME="low",R.MID_LEVEL_NAME="mid",R.HIGH_LEVEL_NAME="hi",R.NAME_ARR_ASCENDING=["low","mid","hi"],R.BITRATE_ARR_ASCENDING=[200,400,1100],SimulcastTransceiverController}var hasRequiredSimulcastContentShareTransceiverController;function requireSimulcastContentShareTransceiverController(){if(hasRequiredSimulcastContentShareTransceiverController)return SimulcastContentShareTransceiverController;hasRequiredSimulcastContentShareTransceiverController=1;var C=SimulcastContentShareTransceiverController&&SimulcastContentShareTransceiverController.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})},E=SimulcastContentShareTransceiverController&&SimulcastContentShareTransceiverController.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(SimulcastContentShareTransceiverController,"__esModule",{value:!0});const w=E(requireSimulcastTransceiverController());let R=class fu extends w.default{constructor(x,S,T){super(x,S,T);let _=2;this.videoQualityControlParameterMap=new Map;for(let D=0;D<fu.NAME_ARR_ASCENDING.length;D++){const Y=fu.NAME_ARR_ASCENDING[D];this.videoQualityControlParameterMap.set(Y,{rid:Y,scaleResolutionDownBy:_,maxBitrate:fu.BITRATE_ARR_ASCENDING[D]*1e3}),_=_/2}}setEncodingParameters(x){return C(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||this._localCameraTransceiver.direction!=="sendrecv")return;const S=this._localCameraTransceiver.sender,T=Array.from(x.values());if(T.length<=0)return;const _=S.getParameters();if(!_.encodings)_.encodings=T;else for(let D=0;D<_.encodings.length;D++)_.encodings[D].rid===w.default.LOW_LEVEL_NAME&&this.copyEncodingParams(x.get(w.default.LOW_LEVEL_NAME),_.encodings[D]),_.encodings[D].rid===w.default.HIGH_LEVEL_NAME&&this.copyEncodingParams(x.get(w.default.HIGH_LEVEL_NAME),_.encodings[D]);yield S.setParameters(_),this.logVideoTransceiverParameters()})}};return SimulcastContentShareTransceiverController.default=R,R.NAME_ARR_ASCENDING=["low","hi"],R.BITRATE_ARR_ASCENDING=[300,1200],SimulcastContentShareTransceiverController}var VideoOnlyTransceiverController={},hasRequiredVideoOnlyTransceiverController;function requireVideoOnlyTransceiverController(){if(hasRequiredVideoOnlyTransceiverController)return VideoOnlyTransceiverController;hasRequiredVideoOnlyTransceiverController=1;var C=VideoOnlyTransceiverController&&VideoOnlyTransceiverController.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(VideoOnlyTransceiverController,"__esModule",{value:!0});const E=C(requireDefaultTransceiverController());let w=class extends E.default{constructor(R,M,x){super(R,M,x)}setupLocalTransceivers(){this.useTransceivers()&&(!this.defaultMediaStream&&typeof MediaStream<"u"&&(this.defaultMediaStream=new MediaStream),this._localCameraTransceiver||(this._localCameraTransceiver=this.peer.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream]})))}};return VideoOnlyTransceiverController.default=w,VideoOnlyTransceiverController}var DefaultVideoCaptureAndEncodeParameter={},hasRequiredDefaultVideoCaptureAndEncodeParameter;function requireDefaultVideoCaptureAndEncodeParameter(){if(hasRequiredDefaultVideoCaptureAndEncodeParameter)return DefaultVideoCaptureAndEncodeParameter;hasRequiredDefaultVideoCaptureAndEncodeParameter=1,Object.defineProperty(DefaultVideoCaptureAndEncodeParameter,"__esModule",{value:!0});let C=class nm{constructor(w,R,M,x,S,T=1,_=!1){this.cameraWidth=w,this.cameraHeight=R,this.cameraFrameRate=M,this.maxEncodeBitrateKbps=x,this.isSimulcast=S,this.scaleResolutionDownBy=T,this.isSVC=_}equal(w){let R=w.captureWidth()===this.cameraWidth&&w.captureHeight()===this.cameraHeight&&w.captureFrameRate()===this.cameraFrameRate&&w.encodeBitrates().length===this.encodeBitrates().length&&w.encodeScaleResolutionDownBy().length===this.encodeScaleResolutionDownBy().length&&w.encodeWidths().length===this.encodeWidths().length&&w.encodeHeights().length===this.encodeHeights().length&&w.isSVCEncoding()===this.isSVC;if(R){for(let M=0;M<w.encodeWidths().length;M++)if(w.encodeWidths()[M]!==this.encodeWidths()[M]||w.encodeHeights()[M]!==this.encodeHeights()[M]||w.encodeBitrates()[M]!==this.encodeBitrates()[M]||w.encodeScaleResolutionDownBy()[M]!==this.encodeScaleResolutionDownBy()[M])return R=!1,R}return R}clone(){return new nm(this.cameraWidth,this.cameraHeight,this.cameraFrameRate,this.maxEncodeBitrateKbps,this.isSimulcast,this.scaleResolutionDownBy,this.isSVC)}captureWidth(){return this.cameraWidth}captureHeight(){return this.cameraHeight}captureFrameRate(){return this.cameraFrameRate}encodeBitrates(){return[this.maxEncodeBitrateKbps]}encodeScaleResolutionDownBy(){return[this.scaleResolutionDownBy]}encodeWidths(){return[this.cameraWidth]}encodeHeights(){return[this.cameraHeight]}isSVCEncoding(){return this.isSVC}};return DefaultVideoCaptureAndEncodeParameter.default=C,DefaultVideoCaptureAndEncodeParameter}var VideoAdaptiveProbePolicy={},VideoPreference={},TargetDisplaySize={},hasRequiredTargetDisplaySize;function requireTargetDisplaySize(){return hasRequiredTargetDisplaySize||(hasRequiredTargetDisplaySize=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.TargetDisplaySize=void 0;var E;(function(w){w[w.Low=0]="Low",w[w.Medium=1]="Medium",w[w.High=2]="High",w[w.Maximum=3]="Maximum"})(E=C.TargetDisplaySize||(C.TargetDisplaySize={})),C.default=E}(TargetDisplaySize)),TargetDisplaySize}var hasRequiredVideoPreference;function requireVideoPreference(){if(hasRequiredVideoPreference)return VideoPreference;hasRequiredVideoPreference=1;var C=VideoPreference&&VideoPreference.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(VideoPreference,"__esModule",{value:!0});const E=C(requireTargetDisplaySize()),w=C(requireVideoQualityAdaptationPreference());let R=class Mo{constructor(x,S,T,_){this.attendeeId=x,this.priority=S,this.targetSize=T!==void 0?T:E.default.Maximum,this.degradationPreference=_!==void 0?_:w.default.Balanced}partialCompare(x){return this.priority-x.priority}equals(x){return this.attendeeId===x.attendeeId&&this.targetSize===x.targetSize&&this.priority===x.priority&&this.degradationPreference===x.degradationPreference}clone(){return new Mo(this.attendeeId,this.priority,this.targetSize,this.degradationPreference)}targetSizeToBitrateKbps(x){switch(x){case E.default.Maximum:return Mo.MAXIMUM_BITRATE_KBPS;case E.default.High:return Mo.HIGH_BITRATE_KBPS;case E.default.Medium:return Mo.MID_BITRATE_KBPS;case E.default.Low:return Mo.LOW_BITRATE_KBPS}}};return VideoPreference.default=R,R.LOW_BITRATE_KBPS=300,R.MID_BITRATE_KBPS=600,R.HIGH_BITRATE_KBPS=1500,R.MAXIMUM_BITRATE_KBPS=1e4,VideoPreference}var VideoPriorityBasedPolicy={},VideoSource={},hasRequiredVideoSource;function requireVideoSource(){if(hasRequiredVideoSource)return VideoSource;hasRequiredVideoSource=1,Object.defineProperty(VideoSource,"__esModule",{value:!0});let C=class{};return VideoSource.default=C,VideoSource}var VideoPriorityBasedPolicyConfig={},hasRequiredVideoPriorityBasedPolicyConfig;function requireVideoPriorityBasedPolicyConfig(){if(hasRequiredVideoPriorityBasedPolicyConfig)return VideoPriorityBasedPolicyConfig;hasRequiredVideoPriorityBasedPolicyConfig=1;var C=VideoPriorityBasedPolicyConfig&&VideoPriorityBasedPolicyConfig.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(VideoPriorityBasedPolicyConfig,"__esModule",{value:!0});const E=C(requireServerSideNetworkAdaption());let w=class Ns{constructor(M=0,x=0){this.networkIssueResponseDelayFactor=M,this.networkIssueRecoveryDelayFactor=x,this.currentNetworkEvent=0,this.bandwidthDecreaseTimestamp=0,this.referenceBitrate=0,this.serverSideNetworkAdaption=E.default.BandwidthProbingAndRemoteVideoQualityAdaption,M<0?M=0:M>1&&(M=1),this.networkIssueResponseDelayFactor=M,x<0?x=0:x>1&&(x=1),this.networkIssueRecoveryDelayFactor=x}allowSubscribe(M,x){let S=0;const T=this.currentNetworkEvent;if(x>this.referenceBitrate)return this.currentNetworkEvent=2,this.referenceBitrate=x,!0;if(x<this.referenceBitrate){if(this.currentNetworkEvent=1,S=this.getSubscribeDelay(this.currentNetworkEvent,M),T!==1)this.bandwidthDecreaseTimestamp=Date.now();else if(Date.now()-this.bandwidthDecreaseTimestamp>S)return this.referenceBitrate=x,!0;return!1}else return this.currentNetworkEvent=0,!1}getSubscribeDelay(M,x){let S=Ns.MINIMUM_DELAY_MS;const T=Ns.MAXIMUM_DELAY_MS-Ns.MINIMUM_DELAY_MS,_=this.networkIssueResponseDelayFactor;switch(M){case 1:S+=T*_*(1+x/10),S=Math.min(Ns.MAXIMUM_DELAY_MS,S);break}return S}};return VideoPriorityBasedPolicyConfig.default=w,w.MINIMUM_DELAY_MS=2e3,w.MAXIMUM_DELAY_MS=8e3,w.Default=new w(0,0),w.UnstableNetworkPreset=new w(0,1),w.StableNetworkPreset=new w(1,0),VideoPriorityBasedPolicyConfig}var hasRequiredVideoPriorityBasedPolicy;function requireVideoPriorityBasedPolicy(){if(hasRequiredVideoPriorityBasedPolicy)return VideoPriorityBasedPolicy;hasRequiredVideoPriorityBasedPolicy=1;var C=VideoPriorityBasedPolicy&&VideoPriorityBasedPolicy.__createBinding||(Object.create?function(fe,ge,he,ve){ve===void 0&&(ve=he),Object.defineProperty(fe,ve,{enumerable:!0,get:function(){return ge[he]}})}:function(fe,ge,he,ve){ve===void 0&&(ve=he),fe[ve]=ge[he]}),E=VideoPriorityBasedPolicy&&VideoPriorityBasedPolicy.__setModuleDefault||(Object.create?function(fe,ge){Object.defineProperty(fe,"default",{enumerable:!0,value:ge})}:function(fe,ge){fe.default=ge}),w=VideoPriorityBasedPolicy&&VideoPriorityBasedPolicy.__importStar||function(fe){if(fe&&fe.__esModule)return fe;var ge={};if(fe!=null)for(var he in fe)he!=="default"&&Object.prototype.hasOwnProperty.call(fe,he)&&C(ge,fe,he);return E(ge,fe),ge},R=VideoPriorityBasedPolicy&&VideoPriorityBasedPolicy.__importDefault||function(fe){return fe&&fe.__esModule?fe:{default:fe}};Object.defineProperty(VideoPriorityBasedPolicy,"__esModule",{value:!0});const M=R(requireAttendee()),x=R(requireClientMetricReportDirection()),S=R(requireClientMetricReportMediaType()),T=R(requireContentShareConstants()),_=requireLogLevel(),D=w(requireServerSideNetworkAdaption()),Y=R(requireVideoSource()),ee=R(requireDefaultVideoStreamIdSet()),ie=R(requireAllHighestVideoBandwidthPolicy()),ne=R(requireTargetDisplaySize()),re=R(requireVideoPreference()),oe=requireVideoPreferences(),ae=R(requireVideoPriorityBasedPolicyConfig()),le=R(requireVideoQualityAdaptationPreference());class de{constructor(){this.bandwidthEstimateKbps=0,this.usedBandwidthKbps=0,this.packetsLost=0,this.nackCount=0,this.rttMs=0}}let me=class en{constructor(ge,he=ae.default.Default){this.logger=ge,this.videoPriorityBasedPolicyConfig=he,this.shouldPauseTiles=!0,this.observerQueue=new Set,this.pausedBwAttendeeIds=new Set,this.wantsResubscribeObserver=void 0,this.videoPriorityBasedPolicyConfig.serverSideNetworkAdaption===D.default.Default&&(this.videoPriorityBasedPolicyConfig.serverSideNetworkAdaption=D.default.BandwidthProbingAndRemoteVideoQualityAdaption),this.reset()}reset(){this.allHighestPolicy=new ie.default(""),this.optimalReceiveSet=new ee.default,this.optimalReceiveStreams=[],this.optimalNonPausedReceiveStreams=[],this.subscribedReceiveSet=new ee.default,this.subscribedReceiveStreams=[],this.videoPreferences=void 0,this.defaultVideoPreferences=void 0,this.shouldPauseTiles=!0,this.pausedStreamIds=new ee.default,this.pausedBwAttendeeIds=new Set,this.videoPreferencesUpdated=!1,this.logCount=0,this.startupPeriod=!0,this.usingPrevTargetRate=!1,this.rateProbeState="Not Probing",this.firstEstimateTimestamp=0,this.lastUpgradeRateKbps=0,this.timeBeforeAllowSubscribeMs=en.MIN_TIME_BETWEEN_SUBSCRIBE_MS,this.lastProbeTimestamp=Date.now(),this.timeBeforeAllowProbeMs=en.MIN_TIME_BETWEEN_PROBE_MS,this.downlinkStats=new de,this.prevDownlinkStats=new de,this.probeFailed=!1,this.serverSideNetworkAdaption=this.videoPriorityBasedPolicyConfig.serverSideNetworkAdaption,this.pendingActionAfterUpdatedPreferences=!1}bindToTileController(ge){this.tileController=ge,this.logger.info("tileController bound")}setWantsResubscribeObserver(ge){this.wantsResubscribeObserver=ge}chooseRemoteVideoSources(ge){var he;if(!(!((he=this.videoPreferences)===null||he===void 0)&&he.equals(ge))){if(this.videoPreferences=ge==null?void 0:ge.clone(),!D.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption)&&(this.pendingActionAfterUpdatedPreferences=!0,this.wantsResubscribeObserver!==void 0&&(this.wantsResubscribeObserver(),this.pendingActionAfterUpdatedPreferences=!1),this.serverSideNetworkAdaption===D.default.BandwidthProbingAndRemoteVideoQualityAdaption)){const ve=new Array;for(const be of this.videoPreferences){const Se=new Y.default;Se.attendee=new M.default,Se.attendee.attendeeId=be.attendeeId,ve.push(Se)}this.allHighestPolicy.chooseRemoteVideoSources(ve);return}this.videoPreferencesUpdated=!0,this.logger.info(`bwe: setVideoPreferences bwe: new preferences: ${JSON.stringify(ge)}`)}}updateIndex(ge){this.videoIndex=ge,this.serverSideNetworkAdaption===D.default.BandwidthProbingAndRemoteVideoQualityAdaption&&this.allHighestPolicy.updateIndex(ge),this.videoPreferences||this.updateDefaultVideoPreferences()}updateDefaultVideoPreferences(){const ge=new Set;for(const Se of this.videoIndex.remoteStreamDescriptions())ge.add(Se.attendeeId);const he=oe.VideoPreferences.prepare(),ve=ge.size;let be=ne.default.Maximum;ve>8?be=ne.default.Low:ve>4&&(be=ne.default.Medium);for(const Se of ge)he.add(new re.default(Se,1,be));this.defaultVideoPreferences=he.build()}updateMetrics(ge){if(!this.videoIndex||this.videoIndex.allStreams().empty())return;this.prevDownlinkStats=this.downlinkStats,this.downlinkStats=new de;const he=ge.getObservableMetrics();this.downlinkStats.bandwidthEstimateKbps=he.availableIncomingBitrate/1e3;for(const ve in ge.streamMetricReports){const be=Number.parseInt(ve,10),Se=ge.streamMetricReports[be];Se.direction===x.default.DOWNSTREAM&&Se.mediaType===S.default.VIDEO&&(Se.currentMetrics.hasOwnProperty("nackCount")&&(this.downlinkStats.nackCount+=ge.countPerSecond("nackCount",be)),Se.currentMetrics.hasOwnProperty("packetsLost")&&(this.downlinkStats.packetsLost+=ge.countPerSecond("packetsLost",be)),Se.currentMetrics.hasOwnProperty("bytesReceived")&&(this.downlinkStats.usedBandwidthKbps+=ge.bitsPerSecond("bytesReceived",be)/1e3))}}wantsResubscribe(){let ge=!1;return!D.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption)&&(ge||(ge=this.pendingActionAfterUpdatedPreferences),this.serverSideNetworkAdaption===D.default.BandwidthProbingAndRemoteVideoQualityAdaption)?ge||this.allHighestPolicy.wantsResubscribe():(this.calculateOptimalReceiveSet(),ge||(ge=!this.subscribedReceiveSet.equal(this.optimalReceiveSet)),ge)}chooseSubscriptions(){return!D.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption)&&(this.pendingActionAfterUpdatedPreferences=!1,this.serverSideNetworkAdaption===D.default.BandwidthProbingAndRemoteVideoQualityAdaption)?this.allHighestPolicy.chooseSubscriptions():(this.subscribedReceiveSet.equal(this.optimalReceiveSet)||(this.lastSubscribeTimestamp=Date.now()),this.subscribedReceiveSet=this.optimalReceiveSet.clone(),this.subscribedReceiveStreams=this.optimalReceiveStreams.slice(),this.subscribedReceiveSet.clone())}addObserver(ge){this.observerQueue.add(ge)}removeObserver(ge){this.observerQueue.delete(ge)}forEachObserver(ge){for(const he of this.observerQueue)ge(he)}setVideoPriorityBasedPolicyConfigs(ge){this.videoPriorityBasedPolicyConfig=ge}calculateOptimalReceiveStreams(){var ge;const he=[],ve=this.videoIndex.remoteStreamDescriptions();if(ve.length===0||!((ge=this.videoPreferences)===null||ge===void 0)&&ge.isEmpty()){this.optimalReceiveStreams=[];return}const be=this.rateProbeState;this.cleanBwPausedTiles(ve),this.handleAppPausedStreams(he,ve);const Se=new Map;for(const He of this.getCurrentVideoPreferences())Se.set(He.attendeeId,He);const Re=ve.filter(He=>Se.has(He.attendeeId)),Ae=!this.streamsWithPreferenceDidChange(Re),Me=!this.startupPeriod&&Ae;if(Me&&Date.now()-this.lastSubscribeTimestamp<this.timeBeforeAllowSubscribeMs)return;Re.sort((He,Je)=>He.maxBitrateKbps===Je.maxBitrateKbps?He.streamId-Je.streamId:He.maxBitrateKbps-Je.maxBitrateKbps);for(const He of Re)(He.avgBitrateKbps===0||He.avgBitrateKbps>He.maxBitrateKbps)&&(He.attendeeId.endsWith(T.default.Modality)&&He.maxBitrateKbps<100?He.maxBitrateKbps=He.avgBitrateKbps:He.avgBitrateKbps=He.maxBitrateKbps);const Be=new Set;for(const He of this.getCurrentVideoPreferences()){const Je=Re.filter(Jt=>Jt.attendeeId===He.attendeeId);if(Je.length<3)continue;let Rt=15,jt=320*480;Je.forEach(Jt=>{Rt=Math.max(Rt,Jt.maxFrameRate),jt=Math.max(jt,Jt.totalPixels())}),Je.sort((Jt,si)=>{if(He.degradationPreference===le.default.MaintainResolution)return Math.abs(Jt.maxFrameRate-si.maxFrameRate)<2?Jt.totalPixels()-si.totalPixels():Jt.maxFrameRate-si.maxFrameRate;if(He.degradationPreference===le.default.MaintainFramerate)return Jt.totalPixels()===si.totalPixels()?Jt.maxFrameRate-si.maxFrameRate:Jt.totalPixels()-si.totalPixels();{const ri=ni=>ni.avgBitrateKbps*Math.pow(2,5*ni.maxFrameRate/Rt*Math.pow(4,ni.totalPixels()/jt));return ri(Jt)-ri(si)}});let hi;for(const Jt of Je){if(hi!==void 0&&(Jt.maxFrameRate<hi.maxFrameRate&&Math.abs(hi.maxFrameRate-Jt.maxFrameRate)>2||Jt.totalPixels()<hi.totalPixels())){Be.add(Jt.streamId);continue}hi=Jt}}const Qe=Re.filter(He=>!Be.has(He.streamId));this.logger.info(`Filtered to ${JSON.stringify(Qe)}`);const Pe={targetDownlinkBitrate:0,chosenTotalBitrate:0,deltaToNextUpgrade:0};Pe.targetDownlinkBitrate=this.determineTargetRate();const je=this.subscribedReceiveSet.size(),Dt=this.downlinkStats.bandwidthEstimateKbps,Xe=!this.videoPriorityBasedPolicyConfig.allowSubscribe(je,Dt);if(this.probeFailed&&(this.probeFailed=!1,this.timeBeforeAllowSubscribeMs=en.MIN_TIME_BETWEEN_SUBSCRIBE_MS,Me&&Xe))return;const zt=this.priorityPolicy(Pe,Qe,he),xe=!D.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption);let $e=0;if(!xe&&!this.startupPeriod&&Ae?this.rateProbeState==="Probing"?$e=this.handleProbe(he,Pe.targetDownlinkBitrate):Pe.deltaToNextUpgrade!==0&&($e=this.maybeOverrideOrProbe(he,Pe,zt)):(this.setProbeState("Not Probing"),this.lastUpgradeRateKbps=0),this.previousStreamsWithPreference=Re,this.videoPreferencesUpdated=!1,$e===1){this.logger.info(`bwe: keepSameSubscriptions stats:${JSON.stringify(this.downlinkStats)}`),this.prevTargetRateKbps=Pe.targetDownlinkBitrate;return}if($e===2){const He=this.calculateSubscribeRate(this.preProbeNonPausedReceiveStreams);this.optimalReceiveStreams=this.preProbeReceiveStreams.slice(),this.processBwPausedStreams(Re,this.preProbeNonPausedReceiveStreams),this.logger.info("bwe: Use Pre-Probe subscription subscribedRate:"+He);return}this.optimalNonPausedReceiveStreams=he.slice();const We=this.pausedBwAttendeeIds.size;this.processBwPausedStreams(Re,he),this.logger.getLogLevel()<=_.LogLevel.INFO&&(this.logCount%15===0||this.rateProbeState!==be||this.optimalReceiveStreams.length!==he.length||We!==this.pausedBwAttendeeIds.size)&&(this.logger.info(this.policyStateLogStr(ve,Pe.targetDownlinkBitrate)),this.logCount=0),this.logCount++,this.prevTargetRateKbps=Pe.targetDownlinkBitrate,this.optimalReceiveStreams=he.slice()}calculateOptimalReceiveSet(){const ge=new ee.default;this.calculateOptimalReceiveStreams();for(const he of this.optimalReceiveStreams)ge.add(he.streamId);if(!this.optimalReceiveSet.equal(ge)){const he=this.calculateSubscribeRate(this.optimalReceiveStreams);this.logger.info(`bwe: new streamSelection: ${JSON.stringify(ge)} subscribedRate:${he}`)}this.optimalReceiveSet=ge}determineTargetRate(){let ge=0;const he=Date.now();return this.downlinkStats.bandwidthEstimateKbps!==0?(this.firstEstimateTimestamp===0&&(this.firstEstimateTimestamp=he),this.startupPeriod&&(this.downlinkStats.bandwidthEstimateKbps>en.DEFAULT_BANDWIDTH_KBPS||this.downlinkStats.packetsLost>0||he-this.firstEstimateTimestamp>en.STARTUP_PERIOD_MS&&this.downlinkStats.bandwidthEstimateKbps<=this.prevDownlinkStats.bandwidthEstimateKbps)&&(this.startupPeriod=!1,this.prevTargetRateKbps=this.downlinkStats.bandwidthEstimateKbps),this.startupPeriod?ge=en.DEFAULT_BANDWIDTH_KBPS:this.rateProbeState==="Probing"&&this.downlinkStats.usedBandwidthKbps>this.downlinkStats.bandwidthEstimateKbps&&this.downlinkStats.packetsLost<en.SPURIOUS_PACKET_LOST_THRESHOLD?(this.logger.info(`bwe: In probe state, overriding estimate ${this.downlinkStats.bandwidthEstimateKbps} with actual receive bitrate ${this.downlinkStats.usedBandwidthKbps}`),ge=this.downlinkStats.usedBandwidthKbps+en.USED_BANDWIDTH_OVERRIDE_BUFFER_KBPS):ge=this.downlinkStats.bandwidthEstimateKbps):this.firstEstimateTimestamp===0?ge=en.DEFAULT_BANDWIDTH_KBPS:ge=this.prevTargetRateKbps,!this.startupPeriod&&(this.usingPrevTargetRate&&this.downlinkStats.bandwidthEstimateKbps<this.prevTargetRateKbps||this.downlinkStats.bandwidthEstimateKbps<this.prevTargetRateKbps*(100-en.LARGE_RATE_CHANGE_TRIGGER_PERCENT)/100||this.downlinkStats.bandwidthEstimateKbps<this.downlinkStats.usedBandwidthKbps*en.LARGE_RATE_CHANGE_TRIGGER_PERCENT/100)&&this.downlinkStats.packetsLost===0?(this.logger.debug(()=>"bwe: ValidateRate: Using Previous rate "+this.prevTargetRateKbps),this.usingPrevTargetRate=!0,ge=this.prevTargetRateKbps):this.usingPrevTargetRate=!1,ge>15e3&&this.logger.warn("bwe: "+ge+" exceeds maximum limit (15000). Limit TargetDisplaySize with VideoPreferences to avoid this."),Math.min(ge,15e3)}setProbeState(ge){if(this.rateProbeState===ge)return!1;const he=Date.now();switch(ge){case"Not Probing":this.probePendingStartTimestamp=0;break;case"Probe Pending":if(this.lastProbeTimestamp===0||he-this.lastProbeTimestamp>en.MIN_TIME_BETWEEN_PROBE_MS)this.probePendingStartTimestamp=he;else return!1;break;case"Probing":if(he-this.probePendingStartTimestamp>this.timeBeforeAllowProbeMs)this.lastProbeTimestamp=he,this.preProbeReceiveStreams=this.subscribedReceiveStreams.slice(),this.preProbeNonPausedReceiveStreams=this.optimalNonPausedReceiveStreams,this.timeBeforeAllowProbeMs=Math.min(this.timeBeforeAllowProbeMs*2,en.MAX_HOLD_BEFORE_PROBE_MS);else return!1;break}return this.logger.info("bwe: setProbeState to "+ge+" from "+this.rateProbeState),this.rateProbeState=ge,!0}upgradeToStream(ge,he){for(let ve=0;ve<ge.length;ve++)if(ge[ve].groupId===he.groupId){const be=he.avgBitrateKbps-ge[ve].avgBitrateKbps;return this.logger.info("bwe: upgradeStream from "+JSON.stringify(ge[ve])+" to "+he),this.lastUpgradeRateKbps=be,ge[ve]=he,be}return ge.push(he),this.lastUpgradeRateKbps=he.avgBitrateKbps,this.lastUpgradeRateKbps}handleProbe(ge,he){if(Date.now()-this.lastProbeTimestamp>en.MAX_ALLOWED_PROBE_TIME_MS)return this.logger.info("bwe: Canceling probe due to timeout"),this.setProbeState("Not Probing"),0;if(this.downlinkStats.packetsLost>0&&(this.logger.info(`bwe: Probe encountering packets lost:${this.downlinkStats.packetsLost}`),this.downlinkStats.packetsLost>en.SPURIOUS_PACKET_LOST_THRESHOLD))return this.setProbeState("Not Probing"),this.logger.info(`bwe: Canceling probe due to packets lost:${this.downlinkStats.packetsLost}`),this.probeFailed=!0,this.timeBeforeAllowSubscribeMs=Math.max(en.MIN_TIME_BETWEEN_SUBSCRIBE_MS,this.timeBeforeAllowSubscribeMs)*3,2;const ve=this.calculateSubscribeRate(this.optimalReceiveStreams);return this.chosenStreamsSameAsLast(ge)||he>ve?(this.logger.info("bwe: Probe successful"),this.setProbeState("Not Probing"),this.timeBeforeAllowProbeMs=en.MIN_TIME_BETWEEN_PROBE_MS,0):1}maybeOverrideOrProbe(ge,he,ve){const be=this.chosenStreamsSameAsLast(ge);let Se=0;const Re=he.targetDownlinkBitrate>en.LOW_BITRATE_THRESHOLD_KBPS?en.TARGET_RATE_CHANGE_TRIGGER_PERCENT:en.TARGET_RATE_CHANGE_TRIGGER_PERCENT*2,Ae=he.targetDownlinkBitrate*Re/100;if(this.targetRateBaselineForDeltaCheckKbps=this.targetRateBaselineForDeltaCheckKbps!==void 0?this.targetRateBaselineForDeltaCheckKbps:this.prevTargetRateKbps,!be&&Math.abs(he.targetDownlinkBitrate-this.targetRateBaselineForDeltaCheckKbps)<Ae?(this.logger.info("bwe: MaybeOverrideOrProbe: Reuse last decision based on delta rate. {"+JSON.stringify(this.subscribedReceiveSet)+"}"),Se=1):this.targetRateBaselineForDeltaCheckKbps=he.targetDownlinkBitrate,this.downlinkStats.packetsLost>this.prevDownlinkStats.packetsLost)return this.setProbeState("Not Probing"),this.lastUpgradeRateKbps=0,Se;if(be||Se===1)switch(this.rateProbeState){case"Not Probing":this.setProbeState("Probe Pending");break;case"Probe Pending":this.setProbeState("Probing")&&(this.upgradeToStream(ge,ve),Se=0);break}else this.setProbeState("Not Probing");return Se}calculateSubscribeRate(ge){let he=0;for(const ve of ge)!this.pausedStreamIds.contain(ve.streamId)&&!this.pausedBwAttendeeIds.has(ve.attendeeId)&&(he+=ve.maxBitrateKbps);return he}handleAppPausedStreams(ge,he){if(!this.tileController){this.logger.warn("tileController not found!");return}this.pausedStreamIds=new ee.default;const ve=this.tileController.getAllRemoteVideoTiles();for(const be of ve){const Se=be.state();if(Se.paused&&!this.pausedBwAttendeeIds.has(Se.boundAttendeeId)){let Re=he.length;for(;Re--;)he[Re].attendeeId===Se.boundAttendeeId&&(this.logger.info("bwe: removed paused attendee "+Se.boundAttendeeId+" streamId: "+he[Re].streamId),this.pausedStreamIds.add(he[Re].streamId),this.subscribedReceiveSet.contain(he[Re].streamId)&&ge.push(he[Re]),he.splice(Re,1))}}}processBwPausedStreams(ge,he){if(!this.tileController){this.logger.warn("tileController not found!");return}const ve=this.getCurrentVideoPreferences();if(ve&&this.shouldPauseTiles){const be=this.tileController.getAllVideoTiles();for(const Se of ve){const Re=this.getVideoTileForAttendeeId(Se.attendeeId,be),Ae=(Re==null?void 0:Re.state().paused)||!1;if(he.some(Me=>Me.attendeeId===Se.attendeeId))Ae&&this.pausedBwAttendeeIds.has(Se.attendeeId)&&(this.logger.info(`bwe: unpausing attendee ${Se.attendeeId} due to bandwidth`),this.forEachObserver(Me=>{Me.tileWillBeUnpausedByDownlinkPolicy(Re.id())}),this.tileController.unpauseVideoTile(Re.id()),this.pausedBwAttendeeIds.delete(Se.attendeeId));else{const Me=ge.some(Be=>Be.attendeeId===Se.attendeeId);if(Re&&Me){const Be=this.optimalReceiveStreams.find(Qe=>Qe.attendeeId===Se.attendeeId);Be!==void 0&&(Ae||(this.logger.info(`bwe: pausing streamId ${Be.streamId} attendee ${Se.attendeeId} due to bandwidth`),this.forEachObserver(Qe=>{Qe.tileWillBePausedByDownlinkPolicy(Re.id())}),this.tileController.pauseVideoTile(Re.id())),he.push(Be)),this.pausedBwAttendeeIds.add(Se.attendeeId)}else if(Me){const Be=this.tileController.addVideoTile();Be.bindVideoStream(Se.attendeeId,!1,null,0,0,0,null),this.forEachObserver(Qe=>{Qe.tileWillBePausedByDownlinkPolicy(Be.id())}),Be.pause(),this.logger.info(`bwe: Created video tile ${Be.id()} for bw paused attendee ${Se.attendeeId}`),this.pausedBwAttendeeIds.add(Se.attendeeId)}}}}}cleanBwPausedTiles(ge){if(!this.tileController){this.logger.warn("tileController not found!");return}const he=this.tileController.getAllRemoteVideoTiles(),ve=this.getCurrentVideoPreferences();for(const be of he){const Se=be.state();Se.boundVideoStream||(ge.some(Re=>Re.attendeeId===Se.boundAttendeeId)?ve!==void 0&&!ve.some(Re=>Re.attendeeId===Se.boundAttendeeId)&&this.tileController.removeVideoTile(Se.tileId):(this.tileController.removeVideoTile(Se.tileId),this.logger.info(`bwe: Removed video tile ${Se.tileId} for bw paused attendee ${Se.boundAttendeeId}`)))}}priorityPolicy(ge,he,ve){let be;const Se=this.getCurrentVideoPreferences(),Re=Se.highestPriority();let Ae,Me=Re;for(;Me!==-1;){Ae=-1;for(const Be of Se)if(Be.priority===Me)for(const Qe of he)Qe.attendeeId===Be.attendeeId&&(ve.some(Pe=>Pe.groupId===Qe.groupId)||(ge.chosenTotalBitrate+Qe.avgBitrateKbps<=ge.targetDownlinkBitrate?(ve.push(Qe),ge.chosenTotalBitrate+=Qe.avgBitrateKbps):ge.deltaToNextUpgrade===0&&(ge.deltaToNextUpgrade=Qe.avgBitrateKbps,be=Qe)));else if(Be.priority>Me){Ae=Be.priority;break}for(const Be of Se)if(Be.priority===Me){for(const Qe of he)if(Qe.attendeeId===Be.attendeeId){const Pe=ve.findIndex(je=>je.groupId===Qe.groupId&&je.maxBitrateKbps<=Qe.maxBitrateKbps&&je.avgBitrateKbps<Qe.avgBitrateKbps);if(Pe!==-1){const je=Qe.avgBitrateKbps-ve[Pe].avgBitrateKbps;this.hasSimulcastStreams(he,Qe.attendeeId,Qe.groupId)&&this.canUpgrade(Qe.avgBitrateKbps,Be.targetSize,Be.targetSizeToBitrateKbps(Be.targetSize),Qe.attendeeId.endsWith(T.default.Modality))?(this.logger.info(`bwe: attendee: ${Qe.attendeeId} group: ${Qe.groupId} has simulcast and can upgrade avgBitrate: ${Qe.avgBitrateKbps} target: ${Be.targetSizeToBitrateKbps(Be.targetSize)} targetTotalBitrate: ${ge.targetDownlinkBitrate}`),ge.chosenTotalBitrate+je<=ge.targetDownlinkBitrate?(ge.chosenTotalBitrate+=je,ve[Pe]=Qe):ge.deltaToNextUpgrade===0&&(ge.deltaToNextUpgrade=je,be=Qe)):this.logger.info("bwe: cannot upgrade stream quality beyond target size")}}}else if(Be.priority>Me)break;if(Me===Re&&ge.deltaToNextUpgrade!==0)break;Me=Ae}return be}getVideoTileForAttendeeId(ge,he){for(const ve of he)if(ve.state().boundAttendeeId===ge)return ve;return null}canUpgrade(ge,he,ve,be){let Se=!1;return(he===ne.default.High||!be&&ge<=ve||be&&he===ne.default.Medium&&ge<=ve)&&(Se=!0),Se?(this.logger.info(`bwe: canUpgrade: bitrateKbps: ${ge} targetBitrateKbps: ${ve}`),!0):(this.logger.info(`bwe: cannot Upgrade: bitrateKbps: ${ge} targetBitrateKbps: ${ve}`),!1)}hasSimulcastStreams(ge,he,ve){let be=0;for(const Se of ge)Se.attendeeId===he&&Se.groupId===ve&&be++;return this.logger.info(`bwe: attendeeId: ${he} groupId: ${ve} hasSimulcastStreams: streamCount: ${be}`),be>1}streamsWithPreferenceDidChange(ge){if(this.previousStreamsWithPreference===void 0||ge.length!==this.previousStreamsWithPreference.length||this.videoPreferencesUpdated===!0)return!0;for(const he of ge)if(this.previousStreamsWithPreference.find(ve=>ve.groupId===he.groupId&&ve.streamId===he.streamId&&ve.maxBitrateKbps===he.maxBitrateKbps)===void 0)return!0;return!1}chosenStreamsSameAsLast(ge){if(this.optimalNonPausedReceiveStreams.length!==ge.length)return!1;for(const he of this.optimalNonPausedReceiveStreams)if(!ge.some(ve=>ve.streamId===he.streamId))return!1;return!0}policyStateLogStr(ge,he){const ve=this.calculateSubscribeRate(this.optimalReceiveStreams),be={targetBitrate:he,subscribedRate:ve,probeState:this.rateProbeState,startupPeriod:this.startupPeriod};let Se="remoteInfos: [";for(const Ae of ge)Se+=`{grpId:${Ae.groupId} strId:${Ae.streamId} maxBr:${Ae.maxBitrateKbps} avgBr:${Ae.avgBitrateKbps}}, `;Se+="]";let Re=`bwe: optimalReceiveSet ${JSON.stringify(be)}
bwe:   prev ${JSON.stringify(this.prevDownlinkStats)}
bwe:   now  ${JSON.stringify(this.downlinkStats)}
bwe:   ${Se}
`;return(this.pausedStreamIds.size()>0||this.pausedBwAttendeeIds.size>0)&&(Re+=`bwe:   paused: app stream ids ${JSON.stringify(this.pausedStreamIds)}  bw attendees { ${Array.from(this.pausedBwAttendeeIds).join(" ")} }
`),this.videoPreferences?Re+=`bwe:   preferences: ${JSON.stringify(this.videoPreferences)}`:Re+=`bwe:   default preferences: ${JSON.stringify(this.defaultVideoPreferences)}`,Re}getCurrentVideoPreferences(){return this.videoPreferences||this.defaultVideoPreferences}getServerSideNetworkAdaption(){return this.serverSideNetworkAdaption}setServerSideNetworkAdaption(ge){this.serverSideNetworkAdaption=ge,this.setProbeState("Not Probing")}supportedServerSideNetworkAdaptions(){return[D.default.None,D.default.BandwidthProbing,D.default.BandwidthProbingAndRemoteVideoQualityAdaption]}getVideoPreferences(){let ge=this.getCurrentVideoPreferences();return ge||(ge=oe.VideoPreferences.prepare().build()),ge}wantsAllTemporalLayersInIndex(){return!0}};return VideoPriorityBasedPolicy.default=me,me.DEFAULT_BANDWIDTH_KBPS=2800,me.STARTUP_PERIOD_MS=6e3,me.LARGE_RATE_CHANGE_TRIGGER_PERCENT=20,me.TARGET_RATE_CHANGE_TRIGGER_PERCENT=15,me.LOW_BITRATE_THRESHOLD_KBPS=300,me.MIN_TIME_BETWEEN_PROBE_MS=5e3,me.MIN_TIME_BETWEEN_SUBSCRIBE_MS=2e3,me.MAX_HOLD_BEFORE_PROBE_MS=3e4,me.MAX_ALLOWED_PROBE_TIME_MS=6e4,me.SPURIOUS_PACKET_LOST_THRESHOLD=2,me.USED_BANDWIDTH_OVERRIDE_BUFFER_KBPS=100,VideoPriorityBasedPolicy}var hasRequiredVideoAdaptiveProbePolicy;function requireVideoAdaptiveProbePolicy(){if(hasRequiredVideoAdaptiveProbePolicy)return VideoAdaptiveProbePolicy;hasRequiredVideoAdaptiveProbePolicy=1;var C=VideoAdaptiveProbePolicy&&VideoAdaptiveProbePolicy.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(VideoAdaptiveProbePolicy,"__esModule",{value:!0});const E=C(requireContentShareConstants()),w=C(requireServerSideNetworkAdaption()),R=C(requireVideoPreference()),M=requireVideoPreferences(),x=C(requireVideoPriorityBasedPolicy()),S=C(requireVideoPriorityBasedPolicyConfig());let T=class rm extends x.default{constructor(D){super(D,rm.createConfig()),this.logger=D,super.shouldPauseTiles=!1,this.videoPreferences=void 0}static createConfig(){const D=new S.default;return D.serverSideNetworkAdaption=w.default.None,D}reset(){super.reset(),super.shouldPauseTiles=!1,this.videoPreferences=void 0}updateIndex(D){super.updateIndex(D);const Y=M.VideoPreferences.prepare();let ee=!1;const ie=D.remoteStreamDescriptions();for(const ne of ie)Y.some(re=>re.attendeeId===ne.attendeeId)||(ne.attendeeId.endsWith(E.default.Modality)?(Y.add(new R.default(ne.attendeeId,1)),ee=!0):Y.add(new R.default(ne.attendeeId,2)));ee?(this.videoPreferences=Y.build(),this.videoPreferencesUpdated=!0):this.videoPreferences=void 0}chooseRemoteVideoSources(D){this.logger.error("chooseRemoteVideoSources should not be called by VideoAdaptiveProbePolicy")}};return VideoAdaptiveProbePolicy.default=T,VideoAdaptiveProbePolicy}var DefaultVideoStreamIndex={},VideoStreamDescription={},hasRequiredVideoStreamDescription;function requireVideoStreamDescription(){if(hasRequiredVideoStreamDescription)return VideoStreamDescription;hasRequiredVideoStreamDescription=1,Object.defineProperty(VideoStreamDescription,"__esModule",{value:!0});const C=requireSignalingProtocol();let E=class am{constructor(R,M,x,S,T){this.attendeeId="",this.groupId=0,this.streamId=0,this.ssrc=0,this.trackLabel="",this.maxBitrateKbps=0,this.avgBitrateKbps=0,this.maxFrameRate=0,this.width=0,this.height=0,this.timeEnabled=0,this.disabledByWebRTC=!1,this.disabledByUplinkPolicy=!1,this.rid="",this.attendeeId=R,this.groupId=M,this.streamId=x,this.maxBitrateKbps=S,this.avgBitrateKbps=T}clone(){const R=new am;return R.attendeeId=this.attendeeId,R.groupId=this.groupId,R.streamId=this.streamId,R.ssrc=this.ssrc,R.trackLabel=this.trackLabel,R.maxBitrateKbps=this.maxBitrateKbps,R.avgBitrateKbps=this.avgBitrateKbps,R.maxFrameRate=this.maxFrameRate,R.timeEnabled=this.timeEnabled,R.disabledByUplinkPolicy=this.disabledByUplinkPolicy,R.width=this.width,R.height=this.height,R}toStreamDescriptor(){const R=C.SdkStreamDescriptor.create();return R.mediaType=C.SdkStreamMediaType.VIDEO,R.trackLabel=this.trackLabel,R.attendeeId=this.attendeeId,R.streamId=this.streamId,R.groupId=this.groupId,R.framerate=this.maxFrameRate,R.maxBitrateKbps=this.disabledByUplinkPolicy?0:this.maxBitrateKbps,R.avgBitrateBps=this.avgBitrateKbps,R}totalPixels(){return this.width*this.height}};return VideoStreamDescription.default=E,VideoStreamDescription}var hasRequiredDefaultVideoStreamIndex;function requireDefaultVideoStreamIndex(){if(hasRequiredDefaultVideoStreamIndex)return DefaultVideoStreamIndex;hasRequiredDefaultVideoStreamIndex=1;var C=DefaultVideoStreamIndex&&DefaultVideoStreamIndex.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(DefaultVideoStreamIndex,"__esModule",{value:!0});const E=requireSignalingProtocol(),w=C(requireDefaultVideoStreamIdSet()),R=C(requireVideoStreamDescription());let M=class{constructor(x){this.logger=x,this.currentIndex=null,this.indexForSubscribe=null,this.indexForLastRemoteVideoUpdate=null,this.currentSubscribeAck=null,this.subscribeTrackToStreamMap=null,this.subscribeStreamToAttendeeMap=null,this.subscribeStreamToExternalUserIdMap=null,this.subscribeSsrcToStreamMap=null,this.subscribeSsrcToGroupMap=null,this.streamToAttendeeMap=null,this.groupIdToAttendeeMap=null,this.streamToExternalUserIdMap=null,this.videoStreamDescription=new R.default,this.sendVideoStreamId=0,this.videoStreamDescription.trackLabel="AmazonChimeExpressVideo",this.videoStreamDescription.streamId=2,this.videoStreamDescription.groupId=2}localStreamDescriptions(){return[this.videoStreamDescription.clone()]}convertBpsToKbps(x){return x>0&&x<1e3?1:Math.trunc(x/1e3)}remoteStreamDescriptions(){if(!this.currentIndex||!this.currentIndex.sources)return[];const x=[];return this.currentIndex.sources.forEach(S=>{const T=new R.default;T.attendeeId=S.attendeeId,T.groupId=S.groupId,T.streamId=S.streamId,T.maxBitrateKbps=S.maxBitrateKbps,T.avgBitrateKbps=this.convertBpsToKbps(S.avgBitrateBps),T.width=S.width,T.height=S.height,T.maxFrameRate=S.framerate,x.push(T)}),x}integrateUplinkPolicyDecision(x){if(x&&x.length){const S=x[0];this.videoStreamDescription.maxBitrateKbps=S.maxBitrate/1e3,this.videoStreamDescription.maxFrameRate=S.maxFramerate}}integrateIndexFrame(x){if(this.currentIndex=x,!x)return;const S=new Map;let T=!1;for(const _ of x.sources){if(!S.has(_.attendeeId)){S.set(_.attendeeId,_.groupId);continue}const D=S.get(_.attendeeId);D<_.groupId&&(this.logger.warn(`Old group ID ${D} found for attendee ID ${_.attendeeId}, replacing with newer group ID ${_.groupId}`),S.set(_.attendeeId,_.groupId)),T=!0}T&&(this.currentIndex.sources=this.currentIndex.sources.filter(_=>S.get(_.attendeeId)===_.groupId)),this.streamToAttendeeMap=null,this.groupIdToAttendeeMap=null,this.streamToExternalUserIdMap=null}subscribeFrameSent(){this.indexForSubscribe=this.currentIndex}remoteVideoUpdateSent(){this.indexForLastRemoteVideoUpdate=this.currentIndex}integrateSubscribeAckFrame(x){this.currentSubscribeAck=x,this.subscribeTrackToStreamMap=this.buildTrackToStreamMap(this.currentSubscribeAck),this.subscribeSsrcToStreamMap=this.buildSSRCToStreamMap(this.currentSubscribeAck),this.subscribeSsrcToGroupMap=this.buildSSRCToGroupMap(this.currentSubscribeAck),this.subscribeStreamToAttendeeMap=this.buildStreamToAttendeeMap(this.indexForSubscribe),this.subscribeStreamToExternalUserIdMap=this.buildStreamExternalUserIdMap(this.indexForSubscribe),this.sendVideoStreamId=0,x.allocations&&x.allocations!==void 0&&x.allocations.length>0&&(this.sendVideoStreamId=x.allocations[0].streamId)}integrateBitratesFrame(x){if(this.currentIndex)for(const S of x.bitrates){const T=this.currentIndex.sources.find(_=>_.streamId===S.sourceStreamId);T!==void 0&&(T.avgBitrateBps=S.avgBitrateBps)}}allStreams(){const x=new w.default;if(this.currentIndex)for(const S of this.currentIndex.sources)x.add(S.streamId);return x}allVideoSendingSourcesExcludingSelf(x){const S=[],T=new Set;if(this.currentIndex&&this.currentIndex.sources&&this.currentIndex.sources.length)for(const _ of this.currentIndex.sources){const{attendeeId:D,externalUserId:Y,mediaType:ee}=_;D!==x&&ee===E.SdkStreamMediaType.VIDEO&&(T.has(D)||(S.push({attendee:{attendeeId:D,externalUserId:Y}}),T.add(D)))}return S}streamSelectionUnderBandwidthConstraint(x,S,T,_){const D=new Set;if(this.currentIndex)for(const re of this.currentIndex.sources)re.attendeeId===x||re.mediaType!==E.SdkStreamMediaType.VIDEO||!S.has(re.attendeeId)&&!T.has(re.attendeeId)&&D.add(re.attendeeId);const Y=this.buildAttendeeToSortedStreamDescriptorMapExcludingSelf(x),ee=new Map;let ie=0;Y.forEach((re,oe)=>{ee.set(oe,re[0]),ie+=re[0].maxBitrateKbps}),ie=this.trySelectHighBitrateForAttendees(Y,S,ie,_,ee),this.trySelectHighBitrateForAttendees(Y,D,ie,_,ee);const ne=new w.default;for(const re of ee.values())ne.add(re.streamId);return ne}highestQualityStreamFromEachGroupExcludingSelf(x){const S=new w.default;if(this.currentIndex){const T=new Map;for(const _ of this.currentIndex.sources)_.attendeeId===x||_.mediaType!==E.SdkStreamMediaType.VIDEO||(!T.has(_.groupId)||_.maxBitrateKbps>T.get(_.groupId).maxBitrateKbps)&&T.set(_.groupId,_);for(const _ of T.values())S.add(_.streamId)}return S}numberOfVideoPublishingParticipantsExcludingSelf(x){return this.highestQualityStreamFromEachGroupExcludingSelf(x).array().length}numberOfParticipants(){return this.currentIndex.numParticipants?this.currentIndex.numParticipants:-1}attendeeIdForTrack(x){const S=this.streamIdForTrack(x);return S===void 0||!this.subscribeStreamToAttendeeMap?(this.logger.warn(`no attendee found for track ${x}`),""):this.subscribeStreamToAttendeeMap.get(S)||(this.logger.info(`track ${x} (stream ${S}) does not correspond to a known attendee`),"")}externalUserIdForTrack(x){const S=this.streamIdForTrack(x);return S===void 0||!this.subscribeStreamToExternalUserIdMap?(this.logger.warn(`no external user id found for track ${x}`),""):this.subscribeStreamToExternalUserIdMap.get(S)||(this.logger.info(`track ${x} (stream ${S}) does not correspond to a known externalUserId`),"")}attendeeIdForStreamId(x){if(!this.streamToAttendeeMap)if(this.currentIndex)this.streamToAttendeeMap=this.buildStreamToAttendeeMap(this.currentIndex);else return"";return this.streamToAttendeeMap.get(x)||(this.logger.info(`stream ID ${x} does not correspond to a known attendee`),"")}attendeeIdForGroupId(x){if(!this.groupIdToAttendeeMap)if(this.currentIndex)this.groupIdToAttendeeMap=this.buildGroupIdToAttendeeMap(this.currentIndex);else return"";return this.groupIdToAttendeeMap.get(x)||(this.logger.info(`group ID ${x} does not correspond to a known attendee`),"")}groupIdForStreamId(x){if(!(!this.currentIndex||!this.currentIndex.sources)){for(const S of this.currentIndex.sources)if(S.streamId===x)return S.groupId;if(this.indexForSubscribe){for(const S of this.indexForSubscribe.sources)if(S.streamId===x)return S.groupId}if(this.indexForLastRemoteVideoUpdate){for(const S of this.indexForLastRemoteVideoUpdate.sources)if(S.streamId===x)return S.groupId}}}StreamIdsInSameGroup(x,S){return this.groupIdForStreamId(x)===this.groupIdForStreamId(S)}streamIdForTrack(x){if(this.subscribeTrackToStreamMap)return this.subscribeTrackToStreamMap.get(x)}streamIdForSSRC(x){if(this.subscribeSsrcToStreamMap)return this.subscribeSsrcToStreamMap.get(x)}overrideStreamIdMappings(x,S){if(this.subscribeTrackToStreamMap){for(const[T,_]of this.subscribeTrackToStreamMap.entries())if(x===_){this.subscribeTrackToStreamMap.set(T,S);break}}if(this.subscribeSsrcToStreamMap){for(const[T,_]of this.subscribeSsrcToStreamMap.entries())if(x===_){this.subscribeSsrcToStreamMap.set(T,S);break}}}groupIdForSSRC(x){if(this.subscribeSsrcToGroupMap)return this.subscribeSsrcToGroupMap.get(x)}streamsPausedAtSource(){const x=new w.default;if(this.currentIndex)for(const S of this.currentIndex.pausedAtSourceIds)x.add(S);return x}sendVideoStreamIdFromRid(x){return this.sendVideoStreamId}buildTrackToStreamMap(x){const S=new Map;this.logger.debug(()=>`trackMap ${JSON.stringify(x.tracks)}`);for(const T of x.tracks)T.trackLabel.length>0&&T.streamId>0&&S.set(T.trackLabel,T.streamId);return S}buildSSRCToStreamMap(x){const S=new Map;this.logger.debug(()=>`ssrcMap ${JSON.stringify(x.tracks)}`);for(const T of x.tracks)T.trackLabel.length>0&&T.streamId>0&&S.set(T.ssrc,T.streamId);return S}buildSSRCToGroupMap(x){const S=new Map;for(const T of x.tracks)T.trackLabel.length>0&&T.streamId>0&&S.set(T.ssrc,this.groupIdForStreamId(T.streamId));return S}buildStreamToAttendeeMap(x){const S=new Map;if(x)for(const T of x.sources)S.set(T.streamId,T.attendeeId);return S}buildGroupIdToAttendeeMap(x){const S=new Map;for(const T of x.sources)S.set(T.groupId,T.attendeeId);return S}buildStreamExternalUserIdMap(x){const S=new Map;if(x)for(const T of x.sources)T.externalUserId&&S.set(T.streamId,T.externalUserId);return S}trySelectHighBitrateForAttendees(x,S,T,_,D){for(const Y of S){if(T>=_)break;if(x.has(Y)){const ee=x.get(Y);for(const ie of ee.reverse())if(T-D.get(Y).maxBitrateKbps+ie.maxBitrateKbps<_){T=T-D.get(Y).maxBitrateKbps+ie.maxBitrateKbps,D.set(Y,ie);break}}}return T}buildAttendeeToSortedStreamDescriptorMapExcludingSelf(x){const S=new Map;if(this.currentIndex)for(const T of this.currentIndex.sources)T.attendeeId===x||T.mediaType!==E.SdkStreamMediaType.VIDEO||(S.has(T.attendeeId)?S.get(T.attendeeId).push(T):S.set(T.attendeeId,[T]));return S.forEach((T,_)=>{T.sort((D,Y)=>D.maxBitrateKbps>Y.maxBitrateKbps?1:D.maxBitrateKbps<Y.maxBitrateKbps?-1:0)}),S}};return DefaultVideoStreamIndex.default=M,DefaultVideoStreamIndex}var SimulcastVideoStreamIndex={},hasRequiredSimulcastVideoStreamIndex;function requireSimulcastVideoStreamIndex(){if(hasRequiredSimulcastVideoStreamIndex)return SimulcastVideoStreamIndex;hasRequiredSimulcastVideoStreamIndex=1;var C=SimulcastVideoStreamIndex&&SimulcastVideoStreamIndex.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(SimulcastVideoStreamIndex,"__esModule",{value:!0});const E=requireSignalingProtocol(),w=C(requireDefaultVideoStreamIndex()),R=C(requireVideoStreamDescription());let M=class Io extends w.default{constructor(){super(...arguments),this.streamIdToBitrateKbpsMap=new Map,this._localStreamInfos=[],this._sendRidToVideoStreamIdMap=new Map}localStreamDescriptions(){const S=[];return this._localStreamInfos.forEach(T=>{S.push(T.clone())}),S}integrateUplinkPolicyDecision(S){let T=!0,_=0;for(let D=0;D<S.length;D++){const Y=S[D].maxBitrate/1e3,ee=S[D].maxFramerate;if(!T||D===this._localStreamInfos.length){T=!1;const ie=new R.default;ie.maxBitrateKbps=Y,ie.maxFrameRate=ee,ie.disabledByUplinkPolicy=Y===0,ie.rid=S[D].rid,Y!==0&&(ie.timeEnabled=Date.now()),this._localStreamInfos.push(ie),_++;continue}this._localStreamInfos[_].maxBitrateKbps===0&&Y>0&&(this._localStreamInfos[_].timeEnabled=Date.now()),this._localStreamInfos[_].maxBitrateKbps=Y,this._localStreamInfos[_].maxFrameRate=ee,this._localStreamInfos[_].disabledByUplinkPolicy=Y===0,_++}T&&this._localStreamInfos.splice(_)}integrateBitratesFrame(S){super.integrateBitratesFrame(S);const T=new Set,_=new Set(this.streamIdToBitrateKbpsMap.keys());for(const D of S.bitrates)T.add(D.sourceStreamId),this.streamIdToBitrateKbpsMap.set(D.sourceStreamId,this.convertBpsToKbps(D.avgBitrateBps));for(const D of _)T.has(D)||(this.streamIdToBitrateKbpsMap.get(D)===Io.UNSEEN_STREAM_BITRATE?this.streamIdToBitrateKbpsMap.set(D,Io.RECENTLY_INACTIVE_STREAM_BITRATE):this.streamIdToBitrateKbpsMap.set(D,Io.NOT_SENDING_STREAM_BITRATE));this.logLocalStreamDescriptions()}logLocalStreamDescriptions(){let S="";for(const T of this._localStreamInfos)S+=`streamId=${T.streamId} maxBitrate=${T.maxBitrateKbps} disabledByUplink=${T.disabledByUplinkPolicy}
`;this.logger.debug(()=>S)}integrateIndexFrame(S){super.integrateIndexFrame(S);const T=new Set,_=new Set(this.streamIdToBitrateKbpsMap.keys());for(const D of this.currentIndex.sources)D.mediaType===E.SdkStreamMediaType.VIDEO&&(T.add(D.streamId),this.streamIdToBitrateKbpsMap.has(D.streamId)||this.streamIdToBitrateKbpsMap.set(D.streamId,Io.UNSEEN_STREAM_BITRATE));for(const D of _)T.has(D)||this.streamIdToBitrateKbpsMap.delete(D)}integrateSubscribeAckFrame(S){if(super.integrateSubscribeAckFrame(S),!S.allocations||S.allocations===void 0)return;let T=0;this._sendRidToVideoStreamIdMap.clear();for(const _ of S.allocations){if(this._localStreamInfos.length<T+1){this.logger.info("simulcast: allocation has more than number of local streams");break}this._localStreamInfos[T].groupId=_.groupId,this._localStreamInfos[T].streamId=_.streamId,this.streamIdToBitrateKbpsMap.has(_.streamId)||this.streamIdToBitrateKbpsMap.set(_.streamId,Io.UNSEEN_STREAM_BITRATE),this._sendRidToVideoStreamIdMap.set(this._localStreamInfos[T].rid,_.streamId),T++}}sendVideoStreamIdFromRid(S){let T=0;return this._sendRidToVideoStreamIdMap.has(S)&&(T=this._sendRidToVideoStreamIdMap.get(S)),T}};return SimulcastVideoStreamIndex.default=M,M.UNSEEN_STREAM_BITRATE=-2,M.RECENTLY_INACTIVE_STREAM_BITRATE=-1,M.NOT_SENDING_STREAM_BITRATE=0,M.BitratesMsgFrequencyMs=4e3,SimulcastVideoStreamIndex}var DefaultVideoTileController={},DefaultDevicePixelRatioMonitor={},hasRequiredDefaultDevicePixelRatioMonitor;function requireDefaultDevicePixelRatioMonitor(){if(hasRequiredDefaultDevicePixelRatioMonitor)return DefaultDevicePixelRatioMonitor;hasRequiredDefaultDevicePixelRatioMonitor=1;var C=DefaultDevicePixelRatioMonitor&&DefaultDevicePixelRatioMonitor.__awaiter||function(w,R,M,x){function S(T){return T instanceof M?T:new M(function(_){_(T)})}return new(M||(M=Promise))(function(T,_){function D(ie){try{ee(x.next(ie))}catch(ne){_(ne)}}function Y(ie){try{ee(x.throw(ie))}catch(ne){_(ne)}}function ee(ie){ie.done?T(ie.value):S(ie.value).then(D,Y)}ee((x=x.apply(w,R||[])).next())})};Object.defineProperty(DefaultDevicePixelRatioMonitor,"__esModule",{value:!0});let E=class{constructor(w,R){if(this.devicePixelRatioSource=w,this.observerQueue=new Set,this.mediaQueryListener=()=>{this.observerQueue.forEach(x=>{x.devicePixelRatioChanged(this.devicePixelRatioSource.devicePixelRatio())})},typeof window>"u")return;const M=matchMedia(`(resolution: ${this.devicePixelRatioSource.devicePixelRatio()}dppx)`);typeof M.addEventListener=="function"?(M.addEventListener("change",this.mediaQueryListener),this.mediaQueryList=M):typeof M.addListener=="function"?(M.addListener(this.mediaQueryListener),this.mediaQueryList=M):R.warn("ignoring DefaultDevicePixelRatioMonitor")}destroy(){return C(this,void 0,void 0,function*(){this.mediaQueryList&&(typeof this.mediaQueryList.addEventListener=="function"?this.mediaQueryList.removeEventListener("change",this.mediaQueryListener):this.mediaQueryList.removeListener(this.mediaQueryListener)),delete this.mediaQueryListener,this.observerQueue.clear()})}registerObserver(w){this.observerQueue.add(w),w.devicePixelRatioChanged(this.devicePixelRatioSource.devicePixelRatio())}removeObserver(w){this.observerQueue.delete(w)}};return DefaultDevicePixelRatioMonitor.default=E,DefaultDevicePixelRatioMonitor}var DevicePixelRatioWindowSource={},hasRequiredDevicePixelRatioWindowSource;function requireDevicePixelRatioWindowSource(){if(hasRequiredDevicePixelRatioWindowSource)return DevicePixelRatioWindowSource;hasRequiredDevicePixelRatioWindowSource=1,Object.defineProperty(DevicePixelRatioWindowSource,"__esModule",{value:!0});let C=class{devicePixelRatio(){return typeof window>"u"||!window||!window.devicePixelRatio?1:window.devicePixelRatio}};return DevicePixelRatioWindowSource.default=C,DevicePixelRatioWindowSource}var hasRequiredDefaultVideoTileController;function requireDefaultVideoTileController(){if(hasRequiredDefaultVideoTileController)return DefaultVideoTileController;hasRequiredDefaultVideoTileController=1;var C=DefaultVideoTileController&&DefaultVideoTileController.__awaiter||function(_,D,Y,ee){function ie(ne){return ne instanceof Y?ne:new Y(function(re){re(ne)})}return new(Y||(Y=Promise))(function(ne,re){function oe(de){try{le(ee.next(de))}catch(me){re(me)}}function ae(de){try{le(ee.throw(de))}catch(me){re(me)}}function le(de){de.done?ne(de.value):ie(de.value).then(oe,ae)}le((ee=ee.apply(_,D||[])).next())})},E=DefaultVideoTileController&&DefaultVideoTileController.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(DefaultVideoTileController,"__esModule",{value:!0});const w=E(requireVideoQualitySettings()),R=E(requireDefaultDevicePixelRatioMonitor()),M=E(requireDevicePixelRatioWindowSource()),x=requireTypes$1(),S=E(requireDefaultVideoTile());let T=class{constructor(_,D,Y){this.tileFactory=_,this.audioVideoController=D,this.logger=Y,this.tileMap=new Map,this.nextTileId=1,this.currentLocalTile=null,this.currentPausedTilesByIds=new Set,this.keepLastFrameWhenPaused=!1,this.keepLastFrameWhenPaused=D.configuration.keepLastFrameWhenPaused}createDevicePixelRatioMonitorIfNeeded(){this.devicePixelRatioMonitor||(this.devicePixelRatioMonitor=new R.default(new M.default,this.logger))}discardDevicePixelRatioMonitorIfNotNeeded(){return C(this,void 0,void 0,function*(){if(this.tileMap.size||!this.devicePixelRatioMonitor)return;const _=this.devicePixelRatioMonitor;return this.devicePixelRatioMonitor=void 0,_.destroy()})}bindVideoElement(_,D){const Y=this.getVideoTile(_);if(Y===null){this.logger.warn(`Ignoring video element binding for unknown tile id ${_}`);return}Y.bindVideoElement(D)}unbindVideoElement(_,D=!0){const Y=this.getVideoTile(_);if(Y===null){this.logger.warn(`Ignoring video element unbinding for unknown tile id ${_}`);return}this.logger.info("Unbinding the video element");const ee=Y.stateRef().boundVideoElement;Y.bindVideoElement(null),D&&(this.logger.info("Cleaning up the video element"),S.default.disconnectVideoStreamFromVideoElement(ee,!1))}startLocalVideoTile(){if(this.audioVideoController.configuration.meetingFeatures.videoMaxResolution===w.default.VideoDisabled)return this.logger.warn("Could not start camera video because max video resolution was set to None"),-1;const _=this.findOrCreateLocalVideoTile();return this.currentLocalTile.stateRef().localTileStarted=!0,this.audioVideoController.update({needsRenegotiation:!0}),_.id()}stopLocalVideoTile(){this.currentLocalTile&&(this.currentLocalTile.stateRef().localTileStarted=!1,this.currentLocalTile.bindVideoStream(this.audioVideoController.configuration.credentials.attendeeId,!0,null,null,null,null,this.audioVideoController.configuration.credentials.externalUserId),this.audioVideoController.update({needsRenegotiation:!0}))}hasStartedLocalVideoTile(){return!!(this.currentLocalTile&&this.currentLocalTile.stateRef().localTileStarted)}removeLocalVideoTile(){this.currentLocalTile&&this.removeVideoTile(this.currentLocalTile.id())}getLocalVideoTile(){return this.currentLocalTile}pauseVideoTile(_){const D=this.getVideoTile(_);D&&(this.currentPausedTilesByIds.has(_)||(this.audioVideoController.pauseReceivingStream(D.stateRef().streamId),this.currentPausedTilesByIds.add(_)),D.pause())}unpauseVideoTile(_){const D=this.getVideoTile(_);D&&(this.currentPausedTilesByIds.has(_)&&(this.audioVideoController.resumeReceivingStream(D.stateRef().streamId),this.currentPausedTilesByIds.delete(_)),D.unpause())}getVideoTile(_){return this.tileMap.has(_)?this.tileMap.get(_):null}getVideoTileArea(_){const D=_.state();let Y=0,ee=0;return D.boundVideoElement&&(Y=D.boundVideoElement.clientHeight*D.devicePixelRatio,ee=D.boundVideoElement.clientWidth*D.devicePixelRatio),Y*ee}getAllRemoteVideoTiles(){const _=new Array;return this.tileMap.forEach((D,Y)=>{(!this.currentLocalTile||Y!==this.currentLocalTile.id())&&_.push(D)}),_}getAllVideoTiles(){return Array.from(this.tileMap.values())}addVideoTile(_=!1){const D=this.nextTileId;this.nextTileId+=1,this.createDevicePixelRatioMonitorIfNeeded();const Y=this.tileFactory.makeTile(D,_,this,this.devicePixelRatioMonitor);return this.tileMap.set(D,Y),Y}removeVideoTile(_){if(!this.tileMap.has(_))return;const D=this.tileMap.get(_);this.currentLocalTile===D&&(this.currentLocalTile=null),D.destroy(),this.tileMap.delete(_),this.audioVideoController.forEachObserver(Y=>{x.Maybe.of(Y.videoTileWasRemoved).map(ee=>ee.bind(Y)(_))}),this.discardDevicePixelRatioMonitorIfNotNeeded()}removeVideoTilesByAttendeeId(_){const D=[];for(const Y of this.getAllVideoTiles()){const ee=Y.state();ee.boundAttendeeId===_&&(this.removeVideoTile(ee.tileId),D.push(ee.tileId))}return D}removeAllVideoTiles(){const _=Array.from(this.tileMap.keys());for(const D of _)this.removeVideoTile(D)}sendTileStateUpdate(_){this.audioVideoController.forEachObserver(D=>{x.Maybe.of(D.videoTileDidUpdate).map(Y=>Y.bind(D)(_))})}haveVideoTilesWithStreams(){for(const _ of this.getAllVideoTiles())if(_.state().boundVideoStream)return!0;return!1}haveVideoTileForAttendeeId(_){return!!this.getVideoTileForAttendeeId(_)}getVideoTileForAttendeeId(_){for(const D of this.getAllVideoTiles())if(D.state().boundAttendeeId===_)return D}captureVideoTile(_){const D=this.getVideoTile(_);return D?D.capture():null}findOrCreateLocalVideoTile(){return this.currentLocalTile?this.currentLocalTile:(this.currentLocalTile=this.addVideoTile(!0),this.currentLocalTile.bindVideoStream(this.audioVideoController.configuration.credentials.attendeeId,!0,null,null,null,null,this.audioVideoController.configuration.credentials.externalUserId),this.currentLocalTile)}};return DefaultVideoTileController.default=T,DefaultVideoTileController}var DefaultVideoTileFactory={},hasRequiredDefaultVideoTileFactory;function requireDefaultVideoTileFactory(){if(hasRequiredDefaultVideoTileFactory)return DefaultVideoTileFactory;hasRequiredDefaultVideoTileFactory=1;var C=DefaultVideoTileFactory&&DefaultVideoTileFactory.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(DefaultVideoTileFactory,"__esModule",{value:!0});const E=C(requireDefaultVideoTile());let w=class{makeTile(R,M,x,S){return new E.default(R,M,x,S)}};return DefaultVideoTileFactory.default=w,DefaultVideoTileFactory}var DefaultSimulcastUplinkPolicy={},SimulcastLayers={},hasRequiredSimulcastLayers;function requireSimulcastLayers(){return hasRequiredSimulcastLayers||(hasRequiredSimulcastLayers=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.SimulcastLayers=void 0;var E;(function(w){w[w.Low=0]="Low",w[w.LowAndMedium=1]="LowAndMedium",w[w.LowAndHigh=2]="LowAndHigh",w[w.Medium=3]="Medium",w[w.MediumAndHigh=4]="MediumAndHigh",w[w.High=5]="High"})(E=C.SimulcastLayers||(C.SimulcastLayers={})),C.default=E}(SimulcastLayers)),SimulcastLayers}var hasRequiredDefaultSimulcastUplinkPolicy;function requireDefaultSimulcastUplinkPolicy(){if(hasRequiredDefaultSimulcastUplinkPolicy)return DefaultSimulcastUplinkPolicy;hasRequiredDefaultSimulcastUplinkPolicy=1;var C=DefaultSimulcastUplinkPolicy&&DefaultSimulcastUplinkPolicy.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(DefaultSimulcastUplinkPolicy,"__esModule",{value:!0});const E=C(requireSimulcastLayers()),w=C(requireSimulcastTransceiverController()),R=requireTypes$1(),M=C(requireDefaultVideoCaptureAndEncodeParameter()),x=C(requireBitrateParameters());let S=class nr{constructor(_,D){this.selfAttendeeId=_,this.logger=D,this.numSenders=0,this.shouldDisableSimulcast=!1,this.newQualityMap=new Map,this.currentQualityMap=new Map,this.newActiveStreams=1,this.videoIndex=null,this.observerQueue=new Set,this.hiTargetBitrateKbps=nr.kHiTargetBitrateKbpsHd,this.midTargetBitrateKbps=nr.kMidTargetBitrateKbpsHd,this.lowTargetBitrateKbps=nr.kLowTargetBitrateKbpsHd,this.enableFhdVideo=!1,this.optimalParameters=new M.default(0,0,0,0,!0),this.parametersInEffect=new M.default(0,0,0,0,!0),this.currentQualityMap=this.fillEncodingParamWithBitrates([this.lowTargetBitrateKbps,0,this.hiTargetBitrateKbps]),this.newQualityMap=this.fillEncodingParamWithBitrates([this.lowTargetBitrateKbps,0,this.hiTargetBitrateKbps])}updateConnectionMetric(_){}calculateEncodingParameters(){const _=[new x.default,new x.default,new x.default];this.shouldDisableSimulcast?(this.newActiveStreams=0,_[0].maxBitrateKbps=0,_[1].maxBitrateKbps=this.hiTargetBitrateKbps,_[2].maxBitrateKbps=0):this.numSenders<=4?(this.newActiveStreams=1,_[0].maxBitrateKbps=this.lowTargetBitrateKbps,_[1].maxBitrateKbps=0,_[2].maxBitrateKbps=this.hiTargetBitrateKbps):(this.newActiveStreams=2,_[0].maxBitrateKbps=this.lowTargetBitrateKbps*2/3,_[1].maxBitrateKbps=this.numSenders<=6?this.midTargetBitrateKbps:this.midTargetBitrateKbps*.6,_[2].maxBitrateKbps=0);const D=_.map((Y,ee,ie)=>Y.maxBitrateKbps);return this.newQualityMap=this.fillEncodingParamWithBitrates(D),this.encodingParametersEqual()||this.logger.info(`simulcast: policy:calculateEncodingParameters numSources:${this.numSenders} shouldDisableSimulcast:${this.shouldDisableSimulcast} newQualityMap: ${this.getQualityMapString(this.newQualityMap)}`),this.newQualityMap}chooseMediaTrackConstraints(){}chooseEncodingParameters(){return this.currentQualityMap=this.newQualityMap,this.activeStreamsToPublish!==this.newActiveStreams&&(this.activeStreamsToPublish=this.newActiveStreams,this.publishEncodingSimulcastLayer()),this.currentQualityMap}updateIndex(_){const D=_.numberOfVideoPublishingParticipantsExcludingSelf(this.selfAttendeeId)+1,Y=D!==this.numSenders,ee=_.numberOfParticipants(),ie=ee>=0&&ee<=2,ne=this.shouldDisableSimulcast!==ie;this.numSenders=D,this.shouldDisableSimulcast=ie,this.optimalParameters=new M.default(this.captureWidth(),this.captureHeight(),this.captureFrameRate(),this.maxBandwidthKbps(),!1),this.videoIndex=_,(Y||ne)&&(this.newQualityMap=this.calculateEncodingParameters())}wantsResubscribe(){return!this.encodingParametersEqual()}compareEncodingParameter(_,D){return JSON.stringify(_)===JSON.stringify(D)}encodingParametersEqual(){let _=!1;for(const D of w.default.NAME_ARR_ASCENDING)if(_=_||!this.compareEncodingParameter(this.newQualityMap.get(D),this.currentQualityMap.get(D)),_)break;return!_}chooseCaptureAndEncodeParameters(){return this.parametersInEffect=this.optimalParameters.clone(),this.parametersInEffect.clone()}captureWidth(){return this.enableFhdVideo?1920:1280}captureHeight(){return this.enableFhdVideo?1080:768}captureFrameRate(){return 15}maxBandwidthKbps(){return this.enableFhdVideo?2500:1400}setIdealMaxBandwidthKbps(_){}setHasBandwidthPriority(_){}setHighResolutionFeatureEnabled(_){this.enableFhdVideo=_,this.hiTargetBitrateKbps=_?nr.kHiTargetBitrateKbpsFhd:nr.kHiTargetBitrateKbpsHd,this.midTargetBitrateKbps=_?nr.kMidTargetBitrateKbpsFhd:nr.kMidTargetBitrateKbpsHd,this.lowTargetBitrateKbps=_?nr.kLowTargetBitrateKbpsFhd:nr.kLowTargetBitrateKbpsHd}wantsVideoDependencyDescriptorRtpHeaderExtension(){return!0}fillEncodingParamWithBitrates(_){const D=new Map,Y=1e3,ee=w.default.NAME_ARR_ASCENDING,ie=_;let ne=this.shouldDisableSimulcast?1:4;for(let re=0;re<ee.length;re++){const oe=ee[re];D.set(oe,{rid:oe,active:ie[re]>0,scaleResolutionDownBy:Math.max(ne,1),maxBitrate:ie[re]*Y}),ne=ne/2}return D}getQualityMapString(_){let D="";return this.videoIndex.localStreamDescriptions().length===3&&_.forEach(Y=>{D+=`{ rid: ${Y.rid} active:${Y.active} maxBitrate:${Y.maxBitrate}}`}),D}getEncodingSimulcastLayer(_){switch(_){case 0:return E.default.High;case 1:return E.default.LowAndHigh;case 2:return E.default.LowAndMedium}}publishEncodingSimulcastLayer(){const _=this.getEncodingSimulcastLayer(this.activeStreamsToPublish);this.forEachObserver(D=>{R.Maybe.of(D.encodingSimulcastLayersDidChange).map(Y=>Y.bind(D)(_))})}addObserver(_){this.logger.info("adding simulcast uplink observer"),this.observerQueue.add(_)}removeObserver(_){this.logger.info("removing simulcast uplink observer"),this.observerQueue.delete(_)}forEachObserver(_){for(const D of this.observerQueue)_(D)}};return DefaultSimulcastUplinkPolicy.default=S,S.kHiTargetBitrateKbpsHd=1200,S.kMidTargetBitrateKbpsHd=600,S.kLowTargetBitrateKbpsHd=300,S.kHiTargetBitrateKbpsFhd=2e3,S.kMidTargetBitrateKbpsFhd=1e3,S.kLowTargetBitrateKbpsFhd=500,DefaultSimulcastUplinkPolicy}var NScaleVideoUplinkBandwidthPolicy={},hasRequiredNScaleVideoUplinkBandwidthPolicy;function requireNScaleVideoUplinkBandwidthPolicy(){if(hasRequiredNScaleVideoUplinkBandwidthPolicy)return NScaleVideoUplinkBandwidthPolicy;hasRequiredNScaleVideoUplinkBandwidthPolicy=1;var C=NScaleVideoUplinkBandwidthPolicy&&NScaleVideoUplinkBandwidthPolicy.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})},E=NScaleVideoUplinkBandwidthPolicy&&NScaleVideoUplinkBandwidthPolicy.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(NScaleVideoUplinkBandwidthPolicy,"__esModule",{value:!0});const w=E(requireDefaultVideoCaptureAndEncodeParameter());let R=class Po{constructor(x,S=!0,T=void 0,_=void 0){this.selfAttendeeId=x,this.scaleResolution=S,this.logger=T,this.browserBehavior=_,this.numberOfPublishedVideoSources=void 0,this.idealMaxBandwidthKbps=1500,this.hasBandwidthPriority=!1,this.encodingParamMap=new Map,this.enableHighResolutionFeature=!1,this.enableSVC=!1,this.isUsingSVCCodec=!0,this.numParticipants=0,this.reset()}reset(){this.numberOfPublishedVideoSources=void 0,this.optimalParameters=new w.default(0,0,0,0,!1),this.parametersInEffect=new w.default(0,0,0,0,!1),this.encodingParamMap.set(Po.encodingMapKey,{maxBitrate:0})}updateConnectionMetric(x){}chooseMediaTrackConstraints(){return{}}chooseEncodingParameters(){return new Map}updateIndex(x){var S;let T=!0;this.transceiverController&&(T=this.transceiverController.hasVideoInput());const _=x.numberOfVideoPublishingParticipantsExcludingSelf(this.selfAttendeeId)+(T?1:0),D=x.numberOfParticipants();if(this.numParticipants===D&&this.numberOfPublishedVideoSources===_){(S=this.logger)===null||S===void 0||S.debug("Skipping update index; Number of participants has not changed");return}this.numberOfPublishedVideoSources=_,this.numParticipants=D,this.updateOptimalParameters()}wantsResubscribe(){return!this.parametersInEffect.equal(this.optimalParameters)}chooseCaptureAndEncodeParameters(){return this.parametersInEffect=this.optimalParameters.clone(),this.parametersInEffect.clone()}updateOptimalParameters(){let x=1;if(this.transceiverController){const S=this.getStreamCaptureSetting();S&&(x=this.calculateEncodingParameters(S).scaleResolutionDownBy)}this.optimalParameters=new w.default(this.captureWidth(),this.captureHeight(),this.captureFrameRate(),this.maxBandwidthKbps(),!1,x,this.enableSVC&&this.numParticipants>2&&this.isUsingSVCCodec)}captureWidth(){let x=640;return this.getNumberOfPublishedVideoSources()>4&&(x=320),x}captureHeight(){let x=384;return this.getNumberOfPublishedVideoSources()>4&&(x=192),x}captureFrameRate(){return 15}maxBandwidthKbps(){if(this.hasBandwidthPriority)return Math.trunc(this.idealMaxBandwidthKbps);let x=0;return this.getNumberOfPublishedVideoSources()<=2?x=this.idealMaxBandwidthKbps:this.getNumberOfPublishedVideoSources()<=4?x=this.idealMaxBandwidthKbps*2/3:x=(544/11+14880/(11*this.getNumberOfPublishedVideoSources()))/600*this.idealMaxBandwidthKbps,Math.trunc(x)}setIdealMaxBandwidthKbps(x){this.idealMaxBandwidthKbps=x}setHasBandwidthPriority(x){this.hasBandwidthPriority=x}setTransceiverController(x){this.transceiverController=x}setSVCEnabled(x){var S;this.enableSVC=x,(S=this.logger)===null||S===void 0||S.info(`setSVCEnabled, enable: ${x}}`)}setHighResolutionFeatureEnabled(x){this.enableHighResolutionFeature=x}updateTransceiverController(){return C(this,void 0,void 0,function*(){const x=this.getStreamCaptureSetting();if(!x)return;const S=this.calculateEncodingParameters(x);this.shouldUpdateEndcodingParameters(S)&&(this.encodingParamMap.set(Po.encodingMapKey,S),this.transceiverController.setEncodingParameters(this.encodingParamMap))})}shouldUpdateEndcodingParameters(x){var S,T;const _=(T=(S=this.transceiverController.localVideoTransceiver().sender.getParameters())===null||S===void 0?void 0:S.encodings)===null||T===void 0?void 0:T[0];return x.maxBitrate!==(_==null?void 0:_.maxBitrate)||x.scaleResolutionDownBy!==(_==null?void 0:_.scaleResolutionDownBy)||(x==null?void 0:x.scalabilityMode)!==(_==null?void 0:_.scalabilityMode)}calculateEncodingParameters(x){var S,T,_;const D=this.maxBandwidthKbps()*1e3;let Y=1,ee=720;if(x.height!==void 0&&x.width!==void 0&&this.scaleResolution&&!this.hasBandwidthPriority&&this.getNumberOfPublishedVideoSources()>2&&(ee=Po.targetHeightArray[Math.min(this.getNumberOfPublishedVideoSources(),Po.targetHeightArray.length-1)][this.enableHighResolutionFeature?1:0],ee===480&&!((S=this.browserBehavior)===null||S===void 0)&&S.disable480pResolutionScaleDown()&&(ee=360),Y=Math.max(Math.min(x.height,x.width)/ee,1),(T=this.logger)===null||T===void 0||T.info(`Resolution scale factor is ${Y} for capture resolution ${x.width}x${x.height}. New dimension is ${x.width/Y}x${x.height/Y}`)),this.enableSVC){let ie;return this.numParticipants>=0&&this.numParticipants<3||!this.isUsingSVCCodec?ie="L1T1":ie="L3T3",(_=this.logger)===null||_===void 0||_.info(`calculateEncodingParameters: SVC: ${this.enableSVC}    participants: ${this.numParticipants}     publishers: ${this.getNumberOfPublishedVideoSources()}     bitrate: ${D}  targetHeight: ${ee}  scalabilityMode: ${ie}   isUsingSVCCodec: ${this.isUsingSVCCodec}`),{scaleResolutionDownBy:Y,maxBitrate:D,scalabilityMode:ie}}else return{scaleResolutionDownBy:Y,maxBitrate:D}}getStreamCaptureSetting(){var x,S,T,_;return(_=(T=(S=(x=this.transceiverController)===null||x===void 0?void 0:x.localVideoTransceiver())===null||S===void 0?void 0:S.sender)===null||T===void 0?void 0:T.track)===null||_===void 0?void 0:_.getSettings()}getNumberOfPublishedVideoSources(){var x;return(x=this.numberOfPublishedVideoSources)!==null&&x!==void 0?x:0}wantsVideoDependencyDescriptorRtpHeaderExtension(){return this.enableSVC}setMeetingSupportedVideoSendCodecs(x,S){const T=x??S,_=T.length>0&&Po.SVCCodecNames.includes(T[0].codecName);_!==this.isUsingSVCCodec&&(this.isUsingSVCCodec=_,this.updateOptimalParameters())}};return NScaleVideoUplinkBandwidthPolicy.default=R,R.encodingMapKey="video",R.targetHeightArray=[[0,0],[0,0],[0,0],[540,720],[540,720],[480,540],[480,540],[480,540],[480,540],[360,480],[360,480],[360,480],[360,480],[270,360],[270,360],[270,360],[270,360],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270]],R.SVCCodecNames=["VP9"],NScaleVideoUplinkBandwidthPolicy}var DefaultVolumeIndicatorAdapter={},hasRequiredDefaultVolumeIndicatorAdapter;function requireDefaultVolumeIndicatorAdapter(){if(hasRequiredDefaultVolumeIndicatorAdapter)return DefaultVolumeIndicatorAdapter;hasRequiredDefaultVolumeIndicatorAdapter=1,Object.defineProperty(DefaultVolumeIndicatorAdapter,"__esModule",{value:!0});let C=class pu{constructor(w,R,M,x,S){this.logger=w,this.realtimeController=R,this.minVolumeDecibels=M,this.maxVolumeDecibels=x,this.selfAttendeeId=S,this.streamIdToAttendeeId={},this.streamIdToExternalUserId={},this.warnedAboutMissingStreamIdMapping={},this.attendeeIdToStreamId={},this.sessionReconnected=!1}onReconnect(){this.sessionReconnected=!0}sendRealtimeUpdatesForAudioStreamIdInfo(w){let R=0;for(const M of w.streams){const x=!!M.attendeeId,S=!!M.externalUserId,T=M.hasOwnProperty("muted"),_=!!M.dropped;if(x){this.attendeeIdToStreamId[M.attendeeId]&&this.attendeeIdToStreamId[M.attendeeId]<M.audioStreamId&&delete this.attendeeIdToStreamId[M.attendeeId],this.streamIdToAttendeeId[M.audioStreamId]=M.attendeeId;const D=S?M.externalUserId:M.attendeeId;this.streamIdToExternalUserId[M.audioStreamId]=D,this.attendeeIdToStreamId[M.attendeeId]=M.audioStreamId,this.realtimeController.realtimeSetAttendeeIdPresence(M.attendeeId,!0,D,!1,{attendeeIndex:R++,attendeesInFrame:w.streams.length})}if(T){const D=this.streamIdToAttendeeId[M.audioStreamId],Y=this.streamIdToExternalUserId[M.audioStreamId];this.realtimeController.realtimeUpdateVolumeIndicator(D,null,M.muted,null,Y)}if(!x&&!T){const D=this.streamIdToAttendeeId[M.audioStreamId];if(D){const Y=this.streamIdToExternalUserId[M.audioStreamId];delete this.streamIdToAttendeeId[M.audioStreamId],delete this.streamIdToExternalUserId[M.audioStreamId],delete this.warnedAboutMissingStreamIdMapping[M.audioStreamId],this.attendeeIdToStreamId[D]===M.audioStreamId&&delete this.attendeeIdToStreamId[D];let ee=!1;for(const ie of Object.keys(this.streamIdToAttendeeId)){const ne=parseInt(ie);if(ne>M.audioStreamId&&this.streamIdToAttendeeId[ne]===D){ee=!0;break}}ee||this.realtimeController.realtimeSetAttendeeIdPresence(D,!1,Y,_,{attendeeIndex:R++,attendeesInFrame:w.streams.length})}}}this.sessionReconnected&&(this.cleanUpState(w),this.sessionReconnected=!1)}cleanUpState(w){const R=Object.values(this.streamIdToAttendeeId),M=w.streams.map(S=>S.attendeeId),x=R.filter(S=>!M.includes(S));for(const[S,T]of x.entries()){const _=this.attendeeIdToStreamId[T],D=this.streamIdToExternalUserId[_];if(delete this.streamIdToAttendeeId[_],delete this.streamIdToExternalUserId[_],delete this.warnedAboutMissingStreamIdMapping[_],delete this.attendeeIdToStreamId[T],T===this.selfAttendeeId){this.logger.warn("the volume indicator adapter cleans up the current attendee (presence = false) after reconnection");continue}this.realtimeController.realtimeSetAttendeeIdPresence(T,!1,D,!1,{attendeeIndex:S,attendeesInFrame:T.length})}}sendRealtimeUpdatesForAudioMetadata(w){let R=null,M=null;for(const x of w.attendeeStates){const S=this.attendeeIdForStreamId(x.audioStreamId);x.hasOwnProperty("volume")&&(R===null&&(R={}),S!==null&&(R[S]=this.normalizedVolume(x))),x.hasOwnProperty("signalStrength")&&(M===null&&(M={}),S!==null&&(M[S]=this.normalizedSignalStrength(x)))}this.applyRealtimeUpdatesForAudioMetadata(R,M)}normalizedVolume(w){const R=1-(-w.volume-this.maxVolumeDecibels)/(this.minVolumeDecibels-this.maxVolumeDecibels);return Math.min(Math.max(R,0),1)}normalizedSignalStrength(w){const R=w.signalStrength/pu.MAX_SIGNAL_STRENGTH_LEVELS;return Math.min(Math.max(R,0),1)}applyRealtimeUpdatesForAudioMetadata(w,R){for(const M in this.streamIdToAttendeeId){const x=this.streamIdToAttendeeId[M],S=this.streamIdToExternalUserId[M];let T=null,_=null;w!==null&&(w.hasOwnProperty(x)?T=w[x]:T=pu.IMPLICIT_VOLUME),R!==null&&(R.hasOwnProperty(x)?_=R[x]:_=pu.IMPLICIT_SIGNAL_STRENGTH),(T!==null||_!==null)&&this.realtimeController.realtimeUpdateVolumeIndicator(x,T,null,_,S)}}attendeeIdForStreamId(w){return w===0?null:this.streamIdToAttendeeId[w]||(this.warnedAboutMissingStreamIdMapping[w]||(this.warnedAboutMissingStreamIdMapping[w]=!0,this.logger.warn(`volume indicator stream id ${w} seen before being defined`)),null)}};return DefaultVolumeIndicatorAdapter.default=C,C.MAX_SIGNAL_STRENGTH_LEVELS=2,C.IMPLICIT_VOLUME=0,C.IMPLICIT_SIGNAL_STRENGTH=1,DefaultVolumeIndicatorAdapter}var hasRequiredDefaultAudioVideoController;function requireDefaultAudioVideoController(){if(hasRequiredDefaultAudioVideoController)return DefaultAudioVideoController;hasRequiredDefaultAudioVideoController=1;var C=DefaultAudioVideoController&&DefaultAudioVideoController.__createBinding||(Object.create?function(Ce,ke,Ne,Le){Le===void 0&&(Le=Ne),Object.defineProperty(Ce,Le,{enumerable:!0,get:function(){return ke[Ne]}})}:function(Ce,ke,Ne,Le){Le===void 0&&(Le=Ne),Ce[Le]=ke[Ne]}),E=DefaultAudioVideoController&&DefaultAudioVideoController.__setModuleDefault||(Object.create?function(Ce,ke){Object.defineProperty(Ce,"default",{enumerable:!0,value:ke})}:function(Ce,ke){Ce.default=ke}),w=DefaultAudioVideoController&&DefaultAudioVideoController.__importStar||function(Ce){if(Ce&&Ce.__esModule)return Ce;var ke={};if(Ce!=null)for(var Ne in Ce)Ne!=="default"&&Object.prototype.hasOwnProperty.call(Ce,Ne)&&C(ke,Ce,Ne);return E(ke,Ce),ke},R=DefaultAudioVideoController&&DefaultAudioVideoController.__awaiter||function(Ce,ke,Ne,Le){function ai(et){return et instanceof Ne?et:new Ne(function(Kt){Kt(et)})}return new(Ne||(Ne=Promise))(function(et,Kt){function qe(Ve){try{pe(Le.next(Ve))}catch(we){Kt(we)}}function Ge(Ve){try{pe(Le.throw(Ve))}catch(we){Kt(we)}}function pe(Ve){Ve.done?et(Ve.value):ai(Ve.value).then(qe,Ge)}pe((Le=Le.apply(Ce,ke||[])).next())})},M=DefaultAudioVideoController&&DefaultAudioVideoController.__importDefault||function(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}};Object.defineProperty(DefaultAudioVideoController,"__esModule",{value:!0});const x=M(requireDefaultActiveSpeakerDetector()),S=M(requireDefaultAudioMixController()),T=M(requireAudioProfile()),_=M(requireDefaultBrowserBehavior()),D=M(requireConnectionHealthData()),Y=M(requireSignalingAndMetricsConnectionMonitor()),ee=M(requireVideoQualitySettings()),ie=M(requireMeetingSessionStatus()),ne=M(requireMeetingSessionStatusCode()),re=M(requireMeetingSessionVideoAvailability()),oe=M(requireDefaultModality()),ae=M(requireDefaultPingPong()),le=M(requireDefaultRealtimeController()),de=M(requireAsyncScheduler()),me=M(requireDefaultSessionStateController()),fe=M(requireSessionStateControllerAction()),ge=M(requireSessionStateControllerState()),he=M(requireSessionStateControllerTransitionResult()),ve=M(requireDefaultSignalingClient()),be=w(requireServerSideNetworkAdaption()),Se=M(requireSignalingClientEventType()),Re=M(requireSignalingClientVideoSubscriptionConfiguration()),Ae=requireSignalingProtocol(),Me=M(requireStatsCollector()),Be=M(requireAttachMediaInputTask()),Qe=M(requireCleanRestartedSessionTask()),Pe=M(requireCleanStoppedSessionTask()),je=M(requireCreatePeerConnectionTask()),Dt=M(requireCreateSDPTask()),Xe=M(requireFinishGatheringICECandidatesTask()),zt=M(requireJoinAndReceiveIndexTask()),xe=M(requireLeaveAndReceiveLeaveAckTask()),$e=M(requireListenForVolumeIndicatorsTask()),We=M(requireMonitorTask()),He=M(requireOpenSignalingConnectionTask()),Je=M(requireParallelGroupTask()),Rt=M(requirePromoteToPrimaryMeetingTask()),jt=M(requireReceiveAudioInputTask()),hi=M(requireReceiveRemoteVideoPauseResumeTask()),Jt=M(requireReceiveVideoInputTask()),si=M(requireReceiveVideoStreamIndexTask()),ri=M(requireSendAndReceiveDataMessagesTask()),ni=M(requireSerialGroupTask()),Pi=M(requireSetLocalDescriptionTask()),Ci=M(requireSetRemoteDescriptionTask()),qi=M(requireSubscribeAndReceiveSubscribeAckTask()),vi=M(requireTimeoutTask()),Ki=M(requireWaitForAttendeePresenceTask()),Vi=M(requireDefaultTransceiverController()),zi=M(requireSimulcastContentShareTransceiverController()),xi=M(requireSimulcastTransceiverController()),Di=M(requireVideoOnlyTransceiverController()),bi=requireTypes$1(),mi=M(requireDefaultVideoCaptureAndEncodeParameter()),Oi=M(requireAllHighestVideoBandwidthPolicy()),Bi=M(requireVideoAdaptiveProbePolicy()),Ji=requireVideoPreferences(),Bt=M(requireDefaultVideoStreamIdSet()),it=M(requireDefaultVideoStreamIndex()),ti=M(requireSimulcastVideoStreamIndex()),Ee=M(requireDefaultVideoTileController()),ct=M(requireDefaultVideoTileFactory()),dt=M(requireDefaultSimulcastUplinkPolicy()),St=M(requireNScaleVideoUplinkBandwidthPolicy()),ft=M(requireDefaultVolumeIndicatorAdapter()),Ie=M(requireAudioVideoControllerState());let Ye=class mu{constructor(ke,Ne,Le,ai,et,Kt){this._audioProfile=new T.default,this.connectionHealthData=new D.default,this.observerQueue=new Set,this.meetingSessionContext=new Ie.default,this.enableSimulcast=!1,this.enableSVC=!1,this.useUpdateTransceiverControllerForUplink=!1,this.totalRetryCount=0,this.startAudioVideoTimestamp=0,this.mayNeedRenegotiationForSimulcastLayerChange=!1,this.promotedToPrimaryMeeting=!1,this.hasGetRTCPeerConnectionStatsDeprecationMessageBeenSent=!1,this.receiveIndexTask=void 0,this.monitorTask=void 0,this.receiveRemotePauseResumeTask=void 0,this.destroyed=!1,this._logger=Ne,this.sessionStateController=new me.default(this._logger),this._configuration=ke,this._webSocketAdapter=Le,this._realtimeController=new le.default(ai),this._realtimeController.realtimeSetLocalAttendeeId(ke.credentials.attendeeId,ke.credentials.externalUserId),this._mediaStreamBroker=ai,this._reconnectController=et,this._videoTileController=new Ee.default(new ct.default,this,this._logger),this._audioMixController=new S.default(this._logger),this._mediaStreamBroker.addMediaStreamBrokerObserver(this._audioMixController),this.meetingSessionContext.logger=this._logger,this._eventController=Kt}destroy(){return R(this,void 0,void 0,function*(){this.observerQueue.clear(),this._mediaStreamBroker.removeMediaStreamBrokerObserver(this._audioMixController),this.destroyed=!0})}get configuration(){return this._configuration}get realtimeController(){return this._realtimeController}get activeSpeakerDetector(){return this._activeSpeakerDetector||(this._activeSpeakerDetector=new x.default(this._realtimeController,this._configuration.credentials.attendeeId,this.handleHasBandwidthPriority.bind(this))),this._activeSpeakerDetector}get videoTileController(){return this._videoTileController}get audioMixController(){return this._audioMixController}get logger(){return this._logger}get rtcPeerConnection(){return this.meetingSessionContext&&this.meetingSessionContext.peer||null}get mediaStreamBroker(){return this._mediaStreamBroker}get eventController(){return this._eventController}getRTCPeerConnectionStats(ke){return this.hasGetRTCPeerConnectionStatsDeprecationMessageBeenSent||(this.logger.warn("The `getRTCPeerConnectionStats()` is on its way to be deprecated. It makes an additional call to the `getStats` API and therefore may cause slight performance degradation. Please use the new API `clientMetricReport.getRTCStatsReport()` returned by `metricsDidReceive(clientMetricReport)` callback instead."),this.hasGetRTCPeerConnectionStatsDeprecationMessageBeenSent=!0),this.rtcPeerConnection?this.rtcPeerConnection.getStats(ke):null}setAudioProfile(ke){this._audioProfile=ke}addObserver(ke){this.logger.info("adding meeting observer"),this.observerQueue.add(ke)}removeObserver(ke){this.logger.info("removing meeting observer"),this.observerQueue.delete(ke)}forEachObserver(ke){for(const Ne of this.observerQueue)de.default.nextTick(()=>{this.observerQueue.has(Ne)&&ke(Ne)})}initSignalingClient(){this.connectionHealthData.reset(),!this.meetingSessionContext.signalingClient&&(this.meetingSessionContext=new Ie.default,this.meetingSessionContext.logger=this.logger,this.meetingSessionContext.eventController=this.eventController,this.meetingSessionContext.browserBehavior=new _.default,this.meetingSessionContext.videoSendCodecPreferences=this.videoSendCodecPreferences,this.meetingSessionContext.audioProfile=this._audioProfile,this.meetingSessionContext.meetingSessionConfiguration=this.configuration,this.meetingSessionContext.signalingClient=new ve.default(this._webSocketAdapter,this.logger))}uninstallPreStartObserver(){this.meetingSessionContext.signalingClient.removeObserver(this.preStartObserver),this.preStartObserver=void 0}prestart(){return this.logger.info("Pre-connecting signaling connection."),this.createOrReuseSignalingTask().run().then(()=>{const ke=()=>R(this,void 0,void 0,function*(){this.logger.info("Early connection closed; discarding signaling task."),this.signalingTask=void 0,this.uninstallPreStartObserver()});this.preStartObserver={handleSignalingClientEvent(Ne){Ne.type===Se.default.WebSocketClosed&&ke()}},this.meetingSessionContext.signalingClient.registerObserver(this.preStartObserver)}).catch(ke=>{this.logger.error(`Signaling task pre-start failed: ${ke}`),this.signalingTask=void 0})}start(ke){this.startReturningPromise(ke).then(()=>{this.logger.info("start completed")}).catch(Ne=>{this.logger.error(`start failed: ${Ne}`)})}startReturningPromise(ke){return(ke==null?void 0:ke.signalingOnly)===!0?this.prestart():(this.activeSpeakerDetector,new Promise((Ne,Le)=>{this.sessionStateController.perform(fe.default.Connect,()=>{this.actionConnect(!1).then(Ne).catch(Le)})}))}connectWithPromises(ke){const Ne=this.meetingSessionContext,Le=(Ze,$t)=>new vi.default(this.logger,$t,Ze);this.monitorTask=new We.default(Ne,this.configuration.connectionHealthPolicyConfiguration,this.connectionHealthData);const ai=this.monitorTask.once(),et=new jt.default(Ne).once();this.receiveIndexTask=new si.default(Ne),this.monitorTask.pauseResubscribeCheck(),this.receiveIndexTask.pauseIngestion();const Kt=new ni.default(this.logger,"Signaling",[this.createOrReuseSignalingTask(),new $e.default(Ne),new ri.default(Ne),new zt.default(Ne),this.receiveIndexTask]).once(),qe=new je.default(Ne).once(Kt),Ge=new Be.default(Ne).once(qe,et),pe=new Dt.default(Ne).once(Ge),Ve=new Pi.default(Ne).once(pe),we=new Xe.default(Ne).once(Ve),ze=new qi.default(Ne).once(we);return this.receiveRemotePauseResumeTask=new hi.default(Ne),this.receiveRemotePauseResumeTask.once(ze),new ni.default(this.logger,this.wrapTaskName("AudioVideoStart"),[ai,Le(this.configuration.connectionTimeoutMs,new ni.default(this.logger,"Peer",[ze,this.receiveRemotePauseResumeTask,ke?new vi.default(this.logger,new Je.default(this.logger,"FinalizeConnection",[new Ki.default(Ne),new Ci.default(Ne)]),this.meetingSessionContext.meetingSessionConfiguration.attendeePresenceTimeoutMs):new Ci.default(Ne)]))])}actionConnect(ke){var Ne;return R(this,void 0,void 0,function*(){this.initSignalingClient(),this.uninstallPreStartObserver(),this.meetingSessionContext.mediaStreamBroker=this._mediaStreamBroker,this.meetingSessionContext.realtimeController=this._realtimeController,this.meetingSessionContext.audioMixController=this._audioMixController,this.meetingSessionContext.audioVideoController=this,this.enableSimulcast=this.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers&&new _.default().hasChromiumWebRTC(),this.enableSimulcast&&this.configuration.enableSVC&&this.logger.warn("SVC cannot be enabled at the same time as simulcast. Disabling SVC, using simulcast."),this.enableSVC=!this.enableSimulcast&&this.configuration.enableSVC&&new _.default().supportsScalableVideoCoding();const Le=!!this.configuration.urls.audioHostURL;if(Le?this.enableSimulcast?(this.logger.info("Using transceiver controller with simulcast support"),new oe.default(this.configuration.credentials.attendeeId).hasModality(oe.default.MODALITY_CONTENT)?this.meetingSessionContext.transceiverController=new zi.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext):this.meetingSessionContext.transceiverController=new xi.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext)):(this.logger.info("Using default transceiver controller"),this.meetingSessionContext.transceiverController=new Vi.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext)):(this.logger.info("Using video only transceiver controller"),this.meetingSessionContext.transceiverController=new Di.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext)),this.meetingSessionContext.volumeIndicatorAdapter=new ft.default(this.logger,this._realtimeController,mu.MIN_VOLUME_DECIBELS,mu.MAX_VOLUME_DECIBELS,this.configuration.credentials.attendeeId),this.meetingSessionContext.videoTileController=this._videoTileController,this.meetingSessionContext.videoDownlinkBandwidthPolicy=this.configuration.videoDownlinkBandwidthPolicy,this.meetingSessionContext.videoUplinkBandwidthPolicy=this.configuration.videoUplinkBandwidthPolicy,this.meetingSessionContext.enableSimulcast=this.enableSimulcast,this.meetingSessionContext.enableSVC=this.enableSVC,this.enableSimulcast){let Kt=this.meetingSessionContext.videoUplinkBandwidthPolicy;Kt||(Kt=new dt.default(this.configuration.credentials.attendeeId,this.meetingSessionContext.logger),this.meetingSessionContext.videoUplinkBandwidthPolicy=Kt),Kt.addObserver(this),this.meetingSessionContext.videoDownlinkBandwidthPolicy||(this.meetingSessionContext.videoDownlinkBandwidthPolicy=new Bi.default(this.meetingSessionContext.logger)),this.meetingSessionContext.videoStreamIndex=new ti.default(this.logger)}else this.meetingSessionContext.enableSimulcast=!1,this.meetingSessionContext.videoStreamIndex=new it.default(this.logger),this.meetingSessionContext.videoUplinkBandwidthPolicy||(this.meetingSessionContext.videoUplinkBandwidthPolicy=new St.default(this.configuration.credentials.attendeeId,!this.meetingSessionContext.browserBehavior.disableResolutionScaleDown(),this.meetingSessionContext.logger,this.meetingSessionContext.browserBehavior),this.meetingSessionContext.videoUplinkBandwidthPolicy.setSVCEnabled(this.enableSVC)),this.meetingSessionContext.videoDownlinkBandwidthPolicy||(this.meetingSessionContext.videoDownlinkBandwidthPolicy=new Oi.default(this.configuration.credentials.attendeeId)),this.meetingSessionContext.videoUplinkBandwidthPolicy.setTransceiverController&&this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController&&(this.useUpdateTransceiverControllerForUplink=!0,this.meetingSessionContext.videoUplinkBandwidthPolicy.setTransceiverController(this.meetingSessionContext.transceiverController)),this.meetingSessionContext.audioProfile=this._audioProfile;if(new oe.default(this.configuration.credentials.attendeeId).hasModality(oe.default.MODALITY_CONTENT)){const Kt=this.configuration.meetingFeatures.contentMaxResolution===ee.default.VideoResolutionUHD;Kt&&this.setVideoMaxBandwidthKbps(2500),this.meetingSessionContext.videoUplinkBandwidthPolicy.setHighResolutionFeatureEnabled(Kt)}else{const Kt=this.configuration.meetingFeatures.videoMaxResolution===ee.default.VideoResolutionFHD;this.meetingSessionContext.videoUplinkBandwidthPolicy.setHighResolutionFeatureEnabled(Kt)}this.meetingSessionContext.videoUplinkBandwidthPolicy&&this.maxUplinkBandwidthKbps&&this.meetingSessionContext.videoUplinkBandwidthPolicy.setIdealMaxBandwidthKbps(this.maxUplinkBandwidthKbps),this.meetingSessionContext.videoDownlinkBandwidthPolicy.bindToTileController&&this.meetingSessionContext.videoDownlinkBandwidthPolicy.bindToTileController(this._videoTileController),this.meetingSessionContext.videoDownlinkBandwidthPolicy.setWantsResubscribeObserver&&this.meetingSessionContext.videoDownlinkBandwidthPolicy.setWantsResubscribeObserver(()=>this.update({needsRenegotiation:!1})),this.meetingSessionContext.lastKnownVideoAvailability=new re.default,this.meetingSessionContext.videoCaptureAndEncodeParameter=new mi.default(0,0,0,0,!1),this.meetingSessionContext.videosToReceive=new Bt.default,this.meetingSessionContext.videosPaused=new Bt.default,this.meetingSessionContext.statsCollector=new Me.default(this,this.logger),this.meetingSessionContext.connectionMonitor=new Y.default(this,this._realtimeController,this.connectionHealthData,new ae.default(this.meetingSessionContext.signalingClient,mu.PING_PONG_INTERVAL_MS,this.logger),this.meetingSessionContext.statsCollector),this.meetingSessionContext.reconnectController=this._reconnectController,this.meetingSessionContext.videoDeviceInformation={},ke||(this.totalRetryCount=0,this._reconnectController.reset(),this.startAudioVideoTimestamp=Date.now(),this.forEachObserver(Kt=>{bi.Maybe.of(Kt.audioVideoDidStartConnecting).map(qe=>qe.bind(Kt)(!1))}),(Ne=this.eventController)===null||Ne===void 0||Ne.publishEvent("meetingStartRequested")),this.meetingSessionContext.startAudioVideoTimestamp=this.startAudioVideoTimestamp,this._reconnectController.hasStartedConnectionAttempt()?this._reconnectController.startedConnectionAttempt(!1):this._reconnectController.startedConnectionAttempt(!0);const ai=Le&&this.meetingSessionContext.meetingSessionConfiguration.attendeePresenceTimeoutMs>0;this.logger.info("Needs to wait for attendee presence? "+ai);const et=this.connectWithPromises(ai);try{yield et.run(),this.connectionHealthData.setConnectionStartTime(),this._mediaStreamBroker.addMediaStreamBrokerObserver(this),this.sessionStateController.perform(fe.default.FinishConnecting,()=>{this.eventController&&(this.meetingSessionContext.meetingStartDurationMs=Date.now()-this.startAudioVideoTimestamp,this.eventController.publishEvent("meetingStartSucceeded",{maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,poorConnectionCount:this.meetingSessionContext.poorConnectionCount,retryCount:this.totalRetryCount,signalingOpenDurationMs:this.meetingSessionContext.signalingOpenDurationMs,iceGatheringDurationMs:this.meetingSessionContext.iceGatheringDurationMs,meetingStartDurationMs:this.meetingSessionContext.meetingStartDurationMs})),this.meetingSessionContext.startTimeMs=Date.now(),this.actionFinishConnecting()})}catch(Kt){this.signalingTask=void 0;const qe=new ie.default(this.getMeetingStatusCode(Kt)||ne.default.TaskFailed);if(this.logger.info(`Start failed: ${qe} due to error ${Kt}.`),this.sessionStateController.state()===ge.default.NotConnected){this.logger.info("Start failed and not connected. Not cleaning up.");return}this.sessionStateController.perform(fe.default.Fail,()=>R(this,void 0,void 0,function*(){yield this.actionDisconnect(qe,!0,Kt),this.handleMeetingSessionStatus(qe,Kt)||this.notifyStop(qe,Kt)}))}})}createOrReuseSignalingTask(){return this.signalingTask||(this.initSignalingClient(),this.signalingTask=new vi.default(this.logger,new He.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs).once()),this.signalingTask}actionFinishConnecting(){this.signalingTask=void 0,this.meetingSessionContext.videoDuplexMode=Ae.SdkStreamServiceType.RX,this.meetingSessionContext.enableSimulcast||(this.useUpdateTransceiverControllerForUplink?this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController():this.enforceBandwidthLimitationForSender(this.meetingSessionContext.videoCaptureAndEncodeParameter.encodeBitrates()[0])),this.forEachObserver(ke=>{bi.Maybe.of(ke.audioVideoDidStart).map(Ne=>Ne.bind(ke)())}),this._reconnectController.reset(),this.receiveIndexTask.resumeIngestion(),this.monitorTask.resumeResubscribeCheck()}stopReturningPromise(){var ke;return this.sessionStateController.state()===ge.default.NotConnected?((ke=this.meetingSessionContext.signalingClient)===null||ke===void 0||ke.closeConnection(),this.cleanUpMediaStreamsAfterStop(),Promise.resolve()):new Promise((Ne,Le)=>{this.sessionStateController.perform(fe.default.Disconnect,()=>{this._reconnectController.disableReconnect(),this.logger.info("attendee left meeting, session will not be reconnected"),this.actionDisconnect(new ie.default(ne.default.Left),!1,null).then(Ne).catch(Le)})})}stop(){this.stopReturningPromise()}actionDisconnect(ke,Ne,Le){return R(this,void 0,void 0,function*(){try{yield new ni.default(this.logger,this.wrapTaskName("AudioVideoStop"),[new vi.default(this.logger,new xe.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs)]).run()}catch{this.logger.info("fail to stop")}try{const ai=[new vi.default(this.logger,new Pe.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs)];this.cleanUpMediaStreamsAfterStop(),yield new ni.default(this.logger,this.wrapTaskName("AudioVideoClean"),ai).run()}catch{this.logger.info("fail to clean")}this.sessionStateController.perform(fe.default.FinishDisconnecting,()=>{Ne||this.notifyStop(ke,Le)})})}update(ke={needsRenegotiation:!0}){let Ne=ke.needsRenegotiation;if(Ne||(Ne=this.meetingSessionContext.peer===void 0),Ne||(Ne=!this.updateRemoteVideosFromPolicy()),Ne||(Ne=!this.updateLocalVideoFromPolicy()),this.meetingSessionContext.lastVideosToReceive=this.meetingSessionContext.videosToReceive,!Ne)return this.logger.info("Update request does not require resubscribe"),this.actionFinishUpdating(),!0;this.logger.info("Update request requires resubscribe");const Le=this.sessionStateController.perform(fe.default.Update,()=>{this.actionUpdateWithRenegotiation(!0)});return Le===he.default.Transitioned||Le===he.default.DeferredTransition}updateRemoteVideosFromPolicy(){if(this.meetingSessionContext.videoDownlinkBandwidthPolicy&&this.meetingSessionContext.videoDownlinkBandwidthPolicy.getVideoPreferences!==void 0&&this.meetingSessionContext.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption!==void 0&&!be.serverSideNetworkAdaptionIsNoneOrDefault(this.meetingSessionContext.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption())){if(!this.sendRemoteVideoUpdate())return!1;if(this.meetingSessionContext.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption()===be.default.BandwidthProbingAndRemoteVideoQualityAdaption)return this.isNotAddingOrRemovingStreams()}return this.updateRemoteVideosIfNotAddingOrRemovingStreams()}updateRemoteVideosIfNotAddingOrRemovingStreams(){const ke=this.detectChangesInVideosToReceive();if(ke===void 0)return!1;const Ne=ke.added,Le=ke.simulcastStreamUpdates,ai=ke.removed,et=this.meetingSessionContext,Kt=[];for(const[qe,Ge]of Le.entries()){const pe=new Re.default;if(pe.streamId=Ge,pe.attendeeId=et.videoStreamIndex.attendeeIdForStreamId(Ge),pe.mid=et.transceiverController.getMidForStreamId(qe),pe.mid===void 0)return this.logger.info(`No MID found for stream ID ${qe}, cannot update stream without renegotiation`),!1;if(Kt.push(pe),et.transceiverController.setStreamIdForMid(pe.mid,Ge),et.videoStreamIndex.overrideStreamIdMappings(qe,Ge),et.videoTileController.haveVideoTileForAttendeeId(pe.attendeeId)){const Ve=et.videoTileController.getVideoTileForAttendeeId(pe.attendeeId);if(!Ve.setStreamId)return!1;Ve.setStreamId(Ge)}}return Kt.length!==0&&et.signalingClient.remoteVideoUpdate(Kt,[]),Ne.length!==0||ai.length!==0?!1:(et.videoStreamIndex.remoteVideoUpdateSent(),!0)}detectChangesInVideosToReceive(){const ke=this.meetingSessionContext;if(ke.videosToReceive===null||!ke.transceiverController||!ke.transceiverController.getMidForStreamId||!ke.transceiverController.setStreamIdForMid||!ke.videosToReceive.forEach||!ke.signalingClient.remoteVideoUpdate||!ke.videoStreamIndex.overrideStreamIdMappings)return;let Ne=[];const Le=new Map;let ai=[];if(ke.lastVideosToReceive===null)Ne=ke.videosToReceive.array();else{const et=ke.videoStreamIndex;ke.videosToReceive.forEach(Kt=>{if(ke.lastVideosToReceive.contain(Kt))return;let qe=!1;ke.lastVideosToReceive.forEach(Ge=>{qe||et.StreamIdsInSameGroup(Ge,Kt)&&(Le.set(Ge,Kt),qe=!0)}),qe||Ne.push(Kt)}),ai=ke.lastVideosToReceive.array().filter(Kt=>{const qe=ke.videosToReceive.contain(Kt),Ge=Le.has(Kt);return!qe&&!Ge})}return this.logger.info(`Request to update remote videos with added: [${Ne}], updated: [${Array.from(Le.entries()).map(([et,Kt])=>`${et}->${Kt}`).join(",")}], removed: [${ai}]`),{added:Ne,removed:ai,simulcastStreamUpdates:Le}}isNotAddingOrRemovingStreams(){const ke=this.detectChangesInVideosToReceive();if(ke===void 0)return!1;const Ne=ke.added,Le=ke.removed;return Ne.length!==0||Le.length!==0?!1:(this.meetingSessionContext.videoStreamIndex.remoteVideoUpdateSent(),!0)}sendRemoteVideoUpdate(){const ke=this.meetingSessionContext;if(ke.videosToReceive===null)return!1;const Ne=ke.videosToReceive.array().map(qe=>ke.videoStreamIndex.groupIdForStreamId(qe));this.receiveRemotePauseResumeTask.updateSubscribedGroupdIds(new Set(Ne));const Le=Ji.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration(ke,Ne,ke.videoDownlinkBandwidthPolicy.getVideoPreferences()),ai=new Map,et=[];for(const qe of Le){let Ge=!1;if(!ke.lastVideoSubscriptionConfiguration.has(qe.groupId))Ge=!0;else{const pe=ke.lastVideoSubscriptionConfiguration.get(qe.groupId);qe.equals(pe)||(this.logger.debug(`${JSON.stringify(qe)} does not equal ${JSON.stringify(pe)}, sending update`),Ge=!0)}ai.set(qe.groupId,qe),Ge&&et.push(qe)}ke.lastVideoSubscriptionConfiguration=ai;const Kt=[];if(ke.lastVideosToReceive!==null){const qe=new Set(Ne);for(const Ge of ke.lastVideosToReceive.array()){const pe=ke.videoStreamIndex.groupIdForStreamId(Ge);if(!qe.has(pe)){const Ve=ke.transceiverController.getMidForGroupId(pe);if(Ve===void 0){ke.logger.warn(`Could not find MID for group ID to remove: ${pe}`);continue}Kt.push(Ve)}}}return(et.length!==0||Kt.length!==0)&&ke.signalingClient.remoteVideoUpdate(et,Kt),!0}updateLocalVideoFromPolicy(){if(this.meetingSessionContext.enableSimulcast){const ke=this.meetingSessionContext.videoUplinkBandwidthPolicy.chooseEncodingParameters();if(this.mayNeedRenegotiationForSimulcastLayerChange&&this.meetingSessionContext.transceiverController.hasVideoInput()&&!this.negotiatedBitrateLayersAllocationRtpHeaderExtension())return this.logger.info("Needs regenotiation for local video simulcast layer change"),this.mayNeedRenegotiationForSimulcastLayerChange=!1,!1;this.meetingSessionContext.transceiverController.setEncodingParameters(ke)}else this.meetingSessionContext.videoCaptureAndEncodeParameter=this.meetingSessionContext.videoUplinkBandwidthPolicy.chooseCaptureAndEncodeParameters();return this.logger.info("Updated local video from policy without renegotiation"),!0}negotiatedBitrateLayersAllocationRtpHeaderExtension(){if(!this.meetingSessionContext.transceiverController.localVideoTransceiver())return!1;const ke=this.meetingSessionContext.transceiverController.localVideoTransceiver().sender.getParameters();return!ke||!ke.headerExtensions?!1:ke.headerExtensions.some(Ne=>Ne.uri==="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00")}restartLocalVideo(ke){const Ne=()=>R(this,void 0,void 0,function*(){this._videoTileController.hasStartedLocalVideoTile()&&(this.logger.info("stopping local video tile prior to local video restart"),this._videoTileController.stopLocalVideoTile(),this.logger.info("preparing local video restart update"),yield this.actionUpdateWithRenegotiation(!1),this.logger.info("starting local video tile for local video restart"),this._videoTileController.startLocalVideoTile()),this.logger.info("finalizing local video restart update"),yield this.actionUpdateWithRenegotiation(!0),ke()}),Le=this.sessionStateController.perform(fe.default.Update,()=>{Ne()});return Le===he.default.Transitioned||Le===he.default.DeferredTransition}replaceLocalVideo(ke){return R(this,void 0,void 0,function*(){if(!ke||ke.getVideoTracks().length<1)throw new Error("could not acquire video track");if(!this.meetingSessionContext||!this.meetingSessionContext.peer)throw new Error("no active meeting and peer connection");const Ne=this.meetingSessionContext.videoTileController.getLocalVideoTile();if(Ne){const Le=Ne.state(),ai=ke.getVideoTracks()[0].getSettings();Ne.bindVideoStream(Le.boundAttendeeId,!0,ke,ai.width,ai.height,Le.streamId,Le.boundExternalUserId)}yield this.meetingSessionContext.transceiverController.setVideoInput(ke.getVideoTracks()[0]),this.meetingSessionContext.activeVideoInput=ke,this.logger.info("Local video input is updated")})}replaceLocalAudio(ke){return R(this,void 0,void 0,function*(){if(!ke||ke.getAudioTracks().length<1)throw new Error("could not acquire audio track");if(!this.meetingSessionContext||!this.meetingSessionContext.peer)throw new Error("no active meeting and peer connection");if(this.connectionHealthData.reset(),this.connectionHealthData.setConnectionStartTime(),!(yield this.meetingSessionContext.transceiverController.replaceAudioTrack(ke.getAudioTracks()[0])))throw new Error("Failed to replace audio track");this.meetingSessionContext.activeAudioInput=ke,this.logger.info("Local audio input is updated")})}actionUpdateWithRenegotiation(ke){return R(this,void 0,void 0,function*(){this.monitorTask.pauseResubscribeCheck(),this.receiveIndexTask.pauseIngestion();try{yield new ni.default(this.logger,this.wrapTaskName("AudioVideoUpdate"),[new Jt.default(this.meetingSessionContext),new vi.default(this.logger,new ni.default(this.logger,"UpdateSession",[new Be.default(this.meetingSessionContext),new Dt.default(this.meetingSessionContext),new Pi.default(this.meetingSessionContext),new Xe.default(this.meetingSessionContext),new qi.default(this.meetingSessionContext),new Ci.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs)]).run(),ke&&this.sessionStateController.perform(fe.default.FinishUpdating,()=>{this.actionFinishUpdating()})}catch(Ne){this.sessionStateController.perform(fe.default.FinishUpdating,()=>{const Le=new ie.default(this.getMeetingStatusCode(Ne)||ne.default.TaskFailed);Le.statusCode()!==ne.default.IncompatibleSDP&&this.logger.info("failed to update audio-video session"),this.handleMeetingSessionStatus(Le,Ne)})}})}notifyStop(ke,Ne){var Le;if(this.forEachObserver(ai=>{bi.Maybe.of(ai.audioVideoDidStop).map(et=>et.bind(ai)(ke))}),this.eventController){const{signalingOpenDurationMs:ai,poorConnectionCount:et,startTimeMs:Kt,iceGatheringDurationMs:qe,attendeePresenceDurationMs:Ge,meetingStartDurationMs:pe}=this.meetingSessionContext,Ve={maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,meetingDurationMs:Kt===null?0:Math.round(Date.now()-Kt),meetingStatus:ne.default[ke.statusCode()],signalingOpenDurationMs:ai,iceGatheringDurationMs:qe,attendeePresenceDurationMs:Ge,poorConnectionCount:et,meetingStartDurationMs:pe,retryCount:this.totalRetryCount},we=Ne&&Ne.message||((Le=ke.toString)===null||Le===void 0?void 0:Le.call(ke))||"";Ve.meetingDurationMs===0?(Ve.meetingErrorMessage=we,delete Ve.meetingDurationMs,delete Ve.attendeePresenceDurationMs,delete Ve.meetingStartDurationMs,this.eventController.publishEvent("meetingStartFailed",Ve)):ke.isFailure()||ke.isAudioConnectionFailure()?(Ve.meetingErrorMessage=we,this.eventController.publishEvent("meetingFailed",Ve)):this.eventController.publishEvent("meetingEnded",Ve)}}actionFinishUpdating(){if(!this.meetingSessionContext.enableSimulcast)if(this.useUpdateTransceiverControllerForUplink)this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController();else{const ke=this.meetingSessionContext.videoCaptureAndEncodeParameter.encodeBitrates()[0];this.enforceBandwidthLimitationForSender(ke)}this.monitorTask.resumeResubscribeCheck(),this.receiveIndexTask.resumeIngestion(),this.logger.info("updated audio-video session")}reconnect(ke,Ne){this.promotedToPrimaryMeeting&&(this.promotedToPrimaryMeeting=!1,this.forEachObserver(ai=>{bi.Maybe.of(ai.audioVideoWasDemotedFromPrimaryMeeting).map(et=>et.bind(ai)(new ie.default(ne.default.AudioVideoDisconnectedWhilePromoted)))}));const Le=this._reconnectController.retryWithBackoff(()=>R(this,void 0,void 0,function*(){this.sessionStateController.state()===ge.default.NotConnected?this.sessionStateController.perform(fe.default.Connect,()=>{this.actionConnect(!0)}):this.sessionStateController.perform(fe.default.Reconnect,()=>{this.actionReconnect(ke)}),this.totalRetryCount+=1}),()=>{this.logger.info("canceled retry")});return Le||this.sessionStateController.perform(fe.default.Fail,()=>{this.actionDisconnect(ke,!1,Ne)}),Le}actionReconnect(ke){return R(this,void 0,void 0,function*(){this._reconnectController.hasStartedConnectionAttempt()||(this._reconnectController.startedConnectionAttempt(!1),this.forEachObserver(Ne=>{bi.Maybe.of(Ne.audioVideoDidStartConnecting).map(Le=>Le.bind(Ne)(!0))})),this.meetingSessionContext.volumeIndicatorAdapter.onReconnect(),this.connectionHealthData.reset(),this.receiveRemotePauseResumeTask=new hi.default(this.meetingSessionContext);try{yield new ni.default(this.logger,this.wrapTaskName("AudioVideoReconnect"),[new vi.default(this.logger,new ni.default(this.logger,"Media",[new Qe.default(this.meetingSessionContext),new ni.default(this.logger,"Signaling",[new He.default(this.meetingSessionContext),new zt.default(this.meetingSessionContext)]),new je.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs),new Jt.default(this.meetingSessionContext),new vi.default(this.logger,new ni.default(this.logger,"UpdateSession",[new Be.default(this.meetingSessionContext),new Dt.default(this.meetingSessionContext),new Pi.default(this.meetingSessionContext),new Xe.default(this.meetingSessionContext),new qi.default(this.meetingSessionContext),new Ci.default(this.meetingSessionContext),this.receiveRemotePauseResumeTask]),this.configuration.connectionTimeoutMs)]).run(),this.sessionStateController.perform(fe.default.FinishConnecting,()=>{if(this.eventController){const{signalingOpenDurationMs:Ne,poorConnectionCount:Le,startTimeMs:ai,iceGatheringDurationMs:et,attendeePresenceDurationMs:Kt,meetingStartDurationMs:qe}=this.meetingSessionContext,Ge={maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,meetingDurationMs:Math.round(Date.now()-ai),meetingStatus:ne.default[ke.statusCode()],signalingOpenDurationMs:Ne,iceGatheringDurationMs:et,attendeePresenceDurationMs:Kt,poorConnectionCount:Le,meetingStartDurationMs:qe,retryCount:this.totalRetryCount};this.eventController.publishEvent("meetingReconnected",Ge)}this.actionFinishConnecting()})}catch(Ne){this.sessionStateController.perform(fe.default.FinishConnecting,()=>{this.logger.info("failed to reconnect audio-video session");const Le=new ie.default(this.getMeetingStatusCode(Ne)||ne.default.TaskFailed);this.handleMeetingSessionStatus(Le,Ne)})}this.connectionHealthData.setConnectionStartTime()})}wrapTaskName(ke){return`${ke}/${this.configuration.meetingId}/${this.configuration.credentials.attendeeId}`}cleanUpMediaStreamsAfterStop(){this._mediaStreamBroker.removeMediaStreamBrokerObserver(this),this.meetingSessionContext.activeAudioInput=void 0,this.meetingSessionContext.activeVideoInput=void 0}getMeetingStatusCode(ke){const Ne=/the meeting status code: (\d+)/.exec(ke&&ke.message);return Ne&&Ne.length>1?Number.parseInt(Ne[1],10):null}enforceBandwidthLimitationForSender(ke){return R(this,void 0,void 0,function*(){yield this.meetingSessionContext.transceiverController.setVideoSendingBitrateKbps(ke)})}handleMeetingSessionStatus(ke,Ne){if(this.logger.info(`handling status: ${ne.default[ke.statusCode()]}`),ke.isTerminal()||this.meetingSessionContext.statsCollector&&this.meetingSessionContext.statsCollector.logMeetingSessionStatus(ke),ke.statusCode()===ne.default.IncompatibleSDP)return this.restartLocalVideo(()=>{this.logger.info("handled incompatible SDP by attempting to restart video")}),!0;if(ke.statusCode()===ne.default.VideoCallSwitchToViewOnly)return this._videoTileController.removeLocalVideoTile(),this.forEachObserver(Le=>{bi.Maybe.of(Le.videoSendDidBecomeUnavailable).map(ai=>ai.bind(Le)())}),!1;if(ke.statusCode()===ne.default.AudioVideoWasRemovedFromPrimaryMeeting)return this.forEachObserver(Le=>{bi.Maybe.of(Le.audioVideoWasDemotedFromPrimaryMeeting).map(ai=>ai.bind(Le)(ke))}),!1;if(ke.isTerminal()&&(this.logger.error("session will not be reconnected"),this.meetingSessionContext.reconnectController&&this.meetingSessionContext.reconnectController.disableReconnect()),(ke.isFailure()||ke.isTerminal())&&this.meetingSessionContext.reconnectController){const Le=this.reconnect(ke,Ne);return Le?this.logger.warn(`will retry due to status code ${ne.default[ke.statusCode()]}${Ne?` and error: ${Ne.message}`:""}`):this.logger.error(`failed with status code ${ne.default[ke.statusCode()]}${Ne?` and error: ${Ne.message}`:""}`),Le}return!1}setVideoMaxBandwidthKbps(ke){if(ke<=0)throw new Error("Max bandwidth kbps has to be greater than 0");this.meetingSessionContext&&this.meetingSessionContext.videoUplinkBandwidthPolicy&&(this.logger.info(`video send has ideal max bandwidth ${ke} kbps`),this.meetingSessionContext.videoUplinkBandwidthPolicy.setIdealMaxBandwidthKbps(ke)),this.maxUplinkBandwidthKbps=ke}handleHasBandwidthPriority(ke){return R(this,void 0,void 0,function*(){if(this.meetingSessionContext&&this.meetingSessionContext.videoUplinkBandwidthPolicy&&!this.meetingSessionContext.enableSimulcast){if(this.useUpdateTransceiverControllerForUplink){this.meetingSessionContext.videoUplinkBandwidthPolicy.setHasBandwidthPriority(ke),yield this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController();return}const Ne=this.meetingSessionContext.videoUplinkBandwidthPolicy.maxBandwidthKbps();this.meetingSessionContext.videoUplinkBandwidthPolicy.setHasBandwidthPriority(ke);const Le=this.meetingSessionContext.videoUplinkBandwidthPolicy.maxBandwidthKbps();Ne!==Le&&(this.logger.info(`video send bandwidth priority ${ke} max has changed from ${Ne} kbps to ${Le} kbps`),yield this.enforceBandwidthLimitationForSender(Le))}})}pauseReceivingStream(ke){this.meetingSessionContext&&this.meetingSessionContext.signalingClient&&this.meetingSessionContext.signalingClient.pause([ke])}resumeReceivingStream(ke){this.meetingSessionContext&&this.meetingSessionContext.signalingClient&&this.meetingSessionContext.signalingClient.resume([ke])}setVideoCodecSendPreferences(ke){this.videoSendCodecPreferences=ke,this.meetingSessionContext.videoSendCodecPreferences=ke,this.sessionStateController.state()!==ge.default.NotConnected&&this.update({needsRenegotiation:!0})}getRemoteVideoSources(){const{videoStreamIndex:ke}=this.meetingSessionContext;if(!ke)return this.logger.info("meeting has not started"),[];const Ne=this.configuration.credentials.attendeeId;return ke.allVideoSendingSourcesExcludingSelf(Ne)}encodingSimulcastLayersDidChange(ke){this.mayNeedRenegotiationForSimulcastLayerChange=!0,this.forEachObserver(Ne=>{bi.Maybe.of(Ne.encodingSimulcastLayersDidChange).map(Le=>Le.bind(Ne)(ke))})}promoteToPrimaryMeeting(ke){return this.actionPromoteToPrimaryMeeting(ke)}actionPromoteToPrimaryMeeting(ke){return R(this,void 0,void 0,function*(){let Ne=new ie.default(ne.default.SignalingRequestFailed);return yield new ni.default(this.logger,this.wrapTaskName("PromoteToPrimaryMeeting"),[new vi.default(this.logger,new Rt.default(this.meetingSessionContext,ke,Le=>{Ne=Le}),this.configuration.connectionTimeoutMs)]).run(),this.promotedToPrimaryMeeting=Ne.statusCode()===ne.default.OK,Ne})}demoteFromPrimaryMeeting(){this.meetingSessionContext.signalingClient.demoteFromPrimaryMeeting(),this.forEachObserver(ke=>{bi.Maybe.of(ke.audioVideoWasDemotedFromPrimaryMeeting).map(Ne=>Ne.bind(ke)(new ie.default(ne.default.OK)))})}videoInputDidChange(ke){return R(this,void 0,void 0,function*(){if(this.logger.info("Receive a video input change event"),!this.meetingSessionContext||!this.meetingSessionContext.peer){this.logger.info("Skip updating video input because there is no active meeting and peer connection");return}this._videoTileController.hasStartedLocalVideoTile()&&(ke?yield this.replaceLocalVideo(ke):this._videoTileController.stopLocalVideoTile())})}audioInputDidChange(ke){return R(this,void 0,void 0,function*(){if(this.logger.info("Receive an audio input change event"),!this.meetingSessionContext||!this.meetingSessionContext.peer){this.logger.info("Skip updating audio input because there is no active meeting and peer connection");return}if(!ke)try{ke=yield this.mediaStreamBroker.acquireAudioInputStream()}catch{this.logger.error("Could not acquire audio track from mediaStreamBroker");return}yield this.replaceLocalAudio(ke)})}};return DefaultAudioVideoController.default=Ye,Ye.MIN_VOLUME_DECIBELS=-42,Ye.MAX_VOLUME_DECIBELS=-14,Ye.PING_PONG_INTERVAL_MS=1e4,DefaultAudioVideoController}var DefaultAudioVideoFacade={},hasRequiredDefaultAudioVideoFacade;function requireDefaultAudioVideoFacade(){if(hasRequiredDefaultAudioVideoFacade)return DefaultAudioVideoFacade;hasRequiredDefaultAudioVideoFacade=1;var C=DefaultAudioVideoFacade&&DefaultAudioVideoFacade.__awaiter||function(R,M,x,S){function T(_){return _ instanceof x?_:new x(function(D){D(_)})}return new(x||(x=Promise))(function(_,D){function Y(ne){try{ie(S.next(ne))}catch(re){D(re)}}function ee(ne){try{ie(S.throw(ne))}catch(re){D(re)}}function ie(ne){ne.done?_(ne.value):T(ne.value).then(Y,ee)}ie((S=S.apply(R,M||[])).next())})};Object.defineProperty(DefaultAudioVideoFacade,"__esModule",{value:!0});const E=requireVideoTransformDevice();let w=class{constructor(R,M,x,S,T,_){this.audioVideoController=R,this.videoTileController=M,this.realtimeController=x,this.audioMixController=S,this.deviceController=T,this.contentShareController=_}addObserver(R){this.audioVideoController.addObserver(R),this.trace("addObserver")}removeObserver(R){this.audioVideoController.removeObserver(R),this.trace("removeObserver")}setAudioProfile(R){this.trace("setAudioProfile",R),this.audioVideoController.setAudioProfile(R)}start(R){this.audioVideoController.start(R),this.trace("start")}stop(){this.audioVideoController.stop(),this.trace("stop")}getRTCPeerConnectionStats(R){return this.trace("getRTCPeerConnectionStats",R?R.id:null),this.audioVideoController.getRTCPeerConnectionStats(R)}bindAudioElement(R){const M=this.audioMixController.bindAudioElement(R);return this.trace("bindAudioElement",R.id,M),M}unbindAudioElement(){this.audioMixController.unbindAudioElement(),this.trace("unbindAudioElement")}getCurrentMeetingAudioStream(){return this.trace("getCurrentConferenceStream"),this.audioMixController.getCurrentMeetingAudioStream()}addAudioMixObserver(R){this.trace("addAudioMixObserver"),this.audioMixController.addAudioMixObserver(R)}removeAudioMixObserver(R){this.trace("removeAudioMixObserver"),this.audioMixController.removeAudioMixObserver(R)}bindVideoElement(R,M){this.videoTileController.bindVideoElement(R,M),this.trace("bindVideoElement",{tileId:R,videoElementId:M.id})}unbindVideoElement(R,M=!0){this.videoTileController.unbindVideoElement(R,M),this.trace("unbindVideoElement",{tileId:R,cleanUpVideoElement:M})}startLocalVideoTile(){const R=this.videoTileController.startLocalVideoTile();return this.trace("startLocalVideoTile",null,R),R}stopLocalVideoTile(){this.videoTileController.stopLocalVideoTile(),this.trace("stopLocalVideoTile")}hasStartedLocalVideoTile(){const R=this.videoTileController.hasStartedLocalVideoTile();return this.trace("hasStartedLocalVideoTile",null,R),R}removeLocalVideoTile(){this.videoTileController.removeLocalVideoTile(),this.trace("removeLocalVideoTile")}getLocalVideoTile(){const R=this.videoTileController.getLocalVideoTile();return this.trace("getLocalVideoTile"),R}pauseVideoTile(R){this.videoTileController.pauseVideoTile(R),this.trace("pauseVideoTile",R)}unpauseVideoTile(R){this.videoTileController.unpauseVideoTile(R),this.trace("unpauseVideoTile",R)}getVideoTile(R){const M=this.videoTileController.getVideoTile(R);return this.trace("getVideoTile",R),M}getAllRemoteVideoTiles(){const R=this.videoTileController.getAllRemoteVideoTiles();return this.trace("getAllRemoteVideoTiles"),R}getAllVideoTiles(){const R=this.videoTileController.getAllVideoTiles();return this.trace("getAllVideoTiles"),R}addVideoTile(){const R=this.videoTileController.addVideoTile();return this.trace("addVideoTile",null,R.state()),R}removeVideoTile(R){this.videoTileController.removeVideoTile(R),this.trace("removeVideoTile",R)}removeVideoTilesByAttendeeId(R){const M=this.videoTileController.removeVideoTilesByAttendeeId(R);return this.trace("removeVideoTilesByAttendeeId",R,M),M}removeAllVideoTiles(){this.videoTileController.removeAllVideoTiles(),this.trace("removeAllVideoTiles")}captureVideoTile(R){const M=this.videoTileController.captureVideoTile(R);return this.trace("captureVideoTile",R),M}realtimeSubscribeToAttendeeIdPresence(R){this.realtimeController.realtimeSubscribeToAttendeeIdPresence(R),this.trace("realtimeSubscribeToAttendeeIdPresence")}realtimeUnsubscribeToAttendeeIdPresence(R){this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(R),this.trace("realtimeUnsubscribeToAttendeeIdPresence")}realtimeSetCanUnmuteLocalAudio(R){this.realtimeController.realtimeSetCanUnmuteLocalAudio(R),this.trace("realtimeSetCanUnmuteLocalAudio",R)}realtimeSubscribeToSetCanUnmuteLocalAudio(R){this.realtimeController.realtimeSubscribeToSetCanUnmuteLocalAudio(R),this.trace("realtimeSubscribeToSetCanUnmuteLocalAudio")}realtimeUnsubscribeToSetCanUnmuteLocalAudio(R){this.realtimeController.realtimeUnsubscribeToSetCanUnmuteLocalAudio(R),this.trace("realtimeUnsubscribeToSetCanUnmuteLocalAudio")}realtimeCanUnmuteLocalAudio(){const R=this.realtimeController.realtimeCanUnmuteLocalAudio();return this.trace("realtimeCanUnmuteLocalAudio",null,R),R}realtimeMuteLocalAudio(){this.realtimeController.realtimeMuteLocalAudio(),this.trace("realtimeMuteLocalAudio")}realtimeUnmuteLocalAudio(){const R=this.realtimeController.realtimeUnmuteLocalAudio();return this.trace("realtimeUnmuteLocalAudio"),R}realtimeSubscribeToMuteAndUnmuteLocalAudio(R){this.realtimeController.realtimeSubscribeToMuteAndUnmuteLocalAudio(R),this.trace("realtimeSubscribeToMuteAndUnmuteLocalAudio")}realtimeUnsubscribeToMuteAndUnmuteLocalAudio(R){this.realtimeController.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(R),this.trace("realtimeUnsubscribeToMuteAndUnmuteLocalAudio")}realtimeIsLocalAudioMuted(){const R=this.realtimeController.realtimeIsLocalAudioMuted();return this.trace("realtimeIsLocalAudioMuted"),R}realtimeSubscribeToVolumeIndicator(R,M){this.realtimeController.realtimeSubscribeToVolumeIndicator(R,M),this.trace("realtimeSubscribeToVolumeIndicator",R)}realtimeUnsubscribeFromVolumeIndicator(R,M){this.realtimeController.realtimeUnsubscribeFromVolumeIndicator(R,M),this.trace("realtimeUnsubscribeFromVolumeIndicator",R,M)}realtimeSubscribeToLocalSignalStrengthChange(R){this.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(R),this.trace("realtimeSubscribeToLocalSignalStrengthChange")}realtimeUnsubscribeToLocalSignalStrengthChange(R){this.realtimeController.realtimeUnsubscribeToLocalSignalStrengthChange(R),this.trace("realtimeUnsubscribeToLocalSignalStrengthChange")}realtimeSendDataMessage(R,M,x){this.realtimeController.realtimeSendDataMessage(R,M,x),this.trace("realtimeSendDataMessage")}realtimeSubscribeToReceiveDataMessage(R,M){this.realtimeController.realtimeSubscribeToReceiveDataMessage(R,M),this.trace("realtimeSubscribeToReceiveDataMessage")}realtimeUnsubscribeFromReceiveDataMessage(R){this.realtimeController.realtimeUnsubscribeFromReceiveDataMessage(R),this.trace("realtimeUnsubscribeFromReceiveDataMessage")}realtimeSubscribeToFatalError(R){this.realtimeController.realtimeSubscribeToFatalError(R),this.trace("realtimeSubscribeToFatalError")}realtimeUnsubscribeToFatalError(R){this.realtimeController.realtimeUnsubscribeToFatalError(R),this.trace("realtimeUnsubscribeToFatalError")}subscribeToActiveSpeakerDetector(R,M,x,S){this.audioVideoController.activeSpeakerDetector.subscribe(R,M,x,S),this.trace("subscribeToActiveSpeakerDetector")}unsubscribeFromActiveSpeakerDetector(R){this.audioVideoController.activeSpeakerDetector.unsubscribe(R),this.trace("unsubscribeFromActiveSpeakerDetector")}listAudioInputDevices(R=!1){return C(this,void 0,void 0,function*(){const M=yield this.deviceController.listAudioInputDevices(R);return this.trace("listAudioInputDevices",R,M),M})}listVideoInputDevices(R=!1){return C(this,void 0,void 0,function*(){const M=yield this.deviceController.listVideoInputDevices(R);return this.trace("listVideoInputDevices",R,M),M})}listAudioOutputDevices(R=!1){return C(this,void 0,void 0,function*(){const M=yield this.deviceController.listAudioOutputDevices(R);return this.trace("listAudioOutputDevices",R,M),M})}startAudioInput(R){return C(this,void 0,void 0,function*(){return this.trace("startAudioInput",R),this.deviceController.startAudioInput(R)})}stopAudioInput(){return C(this,void 0,void 0,function*(){return this.trace("stopAudioInput"),this.deviceController.stopAudioInput()})}startVideoInput(R){return C(this,void 0,void 0,function*(){return E.isVideoTransformDevice(R)?this.trace("startVideoInput with transform device"):this.trace("startVideoInput",R),this.deviceController.startVideoInput(R)})}stopVideoInput(){return C(this,void 0,void 0,function*(){return this.trace("stopVideoInput"),this.deviceController.stopVideoInput()})}chooseAudioOutput(R){const M=this.deviceController.chooseAudioOutput(R);return this.trace("chooseAudioOutput",R),M}addDeviceChangeObserver(R){this.deviceController.addDeviceChangeObserver(R),this.trace("addDeviceChangeObserver")}removeDeviceChangeObserver(R){this.deviceController.removeDeviceChangeObserver(R),this.trace("removeDeviceChangeObserver")}createAnalyserNodeForAudioInput(){const R=this.deviceController.createAnalyserNodeForAudioInput();return this.trace("createAnalyserNodeForAudioInput"),R}startVideoPreviewForVideoInput(R){this.deviceController.startVideoPreviewForVideoInput(R),this.trace("startVideoPreviewForVideoInput",R.id)}stopVideoPreviewForVideoInput(R){this.deviceController.stopVideoPreviewForVideoInput(R),this.trace("stopVideoPreviewForVideoInput",R.id)}setDeviceLabelTrigger(R){this.deviceController.setDeviceLabelTrigger(R),this.trace("setDeviceLabelTrigger")}mixIntoAudioInput(R){const M=this.deviceController.mixIntoAudioInput(R);return this.trace("mixIntoAudioInput",R.id),M}chooseVideoInputQuality(R,M,x){this.deviceController.chooseVideoInputQuality(R,M,x),this.trace("chooseVideoInputQuality",{width:R,height:M,frameRate:x})}setVideoMaxBandwidthKbps(R){this.audioVideoController.setVideoMaxBandwidthKbps(R),this.trace("setVideoMaxBandwidthKbps",R)}setVideoCodecSendPreferences(R){this.audioVideoController.setVideoCodecSendPreferences(R),this.trace("setVideoCodecSendPreferences",R)}getVideoInputQualitySettings(){const R=this.deviceController.getVideoInputQualitySettings();return this.trace("getVideoInputQualitySettings"),R}setContentAudioProfile(R){this.trace("setContentAudioProfile",R),this.contentShareController.setContentAudioProfile(R)}enableSimulcastForContentShare(R,M){this.trace("enableSimulcastForContentShare"),this.contentShareController.enableSimulcastForContentShare(R,M)}enableSVCForContentShare(R){this.trace("enableSVCForContentShare"),this.contentShareController.enableSVCForContentShare(R)}startContentShare(R){const M=this.contentShareController.startContentShare(R);return this.trace("startContentShare"),M}startContentShareFromScreenCapture(R,M){const x=this.contentShareController.startContentShareFromScreenCapture(R,M);return this.trace("startContentShareFromScreenCapture"),x}pauseContentShare(){this.contentShareController.pauseContentShare(),this.trace("pauseContentShare")}unpauseContentShare(){this.contentShareController.unpauseContentShare(),this.trace("unpauseContentShare")}stopContentShare(){this.contentShareController.stopContentShare(),this.trace("stopContentShare")}addContentShareObserver(R){this.contentShareController.addContentShareObserver(R),this.trace("addContentShareObserver")}removeContentShareObserver(R){this.contentShareController.removeContentShareObserver(R),this.trace("removeContentShareObserver")}setContentShareVideoCodecPreferences(R){this.contentShareController.setContentShareVideoCodecPreferences(R),this.trace("setContentShareVideoCodecPreferences")}trace(R,M,x){const S=this.audioVideoController.configuration.meetingId,T=this.audioVideoController.configuration.credentials.attendeeId;let _=`API/DefaultAudioVideoFacade/${S}/${T}/${R}`;typeof M<"u"&&(_+=` ${JSON.stringify(M)}`),typeof x<"u"&&(_+=` -> ${JSON.stringify(x)}`),this.audioVideoController.logger.info(_)}getRemoteVideoSources(){const R=this.audioVideoController.getRemoteVideoSources();return this.trace("getRemoteVideoSources",null,R),R}get transcriptionController(){return this.realtimeController.transcriptionController}promoteToPrimaryMeeting(R){this.audioVideoController.removeObserver(this),this.audioVideoController.addObserver(this);const M=this.audioVideoController.promoteToPrimaryMeeting(R);return this.trace("promoteToPrimaryMeeting",null,M),M}demoteFromPrimaryMeeting(){this.trace("demoteFromPrimaryMeeting"),this.audioVideoController.demoteFromPrimaryMeeting()}audioVideoWasDemotedFromPrimaryMeeting(R){this.contentShareController.stopContentShare(),this.audioVideoController.removeObserver(this)}};return DefaultAudioVideoFacade.default=w,DefaultAudioVideoFacade}var DefaultContentShareController={},MeetingSessionConfiguration={},MeetingFeatures={},hasRequiredMeetingFeatures;function requireMeetingFeatures(){if(hasRequiredMeetingFeatures)return MeetingFeatures;hasRequiredMeetingFeatures=1;var C=MeetingFeatures&&MeetingFeatures.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(MeetingFeatures,"__esModule",{value:!0});const E=C(requireVideoQualitySettings());let w=class om{constructor(M=E.default.VideoResolutionHD,x=E.default.VideoResolutionFHD){this.videoMaxResolution=M,this.contentMaxResolution=x}clone(){return new om(this.videoMaxResolution,this.contentMaxResolution)}};return MeetingFeatures.default=w,MeetingFeatures}var MeetingSessionCredentials={},hasRequiredMeetingSessionCredentials;function requireMeetingSessionCredentials(){if(hasRequiredMeetingSessionCredentials)return MeetingSessionCredentials;hasRequiredMeetingSessionCredentials=1,Object.defineProperty(MeetingSessionCredentials,"__esModule",{value:!0});let C=class{constructor(){this.attendeeId=null,this.externalUserId=null,this.joinToken=null}toJSON(){return{attendeeId:this.attendeeId,joinToken:this.joinToken===null?null:"<redacted>"}}};return MeetingSessionCredentials.default=C,MeetingSessionCredentials}var MeetingSessionURLs={},hasRequiredMeetingSessionURLs;function requireMeetingSessionURLs(){if(hasRequiredMeetingSessionURLs)return MeetingSessionURLs;hasRequiredMeetingSessionURLs=1,Object.defineProperty(MeetingSessionURLs,"__esModule",{value:!0});let C=class{constructor(){this._audioHostURL=null,this._signalingURL=null,this._turnControlURL=null,this._eventIngestionURL=null,this.urlRewriter=E=>E}get audioHostURL(){return this.urlRewriter(this._audioHostURL)}set audioHostURL(E){this._audioHostURL=E}get signalingURL(){return this.urlRewriter(this._signalingURL)}set signalingURL(E){this._signalingURL=E}get turnControlURL(){return this.urlRewriter(this._turnControlURL)}set turnControlURL(E){this._turnControlURL=E}get eventIngestionURL(){return this.urlRewriter(this._eventIngestionURL)}set eventIngestionURL(E){this._eventIngestionURL=E}};return MeetingSessionURLs.default=C,MeetingSessionURLs}var hasRequiredMeetingSessionConfiguration;function requireMeetingSessionConfiguration(){if(hasRequiredMeetingSessionConfiguration)return MeetingSessionConfiguration;hasRequiredMeetingSessionConfiguration=1;var C=MeetingSessionConfiguration&&MeetingSessionConfiguration.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(MeetingSessionConfiguration,"__esModule",{value:!0});const E=C(requireConnectionHealthPolicyConfiguration()),w=C(requireVideoQualitySettings()),R=requireUtils(),M=C(requireMeetingFeatures()),x=C(requireMeetingSessionCredentials()),S=C(requireMeetingSessionURLs());let T=class{constructor(_,D){var Y,ee;if(this.meetingId=null,this.externalMeetingId=null,this.credentials=null,this.urls=null,this.connectionTimeoutMs=15e3,this.attendeePresenceTimeoutMs=0,this.connectionHealthPolicyConfiguration=new E.default,this.reconnectTimeoutMs=120*1e3,this.reconnectFixedWaitMs=0,this.reconnectShortBackOffMs=1*1e3,this.reconnectLongBackOffMs=5*1e3,this.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.enableSVC=!1,this.videoDownlinkBandwidthPolicy=null,this.videoUplinkBandwidthPolicy=null,this.keepLastFrameWhenPaused=!1,this.disablePeriodicKeyframeRequestOnContentSender=!1,this.meetingFeatures=new M.default,_){_=R.toLowerCasePropertyNames(_),_.meeting&&(_=_.meeting),this.meetingId=_.meetingid,this.externalMeetingId=_.externalmeetingid,this.urls=new S.default,this.urls.audioHostURL=_.mediaplacement.audiohosturl,this.urls.signalingURL=_.mediaplacement.signalingurl,this.urls.turnControlURL=_.mediaplacement.turncontrolurl,_.mediaplacement.eventingestionurl&&(this.urls.eventIngestionURL=_.mediaplacement.eventingestionurl);const ie=(ne,re)=>{switch(ne){case"None":return w.default.VideoDisabled;case"HD":return w.default.VideoResolutionHD;case"FHD":return w.default.VideoResolutionFHD;case"UHD":return w.default.VideoResolutionUHD;default:return re}};if(((Y=_.meetingfeatures)===null||Y===void 0?void 0:Y.video)!==void 0||((ee=_.meetingfeatures)===null||ee===void 0?void 0:ee.content)!==void 0){const ne=_.meetingfeatures.video===void 0?"HD":_.meetingfeatures.video.maxresolution,re=_.meetingfeatures.content===void 0?"FHD":_.meetingfeatures.content.maxresolution;this.meetingFeatures=new M.default(ie(ne,w.default.VideoResolutionHD),ie(re,w.default.VideoResolutionFHD))}}D&&(D=R.toLowerCasePropertyNames(D),D.attendee&&(D=D.attendee),this.credentials=new x.default,this.credentials.attendeeId=D.attendeeid,this.credentials.externalUserId=D.externaluserid,this.credentials.joinToken=D.jointoken)}};return MeetingSessionConfiguration.default=T,MeetingSessionConfiguration}var NoVideoDownlinkBandwidthPolicy={},hasRequiredNoVideoDownlinkBandwidthPolicy;function requireNoVideoDownlinkBandwidthPolicy(){if(hasRequiredNoVideoDownlinkBandwidthPolicy)return NoVideoDownlinkBandwidthPolicy;hasRequiredNoVideoDownlinkBandwidthPolicy=1;var C=NoVideoDownlinkBandwidthPolicy&&NoVideoDownlinkBandwidthPolicy.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(NoVideoDownlinkBandwidthPolicy,"__esModule",{value:!0});const E=C(requireDefaultVideoStreamIdSet());let w=class{reset(){}updateIndex(R){}updateMetrics(R){}wantsResubscribe(){return!1}chooseSubscriptions(){return new E.default}};return NoVideoDownlinkBandwidthPolicy.default=w,NoVideoDownlinkBandwidthPolicy}var DefaultSimulcastUplinkPolicyForContentShare={},hasRequiredDefaultSimulcastUplinkPolicyForContentShare;function requireDefaultSimulcastUplinkPolicyForContentShare(){if(hasRequiredDefaultSimulcastUplinkPolicyForContentShare)return DefaultSimulcastUplinkPolicyForContentShare;hasRequiredDefaultSimulcastUplinkPolicyForContentShare=1;var C=DefaultSimulcastUplinkPolicyForContentShare&&DefaultSimulcastUplinkPolicyForContentShare.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(DefaultSimulcastUplinkPolicyForContentShare,"__esModule",{value:!0});const E=C(requireSimulcastContentShareTransceiverController());let w=class{constructor(R,M){this.encodingParams=M,this.enableUhdContent=!1,this.defaultHiTargetBitrateKbps=1200,this.defaultLowTargetBitrateKbps=300}updateConnectionMetric(R){}chooseMediaTrackConstraints(){}chooseEncodingParameters(){var R,M,x,S,T,_,D,Y,ee,ie,ne,re;const oe=new Map,ae=1e3,le=E.default.NAME_ARR_ASCENDING;return oe.set(le[0],{rid:le[0],active:!0,scaleResolutionDownBy:((M=(R=this.encodingParams)===null||R===void 0?void 0:R.low)===null||M===void 0?void 0:M.scaleResolutionDownBy)||2,maxBitrate:(((S=(x=this.encodingParams)===null||x===void 0?void 0:x.low)===null||S===void 0?void 0:S.maxBitrateKbps)||this.defaultLowTargetBitrateKbps)*ae,maxFramerate:((_=(T=this.encodingParams)===null||T===void 0?void 0:T.low)===null||_===void 0?void 0:_.maxFramerate)||5}),oe.set(le[1],{rid:le[1],active:!0,scaleResolutionDownBy:((Y=(D=this.encodingParams)===null||D===void 0?void 0:D.high)===null||Y===void 0?void 0:Y.scaleResolutionDownBy)||1,maxBitrate:(((ie=(ee=this.encodingParams)===null||ee===void 0?void 0:ee.high)===null||ie===void 0?void 0:ie.maxBitrateKbps)||this.defaultHiTargetBitrateKbps)*ae,maxFramerate:(re=(ne=this.encodingParams)===null||ne===void 0?void 0:ne.high)===null||re===void 0?void 0:re.maxFramerate}),oe}updateIndex(R){}wantsResubscribe(){return!1}chooseCaptureAndEncodeParameters(){}maxBandwidthKbps(){return this.enableUhdContent?2e3:1200}setIdealMaxBandwidthKbps(R){}setHasBandwidthPriority(R){}setHighResolutionFeatureEnabled(R){this.enableUhdContent=R,this.defaultHiTargetBitrateKbps=R?2e3:1200,this.defaultLowTargetBitrateKbps=R?500:300}addObserver(R){}removeObserver(R){}forEachObserver(R){}};return DefaultSimulcastUplinkPolicyForContentShare.default=w,DefaultSimulcastUplinkPolicyForContentShare}var hasRequiredDefaultContentShareController;function requireDefaultContentShareController(){if(hasRequiredDefaultContentShareController)return DefaultContentShareController;hasRequiredDefaultContentShareController=1;var C=DefaultContentShareController&&DefaultContentShareController.__awaiter||function(ie,ne,re,oe){function ae(le){return le instanceof re?le:new re(function(de){de(le)})}return new(re||(re=Promise))(function(le,de){function me(he){try{ge(oe.next(he))}catch(ve){de(ve)}}function fe(he){try{ge(oe.throw(he))}catch(ve){de(ve)}}function ge(he){he.done?le(he.value):ae(he.value).then(me,fe)}ge((oe=oe.apply(ie,ne||[])).next())})},E=DefaultContentShareController&&DefaultContentShareController.__importDefault||function(ie){return ie&&ie.__esModule?ie:{default:ie}};Object.defineProperty(DefaultContentShareController,"__esModule",{value:!0});const w=E(requireVideoQualitySettings()),R=E(requireMeetingSessionConfiguration()),M=E(requireMeetingSessionCredentials()),x=E(requireDefaultModality()),S=E(requireAsyncScheduler()),T=requireTypes$1(),_=E(requireNoVideoDownlinkBandwidthPolicy()),D=E(requireDefaultSimulcastUplinkPolicyForContentShare()),Y=E(requireContentShareConstants());let ee=class{constructor(ie,ne,re){this.mediaStreamBroker=ie,this.contentAudioVideo=ne,this.attendeeAudioVideo=re,this.observerQueue=new Set,this.destroyed=!1,this.contentAudioVideo.addObserver(this),this.setupContentShareEvents()}static createContentShareMeetingSessionConfigure(ie){const ne=new R.default;return ne.meetingId=ie.meetingId,ne.externalMeetingId=ie.externalMeetingId,ne.urls=ie.urls,ne.disablePeriodicKeyframeRequestOnContentSender=ie.disablePeriodicKeyframeRequestOnContentSender,ne.credentials=new M.default,ne.credentials.attendeeId=ie.credentials.attendeeId+Y.default.Modality,ne.credentials.externalUserId=ie.credentials.externalUserId,ne.credentials.joinToken=ie.credentials.joinToken+Y.default.Modality,ne.meetingFeatures=ie.meetingFeatures.clone(),ne.videoDownlinkBandwidthPolicy=new _.default,ne}setContentAudioProfile(ie){this.contentAudioVideo.setAudioProfile(ie)}enableSimulcastForContentShare(ie,ne){ie?(this.contentAudioVideo.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!0,this.contentAudioVideo.configuration.videoUplinkBandwidthPolicy=new D.default(this.contentAudioVideo.logger,ne)):(this.contentAudioVideo.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.contentAudioVideo.configuration.videoUplinkBandwidthPolicy=void 0)}enableSVCForContentShare(ie){ie?this.contentAudioVideo.configuration.enableSVC=!0:this.contentAudioVideo.configuration.enableSVC=!1}startContentShare(ie){return C(this,void 0,void 0,function*(){if(ie){if(this.contentAudioVideo.configuration.meetingFeatures.contentMaxResolution===w.default.VideoDisabled){this.contentAudioVideo.logger.info("Could not start content because max content resolution was set to None");return}this.mediaStreamBroker.mediaStream=ie;for(let ne=0;ne<this.mediaStreamBroker.mediaStream.getTracks().length;ne++)this.mediaStreamBroker.mediaStream.getTracks()[ne].addEventListener("ended",()=>{this.stopContentShare()});this.contentAudioVideo.start()}})}startContentShareFromScreenCapture(ie,ne){return C(this,void 0,void 0,function*(){const re=yield this.mediaStreamBroker.acquireScreenCaptureDisplayInputStream(ie,ne);return yield this.startContentShare(re),re})}pauseContentShare(){this.mediaStreamBroker.toggleMediaStream(!1)&&this.forEachContentShareObserver(ie=>{T.Maybe.of(ie.contentShareDidPause).map(ne=>ne.call(ie))})}unpauseContentShare(){this.mediaStreamBroker.toggleMediaStream(!0)&&this.forEachContentShareObserver(ie=>{T.Maybe.of(ie.contentShareDidUnpause).map(ne=>ne.call(ie))})}setContentShareVideoCodecPreferences(ie){this.contentAudioVideo.setVideoCodecSendPreferences(ie)}destroy(){return C(this,void 0,void 0,function*(){this.contentAudioVideo&&(this.destroyed=!0,this.contentAudioVideo.removeObserver(this),this.stopContentShare(),this.observerQueue.clear(),this.contentAudioVideo=void 0,this.attendeeAudioVideo=void 0,this.mediaStreamBroker=void 0)})}stopContentShare(){this.contentAudioVideo.stop(),this.mediaStreamBroker.cleanup()}addContentShareObserver(ie){this.observerQueue.add(ie)}removeContentShareObserver(ie){this.observerQueue.delete(ie)}forEachContentShareObserver(ie){for(const ne of this.observerQueue)S.default.nextTick(()=>{this.observerQueue.has(ne)&&ie(ne)})}audioVideoDidStart(){var ie;((ie=this.mediaStreamBroker.mediaStream)===null||ie===void 0?void 0:ie.getVideoTracks().length)>0&&this.contentAudioVideo.videoTileController.startLocalVideoTile()}audioVideoDidStop(ie){this.mediaStreamBroker.cleanup(),this.contentShareTile&&(this.attendeeAudioVideo.videoTileController.removeVideoTile(this.contentShareTile.id()),this.contentShareTile=null),this.forEachContentShareObserver(ne=>{T.Maybe.of(ne.contentShareDidStop).map(re=>re.call(ne))})}setupContentShareEvents(){this.attendeeAudioVideo.realtimeController.realtimeSubscribeToAttendeeIdPresence((ie,ne,re,oe)=>{const ae=new x.default(ie).hasModality(x.default.MODALITY_CONTENT),le=new x.default(ie).base()===this.attendeeAudioVideo.configuration.credentials.attendeeId;if(!ae||!le||!ne||this.contentShareTile)return;const de=this.mediaStreamBroker.mediaStream;if(de!=null&&de.getVideoTracks().length){this.contentShareTile=this.attendeeAudioVideo.videoTileController.addVideoTile();const me=de.getVideoTracks()[0];let fe,ge;if(me.getSettings){const he=me.getSettings();fe=he.width,ge=he.height}else{const he=me.getCapabilities();fe=he.width,ge=he.height}this.contentShareTile.bindVideoStream(this.contentAudioVideo.configuration.credentials.attendeeId,!1,de,fe,ge,null,this.contentAudioVideo.configuration.credentials.externalUserId)}this.forEachContentShareObserver(me=>{T.Maybe.of(me.contentShareDidStart).map(fe=>fe.call(me))})})}};return DefaultContentShareController.default=ee,DefaultContentShareController}var DefaultEventController={},Destroyable={},hasRequiredDestroyable;function requireDestroyable(){if(hasRequiredDestroyable)return Destroyable;hasRequiredDestroyable=1,Object.defineProperty(Destroyable,"__esModule",{value:!0}),Destroyable.isDestroyable=void 0;function C(E){return E&&"destroy"in E}return Destroyable.isDestroyable=C,Destroyable}var EventIngestionConfiguration={},EventBufferConfiguration={},hasRequiredEventBufferConfiguration;function requireEventBufferConfiguration(){if(hasRequiredEventBufferConfiguration)return EventBufferConfiguration;hasRequiredEventBufferConfiguration=1,Object.defineProperty(EventBufferConfiguration,"__esModule",{value:!0});let C=class{constructor(E=5e3,w=2,R=64,M=100,x=15){this.flushIntervalMs=E,this.flushSize=w,this.maxBufferCapacityKb=R,this.totalBufferItems=M,this.retryCountLimit=x}};return EventBufferConfiguration.default=C,EventBufferConfiguration}var hasRequiredEventIngestionConfiguration;function requireEventIngestionConfiguration(){if(hasRequiredEventIngestionConfiguration)return EventIngestionConfiguration;hasRequiredEventIngestionConfiguration=1;var C=EventIngestionConfiguration&&EventIngestionConfiguration.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(EventIngestionConfiguration,"__esModule",{value:!0});const E=C(requireEventBufferConfiguration());let w=class{constructor(R,M,x=new E.default){this.eventsClientConfiguration=R,this.ingestionURL=M,this.eventBufferConfiguration=x}};return EventIngestionConfiguration.default=w,EventIngestionConfiguration}var DefaultMeetingEventReporter={},InMemoryJSONEventBuffer={},FullJitterBackoff={},hasRequiredFullJitterBackoff;function requireFullJitterBackoff(){if(hasRequiredFullJitterBackoff)return FullJitterBackoff;hasRequiredFullJitterBackoff=1,Object.defineProperty(FullJitterBackoff,"__esModule",{value:!0});let C=class{constructor(E,w,R){this.fixedWaitMs=E,this.shortBackoffMs=w,this.longBackoffMs=R,this.currentRetry=0,this.fixedWaitMs<0&&(this.fixedWaitMs=0),this.shortBackoffMs<0&&(this.shortBackoffMs=0),this.longBackoffMs<0&&(this.longBackoffMs=0),this.reset()}reset(){this.currentRetry=0}nextBackoffAmountMs(){const E=Math.random()*Math.min(this.longBackoffMs,this.shortBackoffMs*Math.pow(2,this.currentRetry))+this.fixedWaitMs;return this.currentRetry+=1,E}};return FullJitterBackoff.default=C,FullJitterBackoff}var DefaultUserAgentParser={},hasRequiredDefaultUserAgentParser;function requireDefaultUserAgentParser(){if(hasRequiredDefaultUserAgentParser)return DefaultUserAgentParser;hasRequiredDefaultUserAgentParser=1;var C=DefaultUserAgentParser&&DefaultUserAgentParser.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(DefaultUserAgentParser,"__esModule",{value:!0});const E=requireUaParser(),w=C(requireVersioning());let R=class Ba{constructor(x){var S,T,_,D,Y,ee,ie;try{this.parserResult=navigator&&navigator.userAgent?new E.UAParser(navigator.userAgent).getResult():void 0}catch(ne){x.error(ne.message)}this.browserMajorVersion=((_=(T=(S=this.parserResult)===null||S===void 0?void 0:S.browser)===null||T===void 0?void 0:T.version)===null||_===void 0?void 0:_.split(".")[0])||Ba.UNAVAILABLE,this.browserName=((D=this.parserResult)===null||D===void 0?void 0:D.browser.name)||Ba.UNAVAILABLE,this.browserVersion=((Y=this.parserResult)===null||Y===void 0?void 0:Y.browser.version)||Ba.UNAVAILABLE,this.deviceName=[((ee=this.parserResult)===null||ee===void 0?void 0:ee.device.vendor)||"",((ie=this.parserResult)===null||ie===void 0?void 0:ie.device.model)||""].join(" ").trim()||Ba.UNAVAILABLE}getParserResult(){var x,S;return{browserMajorVersion:this.browserMajorVersion,browserName:this.browserName,browserVersion:this.browserVersion,deviceName:this.deviceName,osName:((x=this.parserResult)===null||x===void 0?void 0:x.os.name)||Ba.UNAVAILABLE,osVersion:((S=this.parserResult)===null||S===void 0?void 0:S.os.version)||Ba.UNAVAILABLE,sdkVersion:w.default.sdkVersion,sdkName:w.default.sdkName}}};return DefaultUserAgentParser.default=R,R.UNAVAILABLE="Unavailable",DefaultUserAgentParser}var hasRequiredInMemoryJSONEventBuffer;function requireInMemoryJSONEventBuffer(){if(hasRequiredInMemoryJSONEventBuffer)return InMemoryJSONEventBuffer;hasRequiredInMemoryJSONEventBuffer=1;var C=InMemoryJSONEventBuffer&&InMemoryJSONEventBuffer.__awaiter||function(_,D,Y,ee){function ie(ne){return ne instanceof Y?ne:new Y(function(re){re(ne)})}return new(Y||(Y=Promise))(function(ne,re){function oe(de){try{le(ee.next(de))}catch(me){re(me)}}function ae(de){try{le(ee.throw(de))}catch(me){re(me)}}function le(de){de.done?ne(de.value):ie(de.value).then(oe,ae)}le((ee=ee.apply(_,D||[])).next())})},E=InMemoryJSONEventBuffer&&InMemoryJSONEventBuffer.__rest||function(_,D){var Y={};for(var ee in _)Object.prototype.hasOwnProperty.call(_,ee)&&D.indexOf(ee)<0&&(Y[ee]=_[ee]);if(_!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ie=0,ee=Object.getOwnPropertySymbols(_);ie<ee.length;ie++)D.indexOf(ee[ie])<0&&Object.prototype.propertyIsEnumerable.call(_,ee[ie])&&(Y[ee[ie]]=_[ee[ie]]);return Y},w=InMemoryJSONEventBuffer&&InMemoryJSONEventBuffer.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(InMemoryJSONEventBuffer,"__esModule",{value:!0});const R=w(requireFullJitterBackoff()),M=w(requireIntervalScheduler()),x=w(requireDefaultUserAgentParser()),S=requireUtils();let T=class ta{constructor(D,Y,ee,ie,ne){this.buffer=[],this.bufferSize=0,this.maxBufferItemCapacityBytes=0,this.ingestionEventSize=0,this.flushIntervalMs=0,this.flushSize=0,this.failedIngestionEvents=[],this.retryCountLimit=15,this.lock=!1,this.cancellableEvents=new Map,this.attributesToFilter=["externalUserId","externalMeetingId","timestampMs"],this.deepCopyCurrentIngestionEvent=Se=>({type:Se.type,v:Se.v,payloads:[...Se.payloads]}),this.sendEvents=()=>C(this,void 0,void 0,function*(){if(this.lock)return;const Se=this.getItems(this.flushSize);if(Se.length===0)return;this.lock=!0;const Re=this.makeRequestBody(Se);let Ae=!1;const Me=Date.now();this.metadata.browserName.toLowerCase()==="firefox"&&this.cancellableEvents.set(Me,Se);try{this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - sending body ${Re}`);const Be=yield this.send(Re);if(this.cancellableEvents.delete(Me),!Be.ok)this.logger.error(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - Failed to send events ${Re} with response status ${Be.status}`),Ae=!0;else try{const Qe=yield Be.json();this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - send successful events: ${Re} message: ${JSON.stringify(Qe)}`)}catch(Qe){this.logger.warn(`Event Reporting - InMemoryJSONEventBuffer - sendEvents error reading OK response ${Qe} for events ${Re}`)}}catch(Be){Ae=!0,this.logger.warn(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - Error in sending events ${Re} to the ingestion endpoint ${Be}`)}finally{this.lock=!1}Ae&&(this.cancellableEvents.delete(Me),this.failedIngestionEvents.push(...Se))});const re=new x.default(ne).getParserResult(),oe=E(re,["browserMajorVersion"]),ae=Y.toJSON(),{type:le,v:de}=ae,me=E(ae,["type","v"]);this.authenticationToken=Y.getAuthenticationToken(),this.metadata=Object.assign(Object.assign({},oe),me),Object.keys(this.metadata).forEach(Se=>this.attributesToFilter.push(Se)),this.type=le,this.v=de,this.ingestionURL=ee,this.logger=ne,this.importantEvents=new Set(ie);const{maxBufferCapacityKb:fe,totalBufferItems:ge,flushSize:he,flushIntervalMs:ve,retryCountLimit:be}=D;this.maxBufferCapacityBytes=fe*1024,this.totalBufferItems=ge,this.maxBufferItemCapacityBytes=Math.round(this.maxBufferCapacityBytes/ge),this.flushIntervalMs=ve,this.flushSize=he,this.retryCountLimit=be,this.currentIngestionEvent=this.initializeAndGetCurrentIngestionEvent(),this.beaconEventListener=Se=>this.beaconEventHandler(Se),this.addEventListeners()}addEventListeners(){!this.beaconEventListener||!("window"in commonjsGlobal)||!window.addEventListener||!("document"in commonjsGlobal)||!document.addEventListener||(this.logger.debug("Event Reporting - InMemoryJSONEventBuffer - addEventListeners - adding pagehide and visibility change event listeners"),window.addEventListener("pagehide",this.beaconEventListener),document.addEventListener("visibilitychange",this.beaconEventListener))}beaconEventHandler(D){(D.type==="visibilitychange"&&document.visibilityState==="hidden"||D.type==="pagehide")&&(this.logger.debug("Event Reporting - InMemoryJSONEventBuffer - beaconEventHandler is triggered calling sendBeacon"),this.sendBeacon())}removeEventListeners(){!this.beaconEventListener||!("window"in commonjsGlobal)||!window.removeEventListener||!("document"in commonjsGlobal)||!document.removeEventListener||(window.removeEventListener("pagehide",this.beaconEventListener),document.removeEventListener("visibilitychange",this.beaconEventListener),this.logger.debug("Event Reporting - InMemoryJSONEventBuffer - removeEventListeners - removing pagehide and visibility change event listeners"))}start(){var D;this.removeEventListeners(),this.addEventListeners(),(D=this.intervalScheduler)===null||D===void 0||D.stop(),this.intervalScheduler=new M.default(this.flushIntervalMs),this.intervalScheduler.start(()=>this.sendEvents())}stop(){var D;(D=this.intervalScheduler)===null||D===void 0||D.stop(),this.intervalScheduler=void 0,this.sendBeacon(),this.removeEventListeners()}addItem(D){return C(this,void 0,void 0,function*(){this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - received event ${JSON.stringify(D)}`);const{name:Y,ts:ee,attributes:ie}=D,ne=ie&&this.filterAttributes(ie,this.attributesToFilter),re=Object.assign({name:Y,ts:ee},ne);this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - event after filtering attributes ${JSON.stringify(re)}`);const oe=this.getSize(re);if(oe>ta.MAX_ITEM_SIZE_BYTES_ALLOWED)throw new Error(`Event Reporting - Item to be added has size ${oe} bytes. Item cannot exceed max item size allowed of ${ta.MAX_ITEM_SIZE_BYTES_ALLOWED} bytes.`);if(this.importantEvents.has(Y)){this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - sending important event ${JSON.stringify(re)}`),this.sendEventImmediately({name:Y,ts:ee,attributes:ne});return}if(this.isFull())throw this.logger.warn("Event Reporting - Event buffer is full"),new Error("Buffer full");if(this.currentIngestionEvent.payloads.push(re),this.ingestionEventSize+=oe,this.bufferItemThresholdReached(oe)){const ae=this.deepCopyCurrentIngestionEvent(this.currentIngestionEvent);this.buffer.push(ae),this.bufferSize+=this.ingestionEventSize,this.currentIngestionEvent=this.initializeAndGetCurrentIngestionEvent(),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - buffer item threshold reached updated buffer ${JSON.stringify(this.buffer)}`)}})}filterAttributes(D,Y){const ee=new Set(Y);return Object.keys(D).filter(ie=>ee.has(ie)).forEach(ie=>delete D[ie]),D}initializeAndGetCurrentIngestionEvent(){const D={type:this.type,v:this.v,payloads:[]};return this.ingestionEventSize=this.getSize(D),D}bufferItemThresholdReached(D){return D+this.ingestionEventSize>=this.maxBufferItemCapacityBytes||this.currentIngestionEvent.payloads.length===ta.MAX_PAYLOAD_ITEMS}getSize(D){let Y=0;if(typeof D=="object")for(const[ee,ie]of Object.entries(D))Y+=this.getPrimitiveSize(ee),Y+=this.getSize(ie);else Y+=this.getPrimitiveSize(D);return Y}getPrimitiveSize(D){let Y=0;return typeof D=="string"?Y+=D.length*2:typeof D=="number"&&(Y+=8),Y}isFull(){return this.bufferSize===this.maxBufferCapacityBytes||this.buffer.length===this.totalBufferItems}isEmpty(){return this.buffer.length===0||this.bufferSize===0}getItems(D,Y=0){return this.isEmpty()?[]:(D=Math.min(this.buffer.length,D+1),this.buffer.splice(Y,D))}makeBeaconRequestBody(D){const Y={metadata:this.metadata,events:D,authorization:this.authenticationToken};return JSON.stringify(Y)}makeRequestBody(D){const Y={metadata:this.metadata,events:D};return JSON.stringify(Y)}sendEventImmediately(D){return C(this,void 0,void 0,function*(){this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - important event received ${JSON.stringify(D)}`);const{name:Y,ts:ee,attributes:ie}=D,ne={type:this.type,v:this.v,payloads:[Object.assign({name:Y,ts:ee},ie)]};let re=!1,oe=null;const ae=this.makeRequestBody([ne]);try{if(oe=yield this.send(ae),oe.ok){try{const le=yield oe.json();this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - send successful event: ${ae}, message: ${JSON.stringify(le)}`)}catch(le){this.logger.warn(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - Error reading OK response ${le} for event ${ae}`)}return}else this.logger.error(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - Failed to send an important event ${ae} with response status ${oe.status}`),re=!0}catch(le){this.logger.warn(`Event Reporting - There may be a failure in sending an important event ${ae} to the ingestion endpoint ${le}.`),re=!0;try{if(this.metadata.browserName.toLowerCase()==="firefox"){const de=this.makeBeaconRequestBody([ne]);this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - beaconing data out ${de}`),navigator.sendBeacon(`${this.ingestionURL}?beacon=1`,de)?re=!1:re=!0}}catch{this.logger.warn(`Event Reporting - Error sending beacon for an important event ${ae}`),re=!0}}re&&(this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - pushing to failed events ${ae}`),this.failedIngestionEvents.push(ne))})}send(D){return C(this,void 0,void 0,function*(){const Y=new R.default(ta.RETRY_FIXED_BACKOFF_WAIT_MS,ta.RETRY_SHORT_BACKOFF_MS,ta.RETRY_LONG_BACKOFF_MS);try{let ee=0;for(;ee<this.retryCountLimit;){const ie=yield fetch(this.ingestionURL,{method:"POST",headers:{Authorization:`Bearer ${this.authenticationToken}`},body:D});if(ie.ok||!ta.SENDING_FAILURE_CODES.has(ie.status))return ie;if(this.logger.warn(`Will retry sending failure for ${D} due to status code ${ie.status}.`),ee++,ee<this.retryCountLimit){const ne=Y.nextBackoffAmountMs();yield S.wait(ne)}}if(ee===this.retryCountLimit)throw new Error(`Retry count limit reached for ${D}`)}catch(ee){throw ee}})}sendBeacon(){return C(this,void 0,void 0,function*(){const D=this.buffer;if(this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out buffer events ${JSON.stringify(D)}`),this.buffer=[],this.currentIngestionEvent.payloads.length>0){const ee=this.deepCopyCurrentIngestionEvent(this.currentIngestionEvent);D.push(ee),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out current ingestion event ${JSON.stringify(ee)}`),this.currentIngestionEvent=this.initializeAndGetCurrentIngestionEvent()}if(this.failedIngestionEvents.length>0){const ee=this.failedIngestionEvents.map(ie=>this.deepCopyCurrentIngestionEvent(ie));D.push(...ee),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out any failed ingestion event ${JSON.stringify(ee)}`),this.failedIngestionEvents=[]}if(this.cancellableEvents.size>0&&(this.cancellableEvents.forEach(ee=>{D.push(...ee),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out each cancellable event ${JSON.stringify(ee)}`)}),this.cancellableEvents.clear()),D.length===0)return;const Y=this.makeBeaconRequestBody(D);this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - beacon data to send ${Y}`);try{navigator.sendBeacon(`${this.ingestionURL}?beacon=1`,Y)||this.logger.warn(`Event Reporting - Browser failed to queue beacon data ${Y}`)}catch(ee){this.logger.warn(`Event Reporting - Sending beacon data ${Y} failed with error ${ee}`)}})}reset(){this.maxBufferCapacityBytes=0,this.totalBufferItems=0,this.buffer=[],this.bufferSize=0,this.maxBufferItemCapacityBytes=0,this.ingestionEventSize=0,this.flushIntervalMs=0,this.flushSize=0,this.failedIngestionEvents=[],this.lock=!1,this.beaconEventListener=void 0,this.cancellableEvents.clear()}destroy(){return C(this,void 0,void 0,function*(){this.stop(),this.reset()})}};return InMemoryJSONEventBuffer.default=T,T.SENDING_FAILURE_CODES=new Set([408,429,500,502,503,504]),T.RETRY_FIXED_BACKOFF_WAIT_MS=0,T.RETRY_SHORT_BACKOFF_MS=1e3,T.RETRY_LONG_BACKOFF_MS=15e3,T.MAX_PAYLOAD_ITEMS=2,T.MAX_ITEM_SIZE_BYTES_ALLOWED=3e3,InMemoryJSONEventBuffer}var hasRequiredDefaultMeetingEventReporter;function requireDefaultMeetingEventReporter(){if(hasRequiredDefaultMeetingEventReporter)return DefaultMeetingEventReporter;hasRequiredDefaultMeetingEventReporter=1;var C=DefaultMeetingEventReporter&&DefaultMeetingEventReporter.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=DefaultMeetingEventReporter&&DefaultMeetingEventReporter.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(DefaultMeetingEventReporter,"__esModule",{value:!0});const w=requireDestroyable(),R=E(requireInMemoryJSONEventBuffer());let M=class{constructor(x,S){this.reportingEvents=!1,this.importantEvents=["meetingEnded","meetingFailed","meetingStartFailed","audioInputFailed","videoInputFailed","meetingStartSucceeded","deviceLabelTriggerFailed"],this.destroyed=!1;const{eventsClientConfiguration:T,ingestionURL:_,eventBufferConfiguration:D}=x,{eventsToIgnore:Y}=T;this.eventBuffer=new R.default(D,T,_,this.importantEvents,S),this.logger=S,this.eventsToIgnore=Y,this.start()}start(){if(!this.reportingEvents)try{this.eventBuffer.start(),this.logger.info("Event reporting started"),this.reportingEvents=!0}catch(x){this.logger.error(`Event Reporting - Error starting the event buffer ${x}`)}}stop(){if(this.reportingEvents)try{this.eventBuffer.stop(),this.logger.info("Event reporting stopped"),this.reportingEvents=!1}catch(x){this.logger.error(`Event Reporting - Error stopping the event buffer ${x}`)}}reportEvent(x,S,T){return C(this,void 0,void 0,function*(){if(this.logger.debug(`Event Reporting - DefaultMeetingEventReporter - event received in reportEvent ${x}, ${S}, ${JSON.stringify(T)}`),this.eventsToIgnore.includes(S)){this.logger.debug(`Event Reporting - DefaultMeetingEventReporter - ${S} event will be ignored as it is in events to ignore`);return}try{this.logger.debug("Event Reporting - DefaultMeetingEventReporter - adding item to event buffer"),yield this.eventBuffer.addItem({ts:x,name:S,attributes:T})}catch(_){this.logger.error(`Event Reporting - Error adding event to buffer ${_}`)}})}destroy(){return C(this,void 0,void 0,function*(){this.destroyed=!0,this.stop(),w.isDestroyable(this.eventBuffer)&&this.eventBuffer.destroy(),this.eventBuffer=void 0})}};return DefaultMeetingEventReporter.default=M,DefaultMeetingEventReporter}var MeetingEventsClientConfiguration={},hasRequiredMeetingEventsClientConfiguration;function requireMeetingEventsClientConfiguration(){if(hasRequiredMeetingEventsClientConfiguration)return MeetingEventsClientConfiguration;hasRequiredMeetingEventsClientConfiguration=1,Object.defineProperty(MeetingEventsClientConfiguration,"__esModule",{value:!0});let C=class{constructor(E,w,R,M=[]){this.type="Meet",this.v=1,this.meetingId=E,this.attendeeId=w,this.eventsToIgnore=M,this.authenticationToken=R}getAuthenticationToken(){return this.authenticationToken}toJSON(){const E={};return E.type=this.type,E.v=this.v,E.meetingId=this.meetingId,E.attendeeId=this.attendeeId,E}};return MeetingEventsClientConfiguration.default=C,MeetingEventsClientConfiguration}var flattenEventAttributes={},hasRequiredFlattenEventAttributes;function requireFlattenEventAttributes(){if(hasRequiredFlattenEventAttributes)return flattenEventAttributes;hasRequiredFlattenEventAttributes=1,Object.defineProperty(flattenEventAttributes,"__esModule",{value:!0});const C=E=>{const w={};for(const[R,M]of Object.entries(E))if(!(M==null||M===""))if(typeof M=="number"||typeof M=="string")w[R]=M;else throw new TypeError("Unhandled type received while flattening attributes.");return w};return flattenEventAttributes.default=C,flattenEventAttributes}var hasRequiredDefaultEventController;function requireDefaultEventController(){if(hasRequiredDefaultEventController)return DefaultEventController;hasRequiredDefaultEventController=1;var C=DefaultEventController&&DefaultEventController.__awaiter||function(ee,ie,ne,re){function oe(ae){return ae instanceof ne?ae:new ne(function(le){le(ae)})}return new(ne||(ne=Promise))(function(ae,le){function de(ge){try{fe(re.next(ge))}catch(he){le(he)}}function me(ge){try{fe(re.throw(ge))}catch(he){le(he)}}function fe(ge){ge.done?ae(ge.value):oe(ge.value).then(de,me)}fe((re=re.apply(ee,ie||[])).next())})},E=DefaultEventController&&DefaultEventController.__importDefault||function(ee){return ee&&ee.__esModule?ee:{default:ee}};Object.defineProperty(DefaultEventController,"__esModule",{value:!0});const w=requireUaParser(),R=requireDestroyable(),M=E(requireEventIngestionConfiguration()),x=E(requireDefaultMeetingEventReporter()),S=E(requireMeetingEventsClientConfiguration()),T=E(requireAsyncScheduler()),_=E(requireVersioning()),D=E(requireFlattenEventAttributes());let Y=class Va{constructor(ie,ne,re){var oe,ae,le,de,me,fe,ge;this.meetingHistoryStates=[],this.observerSet=new Set,this.destroyed=!1,this.logger=ne,this.configuration=ie,this.setupEventReporter(ie,ne,re);try{this.parserResult=navigator&&navigator.userAgent?new w.UAParser(navigator.userAgent).getResult():null}catch(he){this.logger.error(he.message)}this.browserMajorVersion=((le=(ae=(oe=this.parserResult)===null||oe===void 0?void 0:oe.browser)===null||ae===void 0?void 0:ae.version)===null||le===void 0?void 0:le.split(".")[0])||Va.UNAVAILABLE,this.browserName=((de=this.parserResult)===null||de===void 0?void 0:de.browser.name)||Va.UNAVAILABLE,this.browserVersion=((me=this.parserResult)===null||me===void 0?void 0:me.browser.version)||Va.UNAVAILABLE,this.deviceName=[((fe=this.parserResult)===null||fe===void 0?void 0:fe.device.vendor)||"",((ge=this.parserResult)===null||ge===void 0?void 0:ge.device.model)||""].join(" ").trim()||Va.UNAVAILABLE}addObserver(ie){this.observerSet.add(ie)}removeObserver(ie){this.observerSet.delete(ie)}forEachObserver(ie){for(const ne of this.observerSet)T.default.nextTick(()=>{this.observerSet.has(ne)&&ie(ne)})}publishEvent(ie,ne){return C(this,void 0,void 0,function*(){const re=Date.now();this.meetingHistoryStates.push({name:ie,timestampMs:re});const oe=Object.freeze(Object.assign(this.getAttributes(re),ne));this.forEachObserver(ae=>{ae.eventDidReceive(ie,oe)}),this.reportEvent(ie,re,ne)})}reportEvent(ie,ne,re){var oe;return C(this,void 0,void 0,function*(){let ae;try{re&&(ae=D.default(re)),yield(oe=this.eventReporter)===null||oe===void 0?void 0:oe.reportEvent(ne,ie,ae)}catch(le){this.logger.error(`Error reporting event ${le}`)}})}setupEventReporter(ie,ne,re){if(re)this._eventReporter=re;else if(ie.urls){const oe=ie.urls.eventIngestionURL;if(oe){this.logger.info("Event ingestion URL is present in the configuration");const{meetingId:ae,credentials:{attendeeId:le,joinToken:de}}=ie,me=new S.default(ae,le,de),fe=new M.default(me,oe);this._eventReporter=new x.default(fe,ne)}}}getAttributes(ie){var ne,re;return{attendeeId:this.configuration.credentials.attendeeId,browserMajorVersion:this.browserMajorVersion,browserName:this.browserName,browserVersion:this.browserVersion,deviceName:this.deviceName,externalMeetingId:typeof this.configuration.externalMeetingId=="string"?this.configuration.externalMeetingId:"",externalUserId:this.configuration.credentials.externalUserId,meetingHistory:this.meetingHistoryStates,meetingId:this.configuration.meetingId,osName:((ne=this.parserResult)===null||ne===void 0?void 0:ne.os.name)||Va.UNAVAILABLE,osVersion:((re=this.parserResult)===null||re===void 0?void 0:re.os.version)||Va.UNAVAILABLE,sdkVersion:_.default.sdkVersion,sdkName:_.default.sdkName,timestampMs:ie}}get eventReporter(){return this._eventReporter}destroy(){return C(this,void 0,void 0,function*(){R.isDestroyable(this.eventReporter)&&(yield this.eventReporter.destroy()),this.logger=void 0,this.configuration=void 0,this._eventReporter=void 0,this.destroyed=!0})}};return DefaultEventController.default=Y,Y.UNAVAILABLE="Unavailable",DefaultEventController}var DefaultMeetingReadinessChecker={},MeetingReadinessCheckerConfiguration={},hasRequiredMeetingReadinessCheckerConfiguration;function requireMeetingReadinessCheckerConfiguration(){if(hasRequiredMeetingReadinessCheckerConfiguration)return MeetingReadinessCheckerConfiguration;hasRequiredMeetingReadinessCheckerConfiguration=1,Object.defineProperty(MeetingReadinessCheckerConfiguration,"__esModule",{value:!0});let C=class{constructor(){this.timeoutMs=1e4,this.waitDurationMs=3e3,this.audioOutputFrequency=440,this.audioOutputGain=.1}};return MeetingReadinessCheckerConfiguration.default=C,MeetingReadinessCheckerConfiguration}var hasRequiredDefaultMeetingReadinessChecker;function requireDefaultMeetingReadinessChecker(){if(hasRequiredDefaultMeetingReadinessChecker)return DefaultMeetingReadinessChecker;hasRequiredDefaultMeetingReadinessChecker=1;var C=DefaultMeetingReadinessChecker&&DefaultMeetingReadinessChecker.__awaiter||function(me,fe,ge,he){function ve(be){return be instanceof ge?be:new ge(function(Se){Se(be)})}return new(ge||(ge=Promise))(function(be,Se){function Re(Be){try{Me(he.next(Be))}catch(Qe){Se(Qe)}}function Ae(Be){try{Me(he.throw(Be))}catch(Qe){Se(Qe)}}function Me(Be){Be.done?be(Be.value):ve(Be.value).then(Re,Ae)}Me((he=he.apply(me,fe||[])).next())})},E=DefaultMeetingReadinessChecker&&DefaultMeetingReadinessChecker.__importDefault||function(me){return me&&me.__esModule?me:{default:me}};Object.defineProperty(DefaultMeetingReadinessChecker,"__esModule",{value:!0});const w=E(requireDefaultAudioMixController()),R=E(requireDefaultBrowserBehavior()),M=E(requireDefaultDeviceController()),x=E(requirePermissionDeniedError()),S=E(requireBaseTask()),T=E(requireTimeoutTask()),_=E(requireCheckAudioConnectivityFeedback()),D=E(requireCheckAudioInputFeedback()),Y=E(requireCheckAudioOutputFeedback()),ee=E(requireCheckCameraResolutionFeedback()),ie=E(requireCheckContentShareConnectivityFeedback()),ne=E(requireCheckNetworkTCPConnectivityFeedback()),re=E(requireCheckNetworkUDPConnectivityFeedback()),oe=E(requireCheckVideoConnectivityFeedback()),ae=E(requireCheckVideoInputFeedback()),le=E(requireMeetingReadinessCheckerConfiguration());let de=class sm{constructor(fe,ge,he=new le.default){this.logger=fe,this.meetingSession=ge,this.configuration=he,this.browserBehavior=new R.default}static delay(fe){return C(this,void 0,void 0,function*(){return new Promise(ge=>setTimeout(ge,fe))})}checkAudioInput(fe){return C(this,void 0,void 0,function*(){try{return yield this.meetingSession.audioVideo.startAudioInput(fe),yield this.meetingSession.audioVideo.stopAudioInput(),D.default.Succeeded}catch(ge){return this.logger.error(`MeetingReadinessChecker: Audio input check failed with error ${ge}`),ge instanceof x.default?D.default.PermissionDenied:D.default.Failed}})}checkAudioOutput(fe,ge,he=null){return C(this,void 0,void 0,function*(){try{const ve=fe?M.default.getIntrinsicDeviceId(fe):"";return yield this.playTone(ve,this.configuration.audioOutputFrequency,he),(yield ge())?Y.default.Succeeded:Y.default.Failed}catch(ve){return this.logger.error(`MeetingReadinessChecker: Audio output check failed with error: ${ve}`),Y.default.Failed}finally{this.stopTone()}})}playTone(fe,ge,he){return C(this,void 0,void 0,function*(){const ve=this.configuration.audioOutputGain;this.oscillatorNode&&this.stopTone(),this.audioContext=M.default.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=0,this.oscillatorNode=this.audioContext.createOscillator(),this.oscillatorNode.frequency.value=ge,this.oscillatorNode.connect(this.gainNode),this.destinationStream=this.audioContext.createMediaStreamDestination(),this.gainNode.connect(this.destinationStream);const be=this.audioContext.currentTime+.1;this.gainNode.gain.linearRampToValueAtTime(0,be),this.gainNode.gain.linearRampToValueAtTime(ve,be+.1),this.oscillatorNode.start();const Se=new w.default(this.logger);try{this.browserBehavior.supportsSetSinkId()&&(yield Se.bindAudioDevice({deviceId:fe}))}catch(Re){this.logger.error(`Failed to bind audio device: ${Re}`)}try{yield Se.bindAudioElement(he||new Audio)}catch(Re){this.logger.error(`Failed to bind audio element: ${Re}`)}yield Se.bindAudioStream(this.destinationStream.stream)})}stopTone(){if(!this.audioContext||!this.gainNode||!this.oscillatorNode||!this.destinationStream)return;const fe=1,ge=.1,he=this.configuration.audioOutputGain,ve=this.audioContext.currentTime;this.gainNode.gain.linearRampToValueAtTime(he,ve+ge+fe),this.gainNode.gain.linearRampToValueAtTime(0,ve+ge*2+fe),this.oscillatorNode.stop(),this.oscillatorNode.disconnect(this.gainNode),this.gainNode.disconnect(this.destinationStream),this.oscillatorNode=null,this.gainNode=null,this.destinationStream=null}checkVideoInput(fe){return C(this,void 0,void 0,function*(){try{return yield this.meetingSession.audioVideo.startVideoInput(fe),yield this.meetingSession.audioVideo.stopVideoInput(),ae.default.Succeeded}catch(ge){return this.logger.error(`MeetingReadinessChecker: Video check failed with error ${ge}`),ge instanceof x.default?ae.default.PermissionDenied:ae.default.Failed}})}checkCameraResolution(fe,ge,he){return C(this,void 0,void 0,function*(){let ve;try{const be=M.default.getIntrinsicDeviceId(fe),Se={video:this.calculateVideoConstraint(be,ge,he)};ve=yield navigator.mediaDevices.getUserMedia(Se)}catch(be){return this.logger.error(`MeetingReadinessChecker: Camera resolution check with width: ${ge} height ${he} failed with error ${be}`),be&&be.name==="OverconstrainedError"?ee.default.ResolutionNotSupported:be&&be.name==="NotAllowedError"?ee.default.PermissionDenied:ee.default.Failed}finally{ve&&ve.getTracks().forEach(function(be){be.stop()})}return ee.default.Succeeded})}calculateVideoConstraint(fe,ge,he){const ve=this.browserBehavior.requiresResolutionAlignment(ge,he),be={};return this.browserBehavior.requiresNoExactMediaStreamConstraints()?(be.deviceId=fe,be.width=ge,be.height=he):(be.deviceId={exact:fe},be.width={exact:ve[0]},be.height={exact:ve[1]}),be}checkContentShareConnectivity(fe){return C(this,void 0,void 0,function*(){let ge=!1,he=!1;const ve={contentShareDidStart:()=>{ge=!0}},be={audioVideoDidStart:()=>{he=!0}};try{return this.meetingSession.audioVideo.addObserver(be),this.meetingSession.audioVideo.start(),this.meetingSession.audioVideo.addContentShareObserver(ve),yield this.meetingSession.audioVideo.startContentShareFromScreenCapture(fe),yield this.executeTimeoutTask(()=>C(this,void 0,void 0,function*(){return he&&ge})),he?(yield this.stopMeeting(),ge?ie.default.Succeeded:ie.default.TimedOut):ie.default.ConnectionFailed}catch(Se){return this.logger.error(`MeetingReadinessChecker: Content share check failed with error ${Se}`),Se.name==="NotAllowedError"?ie.default.PermissionDenied:ie.default.Failed}finally{this.meetingSession.audioVideo.removeObserver(be),this.meetingSession.audioVideo.stopContentShare(),this.meetingSession.audioVideo.removeContentShareObserver(ve)}})}checkAudioConnectivity(fe){return C(this,void 0,void 0,function*(){let ge=!1;const he={packetsReceived:0},ve=this.meetingSession.audioVideo,be={metricsDidReceive(Re){Re.getRTCStatsReport().forEach(Ae=>{Ae.type==="inbound-rtp"&&(Ae.mediaType==="audio"||Ae.kind==="audio")&&(he.packetsReceived=Ae.packetsReceived)})}},Se=(Re,Ae,Me,Be)=>{Re===this.meetingSession.configuration.credentials.attendeeId&&Ae&&(ge=!0)};try{yield ve.startAudioInput(fe)}catch(Re){return this.logger.error(`MeetingReadinessChecker: Failed to get audio input device with error ${Re}`),Re instanceof x.default?_.default.AudioInputPermissionDenied:_.default.AudioInputRequestFailed}return ve.realtimeSubscribeToAttendeeIdPresence(Se),ve.addObserver(be),(yield this.startMeeting())?(yield this.executeTimeoutTask(()=>C(this,void 0,void 0,function*(){return this.isAudioConnectionSuccessful(ge,he)})),ve.removeObserver(be),ve.realtimeUnsubscribeToAttendeeIdPresence(Se),yield this.stopMeeting(),yield this.meetingSession.audioVideo.stopAudioInput(),this.isAudioConnectionSuccessful(ge,he)?_.default.Succeeded:_.default.AudioNotReceived):(ve.removeObserver(be),ve.realtimeUnsubscribeToAttendeeIdPresence(Se),yield this.meetingSession.audioVideo.stopAudioInput(),_.default.ConnectionFailed)})}checkVideoConnectivity(fe){return C(this,void 0,void 0,function*(){const ge=this.meetingSession.audioVideo;let he=0;const ve={metricsDidReceive(be){be.getRTCStatsReport().forEach(Se=>{Se.type==="outbound-rtp"&&(Se.mediaType==="video"||Se.kind==="video")&&(he=Se.packetsSent)})}};try{yield ge.startVideoInput(fe)}catch(be){return this.logger.error(`MeetingReadinessChecker: Failed to get video input device with error ${be}`),be instanceof x.default?oe.default.VideoInputPermissionDenied:oe.default.VideoInputRequestFailed}return ge.addObserver(ve),(yield this.startMeeting())?(ge.startLocalVideoTile(),yield this.executeTimeoutTask(()=>C(this,void 0,void 0,function*(){return he>0})),yield ge.stopVideoInput(),yield this.stopMeeting(),ge.removeObserver(ve),he<=0?oe.default.VideoNotSent:oe.default.Succeeded):oe.default.ConnectionFailed})}checkNetworkUDPConnectivity(){return C(this,void 0,void 0,function*(){let fe=!1;const ge={metricsDidReceive(ve){ve.getRTCStatsReport().forEach(be=>{be.type==="candidate-pair"&&be.state==="succeeded"&&(fe=!0)})}};try{this.originalURLRewriter=this.meetingSession.configuration.urls.urlRewriter}catch(ve){return this.logger.error(`MeetingSessionConfiguration.urls doesn't exist. Error: ${ve}`),re.default.MeetingSessionURLsNotInitialized}this.meetingSession.configuration.urls.urlRewriter=ve=>{const be=this.originalURLRewriter(ve);return be.includes("transport=tcp")?"":be};const he=this.meetingSession.audioVideo;return he.addObserver(ge),(yield this.startMeeting())?(yield this.executeTimeoutTask(()=>C(this,void 0,void 0,function*(){return fe})),this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,yield this.stopMeeting(),he.removeObserver(ge),fe?re.default.Succeeded:re.default.ICENegotiationFailed):(this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,re.default.ConnectionFailed)})}checkNetworkTCPConnectivity(){return C(this,void 0,void 0,function*(){let fe=!1;const ge={metricsDidReceive(ve){ve.getRTCStatsReport().forEach(be=>{be.type==="candidate-pair"&&be.state==="succeeded"&&(fe=!0)})}};try{this.originalURLRewriter=this.meetingSession.configuration.urls.urlRewriter}catch(ve){return this.logger.error(`MeetingSessionConfiguration.urls doesn't exist. Error: ${ve}`),ne.default.MeetingSessionURLsNotInitialized}this.meetingSession.configuration.urls.urlRewriter=ve=>{const be=this.originalURLRewriter(ve);return be.includes("transport=udp")?"":be};const he=this.meetingSession.audioVideo;return he.addObserver(ge),(yield this.startMeeting())?(yield this.executeTimeoutTask(()=>C(this,void 0,void 0,function*(){return fe})),this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,yield this.stopMeeting(),he.removeObserver(ge),fe?ne.default.Succeeded:ne.default.ICENegotiationFailed):(this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,ne.default.ConnectionFailed)})}startMeeting(){return C(this,void 0,void 0,function*(){let fe=!1;const ge={audioVideoDidStart:()=>{fe=!0}};return this.meetingSession.audioVideo.addObserver(ge),this.meetingSession.audioVideo.start(),yield this.executeTimeoutTask(()=>C(this,void 0,void 0,function*(){return fe})),this.meetingSession.audioVideo.removeObserver(ge),fe})}stopMeeting(){return C(this,void 0,void 0,function*(){let fe=!1;const ge={audioVideoDidStop:he=>{fe=!0}};return this.meetingSession.audioVideo.addObserver(ge),this.meetingSession.audioVideo.stop(),yield this.executeTimeoutTask(()=>C(this,void 0,void 0,function*(){return fe})),this.meetingSession.audioVideo.removeObserver(ge),fe})}executeTimeoutTask(fe){return C(this,void 0,void 0,function*(){let ge=!1;class he extends S.default{constructor(be,Se){super(be),this.waitDurationMs=Se,this.isCancelled=!1}cancel(){this.isCancelled=!0}run(){return C(this,void 0,void 0,function*(){for(;!this.isCancelled;){if(yield fe()){ge=!0;break}yield sm.delay(this.waitDurationMs)}})}}return yield new T.default(this.logger,new he(this.logger,this.configuration.waitDurationMs),this.configuration.timeoutMs).run(),ge})}isAudioConnectionSuccessful(fe,ge){return fe&&ge.packetsReceived>0}};return DefaultMeetingReadinessChecker.default=de,DefaultMeetingReadinessChecker}var DefaultMeetingSession={},DefaultReconnectController={},hasRequiredDefaultReconnectController;function requireDefaultReconnectController(){if(hasRequiredDefaultReconnectController)return DefaultReconnectController;hasRequiredDefaultReconnectController=1;var C=DefaultReconnectController&&DefaultReconnectController.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(DefaultReconnectController,"__esModule",{value:!0});const E=C(requireTimeoutScheduler());let w=class lm{constructor(M,x){this.reconnectTimeoutMs=M,this.backoffPolicy=x,this.shouldReconnect=!0,this.onlyRestartPeerConnection=!1,this.firstConnectionAttempted=!1,this.firstConnectionAttemptTimestampMs=0,this.lastActiveTimestampMs=1/0,this._isFirstConnection=!0,this.backoffTimer=null,this.backoffCancel=null,this.reset()}timeSpentReconnectingMs(){return this.firstConnectionAttempted?Date.now()-this.firstConnectionAttemptTimestampMs:0}hasPastReconnectDeadline(){return Date.now()-this.lastActiveTimestampMs>=this.reconnectTimeoutMs?!0:this.timeSpentReconnectingMs()>=this.reconnectTimeoutMs}reset(){this.cancel(),this.shouldReconnect=!0,this.onlyRestartPeerConnection=!1,this.firstConnectionAttempted=!1,this.firstConnectionAttemptTimestampMs=0,this.lastActiveTimestampMs=1/0,this.backoffPolicy.reset()}startedConnectionAttempt(M){this._isFirstConnection=M,this.firstConnectionAttempted||(this.firstConnectionAttempted=!0,this.firstConnectionAttemptTimestampMs=Date.now())}hasStartedConnectionAttempt(){return this.firstConnectionAttempted}isFirstConnection(){return this._isFirstConnection}disableReconnect(){this.shouldReconnect=!1}enableRestartPeerConnection(){this.onlyRestartPeerConnection=!0}cancel(){this.disableReconnect(),this.backoffTimer&&(this.backoffTimer.stop(),this.backoffCancel&&(this.backoffCancel(),this.backoffCancel=null))}retryWithBackoff(M,x){const S=this.shouldReconnect&&!this.hasPastReconnectDeadline();return S&&(this.backoffCancel=x,this.backoffTimer=new E.default(this.backoffPolicy.nextBackoffAmountMs()),this.backoffTimer.start(()=>{this.backoffCancel=null,M()})),S}shouldOnlyRestartPeerConnection(){return this.onlyRestartPeerConnection}clone(){return new lm(this.reconnectTimeoutMs,this.backoffPolicy)}setLastActiveTimestampMs(M){this.lastActiveTimestampMs=M}};return DefaultReconnectController.default=w,DefaultReconnectController}var DefaultWebSocketAdapter={},hasRequiredDefaultWebSocketAdapter;function requireDefaultWebSocketAdapter(){if(hasRequiredDefaultWebSocketAdapter)return DefaultWebSocketAdapter;hasRequiredDefaultWebSocketAdapter=1;var C=DefaultWebSocketAdapter&&DefaultWebSocketAdapter.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(DefaultWebSocketAdapter,"__esModule",{value:!0});const E=C(requireVersioning()),w=C(requireWebSocketReadyState());let R=class{constructor(M){this.logger=M}create(M,x,S){this.connection=new WebSocket(S?M:E.default.urlWithVersion(M),x),this.connection.binaryType="arraybuffer"}send(M){if(!this.connection)return this.logger.error("WebSocket not yet created or already destroyed."),!1;try{return M instanceof Uint8Array?this.connection.send(M.buffer):this.connection.send(M),!0}catch(x){return this.logger.debug(()=>`send error: ${x.message}, websocket state=${w.default[this.readyState()]}`),!1}}close(M,x){var S;(S=this.connection)===null||S===void 0||S.close(M,x)}destroy(){this.connection=void 0}addEventListener(M,x){if(!this.connection){this.logger.warn("Cannot add event listener with no WebSocket connection.");return}this.connection.addEventListener(M,x)}removeEventListener(M,x){var S;(S=this.connection)===null||S===void 0||S.removeEventListener(M,x)}readyState(){if(!this.connection)return w.default.None;switch(this.connection.readyState){case WebSocket.CONNECTING:return w.default.Connecting;case WebSocket.OPEN:return w.default.Open;case WebSocket.CLOSING:return w.default.Closing;case WebSocket.CLOSED:return w.default.Closed}}};return DefaultWebSocketAdapter.default=R,DefaultWebSocketAdapter}var hasRequiredDefaultMeetingSession;function requireDefaultMeetingSession(){if(hasRequiredDefaultMeetingSession)return DefaultMeetingSession;hasRequiredDefaultMeetingSession=1;var C=DefaultMeetingSession&&DefaultMeetingSession.__awaiter||function(re,oe,ae,le){function de(me){return me instanceof ae?me:new ae(function(fe){fe(me)})}return new(ae||(ae=Promise))(function(me,fe){function ge(be){try{ve(le.next(be))}catch(Se){fe(Se)}}function he(be){try{ve(le.throw(be))}catch(Se){fe(Se)}}function ve(be){be.done?me(be.value):de(be.value).then(ge,he)}ve((le=le.apply(re,oe||[])).next())})},E=DefaultMeetingSession&&DefaultMeetingSession.__importDefault||function(re){return re&&re.__esModule?re:{default:re}};Object.defineProperty(DefaultMeetingSession,"__esModule",{value:!0});const w=E(requireDefaultAudioVideoController()),R=E(requireDefaultAudioVideoFacade()),M=E(requireFullJitterBackoff()),x=E(requireDefaultBrowserBehavior()),S=E(requireContentShareMediaStreamBroker()),T=E(requireDefaultContentShareController()),_=E(requireCSPMonitor()),D=requireDestroyable(),Y=E(requireDefaultEventController()),ee=E(requireDefaultReconnectController()),ie=E(requireDefaultWebSocketAdapter());let ne=class{constructor(re,oe,ae,le){this._eventController=le,this._configuration=re,this._logger=oe,this.checkBrowserSupportAndFeatureConfiguration(),_.default.addLogger(this._logger),_.default.register(),this._eventController||(this._eventController=new Y.default(re,oe)),ae.eventController||(ae.eventController=this.eventController),this.audioVideoController=new w.default(this._configuration,this._logger,new ie.default(this._logger),ae,new ee.default(this._configuration.reconnectTimeoutMs,new M.default(this._configuration.reconnectFixedWaitMs,this._configuration.reconnectShortBackOffMs,this._configuration.reconnectLongBackOffMs)),this.eventController),this._deviceController=ae,this.logger.info(`MeetingFeatures: ${JSON.stringify(re.meetingFeatures)}`);const de=new S.default(this._logger);this.contentShareController=new T.default(de,new w.default(T.default.createContentShareMeetingSessionConfigure(this._configuration),this._logger,new ie.default(this._logger),de,new ee.default(this._configuration.reconnectTimeoutMs,new M.default(this._configuration.reconnectFixedWaitMs,this._configuration.reconnectShortBackOffMs,this._configuration.reconnectLongBackOffMs))),this.audioVideoController),this.audioVideoFacade=new R.default(this.audioVideoController,this.audioVideoController.videoTileController,this.audioVideoController.realtimeController,this.audioVideoController.audioMixController,this._deviceController,this.contentShareController)}get configuration(){return this._configuration}get logger(){return this._logger}get audioVideo(){return this.audioVideoFacade}get contentShare(){return this.contentShareController}get deviceController(){return this._deviceController}get eventController(){return this._eventController}destroy(){return C(this,void 0,void 0,function*(){D.isDestroyable(this.contentShareController)&&(yield this.contentShareController.destroy()),D.isDestroyable(this.audioVideoController)&&(yield this.audioVideoController.destroy()),D.isDestroyable(this.eventController)&&(yield this.eventController.destroy()),_.default.removeLogger(this._logger),this._logger=void 0,this._configuration=void 0,this._deviceController=void 0,this.audioVideoFacade=void 0,this.audioVideoController=void 0,this.contentShareController=void 0,this._eventController=void 0})}checkBrowserSupportAndFeatureConfiguration(){const re=new x.default,oe=`${re.name()} ${re.majorVersion()} (${re.version()})`;if(this.logger.info(`browser is ${oe}`),re.isSupported()||this.logger.warn(`this browser is not currently supported. Stability may suffer. Supported browsers are: ${re.supportString()}.`),this._configuration.videoUplinkBandwidthPolicy)if(this.isSimulcastUplinkPolicy(this._configuration.videoUplinkBandwidthPolicy)){if(!re.hasChromiumWebRTC())throw new Error("Simulcast is only supported on Chromium-based browsers");this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!0}else this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1;this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers&&(re.hasChromiumWebRTC()?this.logger.info(`Simulcast is enabled for ${re.name()}`):(this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.logger.info("Simulcast is only supported on Chromium-based browsers")),this._configuration.enableSVC&&(this._configuration.enableSVC=!1,this.logger.info("SVC is not successfully enabled since simulcast is enabled"))),this._configuration.enableSVC&&!re.supportsScalableVideoCoding()&&(this._configuration.enableSVC=!1,this.logger.info("SVC is only supported on Chromium-based browsers with version 111 or above"))}isSimulcastUplinkPolicy(re){return!!(re&&re.addObserver)}};return DefaultMeetingSession.default=ne,DefaultMeetingSession}var DefaultMessagingSession={};const getHttpHandlerExtensionConfiguration=C=>{let E=C.httpHandler;return{setHttpHandler(w){E=w},httpHandler(){return E},updateHttpClientConfig(w,R){E.updateHttpClientConfig(w,R)},httpHandlerConfigs(){return E.httpHandlerConfigs()}}},resolveHttpHandlerRuntimeConfig=C=>({httpHandler:C.httpHandler()});var HttpAuthLocation;(function(C){C.HEADER="header",C.QUERY="query"})(HttpAuthLocation||(HttpAuthLocation={}));var HttpApiKeyAuthLocation;(function(C){C.HEADER="header",C.QUERY="query"})(HttpApiKeyAuthLocation||(HttpApiKeyAuthLocation={}));var EndpointURLScheme;(function(C){C.HTTP="http",C.HTTPS="https"})(EndpointURLScheme||(EndpointURLScheme={}));var AlgorithmId;(function(C){C.MD5="md5",C.CRC32="crc32",C.CRC32C="crc32c",C.SHA1="sha1",C.SHA256="sha256"})(AlgorithmId||(AlgorithmId={}));var FieldPosition;(function(C){C[C.HEADER=0]="HEADER",C[C.TRAILER=1]="TRAILER"})(FieldPosition||(FieldPosition={}));const SMITHY_CONTEXT_KEY="__smithy_context";var IniSectionType;(function(C){C.PROFILE="profile",C.SSO_SESSION="sso-session",C.SERVICES="services"})(IniSectionType||(IniSectionType={}));var RequestHandlerProtocol;(function(C){C.HTTP_0_9="http/0.9",C.HTTP_1_0="http/1.0",C.TDS_8_0="tds/8.0"})(RequestHandlerProtocol||(RequestHandlerProtocol={}));class HttpRequest{constructor(E){this.method=E.method||"GET",this.hostname=E.hostname||"localhost",this.port=E.port,this.query=E.query||{},this.headers=E.headers||{},this.body=E.body,this.protocol=E.protocol?E.protocol.slice(-1)!==":"?`${E.protocol}:`:E.protocol:"https:",this.path=E.path?E.path.charAt(0)!=="/"?`/${E.path}`:E.path:"/",this.username=E.username,this.password=E.password,this.fragment=E.fragment}static clone(E){const w=new HttpRequest({...E,headers:{...E.headers}});return w.query&&(w.query=cloneQuery(w.query)),w}static isInstance(E){if(!E)return!1;const w=E;return"method"in w&&"protocol"in w&&"hostname"in w&&"path"in w&&typeof w.query=="object"&&typeof w.headers=="object"}clone(){return HttpRequest.clone(this)}}function cloneQuery(C){return Object.keys(C).reduce((E,w)=>{const R=C[w];return{...E,[w]:Array.isArray(R)?[...R]:R}},{})}class HttpResponse{constructor(E){this.statusCode=E.statusCode,this.reason=E.reason,this.headers=E.headers||{},this.body=E.body}static isInstance(E){if(!E)return!1;const w=E;return typeof w.statusCode=="number"&&typeof w.headers=="object"}}const hostHeaderMiddleware=C=>E=>async w=>{if(!HttpRequest.isInstance(w.request))return E(w);const{request:R}=w,{handlerProtocol:M=""}=C.requestHandler.metadata||{};if(M.indexOf("h2")>=0&&!R.headers[":authority"])delete R.headers.host,R.headers[":authority"]=R.hostname+(R.port?":"+R.port:"");else if(!R.headers.host){let x=R.hostname;R.port!=null&&(x+=`:${R.port}`),R.headers.host=x}return E(w)},hostHeaderMiddlewareOptions={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},getHostHeaderPlugin=C=>({applyToStack:E=>{E.add(hostHeaderMiddleware(C),hostHeaderMiddlewareOptions)}}),loggerMiddleware=()=>(C,E)=>async w=>{var R,M;try{const x=await C(w),{clientName:S,commandName:T,logger:_,dynamoDbDocumentClientOptions:D={}}=E,{overrideInputFilterSensitiveLog:Y,overrideOutputFilterSensitiveLog:ee}=D,ie=Y??E.inputFilterSensitiveLog,ne=ee??E.outputFilterSensitiveLog,{$metadata:re,...oe}=x.output;return(R=_==null?void 0:_.info)==null||R.call(_,{clientName:S,commandName:T,input:ie(w.input),output:ne(oe),metadata:re}),x}catch(x){const{clientName:S,commandName:T,logger:_,dynamoDbDocumentClientOptions:D={}}=E,{overrideInputFilterSensitiveLog:Y}=D,ee=Y??E.inputFilterSensitiveLog;throw(M=_==null?void 0:_.error)==null||M.call(_,{clientName:S,commandName:T,input:ee(w.input),error:x,metadata:x.$metadata}),x}},loggerMiddlewareOptions={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},getLoggerPlugin=C=>({applyToStack:E=>{E.add(loggerMiddleware(),loggerMiddlewareOptions)}}),TRACE_ID_HEADER_NAME="X-Amzn-Trace-Id",ENV_LAMBDA_FUNCTION_NAME="AWS_LAMBDA_FUNCTION_NAME",ENV_TRACE_ID="_X_AMZN_TRACE_ID",recursionDetectionMiddleware=C=>E=>async w=>{const{request:R}=w;if(!HttpRequest.isInstance(R)||C.runtime!=="node"||R.headers.hasOwnProperty(TRACE_ID_HEADER_NAME))return E(w);const M=define_process_env_default[ENV_LAMBDA_FUNCTION_NAME],x=define_process_env_default[ENV_TRACE_ID],S=T=>typeof T=="string"&&T.length>0;return S(M)&&S(x)&&(R.headers[TRACE_ID_HEADER_NAME]=x),E({...w,request:R})},addRecursionDetectionMiddlewareOptions={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},getRecursionDetectionPlugin=C=>({applyToStack:E=>{E.add(recursionDetectionMiddleware(C),addRecursionDetectionMiddlewareOptions)}}),getSmithyContext=C=>C[SMITHY_CONTEXT_KEY]||(C[SMITHY_CONTEXT_KEY]={}),normalizeProvider$1=C=>{if(typeof C=="function")return C;const E=Promise.resolve(C);return()=>E};function convertHttpAuthSchemesToMap(C){const E=new Map;for(const w of C)E.set(w.schemeId,w);return E}const httpAuthSchemeMiddleware=(C,E)=>(w,R)=>async M=>{var x;const S=C.httpAuthSchemeProvider(await E.httpAuthSchemeParametersProvider(C,R,M.input)),T=convertHttpAuthSchemesToMap(C.httpAuthSchemes),_=getSmithyContext(R),D=[];for(const Y of S){const ee=T.get(Y.schemeId);if(!ee){D.push(`HttpAuthScheme \`${Y.schemeId}\` was not enabled for this service.`);continue}const ie=ee.identityProvider(await E.identityProviderConfigProvider(C));if(!ie){D.push(`HttpAuthScheme \`${Y.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:ne={},signingProperties:re={}}=((x=Y.propertiesExtractor)==null?void 0:x.call(Y,C,R))||{};Y.identityProperties=Object.assign(Y.identityProperties||{},ne),Y.signingProperties=Object.assign(Y.signingProperties||{},re),_.selectedHttpAuthScheme={httpAuthOption:Y,identity:await ie(Y.identityProperties),signer:ee.signer};break}if(!_.selectedHttpAuthScheme)throw new Error(D.join(`
`));return w(M)},httpAuthSchemeEndpointRuleSetMiddlewareOptions={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},getHttpAuthSchemeEndpointRuleSetPlugin=(C,{httpAuthSchemeParametersProvider:E,identityProviderConfigProvider:w})=>({applyToStack:R=>{R.addRelativeTo(httpAuthSchemeMiddleware(C,{httpAuthSchemeParametersProvider:E,identityProviderConfigProvider:w}),httpAuthSchemeEndpointRuleSetMiddlewareOptions)}}),deserializerMiddleware=(C,E)=>w=>async R=>{const{response:M}=await w(R);try{const x=await E(M,C);return{response:M,output:x}}catch(x){if(Object.defineProperty(x,"$response",{value:M}),!("$metadata"in x)){const S="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";x.message+=`
  `+S,typeof x.$responseBodyText<"u"&&x.$response&&(x.$response.body=x.$responseBodyText)}throw x}},serializerMiddleware=(C,E)=>(w,R)=>async M=>{var x;const S=(x=R.endpointV2)!=null&&x.url&&C.urlParser?async()=>C.urlParser(R.endpointV2.url):C.endpoint;if(!S)throw new Error("No valid endpoint provider available.");const T=await E(M.input,{...C,endpoint:S});return w({...M,request:T})},deserializerMiddlewareOption={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},serializerMiddlewareOption={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function getSerdePlugin(C,E,w){return{applyToStack:R=>{R.add(deserializerMiddleware(C,w),deserializerMiddlewareOption),R.add(serializerMiddleware(C,E),serializerMiddlewareOption)}}}serializerMiddlewareOption.name;const defaultErrorHandler=C=>E=>{throw E},defaultSuccessHandler=(C,E)=>{},httpSigningMiddleware=C=>(E,w)=>async R=>{if(!HttpRequest.isInstance(R.request))return E(R);const M=getSmithyContext(w).selectedHttpAuthScheme;if(!M)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:x={}},identity:S,signer:T}=M,_=await E({...R,request:await T.sign(R.request,S,x)}).catch((T.errorHandler||defaultErrorHandler)(x));return(T.successHandler||defaultSuccessHandler)(_.response,x),_},httpSigningMiddlewareOptions={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},getHttpSigningPlugin=C=>({applyToStack:E=>{E.addRelativeTo(httpSigningMiddleware(),httpSigningMiddlewareOptions)}}),normalizeProvider=C=>{if(typeof C=="function")return C;const E=Promise.resolve(C);return()=>E},makePagedClientRequest=async(C,E,w,...R)=>await E.send(new C(w),...R);function createPaginator(C,E,w,R,M){return async function*(x,S,...T){let _=x.startingToken||void 0,D=!0,Y;for(;D;){if(S[w]=_,S[M]=S[M]??x.pageSize,x.client instanceof C)Y=await makePagedClientRequest(E,x.client,S,...T);else throw new Error(`Invalid client, expected instance of ${C.name}`);yield Y;const ee=_;_=get$1(Y,R),D=!!(_&&(!x.stopOnSameToken||_!==ee))}return void 0}}const get$1=(C,E)=>{let w=C;const R=E.split(".");for(const M of R){if(!w||typeof w!="object")return;w=w[M]}return w},alphabetByEncoding={},alphabetByValue=new Array(64);for(let C=0,E=65,w=90;C+E<=w;C++){const R=String.fromCharCode(C+E);alphabetByEncoding[R]=C,alphabetByValue[C]=R}for(let C=0,E=97,w=122;C+E<=w;C++){const R=String.fromCharCode(C+E),M=C+26;alphabetByEncoding[R]=M,alphabetByValue[M]=R}for(let C=0;C<10;C++){alphabetByEncoding[C.toString(10)]=C+52;const E=C.toString(10),w=C+52;alphabetByEncoding[E]=w,alphabetByValue[w]=E}alphabetByEncoding["+"]=62;alphabetByValue[62]="+";alphabetByEncoding["/"]=63;alphabetByValue[63]="/";const bitsPerLetter=6,bitsPerByte=8,maxLetterValue=63,fromBase64=C=>{let E=C.length/4*3;C.slice(-2)==="=="?E-=2:C.slice(-1)==="="&&E--;const w=new ArrayBuffer(E),R=new DataView(w);for(let M=0;M<C.length;M+=4){let x=0,S=0;for(let D=M,Y=M+3;D<=Y;D++)if(C[D]!=="="){if(!(C[D]in alphabetByEncoding))throw new TypeError(`Invalid character ${C[D]} in base64 string.`);x|=alphabetByEncoding[C[D]]<<(Y-D)*bitsPerLetter,S+=bitsPerLetter}else x>>=bitsPerLetter;const T=M/4*3;x>>=S%bitsPerByte;const _=Math.floor(S/bitsPerByte);for(let D=0;D<_;D++){const Y=(_-D-1)*bitsPerByte;R.setUint8(T+D,(x&255<<Y)>>Y)}}return new Uint8Array(w)},fromUtf8$5=C=>new TextEncoder().encode(C),toUint8Array=C=>typeof C=="string"?fromUtf8$5(C):ArrayBuffer.isView(C)?new Uint8Array(C.buffer,C.byteOffset,C.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(C),toUtf8$3=C=>{if(typeof C=="string")return C;if(typeof C!="object"||typeof C.byteOffset!="number"||typeof C.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(C)};function toBase64(C){let E;typeof C=="string"?E=fromUtf8$5(C):E=C;const w=typeof E=="object"&&typeof E.length=="number",R=typeof E=="object"&&typeof E.byteOffset=="number"&&typeof E.byteLength=="number";if(!w&&!R)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let M="";for(let x=0;x<E.length;x+=3){let S=0,T=0;for(let D=x,Y=Math.min(x+3,E.length);D<Y;D++)S|=E[D]<<(Y-D-1)*bitsPerByte,T+=bitsPerByte;const _=Math.ceil(T/bitsPerLetter);S<<=_*bitsPerLetter-T;for(let D=1;D<=_;D++){const Y=(_-D)*bitsPerLetter;M+=alphabetByValue[(S&maxLetterValue<<Y)>>Y]}M+="==".slice(0,4-_)}return M}function transformToString(C,E="utf-8"){return E==="base64"?toBase64(C):toUtf8$3(C)}function transformFromString(C,E){return E==="base64"?Uint8ArrayBlobAdapter.mutate(fromBase64(C)):Uint8ArrayBlobAdapter.mutate(fromUtf8$5(C))}class Uint8ArrayBlobAdapter extends Uint8Array{static fromString(E,w="utf-8"){switch(typeof E){case"string":return transformFromString(E,w);default:throw new Error(`Unsupported conversion from ${typeof E} to Uint8ArrayBlobAdapter.`)}}static mutate(E){return Object.setPrototypeOf(E,Uint8ArrayBlobAdapter.prototype),E}transformToString(E="utf-8"){return transformToString(this,E)}}const escapeUri=C=>encodeURIComponent(C).replace(/[!'()*]/g,hexEncode),hexEncode=C=>`%${C.charCodeAt(0).toString(16).toUpperCase()}`;function buildQueryString(C){const E=[];for(let w of Object.keys(C).sort()){const R=C[w];if(w=escapeUri(w),Array.isArray(R))for(let M=0,x=R.length;M<x;M++)E.push(`${w}=${escapeUri(R[M])}`);else{let M=w;(R||typeof R=="string")&&(M+=`=${escapeUri(R)}`),E.push(M)}}return E.join("&")}function createRequest(C,E){return new Request(C,E)}function requestTimeout(C=0){return new Promise((E,w)=>{C&&setTimeout(()=>{const R=new Error(`Request did not complete within ${C} ms`);R.name="TimeoutError",w(R)},C)})}const keepAliveSupport={supported:void 0};class FetchHttpHandler{static create(E){return typeof(E==null?void 0:E.handle)=="function"?E:new FetchHttpHandler(E)}constructor(E){typeof E=="function"?this.configProvider=E().then(w=>w||{}):(this.config=E??{},this.configProvider=Promise.resolve(this.config)),keepAliveSupport.supported===void 0&&(keepAliveSupport.supported=typeof Request<"u"&&"keepalive"in createRequest("https://[::1]"))}destroy(){}async handle(E,{abortSignal:w}={}){var R;this.config||(this.config=await this.configProvider);const M=this.config.requestTimeout,x=this.config.keepAlive===!0,S=this.config.credentials;if(w!=null&&w.aborted){const de=new Error("Request aborted");return de.name="AbortError",Promise.reject(de)}let T=E.path;const _=buildQueryString(E.query||{});_&&(T+=`?${_}`),E.fragment&&(T+=`#${E.fragment}`);let D="";if(E.username!=null||E.password!=null){const de=E.username??"",me=E.password??"";D=`${de}:${me}@`}const{port:Y,method:ee}=E,ie=`${E.protocol}//${D}${E.hostname}${Y?`:${Y}`:""}${T}`,ne=ee==="GET"||ee==="HEAD"?void 0:E.body,re={body:ne,headers:new Headers(E.headers),method:ee,credentials:S};(R=this.config)!=null&&R.cache&&(re.cache=this.config.cache),ne&&(re.duplex="half"),typeof AbortController<"u"&&(re.signal=w),keepAliveSupport.supported&&(re.keepalive=x),typeof this.config.requestInit=="function"&&Object.assign(re,this.config.requestInit(E));let oe=()=>{};const ae=createRequest(ie,re),le=[fetch(ae).then(de=>{const me=de.headers,fe={};for(const ge of me.entries())fe[ge[0]]=ge[1];return de.body!=null?{response:new HttpResponse({headers:fe,reason:de.statusText,statusCode:de.status,body:de.body})}:de.blob().then(ge=>({response:new HttpResponse({headers:fe,reason:de.statusText,statusCode:de.status,body:ge})}))}),requestTimeout(M)];return w&&le.push(new Promise((de,me)=>{const fe=()=>{const ge=new Error("Request aborted");ge.name="AbortError",me(ge)};if(typeof w.addEventListener=="function"){const ge=w;ge.addEventListener("abort",fe,{once:!0}),oe=()=>ge.removeEventListener("abort",fe)}else w.onabort=fe})),Promise.race(le).finally(oe)}updateHttpClientConfig(E,w){this.config=void 0,this.configProvider=this.configProvider.then(R=>(R[E]=w,R))}httpHandlerConfigs(){return this.config??{}}}const streamCollector=async C=>{var E;return typeof Blob=="function"&&C instanceof Blob||((E=C.constructor)==null?void 0:E.name)==="Blob"?new Uint8Array(await C.arrayBuffer()):collectStream(C)};async function collectStream(C){const E=[],w=C.getReader();let R=!1,M=0;for(;!R;){const{done:T,value:_}=await w.read();_&&(E.push(_),M+=_.length),R=T}const x=new Uint8Array(M);let S=0;for(const T of E)x.set(T,S),S+=T.length;return x}const SHORT_TO_HEX$1={},HEX_TO_SHORT$1={};for(let C=0;C<256;C++){let E=C.toString(16).toLowerCase();E.length===1&&(E=`0${E}`),SHORT_TO_HEX$1[C]=E,HEX_TO_SHORT$1[E]=C}function fromHex$1(C){if(C.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const E=new Uint8Array(C.length/2);for(let w=0;w<C.length;w+=2){const R=C.slice(w,w+2).toLowerCase();if(R in HEX_TO_SHORT$1)E[w/2]=HEX_TO_SHORT$1[R];else throw new Error(`Cannot decode unrecognized sequence ${R} as hexadecimal`)}return E}function toHex$1(C){let E="";for(let w=0;w<C.byteLength;w++)E+=SHORT_TO_HEX$1[C[w]];return E}const collectBody=async(C=new Uint8Array,E)=>{if(C instanceof Uint8Array)return Uint8ArrayBlobAdapter.mutate(C);if(!C)return Uint8ArrayBlobAdapter.mutate(new Uint8Array);const w=E.streamCollector(C);return Uint8ArrayBlobAdapter.mutate(await w)};function extendedEncodeURIComponent(C){return encodeURIComponent(C).replace(/[!'()*]/g,function(E){return"%"+E.charCodeAt(0).toString(16).toUpperCase()})}const resolvedPath=(C,E,w,R,M,x)=>{if(E!=null&&E[w]!==void 0){const S=R();if(S.length<=0)throw new Error("Empty value provided for input HTTP label: "+w+".");C=C.replace(M,x?S.split("/").map(T=>extendedEncodeURIComponent(T)).join("/"):extendedEncodeURIComponent(S))}else throw new Error("No value provided for input HTTP label: "+w+".");return C};function requestBuilder(C,E){return new RequestBuilder(C,E)}class RequestBuilder{constructor(E,w){this.input=E,this.context=w,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:E,protocol:w="https",port:R,path:M}=await this.context.endpoint();this.path=M;for(const x of this.resolvePathStack)x(this.path);return new HttpRequest({protocol:w,hostname:this.hostname||E,port:R,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(E){return this.hostname=E,this}bp(E){return this.resolvePathStack.push(w=>{this.path=`${w!=null&&w.endsWith("/")?w.slice(0,-1):w||""}`+E}),this}p(E,w,R,M){return this.resolvePathStack.push(x=>{this.path=resolvedPath(x,this.input,E,w,R,M)}),this}h(E){return this.headers=E,this}q(E){return this.query=E,this}b(E){return this.body=E,this}m(E){return this.method=E,this}}function setFeature$1(C,E,w){C.__smithy_context?C.__smithy_context.features||(C.__smithy_context.features={}):C.__smithy_context={features:{}},C.__smithy_context.features[E]=w}class DefaultIdentityProviderConfig{constructor(E){this.authSchemes=new Map;for(const[w,R]of Object.entries(E))R!==void 0&&this.authSchemes.set(w,R)}getIdentityProvider(E){return this.authSchemes.get(E)}}const createIsIdentityExpiredFunction=C=>E=>doesIdentityRequireRefresh(E)&&E.expiration.getTime()-Date.now()<C,EXPIRATION_MS=3e5,isIdentityExpired=createIsIdentityExpiredFunction(EXPIRATION_MS),doesIdentityRequireRefresh=C=>C.expiration!==void 0,memoizeIdentityProvider=(C,E,w)=>{if(C===void 0)return;const R=typeof C!="function"?async()=>Promise.resolve(C):C;let M,x,S,T=!1;const _=async D=>{x||(x=R(D));try{M=await x,S=!0,T=!1}finally{x=void 0}return M};return E===void 0?async D=>((!S||D!=null&&D.forceRefresh)&&(M=await _(D)),M):async D=>((!S||D!=null&&D.forceRefresh)&&(M=await _(D)),T?M:w(M)?(E(M)&&await _(D),M):(T=!0,M))},DEFAULT_UA_APP_ID=void 0;function isValidUserAgentAppId(C){return C===void 0?!0:typeof C=="string"&&C.length<=50}function resolveUserAgentConfig(C){const E=normalizeProvider(C.userAgentAppId??DEFAULT_UA_APP_ID);return{...C,customUserAgent:typeof C.customUserAgent=="string"?[[C.customUserAgent]]:C.customUserAgent,userAgentAppId:async()=>{var w,R;const M=await E();if(!isValidUserAgentAppId(M)){const x=((R=(w=C.logger)==null?void 0:w.constructor)==null?void 0:R.name)==="NoOpLogger"||!C.logger?console:C.logger;typeof M!="string"?x==null||x.warn("userAgentAppId must be a string or undefined."):M.length>50&&(x==null||x.warn("The provided userAgentAppId exceeds the maximum length of 50 characters."))}return M}}}class EndpointCache{constructor({size:E,params:w}){this.data=new Map,this.parameters=[],this.capacity=E??50,w&&(this.parameters=w)}get(E,w){const R=this.hash(E);if(R===!1)return w();if(!this.data.has(R)){if(this.data.size>this.capacity+10){const M=this.data.keys();let x=0;for(;;){const{value:S,done:T}=M.next();if(this.data.delete(S),T||++x>10)break}}this.data.set(R,w())}return this.data.get(R)}size(){return this.data.size}hash(E){let w="";const{parameters:R}=this;if(R.length===0)return!1;for(const M of R){const x=String(E[M]??"");if(x.includes("|;"))return!1;w+=x+"|;"}return w}}const IP_V4_REGEX=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),isIpAddress=C=>IP_V4_REGEX.test(C)||C.startsWith("[")&&C.endsWith("]"),VALID_HOST_LABEL_REGEX=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),isValidHostLabel=(C,E=!1)=>{if(!E)return VALID_HOST_LABEL_REGEX.test(C);const w=C.split(".");for(const R of w)if(!isValidHostLabel(R))return!1;return!0},customEndpointFunctions={},debugId="endpoints";function toDebugString(C){return typeof C!="object"||C==null?C:"ref"in C?`$${toDebugString(C.ref)}`:"fn"in C?`${C.fn}(${(C.argv||[]).map(toDebugString).join(", ")})`:JSON.stringify(C,null,2)}class EndpointError extends Error{constructor(E){super(E),this.name="EndpointError"}}const booleanEquals=(C,E)=>C===E,getAttrPathList=C=>{const E=C.split("."),w=[];for(const R of E){const M=R.indexOf("[");if(M!==-1){if(R.indexOf("]")!==R.length-1)throw new EndpointError(`Path: '${C}' does not end with ']'`);const x=R.slice(M+1,-1);if(Number.isNaN(parseInt(x)))throw new EndpointError(`Invalid array index: '${x}' in path: '${C}'`);M!==0&&w.push(R.slice(0,M)),w.push(x)}else w.push(R)}return w},getAttr=(C,E)=>getAttrPathList(E).reduce((w,R)=>{if(typeof w!="object")throw new EndpointError(`Index '${R}' in '${E}' not found in '${JSON.stringify(C)}'`);return Array.isArray(w)?w[parseInt(R)]:w[R]},C),isSet=C=>C!=null,not=C=>!C,DEFAULT_PORTS={[EndpointURLScheme.HTTP]:80,[EndpointURLScheme.HTTPS]:443},parseURL=C=>{const E=(()=>{try{if(C instanceof URL)return C;if(typeof C=="object"&&"hostname"in C){const{hostname:ie,port:ne,protocol:re="",path:oe="",query:ae={}}=C,le=new URL(`${re}//${ie}${ne?`:${ne}`:""}${oe}`);return le.search=Object.entries(ae).map(([de,me])=>`${de}=${me}`).join("&"),le}return new URL(C)}catch{return null}})();if(!E)return console.error(`Unable to parse ${JSON.stringify(C)} as a whatwg URL.`),null;const w=E.href,{host:R,hostname:M,pathname:x,protocol:S,search:T}=E;if(T)return null;const _=S.slice(0,-1);if(!Object.values(EndpointURLScheme).includes(_))return null;const D=isIpAddress(M),Y=w.includes(`${R}:${DEFAULT_PORTS[_]}`)||typeof C=="string"&&C.includes(`${R}:${DEFAULT_PORTS[_]}`),ee=`${R}${Y?`:${DEFAULT_PORTS[_]}`:""}`;return{scheme:_,authority:ee,path:x,normalizedPath:x.endsWith("/")?x:`${x}/`,isIp:D}},stringEquals=(C,E)=>C===E,substring=(C,E,w,R)=>E>=w||C.length<w?null:R?C.substring(C.length-w,C.length-E):C.substring(E,w),uriEncode=C=>encodeURIComponent(C).replace(/[!*'()]/g,E=>`%${E.charCodeAt(0).toString(16).toUpperCase()}`),endpointFunctions={booleanEquals,getAttr,isSet,isValidHostLabel,not,parseURL,stringEquals,substring,uriEncode},evaluateTemplate=(C,E)=>{const w=[],R={...E.endpointParams,...E.referenceRecord};let M=0;for(;M<C.length;){const x=C.indexOf("{",M);if(x===-1){w.push(C.slice(M));break}w.push(C.slice(M,x));const S=C.indexOf("}",x);if(S===-1){w.push(C.slice(x));break}C[x+1]==="{"&&C[S+1]==="}"&&(w.push(C.slice(x+1,S)),M=S+2);const T=C.substring(x+1,S);if(T.includes("#")){const[_,D]=T.split("#");w.push(getAttr(R[_],D))}else w.push(R[T]);M=S+1}return w.join("")},getReferenceValue=({ref:C},E)=>({...E.endpointParams,...E.referenceRecord})[C],evaluateExpression=(C,E,w)=>{if(typeof C=="string")return evaluateTemplate(C,w);if(C.fn)return callFunction(C,w);if(C.ref)return getReferenceValue(C,w);throw new EndpointError(`'${E}': ${String(C)} is not a string, function or reference.`)},callFunction=({fn:C,argv:E},w)=>{const R=E.map(x=>["boolean","number"].includes(typeof x)?x:evaluateExpression(x,"arg",w)),M=C.split(".");return M[0]in customEndpointFunctions&&M[1]!=null?customEndpointFunctions[M[0]][M[1]](...R):endpointFunctions[C](...R)},evaluateCondition=({assign:C,...E},w)=>{var R,M;if(C&&C in w.referenceRecord)throw new EndpointError(`'${C}' is already defined in Reference Record.`);const x=callFunction(E,w);return(M=(R=w.logger)==null?void 0:R.debug)==null||M.call(R,`${debugId} evaluateCondition: ${toDebugString(E)} = ${toDebugString(x)}`),{result:x===""?!0:!!x,...C!=null&&{toAssign:{name:C,value:x}}}},evaluateConditions=(C=[],E)=>{var w,R;const M={};for(const x of C){const{result:S,toAssign:T}=evaluateCondition(x,{...E,referenceRecord:{...E.referenceRecord,...M}});if(!S)return{result:S};T&&(M[T.name]=T.value,(R=(w=E.logger)==null?void 0:w.debug)==null||R.call(w,`${debugId} assign: ${T.name} := ${toDebugString(T.value)}`))}return{result:!0,referenceRecord:M}},getEndpointHeaders=(C,E)=>Object.entries(C).reduce((w,[R,M])=>({...w,[R]:M.map(x=>{const S=evaluateExpression(x,"Header value entry",E);if(typeof S!="string")throw new EndpointError(`Header '${R}' value '${S}' is not a string`);return S})}),{}),getEndpointProperty=(C,E)=>{if(Array.isArray(C))return C.map(w=>getEndpointProperty(w,E));switch(typeof C){case"string":return evaluateTemplate(C,E);case"object":if(C===null)throw new EndpointError(`Unexpected endpoint property: ${C}`);return getEndpointProperties(C,E);case"boolean":return C;default:throw new EndpointError(`Unexpected endpoint property type: ${typeof C}`)}},getEndpointProperties=(C,E)=>Object.entries(C).reduce((w,[R,M])=>({...w,[R]:getEndpointProperty(M,E)}),{}),getEndpointUrl=(C,E)=>{const w=evaluateExpression(C,"Endpoint URL",E);if(typeof w=="string")try{return new URL(w)}catch(R){throw console.error(`Failed to construct URL with ${w}`,R),R}throw new EndpointError(`Endpoint URL must be a string, got ${typeof w}`)},evaluateEndpointRule=(C,E)=>{var w,R;const{conditions:M,endpoint:x}=C,{result:S,referenceRecord:T}=evaluateConditions(M,E);if(!S)return;const _={...E,referenceRecord:{...E.referenceRecord,...T}},{url:D,properties:Y,headers:ee}=x;return(R=(w=E.logger)==null?void 0:w.debug)==null||R.call(w,`${debugId} Resolving endpoint from template: ${toDebugString(x)}`),{...ee!=null&&{headers:getEndpointHeaders(ee,_)},...Y!=null&&{properties:getEndpointProperties(Y,_)},url:getEndpointUrl(D,_)}},evaluateErrorRule=(C,E)=>{const{conditions:w,error:R}=C,{result:M,referenceRecord:x}=evaluateConditions(w,E);if(M)throw new EndpointError(evaluateExpression(R,"Error",{...E,referenceRecord:{...E.referenceRecord,...x}}))},evaluateTreeRule=(C,E)=>{const{conditions:w,rules:R}=C,{result:M,referenceRecord:x}=evaluateConditions(w,E);if(M)return evaluateRules(R,{...E,referenceRecord:{...E.referenceRecord,...x}})},evaluateRules=(C,E)=>{for(const w of C)if(w.type==="endpoint"){const R=evaluateEndpointRule(w,E);if(R)return R}else if(w.type==="error")evaluateErrorRule(w,E);else if(w.type==="tree"){const R=evaluateTreeRule(w,E);if(R)return R}else throw new EndpointError(`Unknown endpoint rule: ${w}`);throw new EndpointError("Rules evaluation failed")},resolveEndpoint=(C,E)=>{var w,R,M,x;const{endpointParams:S,logger:T}=E,{parameters:_,rules:D}=C;(R=(w=E.logger)==null?void 0:w.debug)==null||R.call(w,`${debugId} Initial EndpointParams: ${toDebugString(S)}`);const Y=Object.entries(_).filter(([,ne])=>ne.default!=null).map(([ne,re])=>[ne,re.default]);if(Y.length>0)for(const[ne,re]of Y)S[ne]=S[ne]??re;const ee=Object.entries(_).filter(([,ne])=>ne.required).map(([ne])=>ne);for(const ne of ee)if(S[ne]==null)throw new EndpointError(`Missing required parameter: '${ne}'`);const ie=evaluateRules(D,{endpointParams:S,logger:T,referenceRecord:{}});return(x=(M=E.logger)==null?void 0:M.debug)==null||x.call(M,`${debugId} Resolved endpoint: ${toDebugString(ie)}`),ie},isVirtualHostableS3Bucket=(C,E=!1)=>{if(E){for(const w of C.split("."))if(!isVirtualHostableS3Bucket(w))return!1;return!0}return!(!isValidHostLabel(C)||C.length<3||C.length>63||C!==C.toLowerCase()||isIpAddress(C))},ARN_DELIMITER=":",RESOURCE_DELIMITER="/",parseArn=C=>{const E=C.split(ARN_DELIMITER);if(E.length<6)return null;const[w,R,M,x,S,...T]=E;if(w!=="arn"||R===""||M===""||T.join(ARN_DELIMITER)==="")return null;const _=T.map(D=>D.split(RESOURCE_DELIMITER)).flat();return{partition:R,service:M,region:x,accountId:S,resourceId:_}},partitions=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{}}],version$1="1.1",partitionsInfo={partitions,version:version$1};let selectedPartitionsInfo=partitionsInfo;const partition=C=>{const{partitions:E}=selectedPartitionsInfo;for(const R of E){const{regions:M,outputs:x}=R;for(const[S,T]of Object.entries(M))if(S===C)return{...x,...T}}for(const R of E){const{regionRegex:M,outputs:x}=R;if(new RegExp(M).test(C))return{...x}}const w=E.find(R=>R.id==="aws");if(!w)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...w.outputs}},awsEndpointFunctions={isVirtualHostableS3Bucket,parseArn,partition};customEndpointFunctions.aws=awsEndpointFunctions;function setCredentialFeature(C,E,w){return C.$source||(C.$source={}),C.$source[E]=w,C}function setFeature(C,E,w){C.__aws_sdk_context?C.__aws_sdk_context.features||(C.__aws_sdk_context.features={}):C.__aws_sdk_context={features:{}},C.__aws_sdk_context.features[E]=w}const getDateHeader=C=>{var E,w;return HttpResponse.isInstance(C)?((E=C.headers)==null?void 0:E.date)??((w=C.headers)==null?void 0:w.Date):void 0},getSkewCorrectedDate=C=>new Date(Date.now()+C),isClockSkewed=(C,E)=>Math.abs(getSkewCorrectedDate(E).getTime()-C)>=3e5,getUpdatedSystemClockOffset=(C,E)=>{const w=Date.parse(C);return isClockSkewed(w,E)?w-Date.now():E},throwSigningPropertyError=(C,E)=>{if(!E)throw new Error(`Property \`${C}\` is not resolved for AWS SDK SigV4Auth`);return E},validateSigningProperties=async C=>{var E,w,R;const M=throwSigningPropertyError("context",C.context),x=throwSigningPropertyError("config",C.config),S=(R=(w=(E=M.endpointV2)==null?void 0:E.properties)==null?void 0:w.authSchemes)==null?void 0:R[0],T=await throwSigningPropertyError("signer",x.signer)(S),_=C==null?void 0:C.signingRegion,D=C==null?void 0:C.signingRegionSet,Y=C==null?void 0:C.signingName;return{config:x,signer:T,signingRegion:_,signingRegionSet:D,signingName:Y}};class AwsSdkSigV4Signer{async sign(E,w,R){var M;if(!HttpRequest.isInstance(E))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const x=await validateSigningProperties(R),{config:S,signer:T}=x;let{signingRegion:_,signingName:D}=x;const Y=R.context;if(((M=Y==null?void 0:Y.authSchemes)==null?void 0:M.length)??!1){const[ee,ie]=Y.authSchemes;(ee==null?void 0:ee.name)==="sigv4a"&&(ie==null?void 0:ie.name)==="sigv4"&&(_=(ie==null?void 0:ie.signingRegion)??_,D=(ie==null?void 0:ie.signingName)??D)}return await T.sign(E,{signingDate:getSkewCorrectedDate(S.systemClockOffset),signingRegion:_,signingService:D})}errorHandler(E){return w=>{const R=w.ServerTime??getDateHeader(w.$response);if(R){const M=throwSigningPropertyError("config",E.config),x=M.systemClockOffset;M.systemClockOffset=getUpdatedSystemClockOffset(R,M.systemClockOffset),M.systemClockOffset!==x&&w.$metadata&&(w.$metadata.clockSkewCorrected=!0)}throw w}}successHandler(E,w){const R=getDateHeader(E);if(R){const M=throwSigningPropertyError("config",w.config);M.systemClockOffset=getUpdatedSystemClockOffset(R,M.systemClockOffset)}}}const memoize=(C,E,w)=>{let R,M,x,S=!1;const T=async()=>{M||(M=C());try{R=await M,x=!0,S=!1}finally{M=void 0}return R};return async _=>((!x||_!=null&&_.forceRefresh)&&(R=await T()),R)},ALGORITHM_QUERY_PARAM="X-Amz-Algorithm",CREDENTIAL_QUERY_PARAM="X-Amz-Credential",AMZ_DATE_QUERY_PARAM="X-Amz-Date",SIGNED_HEADERS_QUERY_PARAM="X-Amz-SignedHeaders",EXPIRES_QUERY_PARAM="X-Amz-Expires",SIGNATURE_QUERY_PARAM="X-Amz-Signature",TOKEN_QUERY_PARAM="X-Amz-Security-Token",AUTH_HEADER="authorization",AMZ_DATE_HEADER=AMZ_DATE_QUERY_PARAM.toLowerCase(),DATE_HEADER="date",GENERATED_HEADERS=[AUTH_HEADER,AMZ_DATE_HEADER,DATE_HEADER],SIGNATURE_HEADER=SIGNATURE_QUERY_PARAM.toLowerCase(),SHA256_HEADER="x-amz-content-sha256",TOKEN_HEADER=TOKEN_QUERY_PARAM.toLowerCase(),ALWAYS_UNSIGNABLE_HEADERS={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},PROXY_HEADER_PATTERN=/^proxy-/,SEC_HEADER_PATTERN=/^sec-/,ALGORITHM_IDENTIFIER="AWS4-HMAC-SHA256",EVENT_ALGORITHM_IDENTIFIER="AWS4-HMAC-SHA256-PAYLOAD",UNSIGNED_PAYLOAD="UNSIGNED-PAYLOAD",MAX_CACHE_SIZE=50,KEY_TYPE_IDENTIFIER="aws4_request",MAX_PRESIGNED_TTL=60*60*24*7,signingKeyCache={},cacheQueue=[],createScope=(C,E,w)=>`${C}/${E}/${w}/${KEY_TYPE_IDENTIFIER}`,getSigningKey=async(C,E,w,R,M)=>{const x=await hmac(C,E.secretAccessKey,E.accessKeyId),S=`${w}:${R}:${M}:${toHex$1(x)}:${E.sessionToken}`;if(S in signingKeyCache)return signingKeyCache[S];for(cacheQueue.push(S);cacheQueue.length>MAX_CACHE_SIZE;)delete signingKeyCache[cacheQueue.shift()];let T=`AWS4${E.secretAccessKey}`;for(const _ of[w,R,M,KEY_TYPE_IDENTIFIER])T=await hmac(C,T,_);return signingKeyCache[S]=T},hmac=(C,E,w)=>{const R=new C(E);return R.update(toUint8Array(w)),R.digest()},getCanonicalHeaders=({headers:C},E,w)=>{const R={};for(const M of Object.keys(C).sort()){if(C[M]==null)continue;const x=M.toLowerCase();(x in ALWAYS_UNSIGNABLE_HEADERS||E!=null&&E.has(x)||PROXY_HEADER_PATTERN.test(x)||SEC_HEADER_PATTERN.test(x))&&(!w||w&&!w.has(x))||(R[x]=C[M].trim().replace(/\s+/g," "))}return R},getCanonicalQuery=({query:C={}})=>{const E=[],w={};for(const R of Object.keys(C)){if(R.toLowerCase()===SIGNATURE_HEADER)continue;const M=escapeUri(R);E.push(M);const x=C[R];typeof x=="string"?w[M]=`${M}=${escapeUri(x)}`:Array.isArray(x)&&(w[M]=x.slice(0).reduce((S,T)=>S.concat([`${M}=${escapeUri(T)}`]),[]).sort().join("&"))}return E.sort().map(R=>w[R]).filter(R=>R).join("&")},isArrayBuffer=C=>typeof ArrayBuffer=="function"&&C instanceof ArrayBuffer||Object.prototype.toString.call(C)==="[object ArrayBuffer]",getPayloadHash=async({headers:C,body:E},w)=>{for(const R of Object.keys(C))if(R.toLowerCase()===SHA256_HEADER)return C[R];if(E==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof E=="string"||ArrayBuffer.isView(E)||isArrayBuffer(E)){const R=new w;return R.update(toUint8Array(E)),toHex$1(await R.digest())}return UNSIGNED_PAYLOAD};class HeaderFormatter{format(E){const w=[];for(const x of Object.keys(E)){const S=fromUtf8$5(x);w.push(Uint8Array.from([S.byteLength]),S,this.formatHeaderValue(E[x]))}const R=new Uint8Array(w.reduce((x,S)=>x+S.byteLength,0));let M=0;for(const x of w)R.set(x,M),M+=x.byteLength;return R}formatHeaderValue(E){switch(E.type){case"boolean":return Uint8Array.from([E.value?0:1]);case"byte":return Uint8Array.from([2,E.value]);case"short":const w=new DataView(new ArrayBuffer(3));return w.setUint8(0,3),w.setInt16(1,E.value,!1),new Uint8Array(w.buffer);case"integer":const R=new DataView(new ArrayBuffer(5));return R.setUint8(0,4),R.setInt32(1,E.value,!1),new Uint8Array(R.buffer);case"long":const M=new Uint8Array(9);return M[0]=5,M.set(E.value.bytes,1),M;case"binary":const x=new DataView(new ArrayBuffer(3+E.value.byteLength));x.setUint8(0,6),x.setUint16(1,E.value.byteLength,!1);const S=new Uint8Array(x.buffer);return S.set(E.value,3),S;case"string":const T=fromUtf8$5(E.value),_=new DataView(new ArrayBuffer(3+T.byteLength));_.setUint8(0,7),_.setUint16(1,T.byteLength,!1);const D=new Uint8Array(_.buffer);return D.set(T,3),D;case"timestamp":const Y=new Uint8Array(9);return Y[0]=8,Y.set(Int64.fromNumber(E.value.valueOf()).bytes,1),Y;case"uuid":if(!UUID_PATTERN.test(E.value))throw new Error(`Invalid UUID received: ${E.value}`);const ee=new Uint8Array(17);return ee[0]=9,ee.set(fromHex$1(E.value.replace(/\-/g,"")),1),ee}}}var HEADER_VALUE_TYPE;(function(C){C[C.boolTrue=0]="boolTrue",C[C.boolFalse=1]="boolFalse",C[C.byte=2]="byte",C[C.short=3]="short",C[C.integer=4]="integer",C[C.long=5]="long",C[C.byteArray=6]="byteArray",C[C.string=7]="string",C[C.timestamp=8]="timestamp",C[C.uuid=9]="uuid"})(HEADER_VALUE_TYPE||(HEADER_VALUE_TYPE={}));const UUID_PATTERN=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class Int64{constructor(E){if(this.bytes=E,E.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(E){if(E>9223372036854776e3||E<-9223372036854776e3)throw new Error(`${E} is too large (or, if negative, too small) to represent as an Int64`);const w=new Uint8Array(8);for(let R=7,M=Math.abs(Math.round(E));R>-1&&M>0;R--,M/=256)w[R]=M;return E<0&&negate(w),new Int64(w)}valueOf(){const E=this.bytes.slice(0),w=E[0]&128;return w&&negate(E),parseInt(toHex$1(E),16)*(w?-1:1)}toString(){return String(this.valueOf())}}function negate(C){for(let E=0;E<8;E++)C[E]^=255;for(let E=7;E>-1&&(C[E]++,C[E]===0);E--);}const hasHeader=(C,E)=>{C=C.toLowerCase();for(const w of Object.keys(E))if(C===w.toLowerCase())return!0;return!1},moveHeadersToQuery=(C,E={})=>{var w,R;const{headers:M,query:x={}}=HttpRequest.clone(C);for(const S of Object.keys(M)){const T=S.toLowerCase();(T.slice(0,6)==="x-amz-"&&!((w=E.unhoistableHeaders)!=null&&w.has(T))||(R=E.hoistableHeaders)!=null&&R.has(T))&&(x[S]=M[S],delete M[S])}return{...C,headers:M,query:x}},prepareRequest=C=>{C=HttpRequest.clone(C);for(const E of Object.keys(C.headers))GENERATED_HEADERS.indexOf(E.toLowerCase())>-1&&delete C.headers[E];return C},iso8601=C=>toDate(C).toISOString().replace(/\.\d{3}Z$/,"Z"),toDate=C=>typeof C=="number"?new Date(C*1e3):typeof C=="string"?Number(C)?new Date(Number(C)*1e3):new Date(C):C;class SignatureV4{constructor({applyChecksum:E,credentials:w,region:R,service:M,sha256:x,uriEscapePath:S=!0}){this.headerFormatter=new HeaderFormatter,this.service=M,this.sha256=x,this.uriEscapePath=S,this.applyChecksum=typeof E=="boolean"?E:!0,this.regionProvider=normalizeProvider$1(R),this.credentialProvider=normalizeProvider$1(w)}async presign(E,w={}){const{signingDate:R=new Date,expiresIn:M=3600,unsignableHeaders:x,unhoistableHeaders:S,signableHeaders:T,hoistableHeaders:_,signingRegion:D,signingService:Y}=w,ee=await this.credentialProvider();this.validateResolvedCredentials(ee);const ie=D??await this.regionProvider(),{longDate:ne,shortDate:re}=formatDate(R);if(M>MAX_PRESIGNED_TTL)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const oe=createScope(re,ie,Y??this.service),ae=moveHeadersToQuery(prepareRequest(E),{unhoistableHeaders:S,hoistableHeaders:_});ee.sessionToken&&(ae.query[TOKEN_QUERY_PARAM]=ee.sessionToken),ae.query[ALGORITHM_QUERY_PARAM]=ALGORITHM_IDENTIFIER,ae.query[CREDENTIAL_QUERY_PARAM]=`${ee.accessKeyId}/${oe}`,ae.query[AMZ_DATE_QUERY_PARAM]=ne,ae.query[EXPIRES_QUERY_PARAM]=M.toString(10);const le=getCanonicalHeaders(ae,x,T);return ae.query[SIGNED_HEADERS_QUERY_PARAM]=getCanonicalHeaderList(le),ae.query[SIGNATURE_QUERY_PARAM]=await this.getSignature(ne,oe,this.getSigningKey(ee,ie,re,Y),this.createCanonicalRequest(ae,le,await getPayloadHash(E,this.sha256))),ae}async sign(E,w){return typeof E=="string"?this.signString(E,w):E.headers&&E.payload?this.signEvent(E,w):E.message?this.signMessage(E,w):this.signRequest(E,w)}async signEvent({headers:E,payload:w},{signingDate:R=new Date,priorSignature:M,signingRegion:x,signingService:S}){const T=x??await this.regionProvider(),{shortDate:_,longDate:D}=formatDate(R),Y=createScope(_,T,S??this.service),ee=await getPayloadHash({headers:{},body:w},this.sha256),ie=new this.sha256;ie.update(E);const ne=toHex$1(await ie.digest()),re=[EVENT_ALGORITHM_IDENTIFIER,D,Y,M,ne,ee].join(`
`);return this.signString(re,{signingDate:R,signingRegion:T,signingService:S})}async signMessage(E,{signingDate:w=new Date,signingRegion:R,signingService:M}){return this.signEvent({headers:this.headerFormatter.format(E.message.headers),payload:E.message.body},{signingDate:w,signingRegion:R,signingService:M,priorSignature:E.priorSignature}).then(x=>({message:E.message,signature:x}))}async signString(E,{signingDate:w=new Date,signingRegion:R,signingService:M}={}){const x=await this.credentialProvider();this.validateResolvedCredentials(x);const S=R??await this.regionProvider(),{shortDate:T}=formatDate(w),_=new this.sha256(await this.getSigningKey(x,S,T,M));return _.update(toUint8Array(E)),toHex$1(await _.digest())}async signRequest(E,{signingDate:w=new Date,signableHeaders:R,unsignableHeaders:M,signingRegion:x,signingService:S}={}){const T=await this.credentialProvider();this.validateResolvedCredentials(T);const _=x??await this.regionProvider(),D=prepareRequest(E),{longDate:Y,shortDate:ee}=formatDate(w),ie=createScope(ee,_,S??this.service);D.headers[AMZ_DATE_HEADER]=Y,T.sessionToken&&(D.headers[TOKEN_HEADER]=T.sessionToken);const ne=await getPayloadHash(D,this.sha256);!hasHeader(SHA256_HEADER,D.headers)&&this.applyChecksum&&(D.headers[SHA256_HEADER]=ne);const re=getCanonicalHeaders(D,M,R),oe=await this.getSignature(Y,ie,this.getSigningKey(T,_,ee,S),this.createCanonicalRequest(D,re,ne));return D.headers[AUTH_HEADER]=`${ALGORITHM_IDENTIFIER} Credential=${T.accessKeyId}/${ie}, SignedHeaders=${getCanonicalHeaderList(re)}, Signature=${oe}`,D}createCanonicalRequest(E,w,R){const M=Object.keys(w).sort();return`${E.method}
${this.getCanonicalPath(E)}
${getCanonicalQuery(E)}
${M.map(x=>`${x}:${w[x]}`).join(`
`)}

${M.join(";")}
${R}`}async createStringToSign(E,w,R){const M=new this.sha256;M.update(toUint8Array(R));const x=await M.digest();return`${ALGORITHM_IDENTIFIER}
${E}
${w}
${toHex$1(x)}`}getCanonicalPath({path:E}){if(this.uriEscapePath){const w=[];for(const M of E.split("/"))(M==null?void 0:M.length)!==0&&M!=="."&&(M===".."?w.pop():w.push(M));const R=`${E!=null&&E.startsWith("/")?"/":""}${w.join("/")}${w.length>0&&E!=null&&E.endsWith("/")?"/":""}`;return escapeUri(R).replace(/%2F/g,"/")}return E}async getSignature(E,w,R,M){const x=await this.createStringToSign(E,w,M),S=new this.sha256(await R);return S.update(toUint8Array(x)),toHex$1(await S.digest())}getSigningKey(E,w,R,M){return getSigningKey(this.sha256,E,R,w,M||this.service)}validateResolvedCredentials(E){if(typeof E!="object"||typeof E.accessKeyId!="string"||typeof E.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}}const formatDate=C=>{const E=iso8601(C).replace(/[\-:]/g,"");return{longDate:E,shortDate:E.slice(0,8)}},getCanonicalHeaderList=C=>Object.keys(C).sort().join(";"),resolveAwsSdkSigV4Config=C=>{let E=!1,w;C.credentials&&(E=!0,w=memoizeIdentityProvider(C.credentials,isIdentityExpired,doesIdentityRequireRefresh)),w||(C.credentialDefaultProvider?w=normalizeProvider(C.credentialDefaultProvider(Object.assign({},C,{parentClientConfig:C}))):w=async()=>{throw new Error("`credentials` is missing")});const{signingEscapePath:R=!0,systemClockOffset:M=C.systemClockOffset||0,sha256:x}=C;let S;return C.signer?S=normalizeProvider(C.signer):C.regionInfoProvider?S=()=>normalizeProvider(C.region)().then(async T=>[await C.regionInfoProvider(T,{useFipsEndpoint:await C.useFipsEndpoint(),useDualstackEndpoint:await C.useDualstackEndpoint()})||{},T]).then(([T,_])=>{const{signingRegion:D,signingService:Y}=T;C.signingRegion=C.signingRegion||D||_,C.signingName=C.signingName||Y||C.serviceId;const ee={...C,credentials:w,region:C.signingRegion,service:C.signingName,sha256:x,uriEscapePath:R},ie=C.signerConstructor||SignatureV4;return new ie(ee)}):S=async T=>{T=Object.assign({},{name:"sigv4",signingName:C.signingName||C.defaultSigningName,signingRegion:await normalizeProvider(C.region)(),properties:{}},T);const _=T.signingRegion,D=T.signingName;C.signingRegion=C.signingRegion||_,C.signingName=C.signingName||D||C.serviceId;const Y={...C,credentials:w,region:C.signingRegion,service:C.signingName,sha256:x,uriEscapePath:R},ee=C.signerConstructor||SignatureV4;return new ee(Y)},{...C,systemClockOffset:M,signingEscapePath:R,credentials:E?async()=>w().then(T=>setCredentialFeature(T,"CREDENTIALS_CODE","e")):w,signer:S}},getAllAliases=(C,E)=>{const w=[];if(C&&w.push(C),E)for(const R of E)w.push(R);return w},getMiddlewareNameWithAliases=(C,E)=>`${C||"anonymous"}${E&&E.length>0?` (a.k.a. ${E.join(",")})`:""}`,constructStack=()=>{let C=[],E=[],w=!1;const R=new Set,M=ee=>ee.sort((ie,ne)=>stepWeights[ne.step]-stepWeights[ie.step]||priorityWeights[ne.priority||"normal"]-priorityWeights[ie.priority||"normal"]),x=ee=>{let ie=!1;const ne=re=>{const oe=getAllAliases(re.name,re.aliases);if(oe.includes(ee)){ie=!0;for(const ae of oe)R.delete(ae);return!1}return!0};return C=C.filter(ne),E=E.filter(ne),ie},S=ee=>{let ie=!1;const ne=re=>{if(re.middleware===ee){ie=!0;for(const oe of getAllAliases(re.name,re.aliases))R.delete(oe);return!1}return!0};return C=C.filter(ne),E=E.filter(ne),ie},T=ee=>{var ie;return C.forEach(ne=>{ee.add(ne.middleware,{...ne})}),E.forEach(ne=>{ee.addRelativeTo(ne.middleware,{...ne})}),(ie=ee.identifyOnResolve)==null||ie.call(ee,Y.identifyOnResolve()),ee},_=ee=>{const ie=[];return ee.before.forEach(ne=>{ne.before.length===0&&ne.after.length===0?ie.push(ne):ie.push(..._(ne))}),ie.push(ee),ee.after.reverse().forEach(ne=>{ne.before.length===0&&ne.after.length===0?ie.push(ne):ie.push(..._(ne))}),ie},D=(ee=!1)=>{const ie=[],ne=[],re={};return C.forEach(oe=>{const ae={...oe,before:[],after:[]};for(const le of getAllAliases(ae.name,ae.aliases))re[le]=ae;ie.push(ae)}),E.forEach(oe=>{const ae={...oe,before:[],after:[]};for(const le of getAllAliases(ae.name,ae.aliases))re[le]=ae;ne.push(ae)}),ne.forEach(oe=>{if(oe.toMiddleware){const ae=re[oe.toMiddleware];if(ae===void 0){if(ee)return;throw new Error(`${oe.toMiddleware} is not found when adding ${getMiddlewareNameWithAliases(oe.name,oe.aliases)} middleware ${oe.relation} ${oe.toMiddleware}`)}oe.relation==="after"&&ae.after.push(oe),oe.relation==="before"&&ae.before.push(oe)}}),M(ie).map(_).reduce((oe,ae)=>(oe.push(...ae),oe),[])},Y={add:(ee,ie={})=>{const{name:ne,override:re,aliases:oe}=ie,ae={step:"initialize",priority:"normal",middleware:ee,...ie},le=getAllAliases(ne,oe);if(le.length>0){if(le.some(de=>R.has(de))){if(!re)throw new Error(`Duplicate middleware name '${getMiddlewareNameWithAliases(ne,oe)}'`);for(const de of le){const me=C.findIndex(ge=>{var he;return ge.name===de||((he=ge.aliases)==null?void 0:he.some(ve=>ve===de))});if(me===-1)continue;const fe=C[me];if(fe.step!==ae.step||ae.priority!==fe.priority)throw new Error(`"${getMiddlewareNameWithAliases(fe.name,fe.aliases)}" middleware with ${fe.priority} priority in ${fe.step} step cannot be overridden by "${getMiddlewareNameWithAliases(ne,oe)}" middleware with ${ae.priority} priority in ${ae.step} step.`);C.splice(me,1)}}for(const de of le)R.add(de)}C.push(ae)},addRelativeTo:(ee,ie)=>{const{name:ne,override:re,aliases:oe}=ie,ae={middleware:ee,...ie},le=getAllAliases(ne,oe);if(le.length>0){if(le.some(de=>R.has(de))){if(!re)throw new Error(`Duplicate middleware name '${getMiddlewareNameWithAliases(ne,oe)}'`);for(const de of le){const me=E.findIndex(ge=>{var he;return ge.name===de||((he=ge.aliases)==null?void 0:he.some(ve=>ve===de))});if(me===-1)continue;const fe=E[me];if(fe.toMiddleware!==ae.toMiddleware||fe.relation!==ae.relation)throw new Error(`"${getMiddlewareNameWithAliases(fe.name,fe.aliases)}" middleware ${fe.relation} "${fe.toMiddleware}" middleware cannot be overridden by "${getMiddlewareNameWithAliases(ne,oe)}" middleware ${ae.relation} "${ae.toMiddleware}" middleware.`);E.splice(me,1)}}for(const de of le)R.add(de)}E.push(ae)},clone:()=>T(constructStack()),use:ee=>{ee.applyToStack(Y)},remove:ee=>typeof ee=="string"?x(ee):S(ee),removeByTag:ee=>{let ie=!1;const ne=re=>{const{tags:oe,name:ae,aliases:le}=re;if(oe&&oe.includes(ee)){const de=getAllAliases(ae,le);for(const me of de)R.delete(me);return ie=!0,!1}return!0};return C=C.filter(ne),E=E.filter(ne),ie},concat:ee=>{var ie;const ne=T(constructStack());return ne.use(ee),ne.identifyOnResolve(w||ne.identifyOnResolve()||(((ie=ee.identifyOnResolve)==null?void 0:ie.call(ee))??!1)),ne},applyToStack:T,identify:()=>D(!0).map(ee=>{const ie=ee.step??ee.relation+" "+ee.toMiddleware;return getMiddlewareNameWithAliases(ee.name,ee.aliases)+" - "+ie}),identifyOnResolve(ee){return typeof ee=="boolean"&&(w=ee),w},resolve:(ee,ie)=>{for(const ne of D().map(re=>re.middleware).reverse())ee=ne(ee,ie);return w&&console.log(Y.identify()),ee}};return Y},stepWeights={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},priorityWeights={high:3,normal:2,low:1};class Client{constructor(E){this.config=E,this.middlewareStack=constructStack()}send(E,w,R){const M=typeof w!="function"?w:void 0,x=typeof w=="function"?w:R,S=M===void 0&&this.config.cacheMiddleware===!0;let T;if(S){this.handlers||(this.handlers=new WeakMap);const _=this.handlers;_.has(E.constructor)?T=_.get(E.constructor):(T=E.resolveMiddleware(this.middlewareStack,this.config,M),_.set(E.constructor,T))}else delete this.handlers,T=E.resolveMiddleware(this.middlewareStack,this.config,M);if(x)T(E).then(_=>x(null,_.output),_=>x(_)).catch(()=>{});else return T(E).then(_=>_.output)}destroy(){var E,w,R;(R=(w=(E=this.config)==null?void 0:E.requestHandler)==null?void 0:w.destroy)==null||R.call(w),delete this.handlers}}class Command{constructor(){this.middlewareStack=constructStack()}static classBuilder(){return new ClassBuilder}resolveMiddlewareWithContext(E,w,R,{middlewareFn:M,clientName:x,commandName:S,inputFilterSensitiveLog:T,outputFilterSensitiveLog:_,smithyContext:D,additionalContext:Y,CommandCtor:ee}){for(const ae of M.bind(this)(ee,E,w,R))this.middlewareStack.use(ae);const ie=E.concat(this.middlewareStack),{logger:ne}=w,re={logger:ne,clientName:x,commandName:S,inputFilterSensitiveLog:T,outputFilterSensitiveLog:_,[SMITHY_CONTEXT_KEY]:{commandInstance:this,...D},...Y},{requestHandler:oe}=w;return ie.resolve(ae=>oe.handle(ae.request,R||{}),re)}}class ClassBuilder{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=E=>E,this._outputFilterSensitiveLog=E=>E,this._serializer=null,this._deserializer=null}init(E){this._init=E}ep(E){return this._ep=E,this}m(E){return this._middlewareFn=E,this}s(E,w,R={}){return this._smithyContext={service:E,operation:w,...R},this}c(E={}){return this._additionalContext=E,this}n(E,w){return this._clientName=E,this._commandName=w,this}f(E=R=>R,w=R=>R){return this._inputFilterSensitiveLog=E,this._outputFilterSensitiveLog=w,this}ser(E){return this._serializer=E,this}de(E){return this._deserializer=E,this}build(){const E=this;let w;return w=class extends Command{static getEndpointParameterInstructions(){return E._ep}constructor(...[R]){super(),this.serialize=E._serializer,this.deserialize=E._deserializer,this.input=R??{},E._init(this)}resolveMiddleware(R,M,x){return this.resolveMiddlewareWithContext(R,M,x,{CommandCtor:w,middlewareFn:E._middlewareFn,clientName:E._clientName,commandName:E._commandName,inputFilterSensitiveLog:E._inputFilterSensitiveLog,outputFilterSensitiveLog:E._outputFilterSensitiveLog,smithyContext:E._smithyContext,additionalContext:E._additionalContext})}}}}const SENSITIVE_STRING="***SensitiveInformation***",createAggregatedClient=(C,E)=>{for(const w of Object.keys(C)){const R=C[w],M=async function(S,T,_){const D=new R(S);if(typeof T=="function")this.send(D,T);else if(typeof _=="function"){if(typeof T!="object")throw new Error(`Expected http options but got ${typeof T}`);this.send(D,T||{},_)}else return this.send(D,T)},x=(w[0].toLowerCase()+w.slice(1)).replace(/Command$/,"");E.prototype[x]=M}},expectBoolean=C=>{if(C!=null){if(typeof C=="number"){if((C===0||C===1)&&logger.warn(stackTraceWarning(`Expected boolean, got ${typeof C}: ${C}`)),C===0)return!1;if(C===1)return!0}if(typeof C=="string"){const E=C.toLowerCase();if((E==="false"||E==="true")&&logger.warn(stackTraceWarning(`Expected boolean, got ${typeof C}: ${C}`)),E==="false")return!1;if(E==="true")return!0}if(typeof C=="boolean")return C;throw new TypeError(`Expected boolean, got ${typeof C}: ${C}`)}},expectNumber=C=>{if(C!=null){if(typeof C=="string"){const E=parseFloat(C);if(!Number.isNaN(E))return String(E)!==String(C)&&logger.warn(stackTraceWarning(`Expected number but observed string: ${C}`)),E}if(typeof C=="number")return C;throw new TypeError(`Expected number, got ${typeof C}: ${C}`)}},expectNonNull=(C,E)=>{if(C==null)throw E?new TypeError(`Expected a non-null value for ${E}`):new TypeError("Expected a non-null value");return C},expectObject=C=>{if(C==null)return;if(typeof C=="object"&&!Array.isArray(C))return C;const E=Array.isArray(C)?"array":typeof C;throw new TypeError(`Expected object, got ${E}: ${C}`)},expectString=C=>{if(C!=null){if(typeof C=="string")return C;if(["boolean","number","bigint"].includes(typeof C))return logger.warn(stackTraceWarning(`Expected string, got ${typeof C}: ${C}`)),String(C);throw new TypeError(`Expected string, got ${typeof C}: ${C}`)}},strictParseDouble=C=>expectNumber(typeof C=="string"?parseNumber(C):C),NUMBER_REGEX=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,parseNumber=C=>{const E=C.match(NUMBER_REGEX);if(E===null||E[0].length!==C.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(C)},stackTraceWarning=C=>String(new TypeError(C).stack||C).split(`
`).slice(0,5).filter(E=>!E.includes("stackTraceWarning")).join(`
`),logger={warn:console.warn},parseEpochTimestamp=C=>{if(C==null)return;let E;if(typeof C=="number")E=C;else if(typeof C=="string")E=strictParseDouble(C);else if(typeof C=="object"&&C.tag===1)E=C.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(E)||E===1/0||E===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(E*1e3))};class ServiceException extends Error{constructor(E){super(E.message),Object.setPrototypeOf(this,ServiceException.prototype),this.name=E.name,this.$fault=E.$fault,this.$metadata=E.$metadata}}const decorateServiceException=(C,E={})=>{Object.entries(E).filter(([,R])=>R!==void 0).forEach(([R,M])=>{(C[R]==null||C[R]==="")&&(C[R]=M)});const w=C.message||C.Message||"UnknownError";return C.message=w,delete C.Message,C},throwDefaultError$1=({output:C,parsedBody:E,exceptionCtor:w,errorCode:R})=>{const M=deserializeMetadata$1(C),x=M.httpStatusCode?M.httpStatusCode+"":void 0,S=new w({name:(E==null?void 0:E.code)||(E==null?void 0:E.Code)||R||x||"UnknownError",$fault:"client",$metadata:M});throw decorateServiceException(S,E)},withBaseException=C=>({output:E,parsedBody:w,errorCode:R})=>{throwDefaultError$1({output:E,parsedBody:w,exceptionCtor:C,errorCode:R})},deserializeMetadata$1=C=>({httpStatusCode:C.statusCode,requestId:C.headers["x-amzn-requestid"]??C.headers["x-amzn-request-id"]??C.headers["x-amz-request-id"],extendedRequestId:C.headers["x-amz-id-2"],cfId:C.headers["x-amz-cf-id"]}),loadConfigsForDefaultMode=C=>{switch(C){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},getChecksumConfiguration=C=>{const E=[];for(const w in AlgorithmId){const R=AlgorithmId[w];C[R]!==void 0&&E.push({algorithmId:()=>R,checksumConstructor:()=>C[R]})}return{_checksumAlgorithms:E,addChecksumAlgorithm(w){this._checksumAlgorithms.push(w)},checksumAlgorithms(){return this._checksumAlgorithms}}},resolveChecksumRuntimeConfig=C=>{const E={};return C.checksumAlgorithms().forEach(w=>{E[w.algorithmId()]=w.checksumConstructor()}),E},getRetryConfiguration=C=>{let E=C.retryStrategy;return{setRetryStrategy(w){E=w},retryStrategy(){return E}}},resolveRetryRuntimeConfig=C=>{const E={};return E.retryStrategy=C.retryStrategy(),E},getDefaultExtensionConfiguration=C=>({...getChecksumConfiguration(C),...getRetryConfiguration(C)}),resolveDefaultRuntimeConfig=C=>({...resolveChecksumRuntimeConfig(C),...resolveRetryRuntimeConfig(C)}),isSerializableHeaderValue=C=>C!=null;let NoOpLogger$1=class{trace(){}debug(){}info(){}warn(){}error(){}};function map(C,E,w){let R,M,x;if(typeof E>"u"&&typeof w>"u")R={},x=C;else{if(R=C,typeof E=="function")return M=E,x=w,mapWithFilter(R,M,x);x=E}for(const S of Object.keys(x)){if(!Array.isArray(x[S])){R[S]=x[S];continue}applyInstruction(R,null,x,S)}return R}const take=(C,E)=>{const w={};for(const R in E)applyInstruction(w,C,E,R);return w},mapWithFilter=(C,E,w)=>map(C,Object.entries(w).reduce((R,[M,x])=>(Array.isArray(x)?R[M]=x:typeof x=="function"?R[M]=[E,x()]:R[M]=[E,x],R),{})),applyInstruction=(C,E,w,R)=>{if(E!==null){let S=w[R];typeof S=="function"&&(S=[,S]);const[T=nonNullish,_=pass,D=R]=S;(typeof T=="function"&&T(E[D])||typeof T!="function"&&T)&&(C[R]=_(E[D]));return}let[M,x]=w[R];if(typeof x=="function"){let S;const T=M===void 0&&(S=x())!=null,_=typeof M=="function"&&!!M(void 0)||typeof M!="function"&&!!M;T?C[R]=S:_&&(C[R]=x())}else{const S=M===void 0&&x!=null,T=typeof M=="function"&&!!M(x)||typeof M!="function"&&!!M;(S||T)&&(C[R]=x)}},nonNullish=C=>C!=null,pass=C=>C,serializeDateTime=C=>C.toISOString().replace(".000Z","Z"),_json=C=>{if(C==null)return{};if(Array.isArray(C))return C.filter(E=>E!=null).map(_json);if(typeof C=="object"){const E={};for(const w of Object.keys(C))C[w]!=null&&(E[w]=_json(C[w]));return E}return C},collectBodyString=(C,E)=>collectBody(C,E).then(w=>E.utf8Encoder(w)),parseJsonBody=(C,E)=>collectBodyString(C,E).then(w=>{if(w.length)try{return JSON.parse(w)}catch(R){throw(R==null?void 0:R.name)==="SyntaxError"&&Object.defineProperty(R,"$responseBodyText",{value:w}),R}return{}}),parseJsonErrorBody=async(C,E)=>{const w=await parseJsonBody(C,E);return w.message=w.message??w.Message,w},loadRestJsonErrorCode=(C,E)=>{const w=(x,S)=>Object.keys(x).find(T=>T.toLowerCase()===S.toLowerCase()),R=x=>{let S=x;return typeof S=="number"&&(S=S.toString()),S.indexOf(",")>=0&&(S=S.split(",")[0]),S.indexOf(":")>=0&&(S=S.split(":")[0]),S.indexOf("#")>=0&&(S=S.split("#")[1]),S},M=w(C.headers,"x-amzn-errortype");if(M!==void 0)return R(C.headers[M]);if(E.code!==void 0)return R(E.code);if(E.__type!==void 0)return R(E.__type)},ACCOUNT_ID_ENDPOINT_REGEX=/\d{12}\.ddb/;async function checkFeatures(C,E,w){var R,M,x,S,T,_,D;const Y=w.request;if(((R=Y==null?void 0:Y.headers)==null?void 0:R["smithy-protocol"])==="rpc-v2-cbor"&&setFeature(C,"PROTOCOL_RPC_V2_CBOR","M"),typeof E.retryStrategy=="function"){const ie=await E.retryStrategy();typeof ie.acquireInitialRetryToken=="function"?(x=(M=ie.constructor)==null?void 0:M.name)!=null&&x.includes("Adaptive")?setFeature(C,"RETRY_MODE_ADAPTIVE","F"):setFeature(C,"RETRY_MODE_STANDARD","E"):setFeature(C,"RETRY_MODE_LEGACY","D")}if(typeof E.accountIdEndpointMode=="function"){const ie=C.endpointV2;switch(String((S=ie==null?void 0:ie.url)==null?void 0:S.hostname).match(ACCOUNT_ID_ENDPOINT_REGEX)&&setFeature(C,"ACCOUNT_ID_ENDPOINT","O"),await((T=E.accountIdEndpointMode)==null?void 0:T.call(E))){case"disabled":setFeature(C,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":setFeature(C,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":setFeature(C,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const ee=(D=(_=C.__smithy_context)==null?void 0:_.selectedHttpAuthScheme)==null?void 0:D.identity;if(ee!=null&&ee.$source){const ie=ee;ie.accountId&&setFeature(C,"RESOLVED_ACCOUNT_ID","T");for(const[ne,re]of Object.entries(ie.$source??{}))setFeature(C,ne,re)}}const USER_AGENT="user-agent",X_AMZ_USER_AGENT="x-amz-user-agent",SPACE=" ",UA_NAME_SEPARATOR="/",UA_NAME_ESCAPE_REGEX=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,UA_VALUE_ESCAPE_REGEX=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,UA_ESCAPE_CHAR="-",BYTE_LIMIT=1024;function encodeFeatures(C){let E="";for(const w in C){const R=C[w];if(E.length+R.length+1<=BYTE_LIMIT){E.length?E+=","+R:E+=R;continue}break}return E}const userAgentMiddleware=C=>(E,w)=>async R=>{var M,x,S,T;const{request:_}=R;if(!HttpRequest.isInstance(_))return E(R);const{headers:D}=_,Y=((M=w==null?void 0:w.userAgent)==null?void 0:M.map(escapeUserAgent))||[],ee=(await C.defaultUserAgentProvider()).map(escapeUserAgent);await checkFeatures(w,C,R);const ie=w;ee.push(`m/${encodeFeatures(Object.assign({},(x=w.__smithy_context)==null?void 0:x.features,(S=ie.__aws_sdk_context)==null?void 0:S.features))}`);const ne=((T=C==null?void 0:C.customUserAgent)==null?void 0:T.map(escapeUserAgent))||[],re=await C.userAgentAppId();re&&ee.push(escapeUserAgent([`app/${re}`]));const oe=[].concat([...ee,...Y,...ne]).join(SPACE),ae=[...ee.filter(le=>le.startsWith("aws-sdk-")),...ne].join(SPACE);return C.runtime!=="browser"?(ae&&(D[X_AMZ_USER_AGENT]=D[X_AMZ_USER_AGENT]?`${D[USER_AGENT]} ${ae}`:ae),D[USER_AGENT]=oe):D[X_AMZ_USER_AGENT]=oe,E({...R,request:_})},escapeUserAgent=C=>{var E;const w=C[0].split(UA_NAME_SEPARATOR).map(T=>T.replace(UA_NAME_ESCAPE_REGEX,UA_ESCAPE_CHAR)).join(UA_NAME_SEPARATOR),R=(E=C[1])==null?void 0:E.replace(UA_VALUE_ESCAPE_REGEX,UA_ESCAPE_CHAR),M=w.indexOf(UA_NAME_SEPARATOR),x=w.substring(0,M);let S=w.substring(M+1);return x==="api"&&(S=S.toLowerCase()),[x,S,R].filter(T=>T&&T.length>0).reduce((T,_,D)=>{switch(D){case 0:return _;case 1:return`${T}/${_}`;default:return`${T}#${_}`}},"")},getUserAgentMiddlewareOptions={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},getUserAgentPlugin=C=>({applyToStack:E=>{E.add(userAgentMiddleware(C),getUserAgentMiddlewareOptions)}});var SelectorType;(function(C){C.ENV="env",C.CONFIG="shared config entry"})(SelectorType||(SelectorType={}));const DEFAULT_USE_DUALSTACK_ENDPOINT=!1,DEFAULT_USE_FIPS_ENDPOINT=!1,isFipsRegion=C=>typeof C=="string"&&(C.startsWith("fips-")||C.endsWith("-fips")),getRealRegion=C=>isFipsRegion(C)?["fips-aws-global","aws-fips"].includes(C)?"us-east-1":C.replace(/fips-(dkr-|prod-)?|-fips/,""):C,resolveRegionConfig=C=>{const{region:E,useFipsEndpoint:w}=C;if(!E)throw new Error("Region is missing");return{...C,region:async()=>{if(typeof E=="string")return getRealRegion(E);const R=await E();return getRealRegion(R)},useFipsEndpoint:async()=>{const R=typeof E=="string"?E:await E();return isFipsRegion(R)?!0:typeof w!="function"?Promise.resolve(!!w):w()}}},CONTENT_LENGTH_HEADER="content-length";function contentLengthMiddleware(C){return E=>async w=>{const R=w.request;if(HttpRequest.isInstance(R)){const{body:M,headers:x}=R;if(M&&Object.keys(x).map(S=>S.toLowerCase()).indexOf(CONTENT_LENGTH_HEADER)===-1)try{const S=C(M);R.headers={...R.headers,[CONTENT_LENGTH_HEADER]:String(S)}}catch{}}return E({...w,request:R})}}const contentLengthMiddlewareOptions={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},getContentLengthPlugin=C=>({applyToStack:E=>{E.add(contentLengthMiddleware(C.bodyLengthChecker),contentLengthMiddlewareOptions)}}),resolveParamsForS3=async C=>{const E=(C==null?void 0:C.Bucket)||"";if(typeof C.Bucket=="string"&&(C.Bucket=E.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),isArnBucketName(E)){if(C.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!isDnsCompatibleBucketName(E)||E.indexOf(".")!==-1&&!String(C.Endpoint).startsWith("http:")||E.toLowerCase()!==E||E.length<3)&&(C.ForcePathStyle=!0);return C.DisableMultiRegionAccessPoints&&(C.disableMultiRegionAccessPoints=!0,C.DisableMRAP=!0),C},DOMAIN_PATTERN=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,IP_ADDRESS_PATTERN=/(\d+\.){3}\d+/,DOTS_PATTERN=/\.\./,isDnsCompatibleBucketName=C=>DOMAIN_PATTERN.test(C)&&!IP_ADDRESS_PATTERN.test(C)&&!DOTS_PATTERN.test(C),isArnBucketName=C=>{const[E,w,R,,,M]=C.split(":"),x=E==="arn"&&C.split(":").length>=6,S=!!(x&&w&&R&&M);if(x&&!S)throw new Error(`Invalid ARN: ${C} was an invalid ARN.`);return S},createConfigValueProvider=(C,E,w)=>{const R=async()=>{const M=w[C]??w[E];return typeof M=="function"?M():M};return C==="credentialScope"||E==="CredentialScope"?async()=>{const M=typeof w.credentials=="function"?await w.credentials():w.credentials;return(M==null?void 0:M.credentialScope)??(M==null?void 0:M.CredentialScope)}:C==="accountId"||E==="AccountId"?async()=>{const M=typeof w.credentials=="function"?await w.credentials():w.credentials;return(M==null?void 0:M.accountId)??(M==null?void 0:M.AccountId)}:C==="endpoint"||E==="endpoint"?async()=>{const M=await R();if(M&&typeof M=="object"){if("url"in M)return M.url.href;if("hostname"in M){const{protocol:x,hostname:S,port:T,path:_}=M;return`${x}//${S}${T?":"+T:""}${_}`}}return M}:R},getEndpointFromConfig=async C=>{};function parseQueryString(C){const E={};if(C=C.replace(/^\?/,""),C)for(const w of C.split("&")){let[R,M=null]=w.split("=");R=decodeURIComponent(R),M&&(M=decodeURIComponent(M)),R in E?Array.isArray(E[R])?E[R].push(M):E[R]=[E[R],M]:E[R]=M}return E}const parseUrl=C=>{if(typeof C=="string")return parseUrl(new URL(C));const{hostname:E,pathname:w,port:R,protocol:M,search:x}=C;let S;return x&&(S=parseQueryString(x)),{hostname:E,port:R?parseInt(R):void 0,protocol:M,path:w,query:S}},toEndpointV1=C=>typeof C=="object"?"url"in C?parseUrl(C.url):C:parseUrl(C),getEndpointFromInstructions=async(C,E,w,R)=>{if(!w.endpoint){let x;w.serviceConfiguredEndpoint?x=await w.serviceConfiguredEndpoint():x=await getEndpointFromConfig(w.serviceId),x&&(w.endpoint=()=>Promise.resolve(toEndpointV1(x)))}const M=await resolveParams(C,E,w);if(typeof w.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return w.endpointProvider(M,R)},resolveParams=async(C,E,w)=>{var R;const M={},x=((R=E==null?void 0:E.getEndpointParameterInstructions)==null?void 0:R.call(E))||{};for(const[S,T]of Object.entries(x))switch(T.type){case"staticContextParams":M[S]=T.value;break;case"contextParams":M[S]=C[T.name];break;case"clientContextParams":case"builtInParams":M[S]=await createConfigValueProvider(T.name,S,w)();break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(T))}return Object.keys(x).length===0&&Object.assign(M,w),String(w.serviceId).toLowerCase()==="s3"&&await resolveParamsForS3(M),M},endpointMiddleware=({config:C,instructions:E})=>(w,R)=>async M=>{var x,S,T;C.endpoint&&setFeature$1(R,"ENDPOINT_OVERRIDE","N");const _=await getEndpointFromInstructions(M.input,{getEndpointParameterInstructions(){return E}},{...C},R);R.endpointV2=_,R.authSchemes=(x=_.properties)==null?void 0:x.authSchemes;const D=(S=R.authSchemes)==null?void 0:S[0];if(D){R.signing_region=D.signingRegion,R.signing_service=D.signingName;const Y=getSmithyContext(R),ee=(T=Y==null?void 0:Y.selectedHttpAuthScheme)==null?void 0:T.httpAuthOption;ee&&(ee.signingProperties=Object.assign(ee.signingProperties||{},{signing_region:D.signingRegion,signingRegion:D.signingRegion,signing_service:D.signingName,signingName:D.signingName,signingRegionSet:D.signingRegionSet},D.properties))}return w({...M})},endpointMiddlewareOptions={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:serializerMiddlewareOption.name},getEndpointPlugin=(C,E)=>({applyToStack:w=>{w.addRelativeTo(endpointMiddleware({config:C,instructions:E}),endpointMiddlewareOptions)}}),resolveEndpointConfig=C=>{const E=C.tls??!0,{endpoint:w}=C,R=w!=null?async()=>toEndpointV1(await normalizeProvider$1(w)()):void 0,M={...C,endpoint:R,tls:E,isCustomEndpoint:!!w,useDualstackEndpoint:normalizeProvider$1(C.useDualstackEndpoint??!1),useFipsEndpoint:normalizeProvider$1(C.useFipsEndpoint??!1)};let x;return M.serviceConfiguredEndpoint=async()=>(C.serviceId&&!x&&(x=getEndpointFromConfig(C.serviceId)),x),M};var RETRY_MODES;(function(C){C.STANDARD="standard",C.ADAPTIVE="adaptive"})(RETRY_MODES||(RETRY_MODES={}));const DEFAULT_MAX_ATTEMPTS=3,DEFAULT_RETRY_MODE=RETRY_MODES.STANDARD,THROTTLING_ERROR_CODES=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],TRANSIENT_ERROR_CODES=["TimeoutError","RequestTimeout","RequestTimeoutException"],TRANSIENT_ERROR_STATUS_CODES=[500,502,503,504],NODEJS_TIMEOUT_ERROR_CODES=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],isClockSkewCorrectedError=C=>{var E;return(E=C.$metadata)==null?void 0:E.clockSkewCorrected},isThrottlingError=C=>{var E,w;return((E=C.$metadata)==null?void 0:E.httpStatusCode)===429||THROTTLING_ERROR_CODES.includes(C.name)||((w=C.$retryable)==null?void 0:w.throttling)==!0},isTransientError=(C,E=0)=>{var w;return isClockSkewCorrectedError(C)||TRANSIENT_ERROR_CODES.includes(C.name)||NODEJS_TIMEOUT_ERROR_CODES.includes((C==null?void 0:C.code)||"")||TRANSIENT_ERROR_STATUS_CODES.includes(((w=C.$metadata)==null?void 0:w.httpStatusCode)||0)||C.cause!==void 0&&E<=10&&isTransientError(C.cause,E+1)},isServerError=C=>{var E;if(((E=C.$metadata)==null?void 0:E.httpStatusCode)!==void 0){const w=C.$metadata.httpStatusCode;return 500<=w&&w<=599&&!isTransientError(C)}return!1};class DefaultRateLimiter{constructor(E){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=(E==null?void 0:E.beta)??.7,this.minCapacity=(E==null?void 0:E.minCapacity)??1,this.minFillRate=(E==null?void 0:E.minFillRate)??.5,this.scaleConstant=(E==null?void 0:E.scaleConstant)??.4,this.smooth=(E==null?void 0:E.smooth)??.8;const w=this.getCurrentTimeInSeconds();this.lastThrottleTime=w,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(E){if(this.enabled){if(this.refillTokenBucket(),E>this.currentCapacity){const w=(E-this.currentCapacity)/this.fillRate*1e3;await new Promise(R=>DefaultRateLimiter.setTimeoutFn(R,w))}this.currentCapacity=this.currentCapacity-E}}refillTokenBucket(){const E=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=E;return}const w=(E-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+w),this.lastTimestamp=E}updateClientSendingRate(E){let w;if(this.updateMeasuredRate(),isThrottlingError(E)){const M=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=M,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),w=this.cubicThrottle(M),this.enableTokenBucket()}else this.calculateTimeWindow(),w=this.cubicSuccess(this.getCurrentTimeInSeconds());const R=Math.min(w,2*this.measuredTxRate);this.updateTokenBucketRate(R)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(E){return this.getPrecise(E*this.beta)}cubicSuccess(E){return this.getPrecise(this.scaleConstant*Math.pow(E-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(E){this.refillTokenBucket(),this.fillRate=Math.max(E,this.minFillRate),this.maxCapacity=Math.max(E,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const E=this.getCurrentTimeInSeconds(),w=Math.floor(E*2)/2;if(this.requestCount++,w>this.lastTxRateBucket){const R=this.requestCount/(w-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(R*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=w}}getPrecise(E){return parseFloat(E.toFixed(8))}}DefaultRateLimiter.setTimeoutFn=setTimeout;const DEFAULT_RETRY_DELAY_BASE=100,MAXIMUM_RETRY_DELAY=20*1e3,THROTTLING_RETRY_DELAY_BASE=500,INITIAL_RETRY_TOKENS=500,RETRY_COST=5,TIMEOUT_RETRY_COST=10,NO_RETRY_INCREMENT=1,INVOCATION_ID_HEADER="amz-sdk-invocation-id",REQUEST_HEADER="amz-sdk-request",getDefaultRetryBackoffStrategy=()=>{let C=DEFAULT_RETRY_DELAY_BASE;return{computeNextBackoffDelay:E=>Math.floor(Math.min(MAXIMUM_RETRY_DELAY,Math.random()*2**E*C)),setDelayBase:E=>{C=E}}},createDefaultRetryToken=({retryDelay:C,retryCount:E,retryCost:w})=>({getRetryCount:()=>E,getRetryDelay:()=>Math.min(MAXIMUM_RETRY_DELAY,C),getRetryCost:()=>w});class StandardRetryStrategy{constructor(E){this.maxAttempts=E,this.mode=RETRY_MODES.STANDARD,this.capacity=INITIAL_RETRY_TOKENS,this.retryBackoffStrategy=getDefaultRetryBackoffStrategy(),this.maxAttemptsProvider=typeof E=="function"?E:async()=>E}async acquireInitialRetryToken(E){return createDefaultRetryToken({retryDelay:DEFAULT_RETRY_DELAY_BASE,retryCount:0})}async refreshRetryTokenForRetry(E,w){const R=await this.getMaxAttempts();if(this.shouldRetry(E,w,R)){const M=w.errorType;this.retryBackoffStrategy.setDelayBase(M==="THROTTLING"?THROTTLING_RETRY_DELAY_BASE:DEFAULT_RETRY_DELAY_BASE);const x=this.retryBackoffStrategy.computeNextBackoffDelay(E.getRetryCount()),S=w.retryAfterHint?Math.max(w.retryAfterHint.getTime()-Date.now()||0,x):x,T=this.getCapacityCost(M);return this.capacity-=T,createDefaultRetryToken({retryDelay:S,retryCount:E.getRetryCount()+1,retryCost:T})}throw new Error("No retry token available")}recordSuccess(E){this.capacity=Math.max(INITIAL_RETRY_TOKENS,this.capacity+(E.getRetryCost()??NO_RETRY_INCREMENT))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${DEFAULT_MAX_ATTEMPTS}`),DEFAULT_MAX_ATTEMPTS}}shouldRetry(E,w,R){return E.getRetryCount()+1<R&&this.capacity>=this.getCapacityCost(w.errorType)&&this.isRetryableError(w.errorType)}getCapacityCost(E){return E==="TRANSIENT"?TIMEOUT_RETRY_COST:RETRY_COST}isRetryableError(E){return E==="THROTTLING"||E==="TRANSIENT"}}class AdaptiveRetryStrategy{constructor(E,w){this.maxAttemptsProvider=E,this.mode=RETRY_MODES.ADAPTIVE;const{rateLimiter:R}=w??{};this.rateLimiter=R??new DefaultRateLimiter,this.standardRetryStrategy=new StandardRetryStrategy(E)}async acquireInitialRetryToken(E){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(E)}async refreshRetryTokenForRetry(E,w){return this.rateLimiter.updateClientSendingRate(w),this.standardRetryStrategy.refreshRetryTokenForRetry(E,w)}recordSuccess(E){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(E)}}let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let C=0;C<256;++C)byteToHex.push((C+256).toString(16).slice(1));function unsafeStringify(C,E=0){return byteToHex[C[E+0]]+byteToHex[C[E+1]]+byteToHex[C[E+2]]+byteToHex[C[E+3]]+"-"+byteToHex[C[E+4]]+byteToHex[C[E+5]]+"-"+byteToHex[C[E+6]]+byteToHex[C[E+7]]+"-"+byteToHex[C[E+8]]+byteToHex[C[E+9]]+"-"+byteToHex[C[E+10]]+byteToHex[C[E+11]]+byteToHex[C[E+12]]+byteToHex[C[E+13]]+byteToHex[C[E+14]]+byteToHex[C[E+15]]}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(C,E,w){if(native.randomUUID&&!E&&!C)return native.randomUUID();C=C||{};const R=C.random||(C.rng||rng)();return R[6]=R[6]&15|64,R[8]=R[8]&63|128,unsafeStringify(R)}const asSdkError=C=>C instanceof Error?C:C instanceof Object?Object.assign(new Error,C):typeof C=="string"?new Error(C):new Error(`AWS SDK error wrapper for ${C}`),resolveRetryConfig=C=>{const{retryStrategy:E}=C,w=normalizeProvider$1(C.maxAttempts??DEFAULT_MAX_ATTEMPTS);return{...C,maxAttempts:w,retryStrategy:async()=>E||(await normalizeProvider$1(C.retryMode)()===RETRY_MODES.ADAPTIVE?new AdaptiveRetryStrategy(w):new StandardRetryStrategy(w))}},isStreamingPayload=C=>(C==null?void 0:C.body)instanceof ReadableStream,retryMiddleware=C=>(E,w)=>async R=>{var M;let x=await C.retryStrategy();const S=await C.maxAttempts();if(isRetryStrategyV2(x)){x=x;let T=await x.acquireInitialRetryToken(w.partition_id),_=new Error,D=0,Y=0;const{request:ee}=R,ie=HttpRequest.isInstance(ee);for(ie&&(ee.headers[INVOCATION_ID_HEADER]=v4());;)try{ie&&(ee.headers[REQUEST_HEADER]=`attempt=${D+1}; max=${S}`);const{response:ne,output:re}=await E(R);return x.recordSuccess(T),re.$metadata.attempts=D+1,re.$metadata.totalRetryDelay=Y,{response:ne,output:re}}catch(ne){const re=getRetryErrorInfo(ne);if(_=asSdkError(ne),ie&&isStreamingPayload(ee))throw(M=w.logger instanceof NoOpLogger$1?console:w.logger)==null||M.warn("An error was encountered in a non-retryable streaming request."),_;try{T=await x.refreshRetryTokenForRetry(T,re)}catch{throw _.$metadata||(_.$metadata={}),_.$metadata.attempts=D+1,_.$metadata.totalRetryDelay=Y,_}D=T.getRetryCount();const oe=T.getRetryDelay();Y+=oe,await new Promise(ae=>setTimeout(ae,oe))}}else return x=x,x!=null&&x.mode&&(w.userAgent=[...w.userAgent||[],["cfg/retry-mode",x.mode]]),x.retry(E,R)},isRetryStrategyV2=C=>typeof C.acquireInitialRetryToken<"u"&&typeof C.refreshRetryTokenForRetry<"u"&&typeof C.recordSuccess<"u",getRetryErrorInfo=C=>{const E={error:C,errorType:getRetryErrorType(C)},w=getRetryAfterHint(C.$response);return w&&(E.retryAfterHint=w),E},getRetryErrorType=C=>isThrottlingError(C)?"THROTTLING":isTransientError(C)?"TRANSIENT":isServerError(C)?"SERVER_ERROR":"CLIENT_ERROR",retryMiddlewareOptions={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},getRetryPlugin=C=>({applyToStack:E=>{E.add(retryMiddleware(C),retryMiddlewareOptions)}}),getRetryAfterHint=C=>{if(!HttpResponse.isInstance(C))return;const E=Object.keys(C.headers).find(M=>M.toLowerCase()==="retry-after");if(!E)return;const w=C.headers[E],R=Number(w);return Number.isNaN(R)?new Date(w):new Date(R*1e3)},defaultChimeSDKMessagingHttpAuthSchemeParametersProvider=async(C,E,w)=>({operation:getSmithyContext(E).operation,region:await normalizeProvider$1(C.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function createAwsAuthSigv4HttpAuthOption(C){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"chime",region:C.region},propertiesExtractor:(E,w)=>({signingProperties:{config:E,context:w}})}}const defaultChimeSDKMessagingHttpAuthSchemeProvider=C=>{const E=[];switch(C.operation){default:E.push(createAwsAuthSigv4HttpAuthOption(C))}return E},resolveHttpAuthSchemeConfig=C=>({...resolveAwsSdkSigV4Config(C)}),resolveClientEndpointParameters=C=>({...C,useDualstackEndpoint:C.useDualstackEndpoint??!1,useFipsEndpoint:C.useFipsEndpoint??!1,defaultSigningName:"chime"}),commonParams={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},name="@aws-sdk/client-chime-sdk-messaging",description="AWS SDK for JavaScript Chime Sdk Messaging Client for Node.js, Browser and React Native",version="3.712.0",scripts={build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-chime-sdk-messaging","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo chime-sdk-messaging"},main="./dist-cjs/index.js",types$1="./dist-types/index.d.ts",module="./dist-es/index.js",sideEffects=!1,dependencies={"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/client-sso-oidc":"3.712.0","@aws-sdk/client-sts":"3.712.0","@aws-sdk/core":"3.709.0","@aws-sdk/credential-provider-node":"3.712.0","@aws-sdk/middleware-host-header":"3.709.0","@aws-sdk/middleware-logger":"3.709.0","@aws-sdk/middleware-recursion-detection":"3.709.0","@aws-sdk/middleware-user-agent":"3.709.0","@aws-sdk/region-config-resolver":"3.709.0","@aws-sdk/types":"3.709.0","@aws-sdk/util-endpoints":"3.709.0","@aws-sdk/util-user-agent-browser":"3.709.0","@aws-sdk/util-user-agent-node":"3.712.0","@smithy/config-resolver":"^3.0.13","@smithy/core":"^2.5.5","@smithy/fetch-http-handler":"^4.1.2","@smithy/hash-node":"^3.0.11","@smithy/invalid-dependency":"^3.0.11","@smithy/middleware-content-length":"^3.0.13","@smithy/middleware-endpoint":"^3.2.5","@smithy/middleware-retry":"^3.0.30","@smithy/middleware-serde":"^3.0.11","@smithy/middleware-stack":"^3.0.11","@smithy/node-config-provider":"^3.1.12","@smithy/node-http-handler":"^3.3.2","@smithy/protocol-http":"^4.1.8","@smithy/smithy-client":"^3.5.0","@smithy/types":"^3.7.2","@smithy/url-parser":"^3.0.11","@smithy/util-base64":"^3.0.0","@smithy/util-body-length-browser":"^3.0.0","@smithy/util-body-length-node":"^3.0.0","@smithy/util-defaults-mode-browser":"^3.0.30","@smithy/util-defaults-mode-node":"^3.0.30","@smithy/util-endpoints":"^2.1.7","@smithy/util-middleware":"^3.0.11","@smithy/util-retry":"^3.0.11","@smithy/util-utf8":"^3.0.0","@types/uuid":"^9.0.1",tslib:"^2.6.2",uuid:"^9.0.1"},devDependencies={"@tsconfig/node16":"16.1.3","@types/node":"^16.18.96",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~4.9.5"},engines={node:">=16.0.0"},typesVersions={"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files=["dist-*/**"],author={name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license="Apache-2.0",browser={"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},homepage="https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-chime-sdk-messaging",repository={type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-chime-sdk-messaging"},packageInfo={name,description,version,scripts,main,types:types$1,module,sideEffects,dependencies,devDependencies,engines,typesVersions,files,author,license,browser,"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage,repository},fromUtf8$4=C=>new TextEncoder().encode(C);var fromUtf8$3=typeof Buffer<"u"&&Buffer.from?function(C){return Buffer.from(C,"utf8")}:fromUtf8$4;function convertToBuffer$1(C){return C instanceof Uint8Array?C:typeof C=="string"?fromUtf8$3(C):ArrayBuffer.isView(C)?new Uint8Array(C.buffer,C.byteOffset,C.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(C)}function isEmptyData$1(C){return typeof C=="string"?C.length===0:C.byteLength===0}var SHA_256_HASH={name:"SHA-256"},SHA_256_HMAC_ALGO={name:"HMAC",hash:SHA_256_HASH},EMPTY_DATA_SHA_256=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const fallbackWindow={};function locateWindow(){return typeof window<"u"?window:typeof self<"u"?self:fallbackWindow}var Sha256$2=function(){function C(E){this.toHash=new Uint8Array(0),this.secret=E,this.reset()}return C.prototype.update=function(E){if(!isEmptyData$1(E)){var w=convertToBuffer$1(E),R=new Uint8Array(this.toHash.byteLength+w.byteLength);R.set(this.toHash,0),R.set(w,this.toHash.byteLength),this.toHash=R}},C.prototype.digest=function(){var E=this;return this.key?this.key.then(function(w){return locateWindow().crypto.subtle.sign(SHA_256_HMAC_ALGO,w,E.toHash).then(function(R){return new Uint8Array(R)})}):isEmptyData$1(this.toHash)?Promise.resolve(EMPTY_DATA_SHA_256):Promise.resolve().then(function(){return locateWindow().crypto.subtle.digest(SHA_256_HASH,E.toHash)}).then(function(w){return Promise.resolve(new Uint8Array(w))})},C.prototype.reset=function(){var E=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(w,R){locateWindow().crypto.subtle.importKey("raw",convertToBuffer$1(E.secret),SHA_256_HMAC_ALGO,!1,["sign"]).then(w,R)}),this.key.catch(function(){}))},C}();function __awaiter$1(C,E,w,R){function M(x){return x instanceof w?x:new w(function(S){S(x)})}return new(w||(w=Promise))(function(x,S){function T(Y){try{D(R.next(Y))}catch(ee){S(ee)}}function _(Y){try{D(R.throw(Y))}catch(ee){S(ee)}}function D(Y){Y.done?x(Y.value):M(Y.value).then(T,_)}D((R=R.apply(C,[])).next())})}function __generator$1(C,E){var w={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},R,M,x,S=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return S.next=T(0),S.throw=T(1),S.return=T(2),typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function T(D){return function(Y){return _([D,Y])}}function _(D){if(R)throw new TypeError("Generator is already executing.");for(;S&&(S=0,D[0]&&(w=0)),w;)try{if(R=1,M&&(x=D[0]&2?M.return:D[0]?M.throw||((x=M.return)&&x.call(M),0):M.next)&&!(x=x.call(M,D[1])).done)return x;switch(M=0,x&&(D=[D[0]&2,x.value]),D[0]){case 0:case 1:x=D;break;case 4:return w.label++,{value:D[1],done:!1};case 5:w.label++,M=D[1],D=[0];continue;case 7:D=w.ops.pop(),w.trys.pop();continue;default:if(x=w.trys,!(x=x.length>0&&x[x.length-1])&&(D[0]===6||D[0]===2)){w=0;continue}if(D[0]===3&&(!x||D[1]>x[0]&&D[1]<x[3])){w.label=D[1];break}if(D[0]===6&&w.label<x[1]){w.label=x[1],x=D;break}if(x&&w.label<x[2]){w.label=x[2],w.ops.push(D);break}x[2]&&w.ops.pop(),w.trys.pop();continue}D=E.call(C,w)}catch(Y){D=[6,Y],M=0}finally{R=x=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}}var BLOCK_SIZE=64,DIGEST_LENGTH=32,KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],MAX_HASHABLE_LENGTH=Math.pow(2,53)-1,RawSha256$1=function(){function C(){this.state=Int32Array.from(INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return C.prototype.update=function(E){if(this.finished)throw new Error("Attempted to update an already finished hash.");var w=0,R=E.byteLength;if(this.bytesHashed+=R,this.bytesHashed*8>MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;R>0;)this.buffer[this.bufferLength++]=E[w++],R--,this.bufferLength===BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},C.prototype.digest=function(){if(!this.finished){var E=this.bytesHashed*8,w=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),R=this.bufferLength;if(w.setUint8(this.bufferLength++,128),R%BLOCK_SIZE>=BLOCK_SIZE-8){for(var M=this.bufferLength;M<BLOCK_SIZE;M++)w.setUint8(M,0);this.hashBuffer(),this.bufferLength=0}for(var M=this.bufferLength;M<BLOCK_SIZE-8;M++)w.setUint8(M,0);w.setUint32(BLOCK_SIZE-8,Math.floor(E/4294967296),!0),w.setUint32(BLOCK_SIZE-4,E),this.hashBuffer(),this.finished=!0}for(var x=new Uint8Array(DIGEST_LENGTH),M=0;M<8;M++)x[M*4]=this.state[M]>>>24&255,x[M*4+1]=this.state[M]>>>16&255,x[M*4+2]=this.state[M]>>>8&255,x[M*4+3]=this.state[M]>>>0&255;return x},C.prototype.hashBuffer=function(){for(var E=this,w=E.buffer,R=E.state,M=R[0],x=R[1],S=R[2],T=R[3],_=R[4],D=R[5],Y=R[6],ee=R[7],ie=0;ie<BLOCK_SIZE;ie++){if(ie<16)this.temp[ie]=(w[ie*4]&255)<<24|(w[ie*4+1]&255)<<16|(w[ie*4+2]&255)<<8|w[ie*4+3]&255;else{var ne=this.temp[ie-2],re=(ne>>>17|ne<<15)^(ne>>>19|ne<<13)^ne>>>10;ne=this.temp[ie-15];var oe=(ne>>>7|ne<<25)^(ne>>>18|ne<<14)^ne>>>3;this.temp[ie]=(re+this.temp[ie-7]|0)+(oe+this.temp[ie-16]|0)}var ae=(((_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7))+(_&D^~_&Y)|0)+(ee+(KEY[ie]+this.temp[ie]|0)|0)|0,le=((M>>>2|M<<30)^(M>>>13|M<<19)^(M>>>22|M<<10))+(M&x^M&S^x&S)|0;ee=Y,Y=D,D=_,_=T+ae|0,T=S,S=x,x=M,M=ae+le|0}R[0]+=M,R[1]+=x,R[2]+=S,R[3]+=T,R[4]+=_,R[5]+=D,R[6]+=Y,R[7]+=ee},C}(),Sha256$1=function(){function C(E){this.secret=E,this.hash=new RawSha256$1,this.reset()}return C.prototype.update=function(E){if(!(isEmptyData$1(E)||this.error))try{this.hash.update(convertToBuffer$1(E))}catch(w){this.error=w}},C.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},C.prototype.digest=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(E){return[2,this.digestSync()]})})},C.prototype.reset=function(){if(this.hash=new RawSha256$1,this.secret){this.outer=new RawSha256$1;var E=bufferFromSecret(this.secret),w=new Uint8Array(BLOCK_SIZE);w.set(E);for(var R=0;R<BLOCK_SIZE;R++)E[R]^=54,w[R]^=92;this.hash.update(E),this.outer.update(w);for(var R=0;R<E.byteLength;R++)E[R]=0}},C}();function bufferFromSecret(C){var E=convertToBuffer$1(C);if(E.byteLength>BLOCK_SIZE){var w=new RawSha256$1;w.update(E),E=w.digest()}var R=new Uint8Array(BLOCK_SIZE);return R.set(E),R}var subtleCryptoMethods=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function supportsWebCrypto(C){if(supportsSecureRandom(C)&&typeof C.crypto.subtle=="object"){var E=C.crypto.subtle;return supportsSubtleCrypto(E)}return!1}function supportsSecureRandom(C){if(typeof C=="object"&&typeof C.crypto=="object"){var E=C.crypto.getRandomValues;return typeof E=="function"}return!1}function supportsSubtleCrypto(C){return C&&subtleCryptoMethods.every(function(E){return typeof C[E]=="function"})}var Sha256=function(){function C(E){supportsWebCrypto(locateWindow())?this.hash=new Sha256$2(E):this.hash=new Sha256$1(E)}return C.prototype.update=function(E,w){this.hash.update(convertToBuffer$1(E))},C.prototype.digest=function(){return this.hash.digest()},C.prototype.reset=function(){this.hash.reset()},C}();const BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class Utils{static getFirstMatch(E,w){const R=w.match(E);return R&&R.length>0&&R[1]||""}static getSecondMatch(E,w){const R=w.match(E);return R&&R.length>1&&R[2]||""}static matchAndReturnConst(E,w,R){if(E.test(w))return R}static getWindowsVersionName(E){switch(E){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(E){const w=E.split(".").splice(0,2).map(R=>parseInt(R,10)||0);if(w.push(0),w[0]===10)switch(w[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(E){const w=E.split(".").splice(0,2).map(R=>parseInt(R,10)||0);if(w.push(0),!(w[0]===1&&w[1]<5)){if(w[0]===1&&w[1]<6)return"Cupcake";if(w[0]===1&&w[1]>=6)return"Donut";if(w[0]===2&&w[1]<2)return"Eclair";if(w[0]===2&&w[1]===2)return"Froyo";if(w[0]===2&&w[1]>2)return"Gingerbread";if(w[0]===3)return"Honeycomb";if(w[0]===4&&w[1]<1)return"Ice Cream Sandwich";if(w[0]===4&&w[1]<4)return"Jelly Bean";if(w[0]===4&&w[1]>=4)return"KitKat";if(w[0]===5)return"Lollipop";if(w[0]===6)return"Marshmallow";if(w[0]===7)return"Nougat";if(w[0]===8)return"Oreo";if(w[0]===9)return"Pie"}}static getVersionPrecision(E){return E.split(".").length}static compareVersions(E,w,R=!1){const M=Utils.getVersionPrecision(E),x=Utils.getVersionPrecision(w);let S=Math.max(M,x),T=0;const _=Utils.map([E,w],D=>{const Y=S-Utils.getVersionPrecision(D),ee=D+new Array(Y+1).join(".0");return Utils.map(ee.split("."),ie=>new Array(20-ie.length).join("0")+ie).reverse()});for(R&&(T=S-Math.min(M,x)),S-=1;S>=T;){if(_[0][S]>_[1][S])return 1;if(_[0][S]===_[1][S]){if(S===T)return 0;S-=1}else if(_[0][S]<_[1][S])return-1}}static map(E,w){const R=[];let M;if(Array.prototype.map)return Array.prototype.map.call(E,w);for(M=0;M<E.length;M+=1)R.push(w(E[M]));return R}static find(E,w){let R,M;if(Array.prototype.find)return Array.prototype.find.call(E,w);for(R=0,M=E.length;R<M;R+=1){const x=E[R];if(w(x,R))return x}}static assign(E,...w){const R=E;let M,x;if(Object.assign)return Object.assign(E,...w);for(M=0,x=w.length;M<x;M+=1){const S=w[M];typeof S=="object"&&S!==null&&Object.keys(S).forEach(T=>{R[T]=S[T]})}return E}static getBrowserAlias(E){return BROWSER_ALIASES_MAP[E]}static getBrowserTypeByAlias(E){return BROWSER_MAP[E]||""}}const commonVersionIdentifier=/version\/(\d+(\.?_?\d+)+)/i,browsersList=[{test:[/googlebot/i],describe(C){const E={name:"Googlebot"},w=Utils.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/opera/i],describe(C){const E={name:"Opera"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/opr\/|opios/i],describe(C){const E={name:"Opera"},w=Utils.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/SamsungBrowser/i],describe(C){const E={name:"Samsung Internet for Android"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/Whale/i],describe(C){const E={name:"NAVER Whale Browser"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/MZBrowser/i],describe(C){const E={name:"MZ Browser"},w=Utils.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/focus/i],describe(C){const E={name:"Focus"},w=Utils.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/swing/i],describe(C){const E={name:"Swing"},w=Utils.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/coast/i],describe(C){const E={name:"Opera Coast"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(C){const E={name:"Opera Touch"},w=Utils.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/yabrowser/i],describe(C){const E={name:"Yandex Browser"},w=Utils.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/ucbrowser/i],describe(C){const E={name:"UC Browser"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/Maxthon|mxios/i],describe(C){const E={name:"Maxthon"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/epiphany/i],describe(C){const E={name:"Epiphany"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/puffin/i],describe(C){const E={name:"Puffin"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/sleipnir/i],describe(C){const E={name:"Sleipnir"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/k-meleon/i],describe(C){const E={name:"K-Meleon"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/micromessenger/i],describe(C){const E={name:"WeChat"},w=Utils.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/qqbrowser/i],describe(C){const E={name:/qqbrowserlite/i.test(C)?"QQ Browser Lite":"QQ Browser"},w=Utils.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/msie|trident/i],describe(C){const E={name:"Internet Explorer"},w=Utils.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/\sedg\//i],describe(C){const E={name:"Microsoft Edge"},w=Utils.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/edg([ea]|ios)/i],describe(C){const E={name:"Microsoft Edge"},w=Utils.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/vivaldi/i],describe(C){const E={name:"Vivaldi"},w=Utils.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/seamonkey/i],describe(C){const E={name:"SeaMonkey"},w=Utils.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/sailfish/i],describe(C){const E={name:"Sailfish"},w=Utils.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,C);return w&&(E.version=w),E}},{test:[/silk/i],describe(C){const E={name:"Amazon Silk"},w=Utils.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/phantom/i],describe(C){const E={name:"PhantomJS"},w=Utils.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/slimerjs/i],describe(C){const E={name:"SlimerJS"},w=Utils.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(C){const E={name:"BlackBerry"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/(web|hpw)[o0]s/i],describe(C){const E={name:"WebOS Browser"},w=Utils.getFirstMatch(commonVersionIdentifier,C)||Utils.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/bada/i],describe(C){const E={name:"Bada"},w=Utils.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/tizen/i],describe(C){const E={name:"Tizen"},w=Utils.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/qupzilla/i],describe(C){const E={name:"QupZilla"},w=Utils.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/firefox|iceweasel|fxios/i],describe(C){const E={name:"Firefox"},w=Utils.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/electron/i],describe(C){const E={name:"Electron"},w=Utils.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/MiuiBrowser/i],describe(C){const E={name:"Miui"},w=Utils.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/chromium/i],describe(C){const E={name:"Chromium"},w=Utils.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,C)||Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/chrome|crios|crmo/i],describe(C){const E={name:"Chrome"},w=Utils.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/GSA/i],describe(C){const E={name:"Google Search"},w=Utils.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test(C){const E=!C.test(/like android/i),w=C.test(/android/i);return E&&w},describe(C){const E={name:"Android Browser"},w=Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/playstation 4/i],describe(C){const E={name:"PlayStation 4"},w=Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/safari|applewebkit/i],describe(C){const E={name:"Safari"},w=Utils.getFirstMatch(commonVersionIdentifier,C);return w&&(E.version=w),E}},{test:[/.*/i],describe(C){const E=/^(.*)\/(.*) /,w=/^(.*)\/(.*)[ \t]\((.*)/,R=C.search("\\(")!==-1?w:E;return{name:Utils.getFirstMatch(R,C),version:Utils.getSecondMatch(R,C)}}}],osParsersList=[{test:[/Roku\/DVP/],describe(C){const E=Utils.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,C);return{name:OS_MAP.Roku,version:E}}},{test:[/windows phone/i],describe(C){const E=Utils.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,C);return{name:OS_MAP.WindowsPhone,version:E}}},{test:[/windows /i],describe(C){const E=Utils.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,C),w=Utils.getWindowsVersionName(E);return{name:OS_MAP.Windows,version:E,versionName:w}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(C){const E={name:OS_MAP.iOS},w=Utils.getSecondMatch(/(Version\/)(\d[\d.]+)/,C);return w&&(E.version=w),E}},{test:[/macintosh/i],describe(C){const E=Utils.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,C).replace(/[_\s]/g,"."),w=Utils.getMacOSVersionName(E),R={name:OS_MAP.MacOS,version:E};return w&&(R.versionName=w),R}},{test:[/(ipod|iphone|ipad)/i],describe(C){const E=Utils.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,C).replace(/[_\s]/g,".");return{name:OS_MAP.iOS,version:E}}},{test(C){const E=!C.test(/like android/i),w=C.test(/android/i);return E&&w},describe(C){const E=Utils.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,C),w=Utils.getAndroidVersionName(E),R={name:OS_MAP.Android,version:E};return w&&(R.versionName=w),R}},{test:[/(web|hpw)[o0]s/i],describe(C){const E=Utils.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,C),w={name:OS_MAP.WebOS};return E&&E.length&&(w.version=E),w}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(C){const E=Utils.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,C)||Utils.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,C)||Utils.getFirstMatch(/\bbb(\d+)/i,C);return{name:OS_MAP.BlackBerry,version:E}}},{test:[/bada/i],describe(C){const E=Utils.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,C);return{name:OS_MAP.Bada,version:E}}},{test:[/tizen/i],describe(C){const E=Utils.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,C);return{name:OS_MAP.Tizen,version:E}}},{test:[/linux/i],describe(){return{name:OS_MAP.Linux}}},{test:[/CrOS/],describe(){return{name:OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe(C){const E=Utils.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,C);return{name:OS_MAP.PlayStation4,version:E}}}],platformParsersList=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(C){const E=Utils.getFirstMatch(/(can-l01)/i,C)&&"Nova",w={type:PLATFORMS_MAP.mobile,vendor:"Huawei"};return E&&(w.model=E),w}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:PLATFORMS_MAP.tablet}}},{test(C){const E=C.test(/ipod|iphone/i),w=C.test(/like (ipod|iphone)/i);return E&&!w},describe(C){const E=Utils.getFirstMatch(/(ipod|iphone)/i,C);return{type:PLATFORMS_MAP.mobile,vendor:"Apple",model:E}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:PLATFORMS_MAP.mobile}}},{test(C){return C.getBrowserName(!0)==="blackberry"},describe(){return{type:PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test(C){return C.getBrowserName(!0)==="bada"},describe(){return{type:PLATFORMS_MAP.mobile}}},{test(C){return C.getBrowserName()==="windows phone"},describe(){return{type:PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test(C){const E=Number(String(C.getOSVersion()).split(".")[0]);return C.getOSName(!0)==="android"&&E>=3},describe(){return{type:PLATFORMS_MAP.tablet}}},{test(C){return C.getOSName(!0)==="android"},describe(){return{type:PLATFORMS_MAP.mobile}}},{test(C){return C.getOSName(!0)==="macos"},describe(){return{type:PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test(C){return C.getOSName(!0)==="windows"},describe(){return{type:PLATFORMS_MAP.desktop}}},{test(C){return C.getOSName(!0)==="linux"},describe(){return{type:PLATFORMS_MAP.desktop}}},{test(C){return C.getOSName(!0)==="playstation 4"},describe(){return{type:PLATFORMS_MAP.tv}}},{test(C){return C.getOSName(!0)==="roku"},describe(){return{type:PLATFORMS_MAP.tv}}}],enginesParsersList=[{test(C){return C.getBrowserName(!0)==="microsoft edge"},describe(C){if(/\sedg\//i.test(C))return{name:ENGINE_MAP.Blink};const E=Utils.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,C);return{name:ENGINE_MAP.EdgeHTML,version:E}}},{test:[/trident/i],describe(C){const E={name:ENGINE_MAP.Trident},w=Utils.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test(C){return C.test(/presto/i)},describe(C){const E={name:ENGINE_MAP.Presto},w=Utils.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test(C){const E=C.test(/gecko/i),w=C.test(/like gecko/i);return E&&!w},describe(C){const E={name:ENGINE_MAP.Gecko},w=Utils.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe(C){const E={name:ENGINE_MAP.WebKit},w=Utils.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,C);return w&&(E.version=w),E}}];class Parser{constructor(E,w=!1){if(E==null||E==="")throw new Error("UserAgent parameter can't be empty");this._ua=E,this.parsedResult={},w!==!0&&this.parse()}getUA(){return this._ua}test(E){return E.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const E=Utils.find(browsersList,w=>{if(typeof w.test=="function")return w.test(this);if(w.test instanceof Array)return w.test.some(R=>this.test(R));throw new Error("Browser's test function is not valid")});return E&&(this.parsedResult.browser=E.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(E){return E?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const E=Utils.find(osParsersList,w=>{if(typeof w.test=="function")return w.test(this);if(w.test instanceof Array)return w.test.some(R=>this.test(R));throw new Error("Browser's test function is not valid")});return E&&(this.parsedResult.os=E.describe(this.getUA())),this.parsedResult.os}getOSName(E){const{name:w}=this.getOS();return E?String(w).toLowerCase()||"":w||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(E=!1){const{type:w}=this.getPlatform();return E?String(w).toLowerCase()||"":w||""}parsePlatform(){this.parsedResult.platform={};const E=Utils.find(platformParsersList,w=>{if(typeof w.test=="function")return w.test(this);if(w.test instanceof Array)return w.test.some(R=>this.test(R));throw new Error("Browser's test function is not valid")});return E&&(this.parsedResult.platform=E.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(E){return E?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const E=Utils.find(enginesParsersList,w=>{if(typeof w.test=="function")return w.test(this);if(w.test instanceof Array)return w.test.some(R=>this.test(R));throw new Error("Browser's test function is not valid")});return E&&(this.parsedResult.engine=E.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return Utils.assign({},this.parsedResult)}satisfies(E){const w={};let R=0;const M={};let x=0;if(Object.keys(E).forEach(S=>{const T=E[S];typeof T=="string"?(M[S]=T,x+=1):typeof T=="object"&&(w[S]=T,R+=1)}),R>0){const S=Object.keys(w),T=Utils.find(S,D=>this.isOS(D));if(T){const D=this.satisfies(w[T]);if(D!==void 0)return D}const _=Utils.find(S,D=>this.isPlatform(D));if(_){const D=this.satisfies(w[_]);if(D!==void 0)return D}}if(x>0){const S=Object.keys(M),T=Utils.find(S,_=>this.isBrowser(_,!0));if(T!==void 0)return this.compareVersion(M[T])}}isBrowser(E,w=!1){const R=this.getBrowserName().toLowerCase();let M=E.toLowerCase();const x=Utils.getBrowserTypeByAlias(M);return w&&x&&(M=x.toLowerCase()),M===R}compareVersion(E){let w=[0],R=E,M=!1;const x=this.getBrowserVersion();if(typeof x=="string")return E[0]===">"||E[0]==="<"?(R=E.substr(1),E[1]==="="?(M=!0,R=E.substr(2)):w=[],E[0]===">"?w.push(1):w.push(-1)):E[0]==="="?R=E.substr(1):E[0]==="~"&&(M=!0,R=E.substr(1)),w.indexOf(Utils.compareVersions(x,R,M))>-1}isOS(E){return this.getOSName(!0)===String(E).toLowerCase()}isPlatform(E){return this.getPlatformType(!0)===String(E).toLowerCase()}isEngine(E){return this.getEngineName(!0)===String(E).toLowerCase()}is(E,w=!1){return this.isBrowser(E,w)||this.isOS(E)||this.isPlatform(E)}some(E=[]){return E.some(w=>this.is(w))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class Bowser{static getParser(E,w=!1){if(typeof E!="string")throw new Error("UserAgent should be a string");return new Parser(E,w)}static parse(E){return new Parser(E).getResult()}static get BROWSER_MAP(){return BROWSER_MAP}static get ENGINE_MAP(){return ENGINE_MAP}static get OS_MAP(){return OS_MAP}static get PLATFORMS_MAP(){return PLATFORMS_MAP}}const createDefaultUserAgentProvider=({serviceId:C,clientVersion:E})=>async w=>{var R,M,x,S,T,_;const D=typeof window<"u"&&(R=window==null?void 0:window.navigator)!=null&&R.userAgent?Bowser.parse(window.navigator.userAgent):void 0,Y=[["aws-sdk-js",E],["ua","2.1"],[`os/${((M=D==null?void 0:D.os)==null?void 0:M.name)||"other"}`,(x=D==null?void 0:D.os)==null?void 0:x.version],["lang/js"],["md/browser",`${((S=D==null?void 0:D.browser)==null?void 0:S.name)??"unknown"}_${((T=D==null?void 0:D.browser)==null?void 0:T.version)??"unknown"}`]];C&&Y.push([`api/${C}`,E]);const ee=await((_=w==null?void 0:w.userAgentAppId)==null?void 0:_.call(w));return ee&&Y.push([`app/${ee}`]),Y},invalidProvider=C=>()=>Promise.reject(C),TEXT_ENCODER=typeof TextEncoder=="function"?new TextEncoder:null,calculateBodyLength=C=>{if(typeof C=="string"){if(TEXT_ENCODER)return TEXT_ENCODER.encode(C).byteLength;let E=C.length;for(let w=E-1;w>=0;w--){const R=C.charCodeAt(w);R>127&&R<=2047?E++:R>2047&&R<=65535&&(E+=2),R>=56320&&R<=57343&&w--}return E}else{if(typeof C.byteLength=="number")return C.byteLength;if(typeof C.size=="number")return C.size}throw new Error(`Body Length computation failed for ${C}`)},s="required",t="fn",u="argv",v="ref",a=!0,b="isSet",c="booleanEquals",d="error",e="endpoint",f="tree",g="PartitionResult",h={[s]:!1,type:"String"},i={[s]:!0,default:!1,type:"Boolean"},j={[v]:"Endpoint"},k={[t]:c,[u]:[{[v]:"UseFIPS"},!0]},l={[t]:c,[u]:[{[v]:"UseDualStack"},!0]},m={},n={[t]:"getAttr",[u]:[{[v]:g},"supportsFIPS"]},o={[t]:c,[u]:[!0,{[t]:"getAttr",[u]:[{[v]:g},"supportsDualStack"]}]},p=[k],q=[l],r$1=[{[v]:"Region"}],_data={version:"1.0",parameters:{Region:h,UseDualStack:i,UseFIPS:i,Endpoint:h},rules:[{conditions:[{[t]:b,[u]:[j]}],rules:[{conditions:p,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:d},{conditions:q,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:d},{endpoint:{url:j,properties:m,headers:m},type:e}],type:f},{conditions:[{[t]:b,[u]:r$1}],rules:[{conditions:[{[t]:"aws.partition",[u]:r$1,assign:g}],rules:[{conditions:[k,l],rules:[{conditions:[{[t]:c,[u]:[a,n]},o],rules:[{endpoint:{url:"https://messaging-chime-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:m,headers:m},type:e}],type:f},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:d}],type:f},{conditions:p,rules:[{conditions:[{[t]:c,[u]:[n,a]}],rules:[{endpoint:{url:"https://messaging-chime-fips.{Region}.{PartitionResult#dnsSuffix}",properties:m,headers:m},type:e}],type:f},{error:"FIPS is enabled but this partition does not support FIPS",type:d}],type:f},{conditions:q,rules:[{conditions:[o],rules:[{endpoint:{url:"https://messaging-chime.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:m,headers:m},type:e}],type:f},{error:"DualStack is enabled but this partition does not support DualStack",type:d}],type:f},{endpoint:{url:"https://messaging-chime.{Region}.{PartitionResult#dnsSuffix}",properties:m,headers:m},type:e}],type:f}],type:f},{error:"Invalid Configuration: Missing Region",type:d}]},ruleSet=_data,cache=new EndpointCache({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),defaultEndpointResolver=(C,E={})=>cache.get(C,()=>resolveEndpoint(ruleSet,{endpointParams:C,logger:E.logger}));customEndpointFunctions.aws=awsEndpointFunctions;const getRuntimeConfig$1=C=>({apiVersion:"2021-05-15",base64Decoder:(C==null?void 0:C.base64Decoder)??fromBase64,base64Encoder:(C==null?void 0:C.base64Encoder)??toBase64,disableHostPrefix:(C==null?void 0:C.disableHostPrefix)??!1,endpointProvider:(C==null?void 0:C.endpointProvider)??defaultEndpointResolver,extensions:(C==null?void 0:C.extensions)??[],httpAuthSchemeProvider:(C==null?void 0:C.httpAuthSchemeProvider)??defaultChimeSDKMessagingHttpAuthSchemeProvider,httpAuthSchemes:(C==null?void 0:C.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:E=>E.getIdentityProvider("aws.auth#sigv4"),signer:new AwsSdkSigV4Signer}],logger:(C==null?void 0:C.logger)??new NoOpLogger$1,serviceId:(C==null?void 0:C.serviceId)??"Chime SDK Messaging",urlParser:(C==null?void 0:C.urlParser)??parseUrl,utf8Decoder:(C==null?void 0:C.utf8Decoder)??fromUtf8$5,utf8Encoder:(C==null?void 0:C.utf8Encoder)??toUtf8$3}),DEFAULTS_MODE_OPTIONS=["in-region","cross-region","mobile","standard","legacy"],resolveDefaultsModeConfig=({defaultsMode:C}={})=>memoize(async()=>{const E=typeof C=="function"?await C():C;switch(E==null?void 0:E.toLowerCase()){case"auto":return Promise.resolve(isMobileBrowser()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(E==null?void 0:E.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${DEFAULTS_MODE_OPTIONS.join(", ")}, got ${E}`)}}),isMobileBrowser=()=>{var C,E;const w=typeof window<"u"&&(C=window==null?void 0:window.navigator)!=null&&C.userAgent?Bowser.parse(window.navigator.userAgent):void 0,R=(E=w==null?void 0:w.platform)==null?void 0:E.type;return R==="tablet"||R==="mobile"},getRuntimeConfig=C=>{const E=resolveDefaultsModeConfig(C),w=()=>E().then(loadConfigsForDefaultMode),R=getRuntimeConfig$1(C);return{...R,...C,runtime:"browser",defaultsMode:E,bodyLengthChecker:(C==null?void 0:C.bodyLengthChecker)??calculateBodyLength,credentialDefaultProvider:(C==null?void 0:C.credentialDefaultProvider)??(M=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(C==null?void 0:C.defaultUserAgentProvider)??createDefaultUserAgentProvider({serviceId:R.serviceId,clientVersion:packageInfo.version}),maxAttempts:(C==null?void 0:C.maxAttempts)??DEFAULT_MAX_ATTEMPTS,region:(C==null?void 0:C.region)??invalidProvider("Region is missing"),requestHandler:FetchHttpHandler.create((C==null?void 0:C.requestHandler)??w),retryMode:(C==null?void 0:C.retryMode)??(async()=>(await w()).retryMode||DEFAULT_RETRY_MODE),sha256:(C==null?void 0:C.sha256)??Sha256,streamCollector:(C==null?void 0:C.streamCollector)??streamCollector,useDualstackEndpoint:(C==null?void 0:C.useDualstackEndpoint)??(()=>Promise.resolve(DEFAULT_USE_DUALSTACK_ENDPOINT)),useFipsEndpoint:(C==null?void 0:C.useFipsEndpoint)??(()=>Promise.resolve(DEFAULT_USE_FIPS_ENDPOINT))}},getAwsRegionExtensionConfiguration=C=>{let E=async()=>{if(C.region===void 0)throw new Error("Region is missing from runtimeConfig");const w=C.region;return typeof w=="string"?w:w()};return{setRegion(w){E=w},region(){return E}}},resolveAwsRegionExtensionConfiguration=C=>({region:C.region()}),getHttpAuthExtensionConfiguration=C=>{const E=C.httpAuthSchemes;let w=C.httpAuthSchemeProvider,R=C.credentials;return{setHttpAuthScheme(M){const x=E.findIndex(S=>S.schemeId===M.schemeId);x===-1?E.push(M):E.splice(x,1,M)},httpAuthSchemes(){return E},setHttpAuthSchemeProvider(M){w=M},httpAuthSchemeProvider(){return w},setCredentials(M){R=M},credentials(){return R}}},resolveHttpAuthRuntimeConfig=C=>({httpAuthSchemes:C.httpAuthSchemes(),httpAuthSchemeProvider:C.httpAuthSchemeProvider(),credentials:C.credentials()}),asPartial=C=>C,resolveRuntimeExtensions=(C,E)=>{const w={...asPartial(getAwsRegionExtensionConfiguration(C)),...asPartial(getDefaultExtensionConfiguration(C)),...asPartial(getHttpHandlerExtensionConfiguration(C)),...asPartial(getHttpAuthExtensionConfiguration(C))};return E.forEach(R=>R.configure(w)),{...C,...resolveAwsRegionExtensionConfiguration(w),...resolveDefaultRuntimeConfig(w),...resolveHttpHandlerRuntimeConfig(w),...resolveHttpAuthRuntimeConfig(w)}};class ChimeSDKMessagingClient extends Client{constructor(...[E]){const w=getRuntimeConfig(E||{}),R=resolveClientEndpointParameters(w),M=resolveUserAgentConfig(R),x=resolveRetryConfig(M),S=resolveRegionConfig(x),T=S,_=resolveEndpointConfig(T),D=resolveHttpAuthSchemeConfig(_),Y=resolveRuntimeExtensions(D,(E==null?void 0:E.extensions)||[]);super(Y),this.config=Y,this.middlewareStack.use(getUserAgentPlugin(this.config)),this.middlewareStack.use(getRetryPlugin(this.config)),this.middlewareStack.use(getContentLengthPlugin(this.config)),this.middlewareStack.use(getHostHeaderPlugin(this.config)),this.middlewareStack.use(getLoggerPlugin(this.config)),this.middlewareStack.use(getRecursionDetectionPlugin(this.config)),this.middlewareStack.use(getHttpAuthSchemeEndpointRuleSetPlugin(this.config,{httpAuthSchemeParametersProvider:defaultChimeSDKMessagingHttpAuthSchemeParametersProvider,identityProviderConfigProvider:async ee=>new DefaultIdentityProviderConfig({"aws.auth#sigv4":ee.credentials})})),this.middlewareStack.use(getHttpSigningPlugin(this.config))}destroy(){super.destroy()}}class ChimeSDKMessagingServiceException extends ServiceException{constructor(E){super(E),Object.setPrototypeOf(this,ChimeSDKMessagingServiceException.prototype)}}const AllowNotifications={ALL:"ALL",FILTERED:"FILTERED",NONE:"NONE"},ChannelMembershipType={DEFAULT:"DEFAULT",HIDDEN:"HIDDEN"},ErrorCode={AccessDenied:"AccessDenied",BadRequest:"BadRequest",Conflict:"Conflict",Forbidden:"Forbidden",NotFound:"NotFound",PhoneNumberAssociationsExist:"PhoneNumberAssociationsExist",PreconditionFailed:"PreconditionFailed",ResourceLimitExceeded:"ResourceLimitExceeded",ServiceFailure:"ServiceFailure",ServiceUnavailable:"ServiceUnavailable",Throttled:"Throttled",Throttling:"Throttling",Unauthorized:"Unauthorized",Unprocessable:"Unprocessable",VoiceConnectorGroupAssociationsExist:"VoiceConnectorGroupAssociationsExist"};class BadRequestException extends ChimeSDKMessagingServiceException{constructor(E){super({name:"BadRequestException",$fault:"client",...E}),this.name="BadRequestException",this.$fault="client",Object.setPrototypeOf(this,BadRequestException.prototype),this.Code=E.Code,this.Message=E.Message}}class ConflictException extends ChimeSDKMessagingServiceException{constructor(E){super({name:"ConflictException",$fault:"client",...E}),this.name="ConflictException",this.$fault="client",Object.setPrototypeOf(this,ConflictException.prototype),this.Code=E.Code,this.Message=E.Message}}class ForbiddenException extends ChimeSDKMessagingServiceException{constructor(E){super({name:"ForbiddenException",$fault:"client",...E}),this.name="ForbiddenException",this.$fault="client",Object.setPrototypeOf(this,ForbiddenException.prototype),this.Code=E.Code,this.Message=E.Message}}class NotFoundException extends ChimeSDKMessagingServiceException{constructor(E){super({name:"NotFoundException",$fault:"client",...E}),this.name="NotFoundException",this.$fault="client",Object.setPrototypeOf(this,NotFoundException.prototype),this.Code=E.Code,this.Message=E.Message}}class ServiceFailureException extends ChimeSDKMessagingServiceException{constructor(E){super({name:"ServiceFailureException",$fault:"server",...E}),this.name="ServiceFailureException",this.$fault="server",Object.setPrototypeOf(this,ServiceFailureException.prototype),this.Code=E.Code,this.Message=E.Message}}class ServiceUnavailableException extends ChimeSDKMessagingServiceException{constructor(E){super({name:"ServiceUnavailableException",$fault:"server",...E}),this.name="ServiceUnavailableException",this.$fault="server",Object.setPrototypeOf(this,ServiceUnavailableException.prototype),this.Code=E.Code,this.Message=E.Message}}class ThrottledClientException extends ChimeSDKMessagingServiceException{constructor(E){super({name:"ThrottledClientException",$fault:"client",...E}),this.name="ThrottledClientException",this.$fault="client",Object.setPrototypeOf(this,ThrottledClientException.prototype),this.Code=E.Code,this.Message=E.Message}}class UnauthorizedClientException extends ChimeSDKMessagingServiceException{constructor(E){super({name:"UnauthorizedClientException",$fault:"client",...E}),this.name="UnauthorizedClientException",this.$fault="client",Object.setPrototypeOf(this,UnauthorizedClientException.prototype),this.Code=E.Code,this.Message=E.Message}}class ResourceLimitExceededException extends ChimeSDKMessagingServiceException{constructor(E){super({name:"ResourceLimitExceededException",$fault:"client",...E}),this.name="ResourceLimitExceededException",this.$fault="client",Object.setPrototypeOf(this,ResourceLimitExceededException.prototype),this.Code=E.Code,this.Message=E.Message}}const ExpirationCriterion={CREATED_TIMESTAMP:"CREATED_TIMESTAMP",LAST_MESSAGE_TIMESTAMP:"LAST_MESSAGE_TIMESTAMP"},ChannelMode={RESTRICTED:"RESTRICTED",UNRESTRICTED:"UNRESTRICTED"},ChannelPrivacy={PRIVATE:"PRIVATE",PUBLIC:"PUBLIC"},InvocationType={ASYNC:"ASYNC"},FallbackAction={ABORT:"ABORT",CONTINUE:"CONTINUE"},PushNotificationType={DEFAULT:"DEFAULT",VOIP:"VOIP"},ChannelMessagePersistenceType={NON_PERSISTENT:"NON_PERSISTENT",PERSISTENT:"PERSISTENT"},ChannelMessageStatus={DENIED:"DENIED",FAILED:"FAILED",PENDING:"PENDING",SENT:"SENT"},ChannelMessageType={CONTROL:"CONTROL",STANDARD:"STANDARD"},MessagingDataType={Channel:"Channel",ChannelMessage:"ChannelMessage"},SortOrder={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},SearchFieldKey={MEMBERS:"MEMBERS"},SearchFieldOperator={EQUALS:"EQUALS",INCLUDES:"INCLUDES"},IdentityFilterSensitiveLog=C=>({...C,...C.Name&&{Name:SENSITIVE_STRING}}),BatchChannelMembershipsFilterSensitiveLog=C=>({...C,...C.InvitedBy&&{InvitedBy:IdentityFilterSensitiveLog(C.InvitedBy)},...C.Members&&{Members:C.Members.map(E=>IdentityFilterSensitiveLog(E))}}),BatchCreateChannelMembershipResponseFilterSensitiveLog=C=>({...C,...C.BatchChannelMemberships&&{BatchChannelMemberships:BatchChannelMembershipsFilterSensitiveLog(C.BatchChannelMemberships)}}),ChannelFilterSensitiveLog=C=>({...C,...C.Name&&{Name:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING},...C.CreatedBy&&{CreatedBy:IdentityFilterSensitiveLog(C.CreatedBy)}}),ChannelAssociatedWithFlowSummaryFilterSensitiveLog=C=>({...C,...C.Name&&{Name:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING}}),ChannelBanFilterSensitiveLog=C=>({...C,...C.Member&&{Member:IdentityFilterSensitiveLog(C.Member)},...C.CreatedBy&&{CreatedBy:IdentityFilterSensitiveLog(C.CreatedBy)}}),ChannelBanSummaryFilterSensitiveLog=C=>({...C,...C.Member&&{Member:IdentityFilterSensitiveLog(C.Member)}}),ProcessorFilterSensitiveLog=C=>({...C,...C.Name&&{Name:SENSITIVE_STRING}}),ChannelFlowFilterSensitiveLog=C=>({...C,...C.Processors&&{Processors:C.Processors.map(E=>ProcessorFilterSensitiveLog(E))},...C.Name&&{Name:SENSITIVE_STRING}}),MessageAttributeValueFilterSensitiveLog=C=>({...C,...C.StringValues&&{StringValues:SENSITIVE_STRING}}),PushNotificationConfigurationFilterSensitiveLog=C=>({...C,...C.Title&&{Title:SENSITIVE_STRING},...C.Body&&{Body:SENSITIVE_STRING}}),ChannelMessageCallbackFilterSensitiveLog=C=>({...C,...C.Content&&{Content:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING},...C.PushNotification&&{PushNotification:PushNotificationConfigurationFilterSensitiveLog(C.PushNotification)},...C.MessageAttributes&&{MessageAttributes:Object.entries(C.MessageAttributes).reduce((E,[w,R])=>(E[w]=MessageAttributeValueFilterSensitiveLog(R),E),{})},...C.ContentType&&{ContentType:SENSITIVE_STRING}}),ChannelFlowCallbackRequestFilterSensitiveLog=C=>({...C,...C.ChannelMessage&&{ChannelMessage:ChannelMessageCallbackFilterSensitiveLog(C.ChannelMessage)}}),ChannelFlowSummaryFilterSensitiveLog=C=>({...C,...C.Name&&{Name:SENSITIVE_STRING},...C.Processors&&{Processors:C.Processors.map(E=>ProcessorFilterSensitiveLog(E))}}),ChannelMembershipFilterSensitiveLog=C=>({...C,...C.InvitedBy&&{InvitedBy:IdentityFilterSensitiveLog(C.InvitedBy)},...C.Member&&{Member:IdentityFilterSensitiveLog(C.Member)}}),ChannelSummaryFilterSensitiveLog=C=>({...C,...C.Name&&{Name:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING}}),ChannelMembershipForAppInstanceUserSummaryFilterSensitiveLog=C=>({...C,...C.ChannelSummary&&{ChannelSummary:ChannelSummaryFilterSensitiveLog(C.ChannelSummary)}}),PushNotificationPreferencesFilterSensitiveLog=C=>({...C,...C.FilterRule&&{FilterRule:SENSITIVE_STRING}}),ChannelMembershipPreferencesFilterSensitiveLog=C=>({...C,...C.PushNotifications&&{PushNotifications:PushNotificationPreferencesFilterSensitiveLog(C.PushNotifications)}}),ChannelMembershipSummaryFilterSensitiveLog=C=>({...C,...C.Member&&{Member:IdentityFilterSensitiveLog(C.Member)}}),ChannelMessageFilterSensitiveLog=C=>({...C,...C.Content&&{Content:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING},...C.Sender&&{Sender:IdentityFilterSensitiveLog(C.Sender)},...C.MessageAttributes&&{MessageAttributes:Object.entries(C.MessageAttributes).reduce((E,[w,R])=>(E[w]=MessageAttributeValueFilterSensitiveLog(R),E),{})},...C.ContentType&&{ContentType:SENSITIVE_STRING}}),ChannelMessageSummaryFilterSensitiveLog=C=>({...C,...C.Content&&{Content:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING},...C.Sender&&{Sender:IdentityFilterSensitiveLog(C.Sender)},...C.MessageAttributes&&{MessageAttributes:Object.entries(C.MessageAttributes).reduce((E,[w,R])=>(E[w]=MessageAttributeValueFilterSensitiveLog(R),E),{})},...C.ContentType&&{ContentType:SENSITIVE_STRING}}),ChannelModeratedByAppInstanceUserSummaryFilterSensitiveLog=C=>({...C,...C.ChannelSummary&&{ChannelSummary:ChannelSummaryFilterSensitiveLog(C.ChannelSummary)}}),ChannelModeratorFilterSensitiveLog=C=>({...C,...C.Moderator&&{Moderator:IdentityFilterSensitiveLog(C.Moderator)},...C.CreatedBy&&{CreatedBy:IdentityFilterSensitiveLog(C.CreatedBy)}}),ChannelModeratorSummaryFilterSensitiveLog=C=>({...C,...C.Moderator&&{Moderator:IdentityFilterSensitiveLog(C.Moderator)}}),TagFilterSensitiveLog=C=>({...C,...C.Key&&{Key:SENSITIVE_STRING},...C.Value&&{Value:SENSITIVE_STRING}}),CreateChannelRequestFilterSensitiveLog=C=>({...C,...C.Name&&{Name:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING},...C.ClientRequestToken&&{ClientRequestToken:SENSITIVE_STRING},...C.Tags&&{Tags:C.Tags.map(E=>TagFilterSensitiveLog(E))},...C.ChannelId&&{ChannelId:SENSITIVE_STRING}}),CreateChannelBanResponseFilterSensitiveLog=C=>({...C,...C.Member&&{Member:IdentityFilterSensitiveLog(C.Member)}}),CreateChannelFlowRequestFilterSensitiveLog=C=>({...C,...C.Processors&&{Processors:C.Processors.map(E=>ProcessorFilterSensitiveLog(E))},...C.Name&&{Name:SENSITIVE_STRING},...C.Tags&&{Tags:C.Tags.map(E=>TagFilterSensitiveLog(E))},...C.ClientRequestToken&&{ClientRequestToken:SENSITIVE_STRING}}),CreateChannelMembershipResponseFilterSensitiveLog=C=>({...C,...C.Member&&{Member:IdentityFilterSensitiveLog(C.Member)}}),CreateChannelModeratorResponseFilterSensitiveLog=C=>({...C,...C.ChannelModerator&&{ChannelModerator:IdentityFilterSensitiveLog(C.ChannelModerator)}}),DescribeChannelResponseFilterSensitiveLog=C=>({...C,...C.Channel&&{Channel:ChannelFilterSensitiveLog(C.Channel)}}),DescribeChannelBanResponseFilterSensitiveLog=C=>({...C,...C.ChannelBan&&{ChannelBan:ChannelBanFilterSensitiveLog(C.ChannelBan)}}),DescribeChannelFlowResponseFilterSensitiveLog=C=>({...C,...C.ChannelFlow&&{ChannelFlow:ChannelFlowFilterSensitiveLog(C.ChannelFlow)}}),DescribeChannelMembershipResponseFilterSensitiveLog=C=>({...C,...C.ChannelMembership&&{ChannelMembership:ChannelMembershipFilterSensitiveLog(C.ChannelMembership)}}),DescribeChannelMembershipForAppInstanceUserResponseFilterSensitiveLog=C=>({...C,...C.ChannelMembership&&{ChannelMembership:ChannelMembershipForAppInstanceUserSummaryFilterSensitiveLog(C.ChannelMembership)}}),DescribeChannelModeratedByAppInstanceUserResponseFilterSensitiveLog=C=>({...C,...C.Channel&&{Channel:ChannelModeratedByAppInstanceUserSummaryFilterSensitiveLog(C.Channel)}}),DescribeChannelModeratorResponseFilterSensitiveLog=C=>({...C,...C.ChannelModerator&&{ChannelModerator:ChannelModeratorFilterSensitiveLog(C.ChannelModerator)}}),GetChannelMembershipPreferencesResponseFilterSensitiveLog=C=>({...C,...C.Member&&{Member:IdentityFilterSensitiveLog(C.Member)},...C.Preferences&&{Preferences:ChannelMembershipPreferencesFilterSensitiveLog(C.Preferences)}}),GetChannelMessageResponseFilterSensitiveLog=C=>({...C,...C.ChannelMessage&&{ChannelMessage:ChannelMessageFilterSensitiveLog(C.ChannelMessage)}}),ListChannelBansRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelBansResponseFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING},...C.ChannelBans&&{ChannelBans:C.ChannelBans.map(E=>ChannelBanSummaryFilterSensitiveLog(E))}}),ListChannelFlowsRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelFlowsResponseFilterSensitiveLog=C=>({...C,...C.ChannelFlows&&{ChannelFlows:C.ChannelFlows.map(E=>ChannelFlowSummaryFilterSensitiveLog(E))},...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelMembershipsRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelMembershipsResponseFilterSensitiveLog=C=>({...C,...C.ChannelMemberships&&{ChannelMemberships:C.ChannelMemberships.map(E=>ChannelMembershipSummaryFilterSensitiveLog(E))},...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelMembershipsForAppInstanceUserRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelMembershipsForAppInstanceUserResponseFilterSensitiveLog=C=>({...C,...C.ChannelMemberships&&{ChannelMemberships:C.ChannelMemberships.map(E=>ChannelMembershipForAppInstanceUserSummaryFilterSensitiveLog(E))},...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelMessagesRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelMessagesResponseFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING},...C.ChannelMessages&&{ChannelMessages:C.ChannelMessages.map(E=>ChannelMessageSummaryFilterSensitiveLog(E))}}),ListChannelModeratorsRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelModeratorsResponseFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING},...C.ChannelModerators&&{ChannelModerators:C.ChannelModerators.map(E=>ChannelModeratorSummaryFilterSensitiveLog(E))}}),ListChannelsRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelsResponseFilterSensitiveLog=C=>({...C,...C.Channels&&{Channels:C.Channels.map(E=>ChannelSummaryFilterSensitiveLog(E))},...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelsAssociatedWithChannelFlowRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelsAssociatedWithChannelFlowResponseFilterSensitiveLog=C=>({...C,...C.Channels&&{Channels:C.Channels.map(E=>ChannelAssociatedWithFlowSummaryFilterSensitiveLog(E))},...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelsModeratedByAppInstanceUserRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListChannelsModeratedByAppInstanceUserResponseFilterSensitiveLog=C=>({...C,...C.Channels&&{Channels:C.Channels.map(E=>ChannelModeratedByAppInstanceUserSummaryFilterSensitiveLog(E))},...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListSubChannelsRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListSubChannelsResponseFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),ListTagsForResourceResponseFilterSensitiveLog=C=>({...C,...C.Tags&&{Tags:C.Tags.map(E=>TagFilterSensitiveLog(E))}}),PutChannelMembershipPreferencesRequestFilterSensitiveLog=C=>({...C,...C.Preferences&&{Preferences:ChannelMembershipPreferencesFilterSensitiveLog(C.Preferences)}}),PutChannelMembershipPreferencesResponseFilterSensitiveLog=C=>({...C,...C.Member&&{Member:IdentityFilterSensitiveLog(C.Member)},...C.Preferences&&{Preferences:ChannelMembershipPreferencesFilterSensitiveLog(C.Preferences)}}),SearchChannelsRequestFilterSensitiveLog=C=>({...C,...C.NextToken&&{NextToken:SENSITIVE_STRING}}),SearchChannelsResponseFilterSensitiveLog=C=>({...C,...C.Channels&&{Channels:C.Channels.map(E=>ChannelSummaryFilterSensitiveLog(E))},...C.NextToken&&{NextToken:SENSITIVE_STRING}}),SendChannelMessageRequestFilterSensitiveLog=C=>({...C,...C.Content&&{Content:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING},...C.ClientRequestToken&&{ClientRequestToken:SENSITIVE_STRING},...C.PushNotification&&{PushNotification:PushNotificationConfigurationFilterSensitiveLog(C.PushNotification)},...C.MessageAttributes&&{MessageAttributes:Object.entries(C.MessageAttributes).reduce((E,[w,R])=>(E[w]=MessageAttributeValueFilterSensitiveLog(R),E),{})},...C.ContentType&&{ContentType:SENSITIVE_STRING}}),TagResourceRequestFilterSensitiveLog=C=>({...C,...C.Tags&&{Tags:C.Tags.map(E=>TagFilterSensitiveLog(E))}}),UntagResourceRequestFilterSensitiveLog=C=>({...C,...C.TagKeys&&{TagKeys:SENSITIVE_STRING}}),UpdateChannelRequestFilterSensitiveLog=C=>({...C,...C.Name&&{Name:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING}}),UpdateChannelFlowRequestFilterSensitiveLog=C=>({...C,...C.Processors&&{Processors:C.Processors.map(E=>ProcessorFilterSensitiveLog(E))},...C.Name&&{Name:SENSITIVE_STRING}}),UpdateChannelMessageRequestFilterSensitiveLog=C=>({...C,...C.Content&&{Content:SENSITIVE_STRING},...C.Metadata&&{Metadata:SENSITIVE_STRING},...C.ContentType&&{ContentType:SENSITIVE_STRING}}),se_AssociateChannelFlowCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/channel-flow"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);let M;return M=JSON.stringify(take(C,{ChannelFlowArn:[]})),w.m("PUT").h(R).b(M),w.build()},se_BatchCreateChannelMembershipCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/memberships"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);const M=map({[_o$1]:[,"batch-create"]});let x;return x=JSON.stringify(take(C,{MemberArns:S=>_json(S),SubChannelId:[],Type:[]})),w.m("POST").h(R).q(M).b(x),w.build()},se_ChannelFlowCallbackCommand=async(C,E)=>{const w=requestBuilder(C,E),R={"content-type":"application/json"};w.bp("/channels/{ChannelArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);const M=map({[_o$1]:[,"channel-flow-callback"]});let x;return x=JSON.stringify(take(C,{CallbackId:[!0,S=>S??v4()],ChannelMessage:S=>_json(S),DeleteResource:[]})),w.m("POST").h(R).q(M).b(x),w.build()},se_CreateChannelCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels");let M;return M=JSON.stringify(take(C,{AppInstanceArn:[],ChannelId:[],ClientRequestToken:[!0,x=>x??v4()],ElasticChannelConfiguration:x=>_json(x),ExpirationSettings:x=>_json(x),MemberArns:x=>_json(x),Metadata:[],Mode:[],ModeratorArns:x=>_json(x),Name:[],Privacy:[],Tags:x=>_json(x)})),w.m("POST").h(R).b(M),w.build()},se_CreateChannelBanCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/bans"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);let M;return M=JSON.stringify(take(C,{MemberArn:[]})),w.m("POST").h(R).b(M),w.build()},se_CreateChannelFlowCommand=async(C,E)=>{const w=requestBuilder(C,E),R={"content-type":"application/json"};w.bp("/channel-flows");let M;return M=JSON.stringify(take(C,{AppInstanceArn:[],ClientRequestToken:[!0,x=>x??v4()],Name:[],Processors:x=>_json(x),Tags:x=>_json(x)})),w.m("POST").h(R).b(M),w.build()},se_CreateChannelMembershipCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/memberships"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);let M;return M=JSON.stringify(take(C,{MemberArn:[],SubChannelId:[],Type:[]})),w.m("POST").h(R).b(M),w.build()},se_CreateChannelModeratorCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/moderators"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);let M;return M=JSON.stringify(take(C,{ChannelModeratorArn:[]})),w.m("POST").h(R).b(M),w.build()},se_DeleteChannelCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});return w.bp("/channels/{ChannelArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.m("DELETE").h(R).b(void 0),w.build()},se_DeleteChannelBanCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});return w.bp("/channels/{ChannelArn}/bans/{MemberArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MemberArn",()=>C.MemberArn,"{MemberArn}",!1),w.m("DELETE").h(R).b(void 0),w.build()},se_DeleteChannelFlowCommand=async(C,E)=>{const w=requestBuilder(C,E),R={};return w.bp("/channel-flows/{ChannelFlowArn}"),w.p("ChannelFlowArn",()=>C.ChannelFlowArn,"{ChannelFlowArn}",!1),w.m("DELETE").h(R).b(void 0),w.build()},se_DeleteChannelMembershipCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/memberships/{MemberArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MemberArn",()=>C.MemberArn,"{MemberArn}",!1);const M=map({[_sci]:[,C[_SCI]]});return w.m("DELETE").h(R).q(M).b(void 0),w.build()},se_DeleteChannelMessageCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/messages/{MessageId}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MessageId",()=>C.MessageId,"{MessageId}",!1);const M=map({[_sci]:[,C[_SCI]]});return w.m("DELETE").h(R).q(M).b(void 0),w.build()},se_DeleteChannelModeratorCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});return w.bp("/channels/{ChannelArn}/moderators/{ChannelModeratorArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("ChannelModeratorArn",()=>C.ChannelModeratorArn,"{ChannelModeratorArn}",!1),w.m("DELETE").h(R).b(void 0),w.build()},se_DeleteMessagingStreamingConfigurationsCommand=async(C,E)=>{const w=requestBuilder(C,E),R={};return w.bp("/app-instances/{AppInstanceArn}/streaming-configurations"),w.p("AppInstanceArn",()=>C.AppInstanceArn,"{AppInstanceArn}",!1),w.m("DELETE").h(R).b(void 0),w.build()},se_DescribeChannelCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});return w.bp("/channels/{ChannelArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.m("GET").h(R).b(void 0),w.build()},se_DescribeChannelBanCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});return w.bp("/channels/{ChannelArn}/bans/{MemberArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MemberArn",()=>C.MemberArn,"{MemberArn}",!1),w.m("GET").h(R).b(void 0),w.build()},se_DescribeChannelFlowCommand=async(C,E)=>{const w=requestBuilder(C,E),R={};return w.bp("/channel-flows/{ChannelFlowArn}"),w.p("ChannelFlowArn",()=>C.ChannelFlowArn,"{ChannelFlowArn}",!1),w.m("GET").h(R).b(void 0),w.build()},se_DescribeChannelMembershipCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/memberships/{MemberArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MemberArn",()=>C.MemberArn,"{MemberArn}",!1);const M=map({[_sci]:[,C[_SCI]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_DescribeChannelMembershipForAppInstanceUserCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);const M=map({[_s]:[,"app-instance-user-membership"],[_aiua]:[,expectNonNull(C[_AIUA],"AppInstanceUserArn")]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_DescribeChannelModeratedByAppInstanceUserCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);const M=map({[_s]:[,"app-instance-user-moderated-channel"],[_aiua]:[,expectNonNull(C[_AIUA],"AppInstanceUserArn")]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_DescribeChannelModeratorCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});return w.bp("/channels/{ChannelArn}/moderators/{ChannelModeratorArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("ChannelModeratorArn",()=>C.ChannelModeratorArn,"{ChannelModeratorArn}",!1),w.m("GET").h(R).b(void 0),w.build()},se_DisassociateChannelFlowCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});return w.bp("/channels/{ChannelArn}/channel-flow/{ChannelFlowArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("ChannelFlowArn",()=>C.ChannelFlowArn,"{ChannelFlowArn}",!1),w.m("DELETE").h(R).b(void 0),w.build()},se_GetChannelMembershipPreferencesCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});return w.bp("/channels/{ChannelArn}/memberships/{MemberArn}/preferences"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MemberArn",()=>C.MemberArn,"{MemberArn}",!1),w.m("GET").h(R).b(void 0),w.build()},se_GetChannelMessageCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/messages/{MessageId}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MessageId",()=>C.MessageId,"{MessageId}",!1);const M=map({[_sci]:[,C[_SCI]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_GetChannelMessageStatusCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/messages/{MessageId}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MessageId",()=>C.MessageId,"{MessageId}",!1);const M=map({[_s]:[,"message-status"],[_sci]:[,C[_SCI]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_GetMessagingSessionEndpointCommand=async(C,E)=>{const w=requestBuilder(C,E),R={};return w.bp("/endpoints/messaging-session"),w.m("GET").h(R).b(void 0),w.build()},se_GetMessagingStreamingConfigurationsCommand=async(C,E)=>{const w=requestBuilder(C,E),R={};return w.bp("/app-instances/{AppInstanceArn}/streaming-configurations"),w.p("AppInstanceArn",()=>C.AppInstanceArn,"{AppInstanceArn}",!1),w.m("GET").h(R).b(void 0),w.build()},se_ListChannelBansCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/bans"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);const M=map({[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListChannelFlowsCommand=async(C,E)=>{const w=requestBuilder(C,E),R={};w.bp("/channel-flows");const M=map({[_aia]:[,expectNonNull(C[_AIA],"AppInstanceArn")],[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListChannelMembershipsCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/memberships"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);const M=map({[_t$1]:[,C[_T]],[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]],[_sci]:[,C[_SCI]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListChannelMembershipsForAppInstanceUserCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels");const M=map({[_s]:[,"app-instance-user-memberships"],[_aiua]:[,C[_AIUA]],[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListChannelMessagesCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/messages"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);const M=map({[_so]:[,C[_SO]],[_nb]:[()=>C.NotBefore!==void 0,()=>serializeDateTime(C[_NB]).toString()],[_na]:[()=>C.NotAfter!==void 0,()=>serializeDateTime(C[_NA]).toString()],[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]],[_sci]:[,C[_SCI]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListChannelModeratorsCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/moderators"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);const M=map({[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListChannelsCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels");const M=map({[_aia]:[,expectNonNull(C[_AIA],"AppInstanceArn")],[_p]:[,C[_P]],[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListChannelsAssociatedWithChannelFlowCommand=async(C,E)=>{const w=requestBuilder(C,E),R={};w.bp("/channels");const M=map({[_s]:[,"channel-flow-associations"],[_cfa]:[,expectNonNull(C[_CFA],"ChannelFlowArn")],[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListChannelsModeratedByAppInstanceUserCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels");const M=map({[_s]:[,"app-instance-user-moderated-channels"],[_aiua]:[,C[_AIUA]],[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListSubChannelsCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/subchannels"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);const M=map({[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_ListTagsForResourceCommand=async(C,E)=>{const w=requestBuilder(C,E),R={};w.bp("/tags");const M=map({[_a]:[,expectNonNull(C[_RARN],"ResourceARN")]});return w.m("GET").h(R).q(M).b(void 0),w.build()},se_PutChannelExpirationSettingsCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/expiration-settings"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);let M;return M=JSON.stringify(take(C,{ExpirationSettings:x=>_json(x)})),w.m("PUT").h(R).b(M),w.build()},se_PutChannelMembershipPreferencesCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/memberships/{MemberArn}/preferences"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MemberArn",()=>C.MemberArn,"{MemberArn}",!1);let M;return M=JSON.stringify(take(C,{Preferences:x=>_json(x)})),w.m("PUT").h(R).b(M),w.build()},se_PutMessagingStreamingConfigurationsCommand=async(C,E)=>{const w=requestBuilder(C,E),R={"content-type":"application/json"};w.bp("/app-instances/{AppInstanceArn}/streaming-configurations"),w.p("AppInstanceArn",()=>C.AppInstanceArn,"{AppInstanceArn}",!1);let M;return M=JSON.stringify(take(C,{StreamingConfigurations:x=>_json(x)})),w.m("PUT").h(R).b(M),w.build()},se_RedactChannelMessageCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/messages/{MessageId}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MessageId",()=>C.MessageId,"{MessageId}",!1);const M=map({[_o$1]:[,"redact"]});let x;return x=JSON.stringify(take(C,{SubChannelId:[]})),w.m("POST").h(R).q(M).b(x),w.build()},se_SearchChannelsCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels");const M=map({[_o$1]:[,"search"],[_mr]:[()=>C.MaxResults!==void 0,()=>C[_MR].toString()],[_nt]:[,C[_NT]]});let x;return x=JSON.stringify(take(C,{Fields:S=>_json(S)})),w.m("POST").h(R).q(M).b(x),w.build()},se_SendChannelMessageCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/messages"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);let M;return M=JSON.stringify(take(C,{ClientRequestToken:[!0,x=>x??v4()],Content:[],ContentType:[],MessageAttributes:x=>_json(x),Metadata:[],Persistence:[],PushNotification:x=>_json(x),SubChannelId:[],Target:x=>_json(x),Type:[]})),w.m("POST").h(R).b(M),w.build()},se_TagResourceCommand=async(C,E)=>{const w=requestBuilder(C,E),R={"content-type":"application/json"};w.bp("/tags");const M=map({[_o$1]:[,"tag-resource"]});let x;return x=JSON.stringify(take(C,{ResourceARN:[],Tags:S=>_json(S)})),w.m("POST").h(R).q(M).b(x),w.build()},se_UntagResourceCommand=async(C,E)=>{const w=requestBuilder(C,E),R={"content-type":"application/json"};w.bp("/tags");const M=map({[_o$1]:[,"untag-resource"]});let x;return x=JSON.stringify(take(C,{ResourceARN:[],TagKeys:S=>_json(S)})),w.m("POST").h(R).q(M).b(x),w.build()},se_UpdateChannelCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1);let M;return M=JSON.stringify(take(C,{Metadata:[],Mode:[],Name:[]})),w.m("PUT").h(R).b(M),w.build()},se_UpdateChannelFlowCommand=async(C,E)=>{const w=requestBuilder(C,E),R={"content-type":"application/json"};w.bp("/channel-flows/{ChannelFlowArn}"),w.p("ChannelFlowArn",()=>C.ChannelFlowArn,"{ChannelFlowArn}",!1);let M;return M=JSON.stringify(take(C,{Name:[],Processors:x=>_json(x)})),w.m("PUT").h(R).b(M),w.build()},se_UpdateChannelMessageCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{"content-type":"application/json",[_xacb]:C[_CB]});w.bp("/channels/{ChannelArn}/messages/{MessageId}"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.p("MessageId",()=>C.MessageId,"{MessageId}",!1);let M;return M=JSON.stringify(take(C,{Content:[],ContentType:[],Metadata:[],SubChannelId:[]})),w.m("PUT").h(R).b(M),w.build()},se_UpdateChannelReadMarkerCommand=async(C,E)=>{const w=requestBuilder(C,E),R=map({},isSerializableHeaderValue,{[_xacb]:C[_CB]});return w.bp("/channels/{ChannelArn}/readMarker"),w.p("ChannelArn",()=>C.ChannelArn,"{ChannelArn}",!1),w.m("PUT").h(R).b(void 0),w.build()},de_AssociateChannelFlowCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_BatchCreateChannelMembershipCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{BatchChannelMemberships:_json,Errors:_json});return Object.assign(w,M),w},de_ChannelFlowCallbackCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{CallbackId:expectString,ChannelArn:expectString});return Object.assign(w,M),w},de_CreateChannelCommand=async(C,E)=>{if(C.statusCode!==201&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString});return Object.assign(w,M),w},de_CreateChannelBanCommand=async(C,E)=>{if(C.statusCode!==201&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,Member:_json});return Object.assign(w,M),w},de_CreateChannelFlowCommand=async(C,E)=>{if(C.statusCode!==201&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelFlowArn:expectString});return Object.assign(w,M),w},de_CreateChannelMembershipCommand=async(C,E)=>{if(C.statusCode!==201&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,Member:_json,SubChannelId:expectString});return Object.assign(w,M),w},de_CreateChannelModeratorCommand=async(C,E)=>{if(C.statusCode!==201&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,ChannelModerator:_json});return Object.assign(w,M),w},de_DeleteChannelCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_DeleteChannelBanCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_DeleteChannelFlowCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_DeleteChannelMembershipCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_DeleteChannelMessageCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_DeleteChannelModeratorCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_DeleteMessagingStreamingConfigurationsCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_DescribeChannelCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{Channel:x=>de_Channel(x)});return Object.assign(w,M),w},de_DescribeChannelBanCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelBan:x=>de_ChannelBan(x)});return Object.assign(w,M),w},de_DescribeChannelFlowCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelFlow:x=>de_ChannelFlow(x)});return Object.assign(w,M),w},de_DescribeChannelMembershipCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelMembership:x=>de_ChannelMembership(x)});return Object.assign(w,M),w},de_DescribeChannelMembershipForAppInstanceUserCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelMembership:x=>de_ChannelMembershipForAppInstanceUserSummary(x)});return Object.assign(w,M),w},de_DescribeChannelModeratedByAppInstanceUserCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{Channel:x=>de_ChannelModeratedByAppInstanceUserSummary(x)});return Object.assign(w,M),w},de_DescribeChannelModeratorCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelModerator:x=>de_ChannelModerator(x)});return Object.assign(w,M),w},de_DisassociateChannelFlowCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_GetChannelMembershipPreferencesCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,Member:_json,Preferences:_json});return Object.assign(w,M),w},de_GetChannelMessageCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelMessage:x=>de_ChannelMessage(x)});return Object.assign(w,M),w},de_GetChannelMessageStatusCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{Status:_json});return Object.assign(w,M),w},de_GetMessagingSessionEndpointCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{Endpoint:_json});return Object.assign(w,M),w},de_GetMessagingStreamingConfigurationsCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{StreamingConfigurations:_json});return Object.assign(w,M),w},de_ListChannelBansCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,ChannelBans:_json,NextToken:expectString});return Object.assign(w,M),w},de_ListChannelFlowsCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelFlows:_json,NextToken:expectString});return Object.assign(w,M),w},de_ListChannelMembershipsCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,ChannelMemberships:_json,NextToken:expectString});return Object.assign(w,M),w},de_ListChannelMembershipsForAppInstanceUserCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelMemberships:x=>de_ChannelMembershipForAppInstanceUserSummaryList(x),NextToken:expectString});return Object.assign(w,M),w},de_ListChannelMessagesCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,ChannelMessages:x=>de_ChannelMessageSummaryList(x),NextToken:expectString,SubChannelId:expectString});return Object.assign(w,M),w},de_ListChannelModeratorsCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,ChannelModerators:_json,NextToken:expectString});return Object.assign(w,M),w},de_ListChannelsCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{Channels:x=>de_ChannelSummaryList(x),NextToken:expectString});return Object.assign(w,M),w},de_ListChannelsAssociatedWithChannelFlowCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{Channels:_json,NextToken:expectString});return Object.assign(w,M),w},de_ListChannelsModeratedByAppInstanceUserCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{Channels:x=>de_ChannelModeratedByAppInstanceUserSummaryList(x),NextToken:expectString});return Object.assign(w,M),w},de_ListSubChannelsCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,NextToken:expectString,SubChannels:_json});return Object.assign(w,M),w},de_ListTagsForResourceCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{Tags:_json});return Object.assign(w,M),w},de_PutChannelExpirationSettingsCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,ExpirationSettings:_json});return Object.assign(w,M),w},de_PutChannelMembershipPreferencesCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,Member:_json,Preferences:_json});return Object.assign(w,M),w},de_PutMessagingStreamingConfigurationsCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{StreamingConfigurations:_json});return Object.assign(w,M),w},de_RedactChannelMessageCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,MessageId:expectString,SubChannelId:expectString});return Object.assign(w,M),w},de_SearchChannelsCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{Channels:x=>de_ChannelSummaryList(x),NextToken:expectString});return Object.assign(w,M),w},de_SendChannelMessageCommand=async(C,E)=>{if(C.statusCode!==201&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,MessageId:expectString,Status:_json,SubChannelId:expectString});return Object.assign(w,M),w},de_TagResourceCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_UntagResourceCommand=async(C,E)=>{if(C.statusCode!==204&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)});return await collectBody(C.body,E),w},de_UpdateChannelCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString});return Object.assign(w,M),w},de_UpdateChannelFlowCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelFlowArn:expectString});return Object.assign(w,M),w},de_UpdateChannelMessageCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString,MessageId:expectString,Status:_json,SubChannelId:expectString});return Object.assign(w,M),w},de_UpdateChannelReadMarkerCommand=async(C,E)=>{if(C.statusCode!==200&&C.statusCode>=300)return de_CommandError(C,E);const w=map({$metadata:deserializeMetadata(C)}),R=expectNonNull(expectObject(await parseJsonBody(C.body,E)),"body"),M=take(R,{ChannelArn:expectString});return Object.assign(w,M),w},de_CommandError=async(C,E)=>{const w={...C,body:await parseJsonErrorBody(C.body,E)},R=loadRestJsonErrorCode(C,w.body);switch(R){case"BadRequestException":case"com.amazonaws.chimesdkmessaging#BadRequestException":throw await de_BadRequestExceptionRes(w);case"ConflictException":case"com.amazonaws.chimesdkmessaging#ConflictException":throw await de_ConflictExceptionRes(w);case"ForbiddenException":case"com.amazonaws.chimesdkmessaging#ForbiddenException":throw await de_ForbiddenExceptionRes(w);case"NotFoundException":case"com.amazonaws.chimesdkmessaging#NotFoundException":throw await de_NotFoundExceptionRes(w);case"ServiceFailureException":case"com.amazonaws.chimesdkmessaging#ServiceFailureException":throw await de_ServiceFailureExceptionRes(w);case"ServiceUnavailableException":case"com.amazonaws.chimesdkmessaging#ServiceUnavailableException":throw await de_ServiceUnavailableExceptionRes(w);case"ThrottledClientException":case"com.amazonaws.chimesdkmessaging#ThrottledClientException":throw await de_ThrottledClientExceptionRes(w);case"UnauthorizedClientException":case"com.amazonaws.chimesdkmessaging#UnauthorizedClientException":throw await de_UnauthorizedClientExceptionRes(w);case"ResourceLimitExceededException":case"com.amazonaws.chimesdkmessaging#ResourceLimitExceededException":throw await de_ResourceLimitExceededExceptionRes(w);default:const M=w.body;return throwDefaultError({output:C,parsedBody:M,errorCode:R})}},throwDefaultError=withBaseException(ChimeSDKMessagingServiceException),de_BadRequestExceptionRes=async(C,E)=>{const w=map({}),R=C.body,M=take(R,{Code:expectString,Message:expectString});Object.assign(w,M);const x=new BadRequestException({$metadata:deserializeMetadata(C),...w});return decorateServiceException(x,C.body)},de_ConflictExceptionRes=async(C,E)=>{const w=map({}),R=C.body,M=take(R,{Code:expectString,Message:expectString});Object.assign(w,M);const x=new ConflictException({$metadata:deserializeMetadata(C),...w});return decorateServiceException(x,C.body)},de_ForbiddenExceptionRes=async(C,E)=>{const w=map({}),R=C.body,M=take(R,{Code:expectString,Message:expectString});Object.assign(w,M);const x=new ForbiddenException({$metadata:deserializeMetadata(C),...w});return decorateServiceException(x,C.body)},de_NotFoundExceptionRes=async(C,E)=>{const w=map({}),R=C.body,M=take(R,{Code:expectString,Message:expectString});Object.assign(w,M);const x=new NotFoundException({$metadata:deserializeMetadata(C),...w});return decorateServiceException(x,C.body)},de_ResourceLimitExceededExceptionRes=async(C,E)=>{const w=map({}),R=C.body,M=take(R,{Code:expectString,Message:expectString});Object.assign(w,M);const x=new ResourceLimitExceededException({$metadata:deserializeMetadata(C),...w});return decorateServiceException(x,C.body)},de_ServiceFailureExceptionRes=async(C,E)=>{const w=map({}),R=C.body,M=take(R,{Code:expectString,Message:expectString});Object.assign(w,M);const x=new ServiceFailureException({$metadata:deserializeMetadata(C),...w});return decorateServiceException(x,C.body)},de_ServiceUnavailableExceptionRes=async(C,E)=>{const w=map({}),R=C.body,M=take(R,{Code:expectString,Message:expectString});Object.assign(w,M);const x=new ServiceUnavailableException({$metadata:deserializeMetadata(C),...w});return decorateServiceException(x,C.body)},de_ThrottledClientExceptionRes=async(C,E)=>{const w=map({}),R=C.body,M=take(R,{Code:expectString,Message:expectString});Object.assign(w,M);const x=new ThrottledClientException({$metadata:deserializeMetadata(C),...w});return decorateServiceException(x,C.body)},de_UnauthorizedClientExceptionRes=async(C,E)=>{const w=map({}),R=C.body,M=take(R,{Code:expectString,Message:expectString});Object.assign(w,M);const x=new UnauthorizedClientException({$metadata:deserializeMetadata(C),...w});return decorateServiceException(x,C.body)},de_AppInstanceUserMembershipSummary=(C,E)=>take(C,{ReadMarkerTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),SubChannelId:expectString,Type:expectString}),de_Channel=(C,E)=>take(C,{ChannelArn:expectString,ChannelFlowArn:expectString,CreatedBy:_json,CreatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),ElasticChannelConfiguration:_json,ExpirationSettings:_json,LastMessageTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),LastUpdatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),Metadata:expectString,Mode:expectString,Name:expectString,Privacy:expectString}),de_ChannelBan=(C,E)=>take(C,{ChannelArn:expectString,CreatedBy:_json,CreatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),Member:_json}),de_ChannelFlow=(C,E)=>take(C,{ChannelFlowArn:expectString,CreatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),LastUpdatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),Name:expectString,Processors:_json}),de_ChannelMembership=(C,E)=>take(C,{ChannelArn:expectString,CreatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),InvitedBy:_json,LastUpdatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),Member:_json,SubChannelId:expectString,Type:expectString}),de_ChannelMembershipForAppInstanceUserSummary=(C,E)=>take(C,{AppInstanceUserMembershipSummary:w=>de_AppInstanceUserMembershipSummary(w),ChannelSummary:w=>de_ChannelSummary(w)}),de_ChannelMembershipForAppInstanceUserSummaryList=(C,E)=>(C||[]).filter(w=>w!=null).map(w=>de_ChannelMembershipForAppInstanceUserSummary(w)),de_ChannelMessage=(C,E)=>take(C,{ChannelArn:expectString,Content:expectString,ContentType:expectString,CreatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),LastEditedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),LastUpdatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),MessageAttributes:_json,MessageId:expectString,Metadata:expectString,Persistence:expectString,Redacted:expectBoolean,Sender:_json,Status:_json,SubChannelId:expectString,Target:_json,Type:expectString}),de_ChannelMessageSummary=(C,E)=>take(C,{Content:expectString,ContentType:expectString,CreatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),LastEditedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),LastUpdatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),MessageAttributes:_json,MessageId:expectString,Metadata:expectString,Redacted:expectBoolean,Sender:_json,Status:_json,Target:_json,Type:expectString}),de_ChannelMessageSummaryList=(C,E)=>(C||[]).filter(w=>w!=null).map(w=>de_ChannelMessageSummary(w)),de_ChannelModeratedByAppInstanceUserSummary=(C,E)=>take(C,{ChannelSummary:w=>de_ChannelSummary(w)}),de_ChannelModeratedByAppInstanceUserSummaryList=(C,E)=>(C||[]).filter(w=>w!=null).map(w=>de_ChannelModeratedByAppInstanceUserSummary(w)),de_ChannelModerator=(C,E)=>take(C,{ChannelArn:expectString,CreatedBy:_json,CreatedTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),Moderator:_json}),de_ChannelSummary=(C,E)=>take(C,{ChannelArn:expectString,LastMessageTimestamp:w=>expectNonNull(parseEpochTimestamp(expectNumber(w))),Metadata:expectString,Mode:expectString,Name:expectString,Privacy:expectString}),de_ChannelSummaryList=(C,E)=>(C||[]).filter(w=>w!=null).map(w=>de_ChannelSummary(w)),deserializeMetadata=C=>({httpStatusCode:C.statusCode,requestId:C.headers["x-amzn-requestid"]??C.headers["x-amzn-request-id"]??C.headers["x-amz-request-id"],extendedRequestId:C.headers["x-amz-id-2"],cfId:C.headers["x-amz-cf-id"]}),_AIA="AppInstanceArn",_AIUA="AppInstanceUserArn",_CB="ChimeBearer",_CFA="ChannelFlowArn",_MR="MaxResults",_NA="NotAfter",_NB="NotBefore",_NT="NextToken",_P="Privacy",_RARN="ResourceARN",_SCI="SubChannelId",_SO="SortOrder",_T="Type",_a="arn",_aia="app-instance-arn",_aiua="app-instance-user-arn",_cfa="channel-flow-arn",_mr="max-results",_na="not-after",_nb="not-before",_nt="next-token",_o$1="operation",_p="privacy",_s="scope",_sci="sub-channel-id",_so="sort-order",_t$1="type",_xacb="x-amz-chime-bearer";class AssociateChannelFlowCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","AssociateChannelFlow",{}).n("ChimeSDKMessagingClient","AssociateChannelFlowCommand").f(void 0,void 0).ser(se_AssociateChannelFlowCommand).de(de_AssociateChannelFlowCommand).build(){}class BatchCreateChannelMembershipCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","BatchCreateChannelMembership",{}).n("ChimeSDKMessagingClient","BatchCreateChannelMembershipCommand").f(void 0,BatchCreateChannelMembershipResponseFilterSensitiveLog).ser(se_BatchCreateChannelMembershipCommand).de(de_BatchCreateChannelMembershipCommand).build(){}class ChannelFlowCallbackCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ChannelFlowCallback",{}).n("ChimeSDKMessagingClient","ChannelFlowCallbackCommand").f(ChannelFlowCallbackRequestFilterSensitiveLog,void 0).ser(se_ChannelFlowCallbackCommand).de(de_ChannelFlowCallbackCommand).build(){}class CreateChannelBanCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannelBan",{}).n("ChimeSDKMessagingClient","CreateChannelBanCommand").f(void 0,CreateChannelBanResponseFilterSensitiveLog).ser(se_CreateChannelBanCommand).de(de_CreateChannelBanCommand).build(){}class CreateChannelCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannel",{}).n("ChimeSDKMessagingClient","CreateChannelCommand").f(CreateChannelRequestFilterSensitiveLog,void 0).ser(se_CreateChannelCommand).de(de_CreateChannelCommand).build(){}class CreateChannelFlowCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannelFlow",{}).n("ChimeSDKMessagingClient","CreateChannelFlowCommand").f(CreateChannelFlowRequestFilterSensitiveLog,void 0).ser(se_CreateChannelFlowCommand).de(de_CreateChannelFlowCommand).build(){}class CreateChannelMembershipCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannelMembership",{}).n("ChimeSDKMessagingClient","CreateChannelMembershipCommand").f(void 0,CreateChannelMembershipResponseFilterSensitiveLog).ser(se_CreateChannelMembershipCommand).de(de_CreateChannelMembershipCommand).build(){}class CreateChannelModeratorCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannelModerator",{}).n("ChimeSDKMessagingClient","CreateChannelModeratorCommand").f(void 0,CreateChannelModeratorResponseFilterSensitiveLog).ser(se_CreateChannelModeratorCommand).de(de_CreateChannelModeratorCommand).build(){}class DeleteChannelBanCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelBan",{}).n("ChimeSDKMessagingClient","DeleteChannelBanCommand").f(void 0,void 0).ser(se_DeleteChannelBanCommand).de(de_DeleteChannelBanCommand).build(){}class DeleteChannelCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannel",{}).n("ChimeSDKMessagingClient","DeleteChannelCommand").f(void 0,void 0).ser(se_DeleteChannelCommand).de(de_DeleteChannelCommand).build(){}class DeleteChannelFlowCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelFlow",{}).n("ChimeSDKMessagingClient","DeleteChannelFlowCommand").f(void 0,void 0).ser(se_DeleteChannelFlowCommand).de(de_DeleteChannelFlowCommand).build(){}class DeleteChannelMembershipCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelMembership",{}).n("ChimeSDKMessagingClient","DeleteChannelMembershipCommand").f(void 0,void 0).ser(se_DeleteChannelMembershipCommand).de(de_DeleteChannelMembershipCommand).build(){}class DeleteChannelMessageCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelMessage",{}).n("ChimeSDKMessagingClient","DeleteChannelMessageCommand").f(void 0,void 0).ser(se_DeleteChannelMessageCommand).de(de_DeleteChannelMessageCommand).build(){}class DeleteChannelModeratorCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelModerator",{}).n("ChimeSDKMessagingClient","DeleteChannelModeratorCommand").f(void 0,void 0).ser(se_DeleteChannelModeratorCommand).de(de_DeleteChannelModeratorCommand).build(){}class DeleteMessagingStreamingConfigurationsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteMessagingStreamingConfigurations",{}).n("ChimeSDKMessagingClient","DeleteMessagingStreamingConfigurationsCommand").f(void 0,void 0).ser(se_DeleteMessagingStreamingConfigurationsCommand).de(de_DeleteMessagingStreamingConfigurationsCommand).build(){}class DescribeChannelBanCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelBan",{}).n("ChimeSDKMessagingClient","DescribeChannelBanCommand").f(void 0,DescribeChannelBanResponseFilterSensitiveLog).ser(se_DescribeChannelBanCommand).de(de_DescribeChannelBanCommand).build(){}class DescribeChannelCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannel",{}).n("ChimeSDKMessagingClient","DescribeChannelCommand").f(void 0,DescribeChannelResponseFilterSensitiveLog).ser(se_DescribeChannelCommand).de(de_DescribeChannelCommand).build(){}class DescribeChannelFlowCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelFlow",{}).n("ChimeSDKMessagingClient","DescribeChannelFlowCommand").f(void 0,DescribeChannelFlowResponseFilterSensitiveLog).ser(se_DescribeChannelFlowCommand).de(de_DescribeChannelFlowCommand).build(){}class DescribeChannelMembershipCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelMembership",{}).n("ChimeSDKMessagingClient","DescribeChannelMembershipCommand").f(void 0,DescribeChannelMembershipResponseFilterSensitiveLog).ser(se_DescribeChannelMembershipCommand).de(de_DescribeChannelMembershipCommand).build(){}class DescribeChannelMembershipForAppInstanceUserCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelMembershipForAppInstanceUser",{}).n("ChimeSDKMessagingClient","DescribeChannelMembershipForAppInstanceUserCommand").f(void 0,DescribeChannelMembershipForAppInstanceUserResponseFilterSensitiveLog).ser(se_DescribeChannelMembershipForAppInstanceUserCommand).de(de_DescribeChannelMembershipForAppInstanceUserCommand).build(){}class DescribeChannelModeratedByAppInstanceUserCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelModeratedByAppInstanceUser",{}).n("ChimeSDKMessagingClient","DescribeChannelModeratedByAppInstanceUserCommand").f(void 0,DescribeChannelModeratedByAppInstanceUserResponseFilterSensitiveLog).ser(se_DescribeChannelModeratedByAppInstanceUserCommand).de(de_DescribeChannelModeratedByAppInstanceUserCommand).build(){}class DescribeChannelModeratorCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelModerator",{}).n("ChimeSDKMessagingClient","DescribeChannelModeratorCommand").f(void 0,DescribeChannelModeratorResponseFilterSensitiveLog).ser(se_DescribeChannelModeratorCommand).de(de_DescribeChannelModeratorCommand).build(){}class DisassociateChannelFlowCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DisassociateChannelFlow",{}).n("ChimeSDKMessagingClient","DisassociateChannelFlowCommand").f(void 0,void 0).ser(se_DisassociateChannelFlowCommand).de(de_DisassociateChannelFlowCommand).build(){}class GetChannelMembershipPreferencesCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetChannelMembershipPreferences",{}).n("ChimeSDKMessagingClient","GetChannelMembershipPreferencesCommand").f(void 0,GetChannelMembershipPreferencesResponseFilterSensitiveLog).ser(se_GetChannelMembershipPreferencesCommand).de(de_GetChannelMembershipPreferencesCommand).build(){}class GetChannelMessageCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetChannelMessage",{}).n("ChimeSDKMessagingClient","GetChannelMessageCommand").f(void 0,GetChannelMessageResponseFilterSensitiveLog).ser(se_GetChannelMessageCommand).de(de_GetChannelMessageCommand).build(){}class GetChannelMessageStatusCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetChannelMessageStatus",{}).n("ChimeSDKMessagingClient","GetChannelMessageStatusCommand").f(void 0,void 0).ser(se_GetChannelMessageStatusCommand).de(de_GetChannelMessageStatusCommand).build(){}class GetMessagingSessionEndpointCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetMessagingSessionEndpoint",{}).n("ChimeSDKMessagingClient","GetMessagingSessionEndpointCommand").f(void 0,void 0).ser(se_GetMessagingSessionEndpointCommand).de(de_GetMessagingSessionEndpointCommand).build(){}class GetMessagingStreamingConfigurationsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetMessagingStreamingConfigurations",{}).n("ChimeSDKMessagingClient","GetMessagingStreamingConfigurationsCommand").f(void 0,void 0).ser(se_GetMessagingStreamingConfigurationsCommand).de(de_GetMessagingStreamingConfigurationsCommand).build(){}class ListChannelBansCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelBans",{}).n("ChimeSDKMessagingClient","ListChannelBansCommand").f(ListChannelBansRequestFilterSensitiveLog,ListChannelBansResponseFilterSensitiveLog).ser(se_ListChannelBansCommand).de(de_ListChannelBansCommand).build(){}class ListChannelFlowsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelFlows",{}).n("ChimeSDKMessagingClient","ListChannelFlowsCommand").f(ListChannelFlowsRequestFilterSensitiveLog,ListChannelFlowsResponseFilterSensitiveLog).ser(se_ListChannelFlowsCommand).de(de_ListChannelFlowsCommand).build(){}class ListChannelMembershipsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelMemberships",{}).n("ChimeSDKMessagingClient","ListChannelMembershipsCommand").f(ListChannelMembershipsRequestFilterSensitiveLog,ListChannelMembershipsResponseFilterSensitiveLog).ser(se_ListChannelMembershipsCommand).de(de_ListChannelMembershipsCommand).build(){}class ListChannelMembershipsForAppInstanceUserCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelMembershipsForAppInstanceUser",{}).n("ChimeSDKMessagingClient","ListChannelMembershipsForAppInstanceUserCommand").f(ListChannelMembershipsForAppInstanceUserRequestFilterSensitiveLog,ListChannelMembershipsForAppInstanceUserResponseFilterSensitiveLog).ser(se_ListChannelMembershipsForAppInstanceUserCommand).de(de_ListChannelMembershipsForAppInstanceUserCommand).build(){}class ListChannelMessagesCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelMessages",{}).n("ChimeSDKMessagingClient","ListChannelMessagesCommand").f(ListChannelMessagesRequestFilterSensitiveLog,ListChannelMessagesResponseFilterSensitiveLog).ser(se_ListChannelMessagesCommand).de(de_ListChannelMessagesCommand).build(){}class ListChannelModeratorsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelModerators",{}).n("ChimeSDKMessagingClient","ListChannelModeratorsCommand").f(ListChannelModeratorsRequestFilterSensitiveLog,ListChannelModeratorsResponseFilterSensitiveLog).ser(se_ListChannelModeratorsCommand).de(de_ListChannelModeratorsCommand).build(){}class ListChannelsAssociatedWithChannelFlowCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelsAssociatedWithChannelFlow",{}).n("ChimeSDKMessagingClient","ListChannelsAssociatedWithChannelFlowCommand").f(ListChannelsAssociatedWithChannelFlowRequestFilterSensitiveLog,ListChannelsAssociatedWithChannelFlowResponseFilterSensitiveLog).ser(se_ListChannelsAssociatedWithChannelFlowCommand).de(de_ListChannelsAssociatedWithChannelFlowCommand).build(){}class ListChannelsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannels",{}).n("ChimeSDKMessagingClient","ListChannelsCommand").f(ListChannelsRequestFilterSensitiveLog,ListChannelsResponseFilterSensitiveLog).ser(se_ListChannelsCommand).de(de_ListChannelsCommand).build(){}class ListChannelsModeratedByAppInstanceUserCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelsModeratedByAppInstanceUser",{}).n("ChimeSDKMessagingClient","ListChannelsModeratedByAppInstanceUserCommand").f(ListChannelsModeratedByAppInstanceUserRequestFilterSensitiveLog,ListChannelsModeratedByAppInstanceUserResponseFilterSensitiveLog).ser(se_ListChannelsModeratedByAppInstanceUserCommand).de(de_ListChannelsModeratedByAppInstanceUserCommand).build(){}class ListSubChannelsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListSubChannels",{}).n("ChimeSDKMessagingClient","ListSubChannelsCommand").f(ListSubChannelsRequestFilterSensitiveLog,ListSubChannelsResponseFilterSensitiveLog).ser(se_ListSubChannelsCommand).de(de_ListSubChannelsCommand).build(){}class ListTagsForResourceCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListTagsForResource",{}).n("ChimeSDKMessagingClient","ListTagsForResourceCommand").f(void 0,ListTagsForResourceResponseFilterSensitiveLog).ser(se_ListTagsForResourceCommand).de(de_ListTagsForResourceCommand).build(){}class PutChannelExpirationSettingsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","PutChannelExpirationSettings",{}).n("ChimeSDKMessagingClient","PutChannelExpirationSettingsCommand").f(void 0,void 0).ser(se_PutChannelExpirationSettingsCommand).de(de_PutChannelExpirationSettingsCommand).build(){}class PutChannelMembershipPreferencesCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","PutChannelMembershipPreferences",{}).n("ChimeSDKMessagingClient","PutChannelMembershipPreferencesCommand").f(PutChannelMembershipPreferencesRequestFilterSensitiveLog,PutChannelMembershipPreferencesResponseFilterSensitiveLog).ser(se_PutChannelMembershipPreferencesCommand).de(de_PutChannelMembershipPreferencesCommand).build(){}class PutMessagingStreamingConfigurationsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","PutMessagingStreamingConfigurations",{}).n("ChimeSDKMessagingClient","PutMessagingStreamingConfigurationsCommand").f(void 0,void 0).ser(se_PutMessagingStreamingConfigurationsCommand).de(de_PutMessagingStreamingConfigurationsCommand).build(){}class RedactChannelMessageCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","RedactChannelMessage",{}).n("ChimeSDKMessagingClient","RedactChannelMessageCommand").f(void 0,void 0).ser(se_RedactChannelMessageCommand).de(de_RedactChannelMessageCommand).build(){}class SearchChannelsCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","SearchChannels",{}).n("ChimeSDKMessagingClient","SearchChannelsCommand").f(SearchChannelsRequestFilterSensitiveLog,SearchChannelsResponseFilterSensitiveLog).ser(se_SearchChannelsCommand).de(de_SearchChannelsCommand).build(){}class SendChannelMessageCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","SendChannelMessage",{}).n("ChimeSDKMessagingClient","SendChannelMessageCommand").f(SendChannelMessageRequestFilterSensitiveLog,void 0).ser(se_SendChannelMessageCommand).de(de_SendChannelMessageCommand).build(){}class TagResourceCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","TagResource",{}).n("ChimeSDKMessagingClient","TagResourceCommand").f(TagResourceRequestFilterSensitiveLog,void 0).ser(se_TagResourceCommand).de(de_TagResourceCommand).build(){}class UntagResourceCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UntagResource",{}).n("ChimeSDKMessagingClient","UntagResourceCommand").f(UntagResourceRequestFilterSensitiveLog,void 0).ser(se_UntagResourceCommand).de(de_UntagResourceCommand).build(){}class UpdateChannelCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UpdateChannel",{}).n("ChimeSDKMessagingClient","UpdateChannelCommand").f(UpdateChannelRequestFilterSensitiveLog,void 0).ser(se_UpdateChannelCommand).de(de_UpdateChannelCommand).build(){}class UpdateChannelFlowCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UpdateChannelFlow",{}).n("ChimeSDKMessagingClient","UpdateChannelFlowCommand").f(UpdateChannelFlowRequestFilterSensitiveLog,void 0).ser(se_UpdateChannelFlowCommand).de(de_UpdateChannelFlowCommand).build(){}class UpdateChannelMessageCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UpdateChannelMessage",{}).n("ChimeSDKMessagingClient","UpdateChannelMessageCommand").f(UpdateChannelMessageRequestFilterSensitiveLog,void 0).ser(se_UpdateChannelMessageCommand).de(de_UpdateChannelMessageCommand).build(){}class UpdateChannelReadMarkerCommand extends Command.classBuilder().ep(commonParams).m(function(E,w,R,M){return[getSerdePlugin(R,this.serialize,this.deserialize),getEndpointPlugin(R,E.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UpdateChannelReadMarker",{}).n("ChimeSDKMessagingClient","UpdateChannelReadMarkerCommand").f(void 0,void 0).ser(se_UpdateChannelReadMarkerCommand).de(de_UpdateChannelReadMarkerCommand).build(){}const commands={AssociateChannelFlowCommand,BatchCreateChannelMembershipCommand,ChannelFlowCallbackCommand,CreateChannelCommand,CreateChannelBanCommand,CreateChannelFlowCommand,CreateChannelMembershipCommand,CreateChannelModeratorCommand,DeleteChannelCommand,DeleteChannelBanCommand,DeleteChannelFlowCommand,DeleteChannelMembershipCommand,DeleteChannelMessageCommand,DeleteChannelModeratorCommand,DeleteMessagingStreamingConfigurationsCommand,DescribeChannelCommand,DescribeChannelBanCommand,DescribeChannelFlowCommand,DescribeChannelMembershipCommand,DescribeChannelMembershipForAppInstanceUserCommand,DescribeChannelModeratedByAppInstanceUserCommand,DescribeChannelModeratorCommand,DisassociateChannelFlowCommand,GetChannelMembershipPreferencesCommand,GetChannelMessageCommand,GetChannelMessageStatusCommand,GetMessagingSessionEndpointCommand,GetMessagingStreamingConfigurationsCommand,ListChannelBansCommand,ListChannelFlowsCommand,ListChannelMembershipsCommand,ListChannelMembershipsForAppInstanceUserCommand,ListChannelMessagesCommand,ListChannelModeratorsCommand,ListChannelsCommand,ListChannelsAssociatedWithChannelFlowCommand,ListChannelsModeratedByAppInstanceUserCommand,ListSubChannelsCommand,ListTagsForResourceCommand,PutChannelExpirationSettingsCommand,PutChannelMembershipPreferencesCommand,PutMessagingStreamingConfigurationsCommand,RedactChannelMessageCommand,SearchChannelsCommand,SendChannelMessageCommand,TagResourceCommand,UntagResourceCommand,UpdateChannelCommand,UpdateChannelFlowCommand,UpdateChannelMessageCommand,UpdateChannelReadMarkerCommand};class ChimeSDKMessaging extends ChimeSDKMessagingClient{}createAggregatedClient(commands,ChimeSDKMessaging);const paginateListChannelBans=createPaginator(ChimeSDKMessagingClient,ListChannelBansCommand,"NextToken","NextToken","MaxResults"),paginateListChannelFlows=createPaginator(ChimeSDKMessagingClient,ListChannelFlowsCommand,"NextToken","NextToken","MaxResults"),paginateListChannelMembershipsForAppInstanceUser=createPaginator(ChimeSDKMessagingClient,ListChannelMembershipsForAppInstanceUserCommand,"NextToken","NextToken","MaxResults"),paginateListChannelMemberships=createPaginator(ChimeSDKMessagingClient,ListChannelMembershipsCommand,"NextToken","NextToken","MaxResults"),paginateListChannelMessages=createPaginator(ChimeSDKMessagingClient,ListChannelMessagesCommand,"NextToken","NextToken","MaxResults"),paginateListChannelModerators=createPaginator(ChimeSDKMessagingClient,ListChannelModeratorsCommand,"NextToken","NextToken","MaxResults"),paginateListChannelsAssociatedWithChannelFlow=createPaginator(ChimeSDKMessagingClient,ListChannelsAssociatedWithChannelFlowCommand,"NextToken","NextToken","MaxResults"),paginateListChannelsModeratedByAppInstanceUser=createPaginator(ChimeSDKMessagingClient,ListChannelsModeratedByAppInstanceUserCommand,"NextToken","NextToken","MaxResults"),paginateListChannels=createPaginator(ChimeSDKMessagingClient,ListChannelsCommand,"NextToken","NextToken","MaxResults"),paginateListSubChannels=createPaginator(ChimeSDKMessagingClient,ListSubChannelsCommand,"NextToken","NextToken","MaxResults"),paginateSearchChannels=createPaginator(ChimeSDKMessagingClient,SearchChannelsCommand,"NextToken","NextToken","MaxResults"),distEs$2=Object.freeze(Object.defineProperty({__proto__:null,$Command:Command,AllowNotifications,AssociateChannelFlowCommand,BadRequestException,BatchChannelMembershipsFilterSensitiveLog,BatchCreateChannelMembershipCommand,BatchCreateChannelMembershipResponseFilterSensitiveLog,ChannelAssociatedWithFlowSummaryFilterSensitiveLog,ChannelBanFilterSensitiveLog,ChannelBanSummaryFilterSensitiveLog,ChannelFilterSensitiveLog,ChannelFlowCallbackCommand,ChannelFlowCallbackRequestFilterSensitiveLog,ChannelFlowFilterSensitiveLog,ChannelFlowSummaryFilterSensitiveLog,ChannelMembershipFilterSensitiveLog,ChannelMembershipForAppInstanceUserSummaryFilterSensitiveLog,ChannelMembershipPreferencesFilterSensitiveLog,ChannelMembershipSummaryFilterSensitiveLog,ChannelMembershipType,ChannelMessageCallbackFilterSensitiveLog,ChannelMessageFilterSensitiveLog,ChannelMessagePersistenceType,ChannelMessageStatus,ChannelMessageSummaryFilterSensitiveLog,ChannelMessageType,ChannelMode,ChannelModeratedByAppInstanceUserSummaryFilterSensitiveLog,ChannelModeratorFilterSensitiveLog,ChannelModeratorSummaryFilterSensitiveLog,ChannelPrivacy,ChannelSummaryFilterSensitiveLog,ChimeSDKMessaging,ChimeSDKMessagingClient,ChimeSDKMessagingServiceException,ConflictException,CreateChannelBanCommand,CreateChannelBanResponseFilterSensitiveLog,CreateChannelCommand,CreateChannelFlowCommand,CreateChannelFlowRequestFilterSensitiveLog,CreateChannelMembershipCommand,CreateChannelMembershipResponseFilterSensitiveLog,CreateChannelModeratorCommand,CreateChannelModeratorResponseFilterSensitiveLog,CreateChannelRequestFilterSensitiveLog,DeleteChannelBanCommand,DeleteChannelCommand,DeleteChannelFlowCommand,DeleteChannelMembershipCommand,DeleteChannelMessageCommand,DeleteChannelModeratorCommand,DeleteMessagingStreamingConfigurationsCommand,DescribeChannelBanCommand,DescribeChannelBanResponseFilterSensitiveLog,DescribeChannelCommand,DescribeChannelFlowCommand,DescribeChannelFlowResponseFilterSensitiveLog,DescribeChannelMembershipCommand,DescribeChannelMembershipForAppInstanceUserCommand,DescribeChannelMembershipForAppInstanceUserResponseFilterSensitiveLog,DescribeChannelMembershipResponseFilterSensitiveLog,DescribeChannelModeratedByAppInstanceUserCommand,DescribeChannelModeratedByAppInstanceUserResponseFilterSensitiveLog,DescribeChannelModeratorCommand,DescribeChannelModeratorResponseFilterSensitiveLog,DescribeChannelResponseFilterSensitiveLog,DisassociateChannelFlowCommand,ErrorCode,ExpirationCriterion,FallbackAction,ForbiddenException,GetChannelMembershipPreferencesCommand,GetChannelMembershipPreferencesResponseFilterSensitiveLog,GetChannelMessageCommand,GetChannelMessageResponseFilterSensitiveLog,GetChannelMessageStatusCommand,GetMessagingSessionEndpointCommand,GetMessagingStreamingConfigurationsCommand,IdentityFilterSensitiveLog,InvocationType,ListChannelBansCommand,ListChannelBansRequestFilterSensitiveLog,ListChannelBansResponseFilterSensitiveLog,ListChannelFlowsCommand,ListChannelFlowsRequestFilterSensitiveLog,ListChannelFlowsResponseFilterSensitiveLog,ListChannelMembershipsCommand,ListChannelMembershipsForAppInstanceUserCommand,ListChannelMembershipsForAppInstanceUserRequestFilterSensitiveLog,ListChannelMembershipsForAppInstanceUserResponseFilterSensitiveLog,ListChannelMembershipsRequestFilterSensitiveLog,ListChannelMembershipsResponseFilterSensitiveLog,ListChannelMessagesCommand,ListChannelMessagesRequestFilterSensitiveLog,ListChannelMessagesResponseFilterSensitiveLog,ListChannelModeratorsCommand,ListChannelModeratorsRequestFilterSensitiveLog,ListChannelModeratorsResponseFilterSensitiveLog,ListChannelsAssociatedWithChannelFlowCommand,ListChannelsAssociatedWithChannelFlowRequestFilterSensitiveLog,ListChannelsAssociatedWithChannelFlowResponseFilterSensitiveLog,ListChannelsCommand,ListChannelsModeratedByAppInstanceUserCommand,ListChannelsModeratedByAppInstanceUserRequestFilterSensitiveLog,ListChannelsModeratedByAppInstanceUserResponseFilterSensitiveLog,ListChannelsRequestFilterSensitiveLog,ListChannelsResponseFilterSensitiveLog,ListSubChannelsCommand,ListSubChannelsRequestFilterSensitiveLog,ListSubChannelsResponseFilterSensitiveLog,ListTagsForResourceCommand,ListTagsForResourceResponseFilterSensitiveLog,MessageAttributeValueFilterSensitiveLog,MessagingDataType,NotFoundException,ProcessorFilterSensitiveLog,PushNotificationConfigurationFilterSensitiveLog,PushNotificationPreferencesFilterSensitiveLog,PushNotificationType,PutChannelExpirationSettingsCommand,PutChannelMembershipPreferencesCommand,PutChannelMembershipPreferencesRequestFilterSensitiveLog,PutChannelMembershipPreferencesResponseFilterSensitiveLog,PutMessagingStreamingConfigurationsCommand,RedactChannelMessageCommand,ResourceLimitExceededException,SearchChannelsCommand,SearchChannelsRequestFilterSensitiveLog,SearchChannelsResponseFilterSensitiveLog,SearchFieldKey,SearchFieldOperator,SendChannelMessageCommand,SendChannelMessageRequestFilterSensitiveLog,ServiceFailureException,ServiceUnavailableException,SortOrder,TagFilterSensitiveLog,TagResourceCommand,TagResourceRequestFilterSensitiveLog,ThrottledClientException,UnauthorizedClientException,UntagResourceCommand,UntagResourceRequestFilterSensitiveLog,UpdateChannelCommand,UpdateChannelFlowCommand,UpdateChannelFlowRequestFilterSensitiveLog,UpdateChannelMessageCommand,UpdateChannelMessageRequestFilterSensitiveLog,UpdateChannelReadMarkerCommand,UpdateChannelRequestFilterSensitiveLog,__Client:Client,paginateListChannelBans,paginateListChannelFlows,paginateListChannelMemberships,paginateListChannelMembershipsForAppInstanceUser,paginateListChannelMessages,paginateListChannelModerators,paginateListChannels,paginateListChannelsAssociatedWithChannelFlow,paginateListChannelsModeratedByAppInstanceUser,paginateListSubChannels,paginateSearchChannels},Symbol.toStringTag,{value:"Module"})),require$$0$2=getAugmentedNamespace(distEs$2);var Message={},hasRequiredMessage;function requireMessage(){if(hasRequiredMessage)return Message;hasRequiredMessage=1,Object.defineProperty(Message,"__esModule",{value:!0});let C=class{constructor(E,w,R){this.type=E,this.headers=w,this.payload=R}};return Message.default=C,Message}var DefaultSigV4={},build$1={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(C,E){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,R){w.__proto__=R}||function(w,R){for(var M in R)R.hasOwnProperty(M)&&(w[M]=R[M])},extendStatics(C,E)};function __extends(C,E){extendStatics(C,E);function w(){this.constructor=C}C.prototype=E===null?Object.create(E):(w.prototype=E.prototype,new w)}var __assign=function(){return __assign=Object.assign||function(C){for(var E,w=1,R=arguments.length;w<R;w++){E=arguments[w];for(var M in E)Object.prototype.hasOwnProperty.call(E,M)&&(C[M]=E[M])}return C},__assign.apply(this,arguments)};function __rest(C,E){var w={};for(var R in C)Object.prototype.hasOwnProperty.call(C,R)&&E.indexOf(R)<0&&(w[R]=C[R]);if(C!=null&&typeof Object.getOwnPropertySymbols=="function")for(var M=0,R=Object.getOwnPropertySymbols(C);M<R.length;M++)E.indexOf(R[M])<0&&Object.prototype.propertyIsEnumerable.call(C,R[M])&&(w[R[M]]=C[R[M]]);return w}function __decorate(C,E,w,R){var M=arguments.length,x=M<3?E:R===null?R=Object.getOwnPropertyDescriptor(E,w):R,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(C,E,w,R);else for(var T=C.length-1;T>=0;T--)(S=C[T])&&(x=(M<3?S(x):M>3?S(E,w,x):S(E,w))||x);return M>3&&x&&Object.defineProperty(E,w,x),x}function __param(C,E){return function(w,R){E(w,R,C)}}function __metadata(C,E){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(C,E)}function __awaiter(C,E,w,R){function M(x){return x instanceof w?x:new w(function(S){S(x)})}return new(w||(w=Promise))(function(x,S){function T(Y){try{D(R.next(Y))}catch(ee){S(ee)}}function _(Y){try{D(R.throw(Y))}catch(ee){S(ee)}}function D(Y){Y.done?x(Y.value):M(Y.value).then(T,_)}D((R=R.apply(C,E||[])).next())})}function __generator(C,E){var w={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},R,M,x,S;return S={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function T(D){return function(Y){return _([D,Y])}}function _(D){if(R)throw new TypeError("Generator is already executing.");for(;w;)try{if(R=1,M&&(x=D[0]&2?M.return:D[0]?M.throw||((x=M.return)&&x.call(M),0):M.next)&&!(x=x.call(M,D[1])).done)return x;switch(M=0,x&&(D=[D[0]&2,x.value]),D[0]){case 0:case 1:x=D;break;case 4:return w.label++,{value:D[1],done:!1};case 5:w.label++,M=D[1],D=[0];continue;case 7:D=w.ops.pop(),w.trys.pop();continue;default:if(x=w.trys,!(x=x.length>0&&x[x.length-1])&&(D[0]===6||D[0]===2)){w=0;continue}if(D[0]===3&&(!x||D[1]>x[0]&&D[1]<x[3])){w.label=D[1];break}if(D[0]===6&&w.label<x[1]){w.label=x[1],x=D;break}if(x&&w.label<x[2]){w.label=x[2],w.ops.push(D);break}x[2]&&w.ops.pop(),w.trys.pop();continue}D=E.call(C,w)}catch(Y){D=[6,Y],M=0}finally{R=x=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}}function __createBinding(C,E,w,R){R===void 0&&(R=w),C[R]=E[w]}function __exportStar(C,E){for(var w in C)w!=="default"&&!E.hasOwnProperty(w)&&(E[w]=C[w])}function __values(C){var E=typeof Symbol=="function"&&Symbol.iterator,w=E&&C[E],R=0;if(w)return w.call(C);if(C&&typeof C.length=="number")return{next:function(){return C&&R>=C.length&&(C=void 0),{value:C&&C[R++],done:!C}}};throw new TypeError(E?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(C,E){var w=typeof Symbol=="function"&&C[Symbol.iterator];if(!w)return C;var R=w.call(C),M,x=[],S;try{for(;(E===void 0||E-- >0)&&!(M=R.next()).done;)x.push(M.value)}catch(T){S={error:T}}finally{try{M&&!M.done&&(w=R.return)&&w.call(R)}finally{if(S)throw S.error}}return x}function __spread(){for(var C=[],E=0;E<arguments.length;E++)C=C.concat(__read(arguments[E]));return C}function __spreadArrays(){for(var C=0,E=0,w=arguments.length;E<w;E++)C+=arguments[E].length;for(var R=Array(C),M=0,E=0;E<w;E++)for(var x=arguments[E],S=0,T=x.length;S<T;S++,M++)R[M]=x[S];return R}function __await(C){return this instanceof __await?(this.v=C,this):new __await(C)}function __asyncGenerator(C,E,w){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var R=w.apply(C,E||[]),M,x=[];return M={},S("next"),S("throw"),S("return"),M[Symbol.asyncIterator]=function(){return this},M;function S(ie){R[ie]&&(M[ie]=function(ne){return new Promise(function(re,oe){x.push([ie,ne,re,oe])>1||T(ie,ne)})})}function T(ie,ne){try{_(R[ie](ne))}catch(re){ee(x[0][3],re)}}function _(ie){ie.value instanceof __await?Promise.resolve(ie.value.v).then(D,Y):ee(x[0][2],ie)}function D(ie){T("next",ie)}function Y(ie){T("throw",ie)}function ee(ie,ne){ie(ne),x.shift(),x.length&&T(x[0][0],x[0][1])}}function __asyncDelegator(C){var E,w;return E={},R("next"),R("throw",function(M){throw M}),R("return"),E[Symbol.iterator]=function(){return this},E;function R(M,x){E[M]=C[M]?function(S){return(w=!w)?{value:__await(C[M](S)),done:M==="return"}:x?x(S):S}:x}}function __asyncValues(C){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var E=C[Symbol.asyncIterator],w;return E?E.call(C):(C=typeof __values=="function"?__values(C):C[Symbol.iterator](),w={},R("next"),R("throw"),R("return"),w[Symbol.asyncIterator]=function(){return this},w);function R(x){w[x]=C[x]&&function(S){return new Promise(function(T,_){S=C[x](S),M(T,_,S.done,S.value)})}}function M(x,S,T,_){Promise.resolve(_).then(function(D){x({value:D,done:T})},S)}}function __makeTemplateObject(C,E){return Object.defineProperty?Object.defineProperty(C,"raw",{value:E}):C.raw=E,C}function __importStar(C){if(C&&C.__esModule)return C;var E={};if(C!=null)for(var w in C)Object.hasOwnProperty.call(C,w)&&(E[w]=C[w]);return E.default=C,E}function __importDefault(C){return C&&C.__esModule?C:{default:C}}function __classPrivateFieldGet(C,E){if(!E.has(C))throw new TypeError("attempted to get private field on non-instance");return E.get(C)}function __classPrivateFieldSet(C,E,w){if(!E.has(C))throw new TypeError("attempted to set private field on non-instance");return E.set(C,w),w}const tslib_es6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return __assign},__asyncDelegator,__asyncGenerator,__asyncValues,__await,__awaiter,__classPrivateFieldGet,__classPrivateFieldSet,__createBinding,__decorate,__exportStar,__extends,__generator,__importDefault,__importStar,__makeTemplateObject,__metadata,__param,__read,__rest,__spread,__spreadArrays,__values},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(tslib_es6);var jsSha256={},constants={},hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,Object.defineProperty(constants,"__esModule",{value:!0}),constants.MAX_HASHABLE_LENGTH=constants.INIT=constants.KEY=constants.DIGEST_LENGTH=constants.BLOCK_SIZE=void 0,constants.BLOCK_SIZE=64,constants.DIGEST_LENGTH=32,constants.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),constants.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],constants.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1),constants}var RawSha256={},hasRequiredRawSha256;function requireRawSha256(){if(hasRequiredRawSha256)return RawSha256;hasRequiredRawSha256=1,Object.defineProperty(RawSha256,"__esModule",{value:!0}),RawSha256.RawSha256=void 0;var C=requireConstants(),E=function(){function w(){this.state=Int32Array.from(C.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return w.prototype.update=function(R){if(this.finished)throw new Error("Attempted to update an already finished hash.");var M=0,x=R.byteLength;if(this.bytesHashed+=x,this.bytesHashed*8>C.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;x>0;)this.buffer[this.bufferLength++]=R[M++],x--,this.bufferLength===C.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},w.prototype.digest=function(){if(!this.finished){var R=this.bytesHashed*8,M=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),x=this.bufferLength;if(M.setUint8(this.bufferLength++,128),x%C.BLOCK_SIZE>=C.BLOCK_SIZE-8){for(var S=this.bufferLength;S<C.BLOCK_SIZE;S++)M.setUint8(S,0);this.hashBuffer(),this.bufferLength=0}for(var S=this.bufferLength;S<C.BLOCK_SIZE-8;S++)M.setUint8(S,0);M.setUint32(C.BLOCK_SIZE-8,Math.floor(R/4294967296),!0),M.setUint32(C.BLOCK_SIZE-4,R),this.hashBuffer(),this.finished=!0}for(var T=new Uint8Array(C.DIGEST_LENGTH),S=0;S<8;S++)T[S*4]=this.state[S]>>>24&255,T[S*4+1]=this.state[S]>>>16&255,T[S*4+2]=this.state[S]>>>8&255,T[S*4+3]=this.state[S]>>>0&255;return T},w.prototype.hashBuffer=function(){for(var R=this,M=R.buffer,x=R.state,S=x[0],T=x[1],_=x[2],D=x[3],Y=x[4],ee=x[5],ie=x[6],ne=x[7],re=0;re<C.BLOCK_SIZE;re++){if(re<16)this.temp[re]=(M[re*4]&255)<<24|(M[re*4+1]&255)<<16|(M[re*4+2]&255)<<8|M[re*4+3]&255;else{var oe=this.temp[re-2],ae=(oe>>>17|oe<<15)^(oe>>>19|oe<<13)^oe>>>10;oe=this.temp[re-15];var le=(oe>>>7|oe<<25)^(oe>>>18|oe<<14)^oe>>>3;this.temp[re]=(ae+this.temp[re-7]|0)+(le+this.temp[re-16]|0)}var de=(((Y>>>6|Y<<26)^(Y>>>11|Y<<21)^(Y>>>25|Y<<7))+(Y&ee^~Y&ie)|0)+(ne+(C.KEY[re]+this.temp[re]|0)|0)|0,me=((S>>>2|S<<30)^(S>>>13|S<<19)^(S>>>22|S<<10))+(S&T^S&_^T&_)|0;ne=ie,ie=ee,ee=Y,Y=D+de|0,D=_,_=T,T=S,S=de+me|0}x[0]+=S,x[1]+=T,x[2]+=_,x[3]+=D,x[4]+=Y,x[5]+=ee,x[6]+=ie,x[7]+=ne},w}();return RawSha256.RawSha256=E,RawSha256}var build={},convertToBuffer={};const fromUtf8$2=C=>{const E=[];for(let w=0,R=C.length;w<R;w++){const M=C.charCodeAt(w);if(M<128)E.push(M);else if(M<2048)E.push(M>>6|192,M&63|128);else if(w+1<C.length&&(M&64512)===55296&&(C.charCodeAt(w+1)&64512)===56320){const x=65536+((M&1023)<<10)+(C.charCodeAt(++w)&1023);E.push(x>>18|240,x>>12&63|128,x>>6&63|128,x&63|128)}else E.push(M>>12|224,M>>6&63|128,M&63|128)}return Uint8Array.from(E)},toUtf8$2=C=>{let E="";for(let w=0,R=C.length;w<R;w++){const M=C[w];if(M<128)E+=String.fromCharCode(M);else if(192<=M&&M<224){const x=C[++w];E+=String.fromCharCode((M&31)<<6|x&63)}else if(240<=M&&M<365){const x="%"+[M,C[++w],C[++w],C[++w]].map(S=>S.toString(16)).join("%");E+=decodeURIComponent(x)}else E+=String.fromCharCode((M&15)<<12|(C[++w]&63)<<6|C[++w]&63)}return E};function fromUtf8$1(C){return new TextEncoder().encode(C)}function toUtf8$1(C){return new TextDecoder("utf-8").decode(C)}const fromUtf8=C=>typeof TextEncoder=="function"?fromUtf8$1(C):fromUtf8$2(C),toUtf8=C=>typeof TextDecoder=="function"?toUtf8$1(C):toUtf8$2(C),distEs$1=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8,toUtf8},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(distEs$1);var hasRequiredConvertToBuffer;function requireConvertToBuffer(){if(hasRequiredConvertToBuffer)return convertToBuffer;hasRequiredConvertToBuffer=1,Object.defineProperty(convertToBuffer,"__esModule",{value:!0}),convertToBuffer.convertToBuffer=void 0;var C=require$$0,E=typeof Buffer<"u"&&Buffer.from?function(R){return Buffer.from(R,"utf8")}:C.fromUtf8;function w(R){return R instanceof Uint8Array?R:typeof R=="string"?E(R):ArrayBuffer.isView(R)?new Uint8Array(R.buffer,R.byteOffset,R.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(R)}return convertToBuffer.convertToBuffer=w,convertToBuffer}var isEmptyData={},hasRequiredIsEmptyData;function requireIsEmptyData(){if(hasRequiredIsEmptyData)return isEmptyData;hasRequiredIsEmptyData=1,Object.defineProperty(isEmptyData,"__esModule",{value:!0}),isEmptyData.isEmptyData=void 0;function C(E){return typeof E=="string"?E.length===0:E.byteLength===0}return isEmptyData.isEmptyData=C,isEmptyData}var numToUint8={},hasRequiredNumToUint8;function requireNumToUint8(){if(hasRequiredNumToUint8)return numToUint8;hasRequiredNumToUint8=1,Object.defineProperty(numToUint8,"__esModule",{value:!0}),numToUint8.numToUint8=void 0;function C(E){return new Uint8Array([(E&4278190080)>>24,(E&16711680)>>16,(E&65280)>>8,E&255])}return numToUint8.numToUint8=C,numToUint8}var uint32ArrayFrom={},hasRequiredUint32ArrayFrom;function requireUint32ArrayFrom(){if(hasRequiredUint32ArrayFrom)return uint32ArrayFrom;hasRequiredUint32ArrayFrom=1,Object.defineProperty(uint32ArrayFrom,"__esModule",{value:!0}),uint32ArrayFrom.uint32ArrayFrom=void 0;function C(E){if(!Uint32Array.from){for(var w=new Uint32Array(E.length),R=0;R<E.length;)w[R]=E[R],R+=1;return w}return Uint32Array.from(E)}return uint32ArrayFrom.uint32ArrayFrom=C,uint32ArrayFrom}var hasRequiredBuild$2;function requireBuild$2(){return hasRequiredBuild$2||(hasRequiredBuild$2=1,function(C){Object.defineProperty(C,"__esModule",{value:!0}),C.uint32ArrayFrom=C.numToUint8=C.isEmptyData=C.convertToBuffer=void 0;var E=requireConvertToBuffer();Object.defineProperty(C,"convertToBuffer",{enumerable:!0,get:function(){return E.convertToBuffer}});var w=requireIsEmptyData();Object.defineProperty(C,"isEmptyData",{enumerable:!0,get:function(){return w.isEmptyData}});var R=requireNumToUint8();Object.defineProperty(C,"numToUint8",{enumerable:!0,get:function(){return R.numToUint8}});var M=requireUint32ArrayFrom();Object.defineProperty(C,"uint32ArrayFrom",{enumerable:!0,get:function(){return M.uint32ArrayFrom}})}(build)),build}var hasRequiredJsSha256;function requireJsSha256(){if(hasRequiredJsSha256)return jsSha256;hasRequiredJsSha256=1,Object.defineProperty(jsSha256,"__esModule",{value:!0}),jsSha256.Sha256=void 0;var C=require$$0$1,E=requireConstants(),w=requireRawSha256(),R=requireBuild$2(),M=function(){function S(T){if(this.hash=new w.RawSha256,T){this.outer=new w.RawSha256;var _=x(T),D=new Uint8Array(E.BLOCK_SIZE);D.set(_);for(var Y=0;Y<E.BLOCK_SIZE;Y++)_[Y]^=54,D[Y]^=92;this.hash.update(_),this.outer.update(D);for(var Y=0;Y<_.byteLength;Y++)_[Y]=0}}return S.prototype.update=function(T){if(!((0,R.isEmptyData)(T)||this.error))try{this.hash.update((0,R.convertToBuffer)(T))}catch(_){this.error=_}},S.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},S.prototype.digest=function(){return C.__awaiter(this,void 0,void 0,function(){return C.__generator(this,function(T){return[2,this.digestSync()]})})},S}();jsSha256.Sha256=M;function x(S){var T=(0,R.convertToBuffer)(S);if(T.byteLength>E.BLOCK_SIZE){var _=new w.RawSha256;_.update(T),T=_.digest()}var D=new Uint8Array(E.BLOCK_SIZE);return D.set(T),D}return jsSha256}var hasRequiredBuild$1;function requireBuild$1(){return hasRequiredBuild$1||(hasRequiredBuild$1=1,function(C){Object.defineProperty(C,"__esModule",{value:!0});var E=require$$0$1;E.__exportStar(requireJsSha256(),C)}(build$1)),build$1}const SHORT_TO_HEX={},HEX_TO_SHORT={};for(let C=0;C<256;C++){let E=C.toString(16).toLowerCase();E.length===1&&(E=`0${E}`),SHORT_TO_HEX[C]=E,HEX_TO_SHORT[E]=C}function fromHex(C){if(C.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const E=new Uint8Array(C.length/2);for(let w=0;w<C.length;w+=2){const R=C.slice(w,w+2).toLowerCase();if(R in HEX_TO_SHORT)E[w/2]=HEX_TO_SHORT[R];else throw new Error(`Cannot decode unrecognized sequence ${R} as hexadecimal`)}return E}function toHex(C){let E="";for(let w=0;w<C.byteLength;w++)E+=SHORT_TO_HEX[C[w]];return E}const distEs=Object.freeze(Object.defineProperty({__proto__:null,fromHex,toHex},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(distEs);var hasRequiredDefaultSigV4;function requireDefaultSigV4(){if(hasRequiredDefaultSigV4)return DefaultSigV4;hasRequiredDefaultSigV4=1;var C=DefaultSigV4&&DefaultSigV4.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=DefaultSigV4&&DefaultSigV4.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(DefaultSigV4,"__esModule",{value:!0});const w=requireBuild$1(),R=require$$1,M=E(requireVersioning());let x=class{constructor(S){this.chimeClient=S}makeTwoDigits(S){return S>9?S.toString():"0"+S.toString()}hmac(S,T){const _=new w.Sha256(T);return _.update(S),_.digest()}getDateTimeString(){const S=new Date;return S.getUTCFullYear()+this.makeTwoDigits(S.getUTCMonth()+1)+this.makeTwoDigits(S.getUTCDate())+"T"+this.makeTwoDigits(S.getUTCHours())+this.makeTwoDigits(S.getUTCMinutes())+this.makeTwoDigits(S.getUTCSeconds())+"Z"}getDateString(S){return S.substring(0,S.indexOf("T"))}getSignatureKey(S,T,_,D){return C(this,void 0,void 0,function*(){const Y=yield this.hmac(T,"AWS4"+S),ee=yield this.hmac(_,Y),ie=yield this.hmac(D,ee);return yield this.hmac("aws4_request",ie)})}signURL(S,T,_,D,Y,ee,ie){return C(this,void 0,void 0,function*(){const ne=this.getDateTimeString(),re=this.getDateString(ne),oe="AWS4-HMAC-SHA256";let ae="";this.chimeClient.config.region instanceof Function?ae=yield this.chimeClient.config.region():ae=this.chimeClient.config.region;const le="host",de="host:"+D.toLowerCase()+`
`,me=re+"/"+ae+"/"+_+"/aws4_request";let fe;this.chimeClient.config.credentials instanceof Function?fe=yield this.chimeClient.config.credentials():fe=this.chimeClient.config.credentials;let ge=new Map;ge.set("X-Amz-Algorithm",[oe]),ge.set("X-Amz-Credential",[encodeURIComponent(fe.accessKeyId+"/"+me)]),ge.set("X-Amz-Date",[ne]),ge.set("X-Amz-Expires",["10"]),ge.set("X-Amz-SignedHeaders",["host"]),fe.sessionToken&&ge.set("X-Amz-Security-Token",[encodeURIComponent(fe.sessionToken)]),ge.set(M.default.X_AMZN_VERSION,[encodeURIComponent(M.default.sdkVersion)]),ge.set(M.default.X_AMZN_USER_AGENT,[encodeURIComponent(M.default.sdkUserAgentLowResolution)]),ie==null||ie.forEach((Be,Qe)=>{const Pe=encodeURIComponent(Qe);Be.sort().forEach(je=>{ge.has(Pe)||ge.set(Pe,[]),ge.get(Pe).push(encodeURIComponent(je))})});let he="";ge=new Map([...ge.entries()].sort()),ge.forEach((Be,Qe)=>{Be.forEach(Pe=>{he.length&&(he+="&"),he+=Qe+"="+Pe})});const ve=S+`
`+Y+`
`+he+`
`+de+`
`+le+`
`+R.toHex(yield this.hmac(ee)),be=R.toHex(yield this.hmac(ve)),Se=`AWS4-HMAC-SHA256
`+ne+`
`+re+"/"+ae+"/"+_+`/aws4_request
`+be,Re=yield this.getSignatureKey(fe.secretAccessKey,re,ae,_),Ae=R.toHex(yield this.hmac(Se,Re)),Me=he+"&X-Amz-Signature="+Ae;return T+"://"+D+Y+"?"+Me})}};return DefaultSigV4.default=x,DefaultSigV4}var PrefetchOn={},hasRequiredPrefetchOn;function requirePrefetchOn(){if(hasRequiredPrefetchOn)return PrefetchOn;hasRequiredPrefetchOn=1,Object.defineProperty(PrefetchOn,"__esModule",{value:!0});var C;return function(E){E.Connect="connect"}(C||(C={})),PrefetchOn.default=C,PrefetchOn}var hasRequiredDefaultMessagingSession;function requireDefaultMessagingSession(){if(hasRequiredDefaultMessagingSession)return DefaultMessagingSession;hasRequiredDefaultMessagingSession=1;var C=DefaultMessagingSession&&DefaultMessagingSession.__awaiter||function(ne,re,oe,ae){function le(de){return de instanceof oe?de:new oe(function(me){me(de)})}return new(oe||(oe=Promise))(function(de,me){function fe(ve){try{he(ae.next(ve))}catch(be){me(be)}}function ge(ve){try{he(ae.throw(ve))}catch(be){me(be)}}function he(ve){ve.done?de(ve.value):le(ve.value).then(fe,ge)}he((ae=ae.apply(ne,re||[])).next())})},E=DefaultMessagingSession&&DefaultMessagingSession.__importDefault||function(ne){return ne&&ne.__esModule?ne:{default:ne}};Object.defineProperty(DefaultMessagingSession,"__esModule",{value:!0});const w=require$$0$2,R=E(requireFullJitterBackoff()),M=E(requireCSPMonitor()),x=E(requireMessage()),S=E(requireDefaultReconnectController()),T=E(requireAsyncScheduler()),_=E(requireDefaultSigV4()),D=E(requireDefaultWebSocketAdapter()),Y=E(requireWebSocketReadyState()),ee=E(requirePrefetchOn());let ie=class{constructor(ne,re,oe,ae,le){this.configuration=ne,this.logger=re,this.webSocket=oe,this.reconnectController=ae,this.sigV4=le,this.observerQueue=new Set,this.webSocket||(this.webSocket=new D.default(this.logger)),this.reconnectController||(this.reconnectController=new S.default(ne.reconnectTimeoutMs,new R.default(ne.reconnectFixedWaitMs,ne.reconnectShortBackoffMs,ne.reconnectLongBackoffMs))),this.sigV4||(this.sigV4=new _.default(this.configuration.chimeClient)),M.default.addLogger(this.logger),M.default.register(),this.preBootstrapMessages=[]}addObserver(ne){this.logger.info("adding messaging observer"),this.observerQueue.add(ne)}removeObserver(ne){this.logger.info("removing messaging observer"),this.observerQueue.delete(ne)}start(){return C(this,void 0,void 0,function*(){this.isClosed()?yield this.startConnecting(!1):this.logger.info("messaging session already started")})}stop(){this.isClosed()?this.logger.info("no existing messaging session needs closing"):(this.isClosing=!0,this.webSocket.close(),M.default.removeLogger(this.logger))}forEachObserver(ne){for(const re of this.observerQueue)T.default.nextTick(()=>{this.observerQueue.has(re)&&ne(re)})}setUpEventListeners(){this.webSocket.addEventListener("open",()=>{this.openEventHandler()}),this.webSocket.addEventListener("message",ne=>{this.receiveMessageHandler(ne.data)}),this.webSocket.addEventListener("close",ne=>{this.closeEventHandler(ne)}),this.webSocket.addEventListener("error",()=>{this.logger.error("WebSocket error")})}startConnecting(ne){return C(this,void 0,void 0,function*(){return yield this.startConnectingInternal(ne),yield new Promise((re,oe)=>{this.bootstrapResolved=re,this.bootstrapRejected=oe})})}startConnectingInternal(ne){var re;return C(this,void 0,void 0,function*(){let oe=this.configuration.endpointUrl;if(ne||this.reconnectController.reset(),this.reconnectController.hasStartedConnectionAttempt()?this.reconnectController.startedConnectionAttempt(!1):this.reconnectController.startedConnectionAttempt(!0),ne||oe===void 0)try{if(this.configuration.chimeClient.getMessagingSessionEndpoint instanceof Function){const le=yield this.configuration.chimeClient.getMessagingSessionEndpoint();!((re=le.Endpoint)===null||re===void 0)&&re.Url?oe=le.Endpoint.Url:oe=(yield this.configuration.chimeClient.getMessagingSessionEndpoint().promise()).Endpoint.Url}else oe=(yield this.configuration.chimeClient.send(new w.GetMessagingSessionEndpointCommand({}))).Endpoint.Url;this.logger.debug(`Messaging endpoint resolved to: ${oe}`)}catch(le){this.logger.error(`Messaging Session failed to resolve endpoint: ${le}`);const de=new CloseEvent("close",{wasClean:!1,code:4999,reason:"Failed to get messaging session endpoint URL",bubbles:!1});this.closeEventHandler(de);return}const ae=yield this.prepareWebSocketUrl(oe);this.logger.info(`opening connection to ${ae}`),ne||this.reconnectController.reset(),this.reconnectController.hasStartedConnectionAttempt()?this.reconnectController.startedConnectionAttempt(!1):this.reconnectController.startedConnectionAttempt(!0),this.webSocket.create(ae,[],!0),this.forEachObserver(le=>{le.messagingSessionDidStartConnecting&&le.messagingSessionDidStartConnecting(ne)}),this.setUpEventListeners()})}prepareWebSocketUrl(ne){return C(this,void 0,void 0,function*(){const re=new Map;return re.set("userArn",[this.configuration.userArn]),re.set("sessionId",[this.configuration.messagingSessionId]),this.configuration.prefetchOn===ee.default.Connect&&re.set("prefetch-on",[ee.default.Connect]),this.configuration.prefetchSortBy&&re.set("prefetch-sort-by",[this.configuration.prefetchSortBy]),yield this.sigV4.signURL("GET","wss","chime",ne,"/connect","",re)})}isClosed(){return this.webSocket.readyState()===Y.default.None||this.webSocket.readyState()===Y.default.Closed}openEventHandler(){this.reconnectController.reset(),this.isSessionEstablished=!1}receiveMessageHandler(ne){try{const re=JSON.parse(ne),oe=re.Headers["x-amz-chime-event-type"],ae=new x.default(oe,re.Headers,re.Payload||null);if(!this.isSessionEstablished&&oe==="SESSION_ESTABLISHED"){this.forEachObserver(de=>{de.messagingSessionDidStart&&de.messagingSessionDidStart()}),this.bootstrapResolved(),this.isSessionEstablished=!0;const le=this.preBootstrapMessages.length;for(let de=0;de<le;de++){const me=this.preBootstrapMessages.shift();this.forEachObserver(fe=>{this.sendMessageToObserver(fe,me)})}}else if(!this.isSessionEstablished){this.preBootstrapMessages.push(ae);return}this.forEachObserver(le=>{this.sendMessageToObserver(le,ae)})}catch(re){this.logger.error(`Messaging parsing failed: ${re}`)}}sendMessageToObserver(ne,re){ne.messagingSessionDidReceiveMessage&&ne.messagingSessionDidReceiveMessage(re)}retryConnection(){return this.reconnectController.retryWithBackoff(()=>C(this,void 0,void 0,function*(){yield this.startConnecting(!0)}),null)}closeEventHandler(ne){this.logger.info(`WebSocket close: ${ne.code} ${ne.reason}`),ne.code!==4999&&this.webSocket.destroy(),!(!this.isClosing&&this.canReconnect(ne.code)&&this.retryConnection())&&(this.isClosing=!1,this.isSessionEstablished?this.forEachObserver(re=>{re.messagingSessionDidStop&&re.messagingSessionDidStop(ne)}):this.bootstrapRejected(ne))}canReconnect(ne){return ne===1001||ne===1006||ne>=1011&&ne<=1014||ne>4e3&&ne!==4002&&ne!==4003&&ne!==4401}};return DefaultMessagingSession.default=ie,DefaultMessagingSession}var FullJitterBackoffFactory={},FullJitterLimitedBackoff={},hasRequiredFullJitterLimitedBackoff;function requireFullJitterLimitedBackoff(){if(hasRequiredFullJitterLimitedBackoff)return FullJitterLimitedBackoff;hasRequiredFullJitterLimitedBackoff=1;var C=FullJitterLimitedBackoff&&FullJitterLimitedBackoff.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(FullJitterLimitedBackoff,"__esModule",{value:!0});const E=C(requireFullJitterBackoff());let w=class extends E.default{constructor(R,M,x,S){super(R,M,x),this.limit=S,this.attempts=0}nextBackoffAmountMs(){if(this.attempts++,this.attempts>this.limit)throw new Error("retry limit exceeded");return super.nextBackoffAmountMs()}};return FullJitterLimitedBackoff.default=w,FullJitterLimitedBackoff}var hasRequiredFullJitterBackoffFactory;function requireFullJitterBackoffFactory(){if(hasRequiredFullJitterBackoffFactory)return FullJitterBackoffFactory;hasRequiredFullJitterBackoffFactory=1;var C=FullJitterBackoffFactory&&FullJitterBackoffFactory.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(FullJitterBackoffFactory,"__esModule",{value:!0});const E=C(requireFullJitterBackoff()),w=C(requireFullJitterLimitedBackoff());let R=class{constructor(M,x,S){this.fixedWaitMs=M,this.shortBackoffMs=x,this.longBackoffMs=S}create(){return new E.default(this.fixedWaitMs,this.shortBackoffMs,this.longBackoffMs)}createWithLimit(M){return new w.default(this.fixedWaitMs,this.shortBackoffMs,this.longBackoffMs,M)}};return FullJitterBackoffFactory.default=R,FullJitterBackoffFactory}var Log={},hasRequiredLog;function requireLog(){if(hasRequiredLog)return Log;hasRequiredLog=1,Object.defineProperty(Log,"__esModule",{value:!0});let C=class{constructor(E,w,R,M){this.sequenceNumber=E,this.message=w,this.timestampMs=R,this.logLevel=M}};return Log.default=C,Log}var MessagingSessionConfiguration={},hasRequiredMessagingSessionConfiguration;function requireMessagingSessionConfiguration(){if(hasRequiredMessagingSessionConfiguration)return MessagingSessionConfiguration;hasRequiredMessagingSessionConfiguration=1,Object.defineProperty(MessagingSessionConfiguration,"__esModule",{value:!0});const C=requireUtils();let E=class{constructor(w,R,M,x){this.userArn=w,this.messagingSessionId=R,this.endpointUrl=M,this.chimeClient=x,this.reconnectTimeoutMs=10*1e3,this.reconnectFixedWaitMs=0,this.reconnectShortBackoffMs=1*1e3,this.reconnectLongBackoffMs=5*1e3,this.prefetchOn=void 0,this.prefetchSortBy=void 0,this.messagingSessionId||(this.messagingSessionId=this.generateSessionId())}generateSessionId(){const w=new Uint32Array(1);return C.getRandomValues(w),w[0].toString()}};return MessagingSessionConfiguration.default=E,MessagingSessionConfiguration}var MultiLogger={},hasRequiredMultiLogger;function requireMultiLogger(){if(hasRequiredMultiLogger)return MultiLogger;hasRequiredMultiLogger=1;var C=MultiLogger&&MultiLogger.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(MultiLogger,"__esModule",{value:!0});const E=C(requireLogLevel());let w=class{constructor(...R){this._loggers=R}info(R){for(const M of this._loggers)M.info(R)}warn(R){for(const M of this._loggers)M.warn(R)}error(R){for(const M of this._loggers)M.error(R)}debug(R){let M,x;typeof R=="string"?x=R:R?x=()=>(M||(M=R()),M):x=""+R;for(const S of this._loggers)S.debug(x)}setLogLevel(R){for(const M of this._loggers)M.setLogLevel(R)}getLogLevel(){for(const R of this._loggers)return R.getLogLevel();return E.default.OFF}};return MultiLogger.default=w,MultiLogger}var NoOpAudioVideoController={},NoOpDebugLogger={},NoOpLogger={},hasRequiredNoOpLogger;function requireNoOpLogger(){if(hasRequiredNoOpLogger)return NoOpLogger;hasRequiredNoOpLogger=1;var C=NoOpLogger&&NoOpLogger.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(NoOpLogger,"__esModule",{value:!0});const E=C(requireLogLevel());let w=class{constructor(R=E.default.OFF){this.level=R}info(R){}warn(R){}error(R){}debug(R){E.default.DEBUG<this.level||typeof R!="string"&&R()}setLogLevel(R){this.level=R}getLogLevel(){return this.level}};return NoOpLogger.default=w,NoOpLogger}var hasRequiredNoOpDebugLogger;function requireNoOpDebugLogger(){if(hasRequiredNoOpDebugLogger)return NoOpDebugLogger;hasRequiredNoOpDebugLogger=1;var C=NoOpDebugLogger&&NoOpDebugLogger.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(NoOpDebugLogger,"__esModule",{value:!0});const E=C(requireLogLevel()),w=C(requireNoOpLogger());let R=class extends w.default{constructor(){super(E.default.DEBUG)}};return NoOpDebugLogger.default=R,NoOpDebugLogger}var NoOpMediaStreamBroker={},hasRequiredNoOpMediaStreamBroker;function requireNoOpMediaStreamBroker(){if(hasRequiredNoOpMediaStreamBroker)return NoOpMediaStreamBroker;hasRequiredNoOpMediaStreamBroker=1,Object.defineProperty(NoOpMediaStreamBroker,"__esModule",{value:!0});let C=class{acquireAudioInputStream(){return Promise.reject()}acquireVideoInputStream(){return Promise.reject()}acquireDisplayInputStream(E){return Promise.reject()}muteLocalAudioInputStream(){}unmuteLocalAudioInputStream(){}addMediaStreamBrokerObserver(E){}removeMediaStreamBrokerObserver(E){}};return NoOpMediaStreamBroker.default=C,NoOpMediaStreamBroker}var hasRequiredNoOpAudioVideoController;function requireNoOpAudioVideoController(){if(hasRequiredNoOpAudioVideoController)return NoOpAudioVideoController;hasRequiredNoOpAudioVideoController=1;var C=NoOpAudioVideoController&&NoOpAudioVideoController.__importDefault||function(re){return re&&re.__esModule?re:{default:re}};Object.defineProperty(NoOpAudioVideoController,"__esModule",{value:!0});const E=C(requireFullJitterBackoff()),w=C(requireDefaultEventController()),R=C(requireNoOpDebugLogger()),M=C(requireNoOpMediaStreamBroker()),x=C(requireMeetingSessionConfiguration()),S=C(requireMeetingSessionCredentials()),T=C(requireMeetingSessionStatus()),_=C(requireMeetingSessionStatusCode()),D=C(requireMeetingSessionURLs()),Y=C(requireDefaultReconnectController()),ee=C(requireDefaultWebSocketAdapter()),ie=C(requireDefaultAudioVideoController());let ne=class extends ie.default{constructor(re){const oe=new x.default;oe.meetingId="",oe.externalMeetingId="",oe.credentials=new S.default,oe.credentials.attendeeId="",oe.credentials.joinToken="",oe.urls=new D.default,oe.urls.turnControlURL="",oe.urls.audioHostURL="",oe.urls.signalingURL="wss://localhost/";const ae=new R.default;super(re||oe,ae,new ee.default(new R.default),new M.default,new Y.default(0,new E.default(0,0,0)),new w.default(re||oe,ae))}setAudioProfile(re){}start(){}stop(){}promoteToPrimaryMeeting(re){return Promise.resolve(new T.default(_.default.OK))}demoteFromPrimaryMeeting(){}};return NoOpAudioVideoController.default=ne,NoOpAudioVideoController}var NoOpDeviceController={},hasRequiredNoOpDeviceController;function requireNoOpDeviceController(){if(hasRequiredNoOpDeviceController)return NoOpDeviceController;hasRequiredNoOpDeviceController=1;var C=NoOpDeviceController&&NoOpDeviceController.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=NoOpDeviceController&&NoOpDeviceController.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(NoOpDeviceController,"__esModule",{value:!0}),NoOpDeviceController.NoOpDeviceControllerWithEventController=void 0;const w=E(requireNoOpMediaStreamBroker()),R=E(requireVideoQualitySettings());let M=class extends w.default{constructor(S){super(),this.destroyed=!1}destroy(){return C(this,void 0,void 0,function*(){this.destroyed=!0})}listAudioInputDevices(){return Promise.resolve([])}listVideoInputDevices(){return Promise.resolve([])}listAudioOutputDevices(){return Promise.resolve([])}startAudioInput(S){return Promise.reject()}stopAudioInput(){return Promise.resolve()}startVideoInput(S){return Promise.reject()}stopVideoInput(){return Promise.resolve()}chooseAudioOutput(S){return Promise.reject()}addDeviceChangeObserver(S){}removeDeviceChangeObserver(S){}createAnalyserNodeForAudioInput(){return null}startVideoPreviewForVideoInput(S){}stopVideoPreviewForVideoInput(S){}setDeviceLabelTrigger(S){}mixIntoAudioInput(S){return null}chooseVideoInputQuality(S,T,_){}getVideoInputQualitySettings(){return R.default.VideoDisabled}};NoOpDeviceController.default=M;class x extends M{constructor(T){super(),this.eventController=T}}return NoOpDeviceController.NoOpDeviceControllerWithEventController=x,NoOpDeviceController}var NoOpEventReporter={},hasRequiredNoOpEventReporter;function requireNoOpEventReporter(){if(hasRequiredNoOpEventReporter)return NoOpEventReporter;hasRequiredNoOpEventReporter=1,Object.defineProperty(NoOpEventReporter,"__esModule",{value:!0});let C=class{constructor(){}reportEvent(E,w,R){}start(){}stop(){}};return NoOpEventReporter.default=C,NoOpEventReporter}var NoOpTask={},hasRequiredNoOpTask;function requireNoOpTask(){if(hasRequiredNoOpTask)return NoOpTask;hasRequiredNoOpTask=1,Object.defineProperty(NoOpTask,"__esModule",{value:!0});let C=class{cancel(){}name(){return"NoOpTask"}run(){return Promise.resolve()}setParent(E){}};return NoOpTask.default=C,NoOpTask}var NoOpVideoElementFactory={},hasRequiredNoOpVideoElementFactory;function requireNoOpVideoElementFactory(){if(hasRequiredNoOpVideoElementFactory)return NoOpVideoElementFactory;hasRequiredNoOpVideoElementFactory=1,Object.defineProperty(NoOpVideoElementFactory,"__esModule",{value:!0});let C=class{create(){const E={clientWidth:400,clientHeight:300,width:400,height:300,videoWidth:400,videoHeight:300,style:{transform:""},hasAttribute:()=>!1,removeAttribute:()=>{},setAttribute:()=>{},srcObject:!1,paused:!0,pause:()=>{E.paused=!0},play:()=>(E.paused=!1,Promise.resolve())};return E}};return NoOpVideoElementFactory.default=C,NoOpVideoElementFactory}var NoVideoUplinkBandwidthPolicy={},hasRequiredNoVideoUplinkBandwidthPolicy;function requireNoVideoUplinkBandwidthPolicy(){if(hasRequiredNoVideoUplinkBandwidthPolicy)return NoVideoUplinkBandwidthPolicy;hasRequiredNoVideoUplinkBandwidthPolicy=1;var C=NoVideoUplinkBandwidthPolicy&&NoVideoUplinkBandwidthPolicy.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(NoVideoUplinkBandwidthPolicy,"__esModule",{value:!0});const E=C(requireDefaultVideoCaptureAndEncodeParameter());let w=class{constructor(){}updateConnectionMetric(R){}chooseMediaTrackConstraints(){return{}}chooseEncodingParameters(){return new Map}updateIndex(R){}wantsResubscribe(){return!1}chooseCaptureAndEncodeParameters(){return new E.default(0,0,0,0,!1)}maxBandwidthKbps(){return 0}setIdealMaxBandwidthKbps(R){}setHasBandwidthPriority(R){}setHighResolutionFeatureEnabled(R){}wantsVideoDependencyDescriptorRtpHeaderExtension(){return!1}};return NoVideoUplinkBandwidthPolicy.default=w,NoVideoUplinkBandwidthPolicy}var POSTLogger={},hasRequiredPOSTLogger;function requirePOSTLogger(){if(hasRequiredPOSTLogger)return POSTLogger;hasRequiredPOSTLogger=1;var C=POSTLogger&&POSTLogger.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})},E=POSTLogger&&POSTLogger.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(POSTLogger,"__esModule",{value:!0});const w=E(requireIntervalScheduler()),R=E(requireLog()),M=E(requireLogLevel());let x=class Kd{constructor(T){this.logCapture=[],this.lock=!1,this.sequenceNumber=0;const{url:_,batchSize:D=Kd.BATCH_SIZE,intervalMs:Y=Kd.INTERVAL_MS,logLevel:ee=M.default.WARN,metadata:ie,headers:ne}=T;this.url=_,this.batchSize=D,this.intervalMs=Y,this.logLevel=ee,this.metadata=ie,this.headers=ne,this.start(),this.eventListener=()=>{this.stop()},this.addEventListener()}addEventListener(){!this.eventListener||!("window"in commonjsGlobal)||!window.addEventListener||window.addEventListener("unload",this.eventListener)}removeEventListener(){!this.eventListener||!("window"in commonjsGlobal)||!window.removeEventListener||window.removeEventListener("unload",this.eventListener)}debug(T){M.default.DEBUG<this.logLevel||(typeof T=="string"?this.log(M.default.DEBUG,T):T?this.log(M.default.DEBUG,T()):this.log(M.default.DEBUG,""+T))}info(T){this.log(M.default.INFO,T)}warn(T){this.log(M.default.WARN,T)}error(T){this.log(M.default.ERROR,T)}setLogLevel(T){this.logLevel=T}getLogLevel(){return this.logLevel}getLogCaptureSize(){return this.logCapture.length}start(){this.addEventListener(),this.intervalScheduler=new w.default(this.intervalMs),this.intervalScheduler.start(()=>C(this,void 0,void 0,function*(){if(this.lock===!0||this.getLogCaptureSize()===0)return;this.lock=!0;const T=this.logCapture.slice(0,this.batchSize),_=this.makeRequestBody(T);try{(yield fetch(this.url,Object.assign({method:"POST",body:_},this.headers?{headers:this.headers}:{}))).status===200&&(this.logCapture=this.logCapture.slice(T.length))}catch(D){console.warn("[POSTLogger] "+D.message)}finally{this.lock=!1}}))}stop(){var T;(T=this.intervalScheduler)===null||T===void 0||T.stop(),this.intervalScheduler=void 0,this.removeEventListener();const _=this.makeRequestBody(this.logCapture);navigator.sendBeacon(this.url,_)}destroy(){return C(this,void 0,void 0,function*(){this.stop(),this.metadata=void 0,this.headers=void 0,this.logCapture=[],this.sequenceNumber=0,this.lock=!1,this.batchSize=0,this.intervalMs=0,this.url=void 0})}makeRequestBody(T){return JSON.stringify(Object.assign(Object.assign({},this.metadata),{logs:T}))}log(T,_){if(T<this.logLevel)return;const D=Date.now();this.logCapture.push(new R.default(this.sequenceNumber,_,D,M.default[T])),this.sequenceNumber+=1}};return POSTLogger.default=x,x.BATCH_SIZE=85,x.INTERVAL_MS=2e3,POSTLogger}var PrefetchSortBy={},hasRequiredPrefetchSortBy;function requirePrefetchSortBy(){if(hasRequiredPrefetchSortBy)return PrefetchSortBy;hasRequiredPrefetchSortBy=1,Object.defineProperty(PrefetchSortBy,"__esModule",{value:!0});var C;return function(E){E.Unread="unread",E.LastMessageTimestamp="last-message-timestamp"}(C||(C={})),PrefetchSortBy.default=C,PrefetchSortBy}var RealtimeAttendeePositionInFrame={},hasRequiredRealtimeAttendeePositionInFrame;function requireRealtimeAttendeePositionInFrame(){if(hasRequiredRealtimeAttendeePositionInFrame)return RealtimeAttendeePositionInFrame;hasRequiredRealtimeAttendeePositionInFrame=1,Object.defineProperty(RealtimeAttendeePositionInFrame,"__esModule",{value:!0});let C=class{constructor(){this.attendeeIndex=null,this.attendeesInFrame=null}};return RealtimeAttendeePositionInFrame.default=C,RealtimeAttendeePositionInFrame}var RunnableTask={},hasRequiredRunnableTask;function requireRunnableTask(){if(hasRequiredRunnableTask)return RunnableTask;hasRequiredRunnableTask=1;var C=RunnableTask&&RunnableTask.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(RunnableTask,"__esModule",{value:!0});const E=C(requireBaseTask());let w=class extends E.default{constructor(R,M,x="RunnableTask"){super(R),this.fn=M,this.taskName=x}run(){return this.fn().then(()=>{})}};return RunnableTask.default=w,RunnableTask}var SingleNodeAudioTransformDevice={},hasRequiredSingleNodeAudioTransformDevice;function requireSingleNodeAudioTransformDevice(){if(hasRequiredSingleNodeAudioTransformDevice)return SingleNodeAudioTransformDevice;hasRequiredSingleNodeAudioTransformDevice=1;var C=SingleNodeAudioTransformDevice&&SingleNodeAudioTransformDevice.__awaiter||function(w,R,M,x){function S(T){return T instanceof M?T:new M(function(_){_(T)})}return new(M||(M=Promise))(function(T,_){function D(ie){try{ee(x.next(ie))}catch(ne){_(ne)}}function Y(ie){try{ee(x.throw(ie))}catch(ne){_(ne)}}function ee(ie){ie.done?T(ie.value):S(ie.value).then(D,Y)}ee((x=x.apply(w,R||[])).next())})};Object.defineProperty(SingleNodeAudioTransformDevice,"__esModule",{value:!0});let E=class{constructor(w){this.inner=w}mute(w){return C(this,void 0,void 0,function*(){})}stop(){var w;return C(this,void 0,void 0,function*(){(w=this.node)===null||w===void 0||w.disconnect()})}intrinsicDevice(){return C(this,void 0,void 0,function*(){return this.inner})}createAudioNode(w){var R;return C(this,void 0,void 0,function*(){return(R=this.node)===null||R===void 0||R.disconnect(),this.node=yield this.createSingleAudioNode(w),{start:this.node,end:this.node}})}};return SingleNodeAudioTransformDevice.default=E,SingleNodeAudioTransformDevice}var TranscriptAlternative={},hasRequiredTranscriptAlternative;function requireTranscriptAlternative(){if(hasRequiredTranscriptAlternative)return TranscriptAlternative;hasRequiredTranscriptAlternative=1,Object.defineProperty(TranscriptAlternative,"__esModule",{value:!0});let C=class{};return TranscriptAlternative.default=C,TranscriptAlternative}var TranscriptEntity={},hasRequiredTranscriptEntity;function requireTranscriptEntity(){if(hasRequiredTranscriptEntity)return TranscriptEntity;hasRequiredTranscriptEntity=1,Object.defineProperty(TranscriptEntity,"__esModule",{value:!0});let C=class{};return TranscriptEntity.default=C,TranscriptEntity}var TranscriptItem={},hasRequiredTranscriptItem;function requireTranscriptItem(){if(hasRequiredTranscriptItem)return TranscriptItem;hasRequiredTranscriptItem=1,Object.defineProperty(TranscriptItem,"__esModule",{value:!0});let C=class{};return TranscriptItem.default=C,TranscriptItem}var TranscriptLanguageWithScore={},hasRequiredTranscriptLanguageWithScore;function requireTranscriptLanguageWithScore(){if(hasRequiredTranscriptLanguageWithScore)return TranscriptLanguageWithScore;hasRequiredTranscriptLanguageWithScore=1,Object.defineProperty(TranscriptLanguageWithScore,"__esModule",{value:!0});let C=class{};return TranscriptLanguageWithScore.default=C,TranscriptLanguageWithScore}var TranscriptResult={},hasRequiredTranscriptResult;function requireTranscriptResult(){if(hasRequiredTranscriptResult)return TranscriptResult;hasRequiredTranscriptResult=1,Object.defineProperty(TranscriptResult,"__esModule",{value:!0});let C=class{};return TranscriptResult.default=C,TranscriptResult}var VideoFxProcessor={},DeferredPromise={},hasRequiredDeferredPromise;function requireDeferredPromise(){if(hasRequiredDeferredPromise)return DeferredPromise;hasRequiredDeferredPromise=1,Object.defineProperty(DeferredPromise,"__esModule",{value:!0}),DeferredPromise.DeferredPromise=void 0;let C=class{constructor(){this.promise=new Promise((E,w)=>{this.resolve=E,this.reject=w})}getPromise(){return this.promise}resolvePromise(E){this.resolve(E)}resolveAndReplacePromise(E){this.resolve(E),this.promise=new Promise((w,R)=>{this.resolve=w,this.reject=R})}rejectPromise(E){this.reject(E)}rejectAndReplacePromise(E){this.reject(E),this.promise=new Promise((w,R)=>{this.resolve=w,this.reject=R})}};return DeferredPromise.DeferredPromise=C,DeferredPromise}var VideoFxCanvasOpsManager={},VideoFxConstants={},hasRequiredVideoFxConstants;function requireVideoFxConstants(){if(hasRequiredVideoFxConstants)return VideoFxConstants;hasRequiredVideoFxConstants=1,Object.defineProperty(VideoFxConstants,"__esModule",{value:!0}),VideoFxConstants.FXLIB_PATH=VideoFxConstants.WORKER_PATH=VideoFxConstants.CDN_BASE_PATH=VideoFxConstants.RESOURCE_CONSTRAINTS=VideoFxConstants.SEGMENTATION_MODEL=VideoFxConstants.DEFAULT_STREAM_PARAMETERS=VideoFxConstants.WORKER_MSG=void 0,VideoFxConstants.WORKER_MSG={BUILD_ENGINE_REQUEST:"BuildEngineRequest",BUILD_ENGINE_RESPONSE:"BuildEngineResponse",PERFORM_SEGMENTATION_REQUEST:"PerformSegmentationRequest",PERFORM_SEGMENTATION_RESPONSE:"PerformSegmentationResponse",PERFORM_SEGMENTATION_SAB_REQUEST:"PerformSegmentationSABRequest",PERFORM_SEGMENTATION_SAB_RESPONSE:"PerformSegmentationSABResponse",DESTROY_ASSETS_REQUEST:"DestroyAssetsRequest",DESTROY_ASSETS_RESPONSE:"DestroyAssetsResponse",CLOSE_WORKER_REQUEST:"CloseWorkerRequest"},VideoFxConstants.DEFAULT_STREAM_PARAMETERS={FRAMES_PER_SECOND:15,WIDTH_IN_PIXEL:960,HEIGHT_IN_PIXEL:540,CHANNEL_COUNT:4},VideoFxConstants.SEGMENTATION_MODEL={LOAD_SUCCESS:2,WIDTH_IN_PIXELS:176,HEIGHT_IN_PIXELS:160},VideoFxConstants.RESOURCE_CONSTRAINTS={DEFAULT_PROCESSING_BUDGET_PER_FRAME:50,SEGMENTATION_DEFAULT_FRAMES_PER_SEGMENTATION:1,SEGMENTATION_SAMPLING_PERIOD_FRAME_COUNT:500,BLUR_DEFAULT_CYCLE_PERCENTAGE:10,BLUR_SAMPLING_PERIOD_FRAME_COUNT:1e3,MIN_PROCESSING_BUDGET:0,MAX_PROCESSING_BUDGET:100},VideoFxConstants.CDN_BASE_PATH="https://static.sdkassets.chime.aws";const C="/ml_media_fx/otherassets";return VideoFxConstants.WORKER_PATH=`${C}/worker.js`,VideoFxConstants.FXLIB_PATH=`${C}/fxlib.js`,VideoFxConstants}var hasRequiredVideoFxCanvasOpsManager;function requireVideoFxCanvasOpsManager(){if(hasRequiredVideoFxCanvasOpsManager)return VideoFxCanvasOpsManager;hasRequiredVideoFxCanvasOpsManager=1;var C=VideoFxCanvasOpsManager&&VideoFxCanvasOpsManager.__awaiter||function(R,M,x,S){function T(_){return _ instanceof x?_:new x(function(D){D(_)})}return new(x||(x=Promise))(function(_,D){function Y(ne){try{ie(S.next(ne))}catch(re){D(re)}}function ee(ne){try{ie(S.throw(ne))}catch(re){D(re)}}function ie(ne){ne.done?_(ne.value):T(ne.value).then(Y,ee)}ie((S=S.apply(R,M||[])).next())})};Object.defineProperty(VideoFxCanvasOpsManager,"__esModule",{value:!0}),VideoFxCanvasOpsManager.VideoFxCanvasOpsManager=void 0;const E=requireVideoFxConstants();let w=class{constructor(R,M){this.streamParameters=R,this.outputCanvas=M,this.configureCanvasPipeline()}getInferenceInputData(R){return this.inferenceCtx.save(),this.inferenceCtx.scale(this.horizontalResizeScalar,this.verticalResizeScalar),this.inferenceCtx.drawImage(R,0,0),this.inferenceCtx.restore(),this.inferenceCtx.getImageData(0,0,E.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,E.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS)}configureForStreamParameters(R){return C(this,void 0,void 0,function*(){if(this.streamParameters=R,this.outputCanvas.width=this.streamParameters.width,this.outputCanvas.height=this.streamParameters.height,this.backgroundReplacementCanvas){const M=document.createElement("canvas");M.width=this.streamParameters.width,M.height=this.streamParameters.height,M.getContext("2d").drawImage(this.backgroundReplacementCanvas,0,0,this.streamParameters.width,this.streamParameters.height),this.backgroundReplacementCanvas=M}this.configureCanvasPipeline()})}configureCanvasPipeline(){this.inferenceCanvas=document.createElement("canvas"),this.inferenceCtx=this.inferenceCanvas.getContext("2d",{willReadFrequently:!0}),this.inferenceCanvas.width=E.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,this.inferenceCanvas.height=E.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS,this.horizontalResizeScalar=E.SEGMENTATION_MODEL.WIDTH_IN_PIXELS/this.streamParameters.width,this.verticalResizeScalar=E.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS/this.streamParameters.height}getBackgroundReplacementCanvas(){return this.backgroundReplacementCanvas}loadReplacementBackground(R){return C(this,void 0,void 0,function*(){const M=R.backgroundReplacement.backgroundImageURL,x=R.backgroundReplacement.defaultColor;if(M)try{const S=yield this.loadImage(M);this.backgroundReplacementImage=S,this.resizeAndSetReplacementImage(this.backgroundReplacementImage)}catch(S){throw this.logger.error(S),new Error("Failed to set the replacement image.")}else this.resizeAndSetReplacementColor(x)})}resizeAndSetReplacementImage(R){const M=document.createElement("canvas"),x=M.getContext("2d");M.width=this.streamParameters.width,M.height=this.streamParameters.height,x.drawImage(R,0,0,this.streamParameters.width,this.streamParameters.height),this.backgroundReplacementCanvas=M}resizeAndSetReplacementColor(R){const M=document.createElement("canvas"),x=M.getContext("2d");M.width=this.streamParameters.width,M.height=this.streamParameters.height,x.fillStyle=R,x.fillRect(0,0,this.streamParameters.width,this.streamParameters.height),this.backgroundReplacementCanvas=M}loadImage(R){return C(this,void 0,void 0,function*(){const M=yield(yield fetch(R).catch(S=>{throw this.logger.error(S.toString()),new Error("Failed to fetch image.")})).blob(),x=new Image;return x.src=URL.createObjectURL(M),new Promise((S,T)=>{x.onload=()=>{S(x)},x.onerror=_=>{T(_)}})})}};return VideoFxCanvasOpsManager.VideoFxCanvasOpsManager=w,VideoFxCanvasOpsManager}var VideoFxSegmentationRateManager={},hasRequiredVideoFxSegmentationRateManager;function requireVideoFxSegmentationRateManager(){if(hasRequiredVideoFxSegmentationRateManager)return VideoFxSegmentationRateManager;hasRequiredVideoFxSegmentationRateManager=1,Object.defineProperty(VideoFxSegmentationRateManager,"__esModule",{value:!0}),VideoFxSegmentationRateManager.VideoFxSegmentationRateManager=void 0;const C=requireVideoFxConstants();let E=class{constructor(w,R){this.logger=w,this.targetSegmentationCyclePercentage=R/100,this.frameCountOverSamplingPeriod=0,this.totalSegmentationDurationOverSamplingPeriod=0,this.samplingPeriodStartTime=performance.now(),this.framesPerSegmentation=C.RESOURCE_CONSTRAINTS.SEGMENTATION_DEFAULT_FRAMES_PER_SEGMENTATION}submitFrame(){this.frameCountOverSamplingPeriod++}shouldApplySegmentation(){return this.frameCountOverSamplingPeriod%this.framesPerSegmentation===0}startSegmentation(){this.frameSegmentationStartTime=performance.now()}completeSegmentation(){this.totalSegmentationDurationOverSamplingPeriod+=performance.now()-this.frameSegmentationStartTime,this.frameCountOverSamplingPeriod>=C.RESOURCE_CONSTRAINTS.SEGMENTATION_SAMPLING_PERIOD_FRAME_COUNT&&this.adjustFramesPerSegmentation(this.totalSegmentationDurationOverSamplingPeriod/(performance.now()-this.samplingPeriodStartTime))}adjustFramesPerSegmentation(w){w>this.targetSegmentationCyclePercentage?(this.framesPerSegmentation++,this.logger.info(`Segmentation cycle percentage above the configured maximal value. Decreasing segmentation rate to 1 segmentation per ${this.framesPerSegmentation} frames`)):this.framesPerSegmentation>1&&w<this.targetSegmentationCyclePercentage&&(this.framesPerSegmentation--,this.logger.info(`Segmentation cycle percentage below the configured maximal value. Increasing segmentation rate to 1 segmentation per ${this.framesPerSegmentation} frames`)),this.totalSegmentationDurationOverSamplingPeriod=0,this.frameCountOverSamplingPeriod=0,this.samplingPeriodStartTime=performance.now()}};return VideoFxSegmentationRateManager.VideoFxSegmentationRateManager=E,VideoFxSegmentationRateManager}var hasRequiredVideoFxProcessor;function requireVideoFxProcessor(){if(hasRequiredVideoFxProcessor)return VideoFxProcessor;hasRequiredVideoFxProcessor=1;var C=VideoFxProcessor&&VideoFxProcessor.__awaiter||function(oe,ae,le,de){function me(fe){return fe instanceof le?fe:new le(function(ge){ge(fe)})}return new(le||(le=Promise))(function(fe,ge){function he(Se){try{be(de.next(Se))}catch(Re){ge(Re)}}function ve(Se){try{be(de.throw(Se))}catch(Re){ge(Re)}}function be(Se){Se.done?fe(Se.value):me(Se.value).then(he,ve)}be((de=de.apply(oe,ae||[])).next())})},E=VideoFxProcessor&&VideoFxProcessor.__importDefault||function(oe){return oe&&oe.__esModule?oe:{default:oe}};Object.defineProperty(VideoFxProcessor,"__esModule",{value:!0});const w=requireFetch(),R=requireLoader(),M=requireSupport(),x=E(requireDefaultBrowserBehavior()),S=E(requireNoOpLogger()),T=requireUtils(),_=E(requireVersioning()),D=E(requireCanvasVideoFrameBuffer()),Y=requireDeferredPromise(),ee=requireVideoFxCanvasOpsManager(),ie=requireVideoFxConstants(),ne=requireVideoFxSegmentationRateManager();let re=class Oo{constructor(ae,le=ie.RESOURCE_CONSTRAINTS.DEFAULT_PROCESSING_BUDGET_PER_FRAME,de){this.logger=ae,this.outputCanvas=document.createElement("canvas"),this.canvasVideoFrameBuffer=new D.default(this.outputCanvas);try{this.validateProcessingBudgetPerFrame(le)}catch(me){throw this.logger.error(me),new Error(`Cannot instantiate VideoFxProcessor due to invalid processingBudgetPerFrame of ${le}`)}de&&(this.eventController=de),this.effectConfig={backgroundBlur:{isEnabled:!1,strength:"low"},backgroundReplacement:{isEnabled:!1,backgroundImageURL:null,defaultColor:"black"}},this.segmentationRequestPromise=new Y.DeferredPromise,this.segmentationRateManager=new ne.VideoFxSegmentationRateManager(this.logger,le),this.streamParameters={framerate:ie.DEFAULT_STREAM_PARAMETERS.FRAMES_PER_SECOND,width:ie.DEFAULT_STREAM_PARAMETERS.WIDTH_IN_PIXEL,height:ie.DEFAULT_STREAM_PARAMETERS.HEIGHT_IN_PIXEL,channels:ie.DEFAULT_STREAM_PARAMETERS.CHANNEL_COUNT},Oo.isSharedArrayBufferSupported&&(this.sharedImageBuffer=new SharedArrayBuffer(ie.SEGMENTATION_MODEL.WIDTH_IN_PIXELS*ie.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS*this.streamParameters.channels),this.sharedImageData=new Uint8ClampedArray(this.sharedImageBuffer)),this.logger.info(`VideoFx supports Shared Array Buffer: ${Oo.isSharedArrayBufferSupported}`),this.canvasOpsManager=new ee.VideoFxCanvasOpsManager(this.streamParameters,this.outputCanvas),this.outputCanvas.width=this.streamParameters.width,this.outputCanvas.height=this.streamParameters.height,this.segmentationMask=new ImageData(this.streamParameters.width,this.streamParameters.height),this.logger.info(`VideoFxProcessor instantiated with a processingBudgetPerFrame of ${le}`)}process(ae){return C(this,void 0,void 0,function*(){return ae})}fxProcess(ae){return C(this,void 0,void 0,function*(){const le=ae[0].asCanvasElement();this.didStreamParametersChange(le)&&(yield this.adjustProcessorForNewStreamParameters(le));try{yield this.manageSegmentationMask(le)}catch(de){throw this.logger.error(de),new Error("Video stream could not be processed")}return yield this.renderer.render(le,this.segmentationMask),ae[0]=this.canvasVideoFrameBuffer,ae})}noOpProcess(ae){return C(this,void 0,void 0,function*(){return ae})}didStreamParametersChange(ae){return ae.width!==this.streamParameters.width||ae.height!==this.streamParameters.height}adjustProcessorForNewStreamParameters(ae){return C(this,void 0,void 0,function*(){this.streamParameters.width=ae.width,this.streamParameters.height=ae.height,yield this.canvasOpsManager.configureForStreamParameters(this.streamParameters),yield this.renderer.configure(this.streamParameters.width,this.streamParameters.height,this.effectConfig)})}destroy(){return C(this,void 0,void 0,function*(){this.canvasVideoFrameBuffer.destroy(),this.fxLibScript&&this.fxLibScript.parentNode&&this.fxLibScript.parentNode.removeChild(this.fxLibScript),this.engineWorker&&(this.destroyedAssetsPromise=new Y.DeferredPromise,this.engineWorker.postMessage({msg:ie.WORKER_MSG.DESTROY_ASSETS_REQUEST}),yield this.destroyedAssetsPromise.getPromise(),this.engineWorker.postMessage({msg:ie.WORKER_MSG.CLOSE_WORKER_REQUEST})),this.logger.info("VideoFxProcessor destroyed.")})}manageSegmentationMask(ae){return C(this,void 0,void 0,function*(){try{if(this.segmentationRateManager.submitFrame(),this.segmentationRateManager.shouldApplySegmentation()){this.segmentationRateManager.startSegmentation();const le=this.canvasOpsManager.getInferenceInputData(ae);this.segmentationMask=yield this.generateSegmentationMask(le),this.segmentationRateManager.completeSegmentation()}}catch(le){throw this.logger.error(le.toString()),new Error("Can not properly manage the returned segmentation mask")}})}generateSegmentationMask(ae){return C(this,void 0,void 0,function*(){Oo.isSharedArrayBufferSupported?(this.sharedImageData.set(ae.data),this.engineWorker.postMessage({msg:ie.WORKER_MSG.PERFORM_SEGMENTATION_SAB_REQUEST,payload:this.sharedImageBuffer})):this.engineWorker.postMessage({msg:ie.WORKER_MSG.PERFORM_SEGMENTATION_REQUEST,payload:ae},[ae.data.buffer]);try{return yield this.segmentationRequestPromise.getPromise()}catch(le){throw this.logger.error(le.toString()),new Error("Segmentation mask could not be generated")}})}cloneConfigFrom(ae){return{backgroundBlur:{isEnabled:ae.backgroundBlur.isEnabled,strength:ae.backgroundBlur.strength},backgroundReplacement:{isEnabled:ae.backgroundReplacement.isEnabled,backgroundImageURL:ae.backgroundReplacement.backgroundImageURL,defaultColor:ae.backgroundReplacement.defaultColor}}}setEffectConfig(ae){return C(this,void 0,void 0,function*(){if(this.sameVideoFxConfig(ae,this.effectConfig))return;const le=this.cloneConfigFrom(ae);try{yield this.validateEffectConfig(le)}catch(de){throw this.logger.error(de.toString()),new Error("Provided effect config is invalid, not updating VideoFxProcessor")}le.backgroundReplacement.isEnabled&&(yield this.canvasOpsManager.loadReplacementBackground(le),yield this.renderer.setBackgroundReplacementCanvas(this.canvasOpsManager.getBackgroundReplacementCanvas())),yield this.renderer.configure(this.streamParameters.width,this.streamParameters.height,le),this.effectConfig=le,!this.effectConfig.backgroundBlur.isEnabled&&!this.effectConfig.backgroundReplacement.isEnabled?this.process=this.noOpProcess:this.process=this.fxProcess,this.logger.info(`VideoFxProcessor effect configuration updated to: ${JSON.stringify(this.effectConfig)}`),this.eventController&&this.publishVideoFxConfigEvent()})}validateEffectConfig(ae){return C(this,void 0,void 0,function*(){if(ae.backgroundBlur.isEnabled&&ae.backgroundReplacement.isEnabled)throw new Error("Invalid VideoFx configuration: Background Blur and Background Replacement can not both be enabled");ae.backgroundReplacement.isEnabled&&(yield this.validateReplacementConfig(ae))})}validateReplacementConfig(ae){return C(this,void 0,void 0,function*(){if(ae.backgroundReplacement.backgroundImageURL&&ae.backgroundReplacement.defaultColor)throw new Error("Invalid VideoFx configuration: Background Replacement can not have both an image URL and default color");if(!ae.backgroundReplacement.backgroundImageURL&&!ae.backgroundReplacement.defaultColor)throw new Error("Invalid VideoFx configuration: Background Replacement image URL and default can not both be null/undefined");try{ae.backgroundReplacement.backgroundImageURL&&(yield this.canvasOpsManager.loadImage(ae.backgroundReplacement.backgroundImageURL))}catch(de){throw this.logger.error(de.toString()),new Error("Invalid VideoFx configuration: backgroundImageURL failed to load")}const le=ae.backgroundReplacement.defaultColor;if(le&&le!=="black"&&le!=="#000000"&&le!=="#000"){if(le.includes("#")&&!new RegExp(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/).test(le))throw new Error(`Invalid hexadecimal color code for default replacement background: ${le}`);const de=document.createElement("canvas").getContext("2d"),me=de.fillStyle;if(de.fillStyle=le,de.fillStyle===me)throw new Error(`Invalid color for default replacement background: ${le}`)}})}validateProcessingBudgetPerFrame(ae){if(ae<ie.RESOURCE_CONSTRAINTS.MIN_PROCESSING_BUDGET||ae>ie.RESOURCE_CONSTRAINTS.MAX_PROCESSING_BUDGET)throw new Error(`Invalid resource constraint: cycle percentage must be within range of ${ie.RESOURCE_CONSTRAINTS.MIN_PROCESSING_BUDGET} and ${ie.RESOURCE_CONSTRAINTS.MAX_PROCESSING_BUDGET}`)}loadAssets(){return C(this,void 0,void 0,function*(){this.logger.info("Loading required assets for the VideoFxProcessor");try{const ae=this.getVideoFxAssetParams();yield this.loadEngineWorker(ae),yield this.buildEngine(ae),yield this.loadFxLib(ae),this.renderer=constructRenderer(ie.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,ie.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS,this.effectConfig,this.outputCanvas)}catch(ae){throw this.logger.error(ae.toString()),new Error("Failed to load necessary assets for the VideoFxProcessor")}this.logger.info("Finished loading of essential VideoFxProcessor assets.")})}getVideoFxAssetParams(){const ae=T.getDefaultAssetSpec();return{assetGroup:ae.assetGroup,revisionID:ae.revisionID,sdk:encodeURIComponent(_.default.sdkVersion),ua:encodeURIComponent(_.default.sdkUserAgentLowResolution)}}getPathFromVideoFxAssetParams(ae,le){const de=new URL(ae);for(const[me,fe]of Object.entries(le))if(fe!==void 0){const ge=encodeURIComponent(me),he=encodeURIComponent(fe);de.searchParams.set(ge,he)}return de.toString()}loadEngineWorker(ae){return C(this,void 0,void 0,function*(){try{const le=this.getPathFromVideoFxAssetParams(ie.CDN_BASE_PATH+ie.WORKER_PATH,ae);this.engineWorker=yield R.loadWorker(le,"VideoFxEngineWorker",{},null),this.logger.info("Successfully loaded the VideoFxProcessor's engine worker"),this.engineWorker.addEventListener("message",de=>this.engineWorkerReceiver(de))}catch(le){throw this.logger.error(le.toString()),new Error("Failed to load the VideoFxProcessor's engine worker")}})}buildEngine(ae){return C(this,void 0,void 0,function*(){this.buildEnginePromise=new Y.DeferredPromise,this.engineWorker.postMessage({msg:ie.WORKER_MSG.BUILD_ENGINE_REQUEST,payload:{cdnBasePath:ie.CDN_BASE_PATH,sdkVersioningParams:ae}});try{yield this.buildEnginePromise.getPromise()}catch(le){throw this.logger.error(le.toString()),new Error("Failed to instantiate the VideoFxEngine")}})}loadFxLib(ae){return C(this,void 0,void 0,function*(){const le=this.getPathFromVideoFxAssetParams(ie.CDN_BASE_PATH+ie.FXLIB_PATH,ae),de={method:"GET",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer"};try{const me=yield w.fetchWithBehavior(le,de,{});if(!me.ok)throw new Error("Fetch failed.");const fe=window.URL.createObjectURL(yield me.blob());yield new Promise((ge,he)=>{this.fxLibScript=document.createElement("script"),this.fxLibScript.setAttribute("src",fe),this.fxLibScript.setAttribute("type","module"),this.fxLibScript.setAttribute("async","false"),this.fxLibScript.addEventListener("load",ge),this.fxLibScript.addEventListener("error",he),document.body.appendChild(this.fxLibScript)})}catch(me){throw this.logger.error(me.toString()),new Error("Failed to load the fxlib")}})}getEffectConfig(){return this.cloneConfigFrom(this.effectConfig)}engineWorkerReceiver(ae){const le=ae.data;switch(le.msg){case ie.WORKER_MSG.BUILD_ENGINE_RESPONSE:this.settleEngineBuildPromise(le.payload);break;case ie.WORKER_MSG.PERFORM_SEGMENTATION_RESPONSE:this.settleSegmentationPromise(le.payload.output);break;case ie.WORKER_MSG.PERFORM_SEGMENTATION_SAB_RESPONSE:this.settleSegmentationPromiseSAB();break;case ie.WORKER_MSG.DESTROY_ASSETS_RESPONSE:this.destroyedAssetsPromise.resolvePromise();break;default:this.logger.info(`VideoFx worker received unknown event msg: ${JSON.stringify(le)}`);break}}settleEngineBuildPromise(ae){ae!==ie.SEGMENTATION_MODEL.LOAD_SUCCESS?this.buildEnginePromise.rejectPromise(new Error("Failed to build VideoFxProcessor's engine")):(this.logger.info("Successfully built the VideoFxEngine"),this.buildEnginePromise.resolvePromise())}settleSegmentationPromise(ae){ae?this.segmentationRequestPromise.resolveAndReplacePromise(ae):this.segmentationRequestPromise.rejectAndReplacePromise(new Error("Failed to perform a segmentation on the input image"))}settleSegmentationPromiseSAB(){try{const ae=new ImageData(new Uint8ClampedArray(this.sharedImageData),ie.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,ie.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS);this.segmentationRequestPromise.resolveAndReplacePromise(ae)}catch{this.segmentationRequestPromise.rejectAndReplacePromise(new Error("Failed to perform a segmentation with a shared array buffer on the input image"))}}setToNoOpProcess(){this.process=this.noOpProcess}static isSupported(ae=new S.default,le=!0){return C(this,void 0,void 0,function*(){let de=!0;const me=(he,ve)=>{he&&(ae.info(ve),de=!1)};me(typeof globalThis>"u","Browser does not have globalThis."),me(!M.supportsWorker(globalThis,ae),"Browser does not support web workers."),me(!M.supportsWASM(globalThis,ae),"Browser does not support wasm."),me(!document.createElement("canvas").getContext("webgl2"),"Browser does not support webgl.");const fe=new x.default;me(!fe.isVideoFxSupportedBrowser(),"Browser is unsupported for VideoFxProcessor");const ge=()=>C(this,void 0,void 0,function*(){if(le)try{const he=new Oo(ae);yield he.loadAssets(),yield he.destroy()}catch{return ae.info("Browser environment is unable to access the required external assets."),Promise.resolve(!1)}return Promise.resolve(!0)});return Promise.resolve(de?yield ge():!1)})}static create(ae,le,de=ie.RESOURCE_CONSTRAINTS.DEFAULT_PROCESSING_BUDGET_PER_FRAME){return C(this,void 0,void 0,function*(){const me=new Oo(ae,de);try{return yield me.loadAssets(),yield me.setEffectConfig(le),me}catch(fe){throw ae.error(fe.toString()),me.setToNoOpProcess(),new Error("VideoFxProcessor built with support for only NoOp processing")}})}setEventController(ae){this.eventController?this.eventController=ae:(this.eventController=ae,this.publishVideoFxConfigEvent())}publishVideoFxConfigEvent(){const ae={backgroundBlurEnabled:this.effectConfig.backgroundBlur.isEnabled.toString(),backgroundBlurStrength:this.effectConfig.backgroundBlur.strength,backgroundReplacementEnabled:this.effectConfig.backgroundReplacement.isEnabled.toString(),backgroundFilterVersion:2};this.eventController.publishEvent("backgroundFilterConfigSelected",ae)}sameVideoFxConfig(ae,le){return ae.backgroundBlur.isEnabled===le.backgroundBlur.isEnabled&&ae.backgroundBlur.strength===le.backgroundBlur.strength&&ae.backgroundReplacement.backgroundImageURL===le.backgroundReplacement.backgroundImageURL&&ae.backgroundReplacement.defaultColor===le.backgroundReplacement.defaultColor&&ae.backgroundReplacement.isEnabled===le.backgroundReplacement.isEnabled}};return VideoFxProcessor.default=re,re.isSharedArrayBufferSupported=typeof SharedArrayBuffer<"u",VideoFxProcessor}var VoiceFocusDeviceTransformer={},voicefocus={},decider={},hasRequiredDecider;function requireDecider(){if(hasRequiredDecider)return decider;hasRequiredDecider=1;var C=decider&&decider.__awaiter||function(de,me,fe,ge){function he(ve){return ve instanceof fe?ve:new fe(function(be){be(ve)})}return new(fe||(fe=Promise))(function(ve,be){function Se(Me){try{Ae(ge.next(Me))}catch(Be){be(Be)}}function Re(Me){try{Ae(ge.throw(Me))}catch(Be){be(Be)}}function Ae(Me){Me.done?ve(Me.value):he(Me.value).then(Se,Re)}Ae((ge=ge.apply(de,me||[])).next())})};Object.defineProperty(decider,"__esModule",{value:!0}),decider.decideModel=decider.measureAndDecideExecutionApproach=void 0;const E=requireLoader(),w=requireSupport(),R=3,M=2.5,x=2.63,S=.6,T=.65,_=.5,D=.7,Y={wasm:{noSupport:.07,inline:{c100:1,c50:.36,c20:.16,c10:.07},worker:{c100:.5,c50:.18,c20:.08,c10:.06}},simd:{noSupport:.1,inline:{c100:1,c50:.43,c20:.3,c10:.2},worker:{c100:.5,c50:.21,c20:.15,c10:.1}}};class ee{constructor(me,fe){this.fetchConfig=me,this.logger=fe;const ge=`${me.paths.workers}estimator-v1.js`;this.fetchBehavior={headers:me.headers,escapedQueryString:me.escapedQueryString},this.worker=E.loadWorker(ge,"VoiceFocusEstimator",this.fetchBehavior,fe)}roundtrip(me,fe,ge){return new Promise((he,ve)=>{this.worker.then(be=>{let Se;Se=Re=>{const{message:Ae,key:Me}=Re.data;Ae===fe&&Me===ge&&(be.removeEventListener("message",Se),he(Re.data))},be.addEventListener("message",Se),be.postMessage(me)}).catch(be=>{var Se;(Se=this.logger)===null||Se===void 0||Se.error("Failed to load worker.",be),ve(be)})})}supportsSIMD(me){const fe="simd",ge=me||`${this.fetchConfig.paths.wasm}simd-v1.wasm`,he={message:"supports-simd",fetchBehavior:this.fetchBehavior,path:ge,key:fe};return this.roundtrip(he,"simd-support",fe).then(ve=>ve.supports)}measure(me,fe){const ge=`${this.fetchConfig.paths.wasm}bench-v1.wasm`,he=`${this.fetchConfig.paths.wasm}bench-v1_simd.wasm`,ve=me?he:ge,be=`bench:${me}`,Se={message:"measure",fetchBehavior:this.fetchBehavior,budget:fe,path:ve,key:be};return this.roundtrip(Se,"measurement",be).then(Re=>{if(Re.measurement)return Re.measurement;throw new Error("Failed to measure.")})}stop(){this.worker.then(me=>{var fe;(fe=this.logger)===null||fe===void 0||fe.debug("Stopping estimator worker."),me.terminate()}).catch(me=>{})}}const ie=(de,me)=>de===1?S:me==="quality"?T*de:_*de,ne=({supportsSIMD:de,supportsSAB:me,duration:fe,executionPreference:ge="auto",simdPreference:he,variantPreference:ve="auto",namePreference:be="default",usagePreference:Se,executionQuantaPreference:Re=R},Ae=Y,Me)=>{const Be=he==="force"||he!=="disable"&&de,Qe=fe!==-1,Pe=Qe?(Be?M:x)/fe:0,je=Be?Ae.simd:Ae.wasm,Dt=Qe?ie(Re,Se)*Pe:0,Xe=Qe?D*Pe:0,zt=be,xe=Je=>({supported:!1,reason:Je});if(Qe){if(Pe<je.noSupport)return xe(`Performance score ${Pe} worse than threshold ${je.noSupport}.`)}else if(ge==="auto"||ve==="auto")return xe(`Missing explicit execution (${ge}) or variant (${ve}) preference, but no scoring performed.`);Me==null||Me.debug(`Bench duration ${fe} yields inline score ${Dt} and worker score ${Xe}.`);const $e=(Je,Rt,jt)=>({supported:!0,useSIMD:Be,processor:Je,executionApproach:Rt,variant:jt,executionQuanta:Rt==="inline"?Re:void 0,name:zt}),We=(Je,Rt,jt)=>Rt!=="auto"?!Qe||Je>jt[Rt]?Rt:"failed":Je>jt.c100?"c100":Je>jt.c50?"c50":Je>jt.c20?"c20":Je>jt.c10?"c10":"failed",He=Je=>{switch(Je||"auto"){case"auto":{let Rt=He("inline"),jt=He("worker");return Me==null||Me.debug(`Reducing auto preference: ${JSON.stringify(Rt)} vs ${JSON.stringify(jt)}`),Rt.supported===!1||jt.supported===!1?jt:Rt.variant===jt.variant||Rt.variant==="c50"?Rt:jt}case"worker":return w.supportsSharedArrayBuffer(globalThis,window,Me)?He("worker-sab"):He("worker-postMessage");case"inline":{const Rt=We(Dt,ve,je.inline);return Rt==="failed"?xe(`Performance score ${Dt} not sufficient for inline use with variant preference ${ve}.`):$e("voicefocus-inline-processor","inline",Rt)}case"worker-sab":{if(!me){const jt="Requested worker-sab but no SharedArrayBuffer support.";return Me==null||Me.warn(jt),{supported:!1,reason:jt}}const Rt=We(Xe,ve,je.worker);return Rt==="failed"?xe(`Performance score ${Xe} not sufficient for worker use with variant preference ${ve}.`):$e("voicefocus-worker-sab-processor","worker-sab",Rt)}case"worker-postMessage":{const Rt=We(Xe,ve,je.worker);if(Rt==="failed")return xe(`Performance score ${Xe} not sufficient for worker use.`);if(zt==="ns_es"){const jt="Requested echo suppression but postMessage executor does not support it.";return Me==null||Me.warn(jt),{supported:!1,reason:jt}}return $e("voicefocus-worker-postMessage-processor","worker-postMessage",Rt)}}};return He(ge)},re=(de,me,fe,ge)=>C(void 0,void 0,void 0,function*(){const he={supportsSIMD:de,supportsSAB:w.supportsSharedArrayBuffer(globalThis,window,fe),duration:-1};if(de)return fe==null||fe.info("Supports SIMD: true (force)"),he;const ve=!ge,be=ge||new ee(me,fe);try{const Se=!w.isOldChrome(window,fe)&&(yield be.supportsSIMD());return fe==null||fe.info(`Supports SIMD: ${Se} (force: ${de})`),he.supportsSIMD=Se,he}finally{ve&&be.stop()}}),oe=(de,me,fe,ge)=>C(void 0,void 0,void 0,function*(){const he=new ee(me,ge);try{const ve=yield re(de,me,ge,he);if(ve.supportsSIMD)try{return ve.duration=yield he.measure(!0,fe),ge==null||ge.info("SIMD timing:",ve.duration),ve}catch{ge==null||ge.warn("Failed SIMD estimation; falling back to non-SIMD."),ve.supportsSIMD=!1}return ve.duration=yield he.measure(!1,fe),ge==null||ge.info("No-SIMD timing:",ve.duration),ve}catch(ve){throw ge==null||ge.error("Could not feature check.",ve),ve}finally{he.stop()}}),ae=(de,me,fe,ge=Y)=>C(void 0,void 0,void 0,function*(){let he=de.executionPreference;const{usagePreference:ve,variantPreference:be,namePreference:Se,simdPreference:Re,estimatorBudget:Ae,executionQuantaPreference:Me}=de;ve==="interactivity"&&he!=="inline"&&(fe==null||fe.debug(`Overriding execution preference ${he} to reflect interactivity preference.`),he="inline");const Be=Re==="force",Qe=be!=="auto",Pe=he!=="auto";let je;try{Qe&&Pe?je=yield re(Be,me,fe):je=yield oe(Be,me,Ae,fe)}catch(Dt){throw fe==null||fe.error("Could not load estimator.",Dt),new Error("Could not load Voice Focus estimator.")}return ne(Object.assign(Object.assign({},je),{simdPreference:Re,executionPreference:he,variantPreference:be,namePreference:Se,usagePreference:ve,executionQuantaPreference:Me}),ge,fe)});decider.measureAndDecideExecutionApproach=ae;const le=({category:de,name:me,variant:fe,simd:ge,url:he})=>`${de}-${me}-${fe}-v1${ge?"_simd":""}`;return decider.decideModel=le,decider}var workletInlineNode={},types={},hasRequiredTypes;function requireTypes(){if(hasRequiredTypes)return types;hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0}),types.VoiceFocusAudioWorkletNode=void 0;class C extends(typeof globalThis<"u"&&globalThis.AudioWorkletNode||class{}){}return types.VoiceFocusAudioWorkletNode=C,types}var hasRequiredWorkletInlineNode;function requireWorkletInlineNode(){if(hasRequiredWorkletInlineNode)return workletInlineNode;hasRequiredWorkletInlineNode=1;var C=workletInlineNode&&workletInlineNode.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})};Object.defineProperty(workletInlineNode,"__esModule",{value:!0});const E=requireSupport(),w=requireTypes(),R=5*1e3;class M extends w.VoiceFocusAudioWorkletNode{constructor(S,T){super(S,T.processor,T),this.cpuWarningCount=0,this.channelCountMode="explicit",this.channelCount=1;const{modelURL:_,worker:D,fetchBehavior:Y,logger:ee,delegate:ie}=T;this.logger=ee,this.port.onmessage=this.onProcessorMessage.bind(this),this.delegate=ie,ee&&ee.debug("VoiceFocusInlineNode:",_),this.worker=D,this.worker.onmessage=this.onWorkerMessage.bind(this);const ne=E.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:ne,key:"model",fetchBehavior:Y,path:_})}onModuleBufferLoaded(S,T){this.port.postMessage({message:"module-buffer",buffer:S,key:T})}onModuleLoaded(S,T){this.port.postMessage({message:"module",module:S,key:T})}enable(){return C(this,void 0,void 0,function*(){this.port.postMessage({message:"enable"})})}disable(){return C(this,void 0,void 0,function*(){this.port.postMessage({message:"disable"})})}stop(){var S;return C(this,void 0,void 0,function*(){this.port.postMessage({message:"stop"});try{(S=this.worker)===null||S===void 0||S.terminate()}catch(T){console.error("failed to terminate worker:",T)}this.disconnect()})}onProcessorMessage(S){var T,_,D;const Y=S.data;switch(Y.message){case"cpu":this.cpuWarningCount++;const ee=Date.now(),ie=this.cpuWarningLastTriggered||ee,ne=Math.abs(ee-ie);(!this.cpuWarningLastTriggered||ne>R)&&((T=this.logger)===null||T===void 0||T.warn(`CPU warning (count: ${this.cpuWarningCount}):`,Y.message),this.cpuWarningCount=0,this.cpuWarningLastTriggered=ee),(_=this.delegate)===null||_===void 0||_.onCPUWarning();break;default:(D=this.logger)===null||D===void 0||D.debug("Ignoring processor message.")}}onWorkerMessage(S){const T=S.data;switch(T.message){case"module-buffer":if(!T.buffer||!T.key)return;this.onModuleBufferLoaded(T.buffer,T.key);break;case"module":if(!T.module||!T.key)return;this.onModuleLoaded(T.module,T.key);break;case"stopped":this.worker&&this.worker.terminate();break;default:return}}}return workletInlineNode.default=M,workletInlineNode}var workletWorkerSabNode={},hasRequiredWorkletWorkerSabNode;function requireWorkletWorkerSabNode(){if(hasRequiredWorkletWorkerSabNode)return workletWorkerSabNode;hasRequiredWorkletWorkerSabNode=1;var C=workletWorkerSabNode&&workletWorkerSabNode.__awaiter||function(S,T,_,D){function Y(ee){return ee instanceof _?ee:new _(function(ie){ie(ee)})}return new(_||(_=Promise))(function(ee,ie){function ne(ae){try{oe(D.next(ae))}catch(le){ie(le)}}function re(ae){try{oe(D.throw(ae))}catch(le){ie(le)}}function oe(ae){ae.done?ee(ae.value):Y(ae.value).then(ne,re)}oe((D=D.apply(S,T||[])).next())})};Object.defineProperty(workletWorkerSabNode,"__esModule",{value:!0});const E=requireSupport(),w=requireTypes(),R={ready:0,enabled:1},M={disabled:0,enabled:1,stopped:2};class x extends w.VoiceFocusAudioWorkletNode{constructor(T,_){super(T,_.processor,_),this.channelCountMode="explicit",this.channelCount=1;const{modelURL:D,resamplerURL:Y,worker:ee,fetchBehavior:ie,delegate:ne}=_;this.delegate=ne,this.worker=ee,this.worker.onmessage=this.onWorkerMessage.bind(this),this.port.onmessage=this.onProcessorMessage.bind(this);const{enabled:re,supportFarendStream:oe}=_.processorOptions;this.worker.postMessage({message:"init",approach:"sab",frames:T.sampleRate===16e3?160:480,enabled:re,model:D,supportFarendStream:oe});const ae=E.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:ae,key:"resampler",fetchBehavior:ie,path:Y})}enable(){return C(this,void 0,void 0,function*(){this.state?(Atomics.store(this.state,R.enabled,M.enabled),Atomics.notify(this.state,R.ready,1)):this.worker.postMessage({message:"enable"})})}disable(){return C(this,void 0,void 0,function*(){this.state?(Atomics.store(this.state,R.enabled,M.disabled),Atomics.notify(this.state,R.ready,1)):this.worker.postMessage({message:"disable"})})}stop(){return C(this,void 0,void 0,function*(){if(this.state)Atomics.store(this.state,R.enabled,M.stopped),Atomics.notify(this.state,R.ready,1);else try{this.worker.postMessage({message:"stop"})}catch{}this.disconnect()})}onWorkerMessage(T){var _;const D=T.data;switch(D.message){case"ready":if(!D.shared)throw new Error("No shared state.");this.state=new Int32Array(D.shared.state),this.port.postMessage(D);break;case"stopped":this.worker.terminate();break;case"module-buffer":case"module":this.port.postMessage(D);break;case"cpu":(_=this.delegate)===null||_===void 0||_.onCPUWarning();break;case"processing":this.port.postMessage(D);break;default:return}}onProcessorMessage(T){var _;const D=T.data;switch(D.message){case"cpu":(_=this.delegate)===null||_===void 0||_.onCPUWarning();break;case"prepare-for-frames":this.worker.postMessage(D);break}}}return workletWorkerSabNode.default=x,workletWorkerSabNode}var workletWorkerPostMessageNode={},hasRequiredWorkletWorkerPostMessageNode;function requireWorkletWorkerPostMessageNode(){if(hasRequiredWorkletWorkerPostMessageNode)return workletWorkerPostMessageNode;hasRequiredWorkletWorkerPostMessageNode=1;var C=workletWorkerPostMessageNode&&workletWorkerPostMessageNode.__awaiter||function(M,x,S,T){function _(D){return D instanceof S?D:new S(function(Y){Y(D)})}return new(S||(S=Promise))(function(D,Y){function ee(re){try{ne(T.next(re))}catch(oe){Y(oe)}}function ie(re){try{ne(T.throw(re))}catch(oe){Y(oe)}}function ne(re){re.done?D(re.value):_(re.value).then(ee,ie)}ne((T=T.apply(M,x||[])).next())})};Object.defineProperty(workletWorkerPostMessageNode,"__esModule",{value:!0});const E=requireSupport(),w=requireTypes();class R extends w.VoiceFocusAudioWorkletNode{constructor(x,S){super(x,S.processor,S),this.channelCountMode="explicit",this.channelCount=1;const{modelURL:T,audioBufferURL:_,worker:D,fetchBehavior:Y,delegate:ee}=S;this.delegate=ee,this.worker=D,this.worker.onmessage=this.onWorkerMessage.bind(this),this.port.onmessage=this.onProcessorMessage.bind(this);const{enabled:ie,agc:ne,supportFarendStream:re}=S.processorOptions;this.worker.postMessage({message:"init",approach:"postMessage",frames:x.sampleRate===16e3?160:480,enabled:ie,agc:ne,fetchBehavior:Y,model:T,supportFarendStream:re});const oe=E.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:oe,key:"buffer",fetchBehavior:Y,path:_})}enable(){return C(this,void 0,void 0,function*(){this.worker.postMessage({message:"enable"})})}disable(){return C(this,void 0,void 0,function*(){this.worker.postMessage({message:"disable"})})}stop(){return C(this,void 0,void 0,function*(){try{this.worker.postMessage({message:"stop"})}catch{}this.disconnect()})}onWorkerMessage(x){var S;const T=x.data;switch(T.message){case"ready":this.port.postMessage({message:"ready",shared:T.shared},T.shared?Object.values(T.shared):[]);break;case"data":if(!T.buffer)return;this.port.postMessage({message:"data",buffer:T.buffer},[T.buffer]);break;case"stopped":this.worker.terminate();break;case"module-buffer":case"module":this.port.postMessage(T);break;case"cpu":(S=this.delegate)===null||S===void 0||S.onCPUWarning();break;case"processing":this.port.postMessage(T);break;default:return}}onProcessorMessage(x){var S;const T=x.data;switch(T.message){case"data":if(!T.buffer)return;this.worker.postMessage({message:"data",buffer:T.buffer},[T.buffer]);break;case"cpu":(S=this.delegate)===null||S===void 0||S.onCPUWarning();break;case"prepare-for-frames":this.worker.postMessage(T);break;default:return}}}return workletWorkerPostMessageNode.default=R,workletWorkerPostMessageNode}var hasRequiredVoicefocus;function requireVoicefocus(){if(hasRequiredVoicefocus)return voicefocus;hasRequiredVoicefocus=1;var C=voicefocus&&voicefocus.__awaiter||function(ve,be,Se,Re){function Ae(Me){return Me instanceof Se?Me:new Se(function(Be){Be(Me)})}return new(Se||(Se=Promise))(function(Me,Be){function Qe(Dt){try{je(Re.next(Dt))}catch(Xe){Be(Xe)}}function Pe(Dt){try{je(Re.throw(Dt))}catch(Xe){Be(Xe)}}function je(Dt){Dt.done?Me(Dt.value):Ae(Dt.value).then(Qe,Pe)}je((Re=Re.apply(ve,be||[])).next())})};Object.defineProperty(voicefocus,"__esModule",{value:!0}),voicefocus.getAudioInput=voicefocus.createAudioContext=voicefocus.VoiceFocus=void 0;const E=requireDecider(),w=requireFetch(),R=requireLoader(),M=requireSupport(),x=requireWorkletInlineNode(),S=requireWorkletWorkerSabNode(),T=requireWorkletWorkerPostMessageNode(),_={useVoiceFocusAGC:!1,useBuiltInAGC:!0},D="stable-v1",Y="https://static.sdkassets.chime.aws",ee={processors:`${Y}/processors/`,workers:`${Y}/workers/`,wasm:`${Y}/wasm/`,models:`${Y}/wasm/`},ie={latencyHint:0},ne={channelCount:1,echoCancellation:!0,googEchoCancellation:!0,noiseSuppression:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googTypingNoiseDetection:!1},re=Object.assign(Object.assign({},ne),{autoGainControl:!0,googAutoGainControl:!0,googAutoGainControl2:!0}),oe=Object.assign(Object.assign({},ne),{autoGainControl:!1,googAutoGainControl:!1,googAutoGainControl2:!1}),ae={"voicefocus-worker-sab-processor":{file:"worklet-worker-sab-processor-v1.js",node:S.default},"voicefocus-worker-postMessage-processor":{file:"worklet-worker-postMessage-processor-v1.js",node:T.default},"voicefocus-inline-processor":{file:"worklet-inline-processor-v1.js",node:x.default}},le=(ve,be)=>{if(ve!==void 0&&!w.isValidAssetGroup(ve))throw new Error(`Invalid asset group ${ve}`);if(be!==void 0&&!w.isValidRevisionID(be))throw new Error(`Invalid revision ID ${be}`)},de=(ve,be)=>{let Se;if(be.useBuiltInAGC?Se=re:Se=oe,!ve)return{audio:Se};if(!ve.audio)return ve;if(ve.video)throw new Error("Not adding Voice Focus to multi-device getUserMedia call.");return Object.assign(Object.assign({},ve),{audio:ve.audio===!0?Se:Object.assign(Object.assign({},ve.audio),Se)})},me=(ve,be)=>`${be.models}${E.decideModel(ve)}.wasm`;class fe{constructor(be,Se,Re,Ae,Me){this.processorURL=Se,this.nodeConstructor=Re,this.nodeOptions=Ae,this.executionQuanta=Me,this.internal={worker:be,nodeOptions:Ae,isDestroyed:!1}}static isSupported(be,Se){const{fetchBehavior:Re,logger:Ae}=Se||{};if(typeof globalThis>"u")return Ae==null||Ae.debug("Browser does not have globalThis."),Promise.resolve(!1);if(!M.supportsAudioWorklet(globalThis,Ae))return Ae==null||Ae.debug("Browser does not support Audio Worklet."),Promise.resolve(!1);if(!M.supportsWASM(globalThis,Ae))return Ae==null||Ae.debug("Browser does not support WASM."),Promise.resolve(!1);M.supportsWASMStreaming(globalThis,Ae)||Ae==null||Ae.debug("Browser does not support streaming WASM compilation.");const{assetGroup:Me=D,revisionID:Be,paths:Qe=ee}=be||{};le(Me,Be);const Pe=Be?{revisionID:Be}:{assetGroup:Me},je=w.addQueryParams(Re,Pe),Dt=Object.assign(Object.assign({},je),{paths:Qe});return M.supportsVoiceFocusWorker(globalThis,Dt,Ae)}static mungeExecutionPreference(be,Se){const Re=be===void 0||be==="auto";if(M.isSafari(globalThis)){if(Re||be==="inline")return"inline";if(!Re)throw new Error(`Unsupported execution preference ${be}`)}if(be==="worker-sab"&&!M.supportsSharedArrayBuffer(globalThis,globalThis,Se))throw new Error(`Unsupported execution preference ${be}`);return be||"auto"}static configure(be,Se){return C(this,void 0,void 0,function*(){const{fetchBehavior:Re,preResolve:Ae,logger:Me}=Se||{},{category:Be="voicefocus",name:Qe="default",variant:Pe="auto",assetGroup:je=D,revisionID:Dt,simd:Xe="detect",executionPreference:zt="auto",executionQuantaPreference:xe,usagePreference:$e="interactivity",estimatorBudget:We=100,paths:He=ee,thresholds:Je}=be||{};if(Me==null||Me.debug("Configuring Voice Focus with spec",be),Be!==void 0&&Be!=="voicefocus")throw new Error(`Unrecognized category ${Be}`);if(Qe!==void 0&&Qe!=="default"&&Qe!=="ns_es")throw new Error(`Unrecognized feature name ${Qe}`);if(Pe!==void 0&&!["auto","c100","c50","c20","c10"].includes(Pe))throw new Error(`Unrecognized feature variant ${Pe}`);if(xe!==void 0&&![1,2,3].includes(xe))throw new Error(`Unrecognized execution quanta preference ${xe}`);if(le(je,Dt),Xe!==void 0&&!["detect","force","disable"].includes(Xe))throw new Error(`Unrecognized SIMD option ${Xe}`);if(zt!==void 0&&!["auto","inline","worker","worker-sab","worker-postMessage"].includes(zt))throw new Error(`Unrecognized execution preference ${zt}`);if($e!==void 0&&!["quality","interactivity"].includes($e))throw new Error(`Unrecognized usage preference ${$e}`);const Rt={executionPreference:this.mungeExecutionPreference(zt,Me),usagePreference:$e,executionQuantaPreference:xe,variantPreference:Pe,namePreference:Qe,simdPreference:Xe,estimatorBudget:We},jt=Dt?{revisionID:Dt}:{assetGroup:je},hi=w.addQueryParams(Re,jt),Jt=Object.assign({paths:He},hi),si=yield E.measureAndDecideExecutionApproach(Rt,Jt,Me,Je);if(si.supported===!1)return{supported:!1,reason:si.reason};Me==null||Me.info("Decided execution approach",si);const{useSIMD:ri,processor:ni,variant:Pi,executionQuanta:Ci}=si,qi={category:Be||"voicefocus",name:Qe||"default",variant:Pi,simd:ri};if(Ae){const vi=me(qi,He);qi.url=yield w.resolveURL(vi,hi)}return{fetchConfig:Jt,model:qi,processor:ni,executionQuanta:Ci,supported:!0}})}static init(be,{delegate:Se,preload:Re=!0,logger:Ae}){return C(this,void 0,void 0,function*(){if(be.supported===!1)throw new Error("Voice Focus not supported. Reason: "+be.reason);const{model:Me,processor:Be,fetchConfig:Qe,executionQuanta:Pe}=be,{simd:je,name:Dt}=Me,{paths:Xe}=Qe;if(Be!=="voicefocus-inline-processor"&&Be!=="voicefocus-worker-postMessage-processor"&&Be!=="voicefocus-worker-sab-processor")throw new Error(`Unknown processor ${Be}`);const zt=Me.url||me(Me,Xe);Ae==null||Ae.debug(`Using model URL ${zt}.`);const xe=`${Xe.wasm}audio_buffer-v1${je?"_simd":""}.wasm`,$e=`${Xe.wasm}resampler-v1${je?"_simd":""}.wasm`,We=`${Xe.workers}worker-v1.js`,{file:He,node:Je}=ae[Be],Rt=`${Xe.processors}${He}`,jt=yield R.loadWorker(We,"VoiceFocusWorker",Qe,Ae);if(Re){Ae==null||Ae.debug("Preloading",zt);let si=M.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";jt.postMessage({message:si,preload:!0,key:"model",fetchBehavior:Qe,path:zt})}const hi={processor:Be,worker:jt,audioBufferURL:xe,resamplerURL:$e,fetchBehavior:Qe,modelURL:zt,delegate:Se,logger:Ae,numberOfInputs:Dt==="ns_es"?2:1},Jt=new fe(jt,Rt,Je,hi,Pe);return Promise.resolve(Jt)})}createNode(be,Se){var Re;if(this.internal.isDestroyed)throw new Error("Unable to create node because VoiceFocus worker has been destroyed.");const{voiceFocusSampleRate:Ae=be.sampleRate===16e3?16e3:48e3,enabled:Me=!0,agc:Be=_}=Se||{},Qe=Se==null?void 0:Se.es,Pe={voiceFocusSampleRate:Ae,enabled:Me,sendBufferCount:10,prefill:6,agc:Be,executionQuanta:this.executionQuanta,supportFarendStream:Qe},je=w.withQueryString(this.processorURL,(Re=this.nodeOptions)===null||Re===void 0?void 0:Re.fetchBehavior);return be.audioWorklet.addModule(je).then(()=>new this.nodeConstructor(be,Object.assign(Object.assign({},this.nodeOptions),{processorOptions:Pe})))}applyToStream(be,Se,Re){return C(this,void 0,void 0,function*(){if(this.internal.isDestroyed)throw new Error("Unable to apply stream because VoiceFocus worker has been destroyed");const Ae=Se.createMediaStreamSource(be),Me=yield this.applyToSourceNode(Ae,Se,Re),Be=Se.createMediaStreamDestination();return Me.connect(Be),{node:Me,source:Ae,destination:Be,stream:Be.stream}})}applyToSourceNode(be,Se,Re){return C(this,void 0,void 0,function*(){const Ae=yield this.createNode(Se,Re);return be.connect(Ae),Ae})}destroy(){this.internal.worker&&this.internal.worker.terminate(),this.internal.isDestroyed=!0}}voicefocus.VoiceFocus=fe;const ge=(ve=ie)=>new(window.AudioContext||window.webkitAudioContext)(ve);voicefocus.createAudioContext=ge;const he=(ve,be,Se)=>C(void 0,void 0,void 0,function*(){var Re,Ae;const{constraints:Me,spec:Be,delegate:Qe,preload:Pe=!0,options:je}=be,{logger:Dt}=Se,Xe=yield fe.configure(Be,Se);if(!Xe.supported)return(Re=Se.logger)===null||Re===void 0||Re.warn("Voice Focus not supported; returning standard stream."),window.navigator.mediaDevices.getUserMedia(Me);const zt=yield fe.init(Xe,{delegate:Qe,preload:Pe,logger:Dt}),xe=((Ae=be.options)===null||Ae===void 0?void 0:Ae.agc)||_,$e=yield window.navigator.mediaDevices.getUserMedia(de(Me,xe));return zt.applyToStream($e,ve,je).then(We=>We.stream)});return voicefocus.getAudioInput=he,voicefocus}var LoggerAdapter={},hasRequiredLoggerAdapter;function requireLoggerAdapter(){if(hasRequiredLoggerAdapter)return LoggerAdapter;hasRequiredLoggerAdapter=1,Object.defineProperty(LoggerAdapter,"__esModule",{value:!0});function C(w){return w.map(R=>typeof R=="object"?JSON.stringify(R):`${R}`).join(" ")}let E=class{constructor(w){this.base=w}debug(...w){this.base.debug(C(w))}info(...w){this.base.info(C(w))}warn(...w){this.base.warn(C(w))}error(...w){this.base.error(C(w))}};return LoggerAdapter.default=E,LoggerAdapter}var VoiceFocusTransformDevice={},hasRequiredVoiceFocusTransformDevice;function requireVoiceFocusTransformDevice(){if(hasRequiredVoiceFocusTransformDevice)return VoiceFocusTransformDevice;hasRequiredVoiceFocusTransformDevice=1;var C=VoiceFocusTransformDevice&&VoiceFocusTransformDevice.__awaiter||function(x,S,T,_){function D(Y){return Y instanceof T?Y:new T(function(ee){ee(Y)})}return new(T||(T=Promise))(function(Y,ee){function ie(oe){try{re(_.next(oe))}catch(ae){ee(ae)}}function ne(oe){try{re(_.throw(oe))}catch(ae){ee(ae)}}function re(oe){oe.done?Y(oe.value):D(oe.value).then(ie,ne)}re((_=_.apply(x,S||[])).next())})},E=VoiceFocusTransformDevice&&VoiceFocusTransformDevice.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(VoiceFocusTransformDevice,"__esModule",{value:!0});const w=E(requireDefaultBrowserBehavior());let R=class um{constructor(S,T,_,D,Y=!1,ee=void 0,ie=new w.default,ne=new Map,re=void 0,oe=void 0){this.device=S,this.voiceFocus=T,this.delegate=_,this.nodeOptions=D,this.failed=Y,this.node=ee,this.browserBehavior=ie,this.farEndStreamToAudioSourceNode=ne,this.mixDestNode=re,this.mixSourceNode=oe}getInnerDevice(){return this.device}mute(S){return C(this,void 0,void 0,function*(){this.node&&(S?yield this.node.disable():yield this.node.enable())})}stop(){return C(this,void 0,void 0,function*(){this.node&&(this.node.disconnect(),yield this.node.stop())})}chooseNewInnerDevice(S){return C(this,void 0,void 0,function*(){return this.device===S&&!M(S)?this:new um(S,this.voiceFocus,this.delegate,this.nodeOptions,this.failed,this.node,this.browserBehavior,this.farEndStreamToAudioSourceNode,this.mixDestNode,this.mixSourceNode)})}intrinsicDevice(){return C(this,void 0,void 0,function*(){if(this.failed)return this.device;const S=this.nodeOptions.es,T={echoCancellation:!S,googEchoCancellation:!S,googEchoCancellation2:!S,noiseSuppression:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googNoiseSuppression2:!1};let _;return this.nodeOptions&&this.nodeOptions.agc!==void 0?_=this.nodeOptions.agc.useBuiltInAGC:_=!0,T.autoGainControl=_,T.googAutoGainControl=_,T.googAutoGainControl2=_,this.device?typeof this.device=="string"?(this.browserBehavior.requiresNoExactMediaStreamConstraints()?T.deviceId=this.device:T.deviceId={exact:this.device},T):this.device.id?this.device:Object.assign(Object.assign({},this.device),T):T})}createAudioNode(S){var T,_;return C(this,void 0,void 0,function*(){if(((T=this.node)===null||T===void 0?void 0:T.context)===S)return{start:this.node,end:this.node};const D=Object.assign({enabled:!0,agc:{useVoiceFocusAGC:!1}},this.nodeOptions);try{if((_=this.node)===null||_===void 0||_.disconnect(),this.node=yield this.voiceFocus.createNode(S,D),this.nodeOptions.es){this.mixDestNode=new MediaStreamAudioDestinationNode(S,{channelCount:1,channelCountMode:"explicit"});for(const ie of this.farEndStreamToAudioSourceNode.keys())this.assignFarEndStreamToAudioSourceNode(ie);this.createMixSourceNode()}const Y=this.node,ee=this.node;return{start:Y,end:ee}}catch(Y){throw this.failed=!0,this.delegate.onFallback(this,Y),Y}})}observeMeetingAudio(S){return C(this,void 0,void 0,function*(){if(!this.nodeOptions.es)return;S.addAudioMixObserver(this);const T=yield S.getCurrentMeetingAudioStream();T&&this.addFarEndStream(T)})}unObserveMeetingAudio(S){return C(this,void 0,void 0,function*(){if(!this.nodeOptions.es)return;S.removeAudioMixObserver(this);const T=yield S.getCurrentMeetingAudioStream();T&&this.removeFarendStream(T)})}addObserver(S){this.delegate.addObserver(S)}removeObserver(S){this.delegate.removeObserver(S)}addFarEndStream(S){return C(this,void 0,void 0,function*(){!this.nodeOptions.es||!S||this.farEndStreamToAudioSourceNode.has(S)||(this.node?this.assignFarEndStreamToAudioSourceNode(S):this.farEndStreamToAudioSourceNode.set(S,null))})}removeFarendStream(S){var T;return C(this,void 0,void 0,function*(){(T=this.farEndStreamToAudioSourceNode.get(S))===null||T===void 0||T.disconnect(),this.farEndStreamToAudioSourceNode.delete(S)})}meetingAudioStreamBecameActive(S){return C(this,void 0,void 0,function*(){this.addFarEndStream(S)})}meetingAudioStreamBecameInactive(S){return C(this,void 0,void 0,function*(){this.removeFarendStream(S)})}assignFarEndStreamToAudioSourceNode(S){const T=this.node.context.createMediaStreamSource(S);T.channelCount=1,T.channelCountMode="explicit",this.farEndStreamToAudioSourceNode.set(S,T),T.connect(this.mixDestNode,0)}createMixSourceNode(){this.mixSourceNode=this.node.context.createMediaStreamSource(this.mixDestNode.stream),this.mixSourceNode.channelCount=1,this.mixSourceNode.channelCountMode="explicit",this.mixSourceNode.connect(this.node,0,1)}};function M(x){return x==="default"?!0:!x||typeof x!="object"?!1:"deviceId"in x&&x.deviceId==="default"||"id"in x&&x.id==="default"}return VoiceFocusTransformDevice.default=R,VoiceFocusTransformDevice}var VoiceFocusTransformDeviceDelegate={},hasRequiredVoiceFocusTransformDeviceDelegate;function requireVoiceFocusTransformDeviceDelegate(){if(hasRequiredVoiceFocusTransformDeviceDelegate)return VoiceFocusTransformDeviceDelegate;hasRequiredVoiceFocusTransformDeviceDelegate=1,Object.defineProperty(VoiceFocusTransformDeviceDelegate,"__esModule",{value:!0});let C=class{constructor(){this.observers=new Set}addObserver(E){this.observers.add(E)}removeObserver(E){this.observers.delete(E)}onFallback(E,w){var R;for(const M of this.observers)(R=M.voiceFocusFellBackToInnerStream)===null||R===void 0||R.call(M,E,w)}onCPUWarning(){var E;for(const w of this.observers)(E=w.voiceFocusInsufficientResources)===null||E===void 0||E.call(w)}};return VoiceFocusTransformDeviceDelegate.default=C,VoiceFocusTransformDeviceDelegate}var hasRequiredVoiceFocusDeviceTransformer;function requireVoiceFocusDeviceTransformer(){if(hasRequiredVoiceFocusDeviceTransformer)return VoiceFocusDeviceTransformer;hasRequiredVoiceFocusDeviceTransformer=1;var C=VoiceFocusDeviceTransformer&&VoiceFocusDeviceTransformer.__awaiter||function(D,Y,ee,ie){function ne(re){return re instanceof ee?re:new ee(function(oe){oe(re)})}return new(ee||(ee=Promise))(function(re,oe){function ae(me){try{de(ie.next(me))}catch(fe){oe(fe)}}function le(me){try{de(ie.throw(me))}catch(fe){oe(fe)}}function de(me){me.done?re(me.value):ne(me.value).then(ae,le)}de((ie=ie.apply(D,Y||[])).next())})},E=VoiceFocusDeviceTransformer&&VoiceFocusDeviceTransformer.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(VoiceFocusDeviceTransformer,"__esModule",{value:!0}),VoiceFocusDeviceTransformer.VoiceFocusDeviceTransformer=void 0;const w=requireVoicefocus(),R=requireUtils(),M=E(requireVersioning()),x=E(requireLoggerAdapter()),S=E(requireVoiceFocusTransformDevice()),T=E(requireVoiceFocusTransformDeviceDelegate());let _=class wr{constructor(Y,{preload:ee=!0,logger:ie,fetchBehavior:ne=wr.defaultFetchBehavior()},re){this.spec=Y,this.supported=!0,this.logger=ie,this.vfLogger=ie?new x.default(ie):void 0,this.preload=ee,this.fetchBehavior=ne,this.spec=wr.augmentSpec(this.spec),re&&(this.configuration=Promise.resolve(re))}static isSupported(Y,ee){var ie,ne;const re=wr.defaultFetchBehavior(),oe=ee!=null&&ee.logger?new x.default(ee.logger):void 0,ae={fetchBehavior:re,logger:oe};if(R.isIFramed()){if((ee==null?void 0:ee.allowIFrame)===!1)return(ie=ee==null?void 0:ee.logger)===null||ie===void 0||ie.error("Amazon Voice Focus support check inside iframe: not supported."),Promise.resolve(!1);(ne=ee==null?void 0:ee.logger)===null||ne===void 0||ne.warn("Amazon Voice Focus support check inside iframe: not recommended.")}return w.VoiceFocus.isSupported(wr.augmentSpec(Y),ae)}static create(Y={},ee={},ie,ne,re){var oe,ae,le;return C(this,void 0,void 0,function*(){ne&&ne.Meeting.Meeting&&(ne=ne.Meeting);const de=((le=(ae=(oe=ne==null?void 0:ne.Meeting)===null||oe===void 0?void 0:oe.MeetingFeatures)===null||ae===void 0?void 0:ae.Audio)===null||le===void 0?void 0:le.EchoReduction)==="AVAILABLE",me=ie&&ie.supported===!0&&ie.model.name==="ns_es"&&!de,fe=Y.name==="ns_es"&&!de;if(me||fe)throw new Error("Echo Reduction requested but not enabled.");const ge=new wr(Y,ee,ie);return yield ge.init(),ge})}static configure(Y={},ee={}){return C(this,void 0,void 0,function*(){return new wr(Y,ee,void 0).configure(!0)})}getConfiguration(){return this.configuration}isSupported(){return this.supported}createTransformDevice(Y,ee){return C(this,void 0,void 0,function*(){if(this.supported)try{const[ie,ne]=yield this.allocateVoiceFocus(!0),re=Object.assign(Object.assign({},ee),{es:this.spec.name==="ns_es"});return new S.default(Y,ie,ne,re)}catch{return}})}static destroyVoiceFocus(Y){var ee;return C(this,void 0,void 0,function*(){(ee=Y==null?void 0:Y.vf)===null||ee===void 0||ee.destroy()})}static augmentSpec(Y){return!Y||!Y.assetGroup&&!Y.revisionID?Object.assign(Object.assign({},Y),{assetGroup:wr.currentSDKAssetGroup()}):Y}configure(Y=!1){return C(this,void 0,void 0,function*(){const ee={fetchBehavior:this.fetchBehavior,preResolve:Y,logger:this.vfLogger};return w.VoiceFocus.configure(this.spec,ee)})}init(){var Y;return C(this,void 0,void 0,function*(){this.configuration||(this.configuration=this.configure());const ee=yield this.configuration;if(!ee.supported){this.supported=!1;return}this.pendingVoiceFocus=this.createVoiceFocus(ee,this.preload);try{yield this.pendingVoiceFocus}catch(ie){(Y=this.logger)===null||Y===void 0||Y.error(`Unable to initialize Amazon Voice Focus: ${ie}`),this.supported=!1}})}createVoiceFocus(Y,ee){return C(this,void 0,void 0,function*(){const ie=new T.default;return this.vf=yield w.VoiceFocus.init(Y,{delegate:ie,preload:ee,logger:this.vfLogger}),[this.vf,ie]})}allocateVoiceFocus(Y){return C(this,void 0,void 0,function*(){if(!this.supported)throw new Error("Not supported.");if(this.pendingVoiceFocus){const ee=this.pendingVoiceFocus;return this.pendingVoiceFocus=void 0,ee}return this.createVoiceFocus(yield this.configuration,Y)})}static majorVersion(){return M.default.sdkVersion.match(/^[1-9][0-9]*\.(?:0|[1-9][0-9]*)/)[0]}static majorMinorVersion(){return M.default.sdkVersion.match(/^[1-9][0-9]*\.(?:0|(?:[1-9][0-9]*))\.(?:0|[1-9][0-9]*)/)[0]}static currentSDKAssetGroup(){const Y=this.majorVersion();return Y?`sdk-${Y}`:"stable-v1"}static defaultFetchBehavior(){const Y=wr.majorMinorVersion()||"unknown",ee=M.default.sdkUserAgentLowResolution;return{escapedQueryString:`sdk=${encodeURIComponent(Y)}&ua=${encodeURIComponent(ee)}`}}};return VoiceFocusDeviceTransformer.VoiceFocusDeviceTransformer=_,VoiceFocusDeviceTransformer.default=_,VoiceFocusDeviceTransformer}var hasRequiredBuild;function requireBuild(){return hasRequiredBuild||(hasRequiredBuild=1,function(C){var E=build$2&&build$2.__importDefault||function(ha){return ha&&ha.__esModule?ha:{default:ha}};Object.defineProperty(C,"__esModule",{value:!0}),C.DefaultEventController=C.DefaultDevicePixelRatioMonitor=C.DefaultDeviceController=C.DefaultContentShareController=C.DefaultBrowserBehavior=C.DefaultAudioVideoFacade=C.DefaultAudioVideoController=C.DefaultAudioMixController=C.DefaultActiveSpeakerPolicy=C.DefaultActiveSpeakerDetector=C.DataMessage=C.CreateSDPTask=C.CreatePeerConnectionTask=C.ContentShareMediaStreamBroker=C.ContentShareConstants=C.ConsoleLogger=C.ConnectionHealthPolicyConfiguration=C.ConnectionHealthData=C.ClientVideoStreamReceivingReport=C.ClientMetricReportMediaType=C.ClientMetricReportDirection=C.ClientMetricReport=C.CleanStoppedSessionTask=C.CleanRestartedSessionTask=C.CheckVideoInputFeedback=C.CheckVideoConnectivityFeedback=C.CheckNetworkUDPConnectivityFeedback=C.CheckNetworkTCPConnectivityFeedback=C.CheckContentShareConnectivityFeedback=C.CheckCameraResolutionFeedback=C.CheckAudioOutputFeedback=C.CheckAudioInputFeedback=C.CheckAudioConnectivityFeedback=C.CanvasVideoFrameBuffer=C.CSPMonitor=C.BitrateParameters=C.BaseTask=C.BaseConnectionHealthPolicy=C.BackgroundReplacementVideoFrameProcessor=C.BackgroundFilterVideoFrameProcessor=C.BackgroundBlurVideoFrameProcessor=C.BackgroundBlurStrength=C.AudioVideoControllerState=C.AudioProfile=C.AudioLogEvent=C.Attendee=C.AttachMediaInputTask=C.AsyncScheduler=C.ApplicationMetadata=C.AllHighestVideoBandwidthPolicy=void 0,C.MeetingReadinessCheckerConfiguration=C.MeetingFeatures=C.MeetingEventsClientConfiguration=C.MediaDeviceProxyHandler=C.Maybe=C.LogLevel=C.Log=C.ListenForVolumeIndicatorsTask=C.LeaveAndReceiveLeaveAckTask=C.JoinAndReceiveIndexTask=C.IntervalScheduler=C.InMemoryJSONEventBuffer=C.GlobalMetricReport=C.GetUserMediaError=C.FullJitterLimitedBackoff=C.FullJitterBackoffFactory=C.FullJitterBackoff=C.FinishGatheringICECandidatesTask=C.EventIngestionConfiguration=C.EventBufferConfiguration=C.DeviceSelection=C.DevicePixelRatioWindowSource=C.DefaultWebSocketAdapter=C.DefaultVolumeIndicatorAdapter=C.DefaultVideoTransformDevice=C.DefaultVideoTileFactory=C.DefaultVideoTileController=C.DefaultVideoTile=C.DefaultVideoStreamIndex=C.DefaultVideoStreamIdSet=C.DefaultVideoFrameProcessorTimer=C.DefaultVideoFrameProcessorPipeline=C.DefaultVideoCaptureAndEncodeParameter=C.DefaultUserAgentParser=C.DefaultTranscriptionController=C.DefaultTransceiverController=C.DefaultSimulcastUplinkPolicyForContentShare=C.DefaultSimulcastUplinkPolicy=C.DefaultSignalingClient=C.DefaultSigV4=C.DefaultSessionStateController=C.DefaultReconnectController=C.DefaultRealtimeController=C.DefaultPingPong=C.DefaultModality=C.DefaultMessagingSession=C.DefaultMeetingSession=C.DefaultMeetingReadinessChecker=C.DefaultMeetingEventReporter=C.DefaultMediaDeviceFactory=void 0,C.RedundantAudioEncoderWorkerCode=C.RedundantAudioEncoder=C.ReconnectionHealthPolicy=C.ReceiveVideoStreamIndexTask=C.ReceiveVideoInputTask=C.ReceiveRemoteVideoPauseResumeTask=C.ReceiveAudioInputTask=C.RealtimeVolumeIndicator=C.RealtimeState=C.RealtimeAttendeePositionInFrame=C.PromoteToPrimaryMeetingTask=C.PromiseQueue=C.PrefetchSortBy=C.PrefetchOn=C.PermissionDeniedError=C.ParallelGroupTask=C.POSTLogger=C.OverconstrainedError=C.OpenSignalingConnectionTask=C.OnceTask=C.NotReadableError=C.NotFoundError=C.None=C.NoVideoUplinkBandwidthPolicy=C.NoVideoDownlinkBandwidthPolicy=C.NoOpVideoFrameProcessor=C.NoOpVideoElementFactory=C.NoOpTask=C.NoOpMediaStreamBroker=C.NoOpLogger=C.NoOpEventReporter=C.NoOpDeviceController=C.NoOpDebugLogger=C.NoOpAudioVideoController=C.NScaleVideoUplinkBandwidthPolicy=C.MutableVideoPreferences=C.MultiLogger=C.MonitorTask=C.ModelSpecBuilder=C.MessagingSessionConfiguration=C.Message=C.MeetingSessionVideoAvailability=C.MeetingSessionURLs=C.MeetingSessionTURNCredentials=C.MeetingSessionStatusCode=C.MeetingSessionStatus=C.MeetingSessionLifecycleEventCondition=C.MeetingSessionLifecycleEvent=C.MeetingSessionCredentials=C.MeetingSessionConfiguration=void 0,C.VideoEncodingCpuConnectionHealthPolicy=C.VideoEncodingConnectionHealthPolicyName=C.VideoCodecCapability=C.VideoAdaptiveProbePolicy=C.Versioning=C.UnusableAudioWarningConnectionHealthPolicy=C.TypeError=C.TranscriptionStatusType=C.TranscriptionStatus=C.TranscriptResult=C.TranscriptLanguageWithScore=C.TranscriptItemType=C.TranscriptItem=C.TranscriptEntity=C.TranscriptAlternative=C.Transcript=C.TimeoutTask=C.TimeoutScheduler=C.TaskStatus=C.TargetDisplaySize=C.SubscribeAndReceiveSubscribeAckTask=C.StreamMetricReport=C.Some=C.SingleNodeAudioTransformDevice=C.SimulcastVideoStreamIndex=C.SimulcastTransceiverController=C.SimulcastLayers=C.SimulcastContentShareTransceiverController=C.SignalingClientVideoSubscriptionConfiguration=C.SignalingClientSubscribe=C.SignalingClientJoin=C.SignalingClientEventType=C.SignalingClientEvent=C.SignalingClientConnectionRequest=C.SignalingAndMetricsConnectionMonitor=C.SetRemoteDescriptionTask=C.SetLocalDescriptionTask=C.SessionStateControllerTransitionResult=C.SessionStateControllerState=C.SessionStateControllerDeferPriority=C.SessionStateControllerAction=C.ServerSideNetworkAdaption=C.SerialGroupTask=C.SendingAudioFailureConnectionHealthPolicy=C.SendAndReceiveDataMessagesTask=C.SDPMediaSection=C.SDPCandidateType=C.SDP=C.RunnableTask=C.RedundantAudioRecoveryMetricReport=void 0,C.isVideoTransformDevice=C.isDestroyable=C.isAudioTransformDevice=C.ZLIBTextCompressor=C.WebSocketReadyState=C.WaitForAttendeePresenceTask=C.VoiceFocusTransformDevice=C.VoiceFocusDeviceTransformer=C.VideoTileState=C.VideoStreamDescription=C.VideoSource=C.VideoQualitySettings=C.VideoQualityAdaptationPreference=C.VideoPriorityBasedPolicyConfig=C.VideoPriorityBasedPolicy=C.VideoPreferences=C.VideoPreference=C.VideoOnlyTransceiverController=C.VideoLogEvent=C.VideoFxProcessor=C.VideoEncodingFramerateConnectionHealthPolicy=void 0;const w=E(requireAllHighestVideoBandwidthPolicy());C.AllHighestVideoBandwidthPolicy=w.default;const R=E(requireApplicationMetadata());C.ApplicationMetadata=R.default;const M=E(requireAsyncScheduler());C.AsyncScheduler=M.default;const x=E(requireAttachMediaInputTask());C.AttachMediaInputTask=x.default;const S=E(requireAttendee());C.Attendee=S.default;const T=E(requireAudioLogEvent());C.AudioLogEvent=T.default;const _=E(requireAudioProfile());C.AudioProfile=_.default;const D=E(requireAudioVideoControllerState());C.AudioVideoControllerState=D.default;const Y=E(requireBackgroundBlurStrength());C.BackgroundBlurStrength=Y.default;const ee=E(requireBackgroundBlurVideoFrameProcessor());C.BackgroundBlurVideoFrameProcessor=ee.default;const ie=E(requireBackgroundFilterVideoFrameProcessor());C.BackgroundFilterVideoFrameProcessor=ie.default;const ne=E(requireBackgroundReplacementVideoFrameProcessor());C.BackgroundReplacementVideoFrameProcessor=ne.default;const re=E(requireBaseConnectionHealthPolicy());C.BaseConnectionHealthPolicy=re.default;const oe=E(requireBaseTask());C.BaseTask=oe.default;const ae=E(requireBitrateParameters());C.BitrateParameters=ae.default;const le=E(requireCSPMonitor());C.CSPMonitor=le.default;const de=E(requireCanvasVideoFrameBuffer());C.CanvasVideoFrameBuffer=de.default;const me=E(requireCheckAudioConnectivityFeedback());C.CheckAudioConnectivityFeedback=me.default;const fe=E(requireCheckAudioInputFeedback());C.CheckAudioInputFeedback=fe.default;const ge=E(requireCheckAudioOutputFeedback());C.CheckAudioOutputFeedback=ge.default;const he=E(requireCheckCameraResolutionFeedback());C.CheckCameraResolutionFeedback=he.default;const ve=E(requireCheckContentShareConnectivityFeedback());C.CheckContentShareConnectivityFeedback=ve.default;const be=E(requireCheckNetworkTCPConnectivityFeedback());C.CheckNetworkTCPConnectivityFeedback=be.default;const Se=E(requireCheckNetworkUDPConnectivityFeedback());C.CheckNetworkUDPConnectivityFeedback=Se.default;const Re=E(requireCheckVideoConnectivityFeedback());C.CheckVideoConnectivityFeedback=Re.default;const Ae=E(requireCheckVideoInputFeedback());C.CheckVideoInputFeedback=Ae.default;const Me=E(requireCleanRestartedSessionTask());C.CleanRestartedSessionTask=Me.default;const Be=E(requireCleanStoppedSessionTask());C.CleanStoppedSessionTask=Be.default;const Qe=E(requireClientMetricReport());C.ClientMetricReport=Qe.default;const Pe=E(requireClientMetricReportDirection());C.ClientMetricReportDirection=Pe.default;const je=E(requireClientMetricReportMediaType());C.ClientMetricReportMediaType=je.default;const Dt=E(requireClientVideoStreamReceivingReport());C.ClientVideoStreamReceivingReport=Dt.default;const Xe=E(requireConnectionHealthData());C.ConnectionHealthData=Xe.default;const zt=E(requireConnectionHealthPolicyConfiguration());C.ConnectionHealthPolicyConfiguration=zt.default;const xe=E(requireConsoleLogger());C.ConsoleLogger=xe.default;const $e=E(requireContentShareConstants());C.ContentShareConstants=$e.default;const We=E(requireContentShareMediaStreamBroker());C.ContentShareMediaStreamBroker=We.default;const He=E(requireCreatePeerConnectionTask());C.CreatePeerConnectionTask=He.default;const Je=E(requireCreateSDPTask());C.CreateSDPTask=Je.default;const Rt=E(requireDataMessage());C.DataMessage=Rt.default;const jt=E(requireDefaultActiveSpeakerDetector());C.DefaultActiveSpeakerDetector=jt.default;const hi=E(requireDefaultActiveSpeakerPolicy());C.DefaultActiveSpeakerPolicy=hi.default;const Jt=E(requireDefaultAudioMixController());C.DefaultAudioMixController=Jt.default;const si=E(requireDefaultAudioVideoController());C.DefaultAudioVideoController=si.default;const ri=E(requireDefaultAudioVideoFacade());C.DefaultAudioVideoFacade=ri.default;const ni=E(requireDefaultBrowserBehavior());C.DefaultBrowserBehavior=ni.default;const Pi=E(requireDefaultContentShareController());C.DefaultContentShareController=Pi.default;const Ci=E(requireDefaultDeviceController());C.DefaultDeviceController=Ci.default;const qi=E(requireDefaultDevicePixelRatioMonitor());C.DefaultDevicePixelRatioMonitor=qi.default;const vi=E(requireDefaultEventController());C.DefaultEventController=vi.default;const Ki=E(requireDefaultMediaDeviceFactory());C.DefaultMediaDeviceFactory=Ki.default;const Vi=E(requireDefaultMeetingEventReporter());C.DefaultMeetingEventReporter=Vi.default;const zi=E(requireDefaultMeetingReadinessChecker());C.DefaultMeetingReadinessChecker=zi.default;const xi=E(requireDefaultMeetingSession());C.DefaultMeetingSession=xi.default;const Di=E(requireDefaultMessagingSession());C.DefaultMessagingSession=Di.default;const bi=E(requireDefaultModality());C.DefaultModality=bi.default;const mi=E(requireDefaultPingPong());C.DefaultPingPong=mi.default;const Oi=E(requireDefaultRealtimeController());C.DefaultRealtimeController=Oi.default;const Bi=E(requireDefaultReconnectController());C.DefaultReconnectController=Bi.default;const Ji=E(requireDefaultSessionStateController());C.DefaultSessionStateController=Ji.default;const Bt=E(requireDefaultSigV4());C.DefaultSigV4=Bt.default;const it=E(requireDefaultSignalingClient());C.DefaultSignalingClient=it.default;const ti=E(requireDefaultSimulcastUplinkPolicy());C.DefaultSimulcastUplinkPolicy=ti.default;const Ee=E(requireDefaultSimulcastUplinkPolicyForContentShare());C.DefaultSimulcastUplinkPolicyForContentShare=Ee.default;const ct=E(requireDefaultTransceiverController());C.DefaultTransceiverController=ct.default;const dt=E(requireDefaultTranscriptionController());C.DefaultTranscriptionController=dt.default;const St=E(requireDefaultUserAgentParser());C.DefaultUserAgentParser=St.default;const ft=E(requireDefaultVideoCaptureAndEncodeParameter());C.DefaultVideoCaptureAndEncodeParameter=ft.default;const Ie=E(requireDefaultVideoFrameProcessorPipeline());C.DefaultVideoFrameProcessorPipeline=Ie.default;const Ye=E(requireDefaultVideoFrameProcessorTimer());C.DefaultVideoFrameProcessorTimer=Ye.default;const Ce=E(requireDefaultVideoStreamIdSet());C.DefaultVideoStreamIdSet=Ce.default;const ke=E(requireDefaultVideoStreamIndex());C.DefaultVideoStreamIndex=ke.default;const Ne=E(requireDefaultVideoTile());C.DefaultVideoTile=Ne.default;const Le=E(requireDefaultVideoTileController());C.DefaultVideoTileController=Le.default;const ai=E(requireDefaultVideoTileFactory());C.DefaultVideoTileFactory=ai.default;const et=E(requireDefaultVideoTransformDevice());C.DefaultVideoTransformDevice=et.default;const Kt=E(requireDefaultVolumeIndicatorAdapter());C.DefaultVolumeIndicatorAdapter=Kt.default;const qe=E(requireDefaultWebSocketAdapter());C.DefaultWebSocketAdapter=qe.default;const Ge=E(requireDevicePixelRatioWindowSource());C.DevicePixelRatioWindowSource=Ge.default;const pe=E(requireDeviceSelection());C.DeviceSelection=pe.default;const Ve=E(requireEventBufferConfiguration());C.EventBufferConfiguration=Ve.default;const we=E(requireEventIngestionConfiguration());C.EventIngestionConfiguration=we.default;const ze=E(requireFinishGatheringICECandidatesTask());C.FinishGatheringICECandidatesTask=ze.default;const Ze=E(requireFullJitterBackoff());C.FullJitterBackoff=Ze.default;const $t=E(requireFullJitterBackoffFactory());C.FullJitterBackoffFactory=$t.default;const ii=E(requireFullJitterLimitedBackoff());C.FullJitterLimitedBackoff=ii.default;const Yt=E(requireGetUserMediaError());C.GetUserMediaError=Yt.default;const Ni=E(requireGlobalMetricReport());C.GlobalMetricReport=Ni.default;const pi=E(requireInMemoryJSONEventBuffer());C.InMemoryJSONEventBuffer=pi.default;const qn=E(requireIntervalScheduler());C.IntervalScheduler=qn.default;const Jn=E(requireJoinAndReceiveIndexTask());C.JoinAndReceiveIndexTask=Jn.default;const Ti=E(requireLeaveAndReceiveLeaveAckTask());C.LeaveAndReceiveLeaveAckTask=Ti.default;const _i=E(requireListenForVolumeIndicatorsTask());C.ListenForVolumeIndicatorsTask=_i.default;const Ei=E(requireLog());C.Log=Ei.default;const un=E(requireLogLevel());C.LogLevel=un.default;const gn=E(requireMediaDeviceProxyHandler());C.MediaDeviceProxyHandler=gn.default;const Na=E(requireMeetingEventsClientConfiguration());C.MeetingEventsClientConfiguration=Na.default;const gu=E(requireMeetingFeatures());C.MeetingFeatures=gu.default;const Ls=E(requireMeetingReadinessCheckerConfiguration());C.MeetingReadinessCheckerConfiguration=Ls.default;const ia=E(requireMeetingSessionConfiguration());C.MeetingSessionConfiguration=ia.default;const Do=E(requireMeetingSessionCredentials());C.MeetingSessionCredentials=Do.default;const ar=E(requireMeetingSessionLifecycleEvent());C.MeetingSessionLifecycleEvent=ar.default;const Tr=E(requireMeetingSessionLifecycleEventCondition());C.MeetingSessionLifecycleEventCondition=Tr.default;const na=E(requireMeetingSessionStatus());C.MeetingSessionStatus=na.default;const Rr=E(requireMeetingSessionStatusCode());C.MeetingSessionStatusCode=Rr.default;const tn=E(requireMeetingSessionTURNCredentials());C.MeetingSessionTURNCredentials=tn.default;const Fs=E(requireMeetingSessionURLs());C.MeetingSessionURLs=Fs.default;const js=E(requireMeetingSessionVideoAvailability());C.MeetingSessionVideoAvailability=js.default;const or=E(requireMessage());C.Message=or.default;const kr=E(requireMessagingSessionConfiguration());C.MessagingSessionConfiguration=kr.default;const Un=E(requireModelSpecBuilder());C.ModelSpecBuilder=Un.default;const vu=E(requireMonitorTask());C.MonitorTask=vu.default;const qs=E(requireMultiLogger());C.MultiLogger=qs.default;const Us=E(requireNScaleVideoUplinkBandwidthPolicy());C.NScaleVideoUplinkBandwidthPolicy=Us.default;const bu=E(requireNoOpAudioVideoController());C.NoOpAudioVideoController=bu.default;const La=E(requireNoOpDebugLogger());C.NoOpDebugLogger=La.default;const Fa=E(requireNoOpDeviceController());C.NoOpDeviceController=Fa.default;const Hn=E(requireNoOpEventReporter());C.NoOpEventReporter=Hn.default;const Cn=E(requireNoOpLogger());C.NoOpLogger=Cn.default;const Hs=E(requireNoOpMediaStreamBroker());C.NoOpMediaStreamBroker=Hs.default;const yu=E(requireNoOpTask());C.NoOpTask=yu.default;const ja=E(requireNoOpVideoElementFactory());C.NoOpVideoElementFactory=ja.default;const zs=E(requireNoOpVideoFrameProcessor());C.NoOpVideoFrameProcessor=zs.default;const qa=E(requireNoVideoDownlinkBandwidthPolicy());C.NoVideoDownlinkBandwidthPolicy=qa.default;const Su=E(requireNoVideoUplinkBandwidthPolicy());C.NoVideoUplinkBandwidthPolicy=Su.default;const En=E(requireNotFoundError());C.NotFoundError=En.default;const Bo=E(requireNotReadableError());C.NotReadableError=Bo.default;const $s=E(requireOnceTask());C.OnceTask=$s.default;const Vo=E(requireOpenSignalingConnectionTask());C.OpenSignalingConnectionTask=Vo.default;const xr=E(requireOverconstrainedError());C.OverconstrainedError=xr.default;const Gs=E(requirePOSTLogger());C.POSTLogger=Gs.default;const Ws=E(requireParallelGroupTask());C.ParallelGroupTask=Ws.default;const _r=E(requirePermissionDeniedError());C.PermissionDeniedError=_r.default;const Cu=E(requirePrefetchOn());C.PrefetchOn=Cu.default;const Ks=E(requirePrefetchSortBy());C.PrefetchSortBy=Ks.default;const Js=E(requirePromiseQueue());C.PromiseQueue=Js.default;const No=E(requirePromoteToPrimaryMeetingTask());C.PromoteToPrimaryMeetingTask=No.default;const Eu=E(requireRealtimeAttendeePositionInFrame());C.RealtimeAttendeePositionInFrame=Eu.default;const wu=E(requireRealtimeState());C.RealtimeState=wu.default;const Ua=E(requireRealtimeVolumeIndicator());C.RealtimeVolumeIndicator=Ua.default;const Lo=E(requireReceiveAudioInputTask());C.ReceiveAudioInputTask=Lo.default;const Fo=E(requireReceiveRemoteVideoPauseResumeTask());C.ReceiveRemoteVideoPauseResumeTask=Fo.default;const Ar=E(requireReceiveVideoInputTask());C.ReceiveVideoInputTask=Ar.default;const Mr=E(requireReceiveVideoStreamIndexTask());C.ReceiveVideoStreamIndexTask=Mr.default;const Xs=E(requireReconnectionHealthPolicy());C.ReconnectionHealthPolicy=Xs.default;const jo=E(requireRedundantAudioEncoder());C.RedundantAudioEncoder=jo.default;const Ys=E(requireRedundantAudioEncoderWorkerCode());C.RedundantAudioEncoderWorkerCode=Ys.default;const ra=E(requireRedundantAudioRecoveryMetricReport());C.RedundantAudioRecoveryMetricReport=ra.default;const qo=E(requireRunnableTask());C.RunnableTask=qo.default;const aa=E(requireSDP());C.SDP=aa.default;const Xn=E(requireSDPCandidateType());C.SDPCandidateType=Xn.default;const Uo=E(requireSDPMediaSection());C.SDPMediaSection=Uo.default;const Ha=E(requireSendAndReceiveDataMessagesTask());C.SendAndReceiveDataMessagesTask=Ha.default;const Zs=E(requireSendingAudioFailureConnectionHealthPolicy());C.SendingAudioFailureConnectionHealthPolicy=Zs.default;const za=E(requireSerialGroupTask());C.SerialGroupTask=za.default;const $a=E(requireServerSideNetworkAdaption());C.ServerSideNetworkAdaption=$a.default;const Qs=E(requireSessionStateControllerAction());C.SessionStateControllerAction=Qs.default;const vn=E(requireSessionStateControllerDeferPriority());C.SessionStateControllerDeferPriority=vn.default;const sr=E(requireSessionStateControllerState());C.SessionStateControllerState=sr.default;const Ga=E(requireSessionStateControllerTransitionResult());C.SessionStateControllerTransitionResult=Ga.default;const oa=E(requireSetLocalDescriptionTask());C.SetLocalDescriptionTask=oa.default;const Tu=E(requireSetRemoteDescriptionTask());C.SetRemoteDescriptionTask=Tu.default;const Ho=E(requireSignalingAndMetricsConnectionMonitor());C.SignalingAndMetricsConnectionMonitor=Ho.default;const zo=E(requireSignalingClientConnectionRequest());C.SignalingClientConnectionRequest=zo.default;const sa=E(requireSignalingClientEvent());C.SignalingClientEvent=sa.default;const Wa=E(requireSignalingClientEventType());C.SignalingClientEventType=Wa.default;const el=E(requireSignalingClientJoin());C.SignalingClientJoin=el.default;const Ru=E(requireSignalingClientSubscribe());C.SignalingClientSubscribe=Ru.default;const ku=E(requireSignalingClientVideoSubscriptionConfiguration());C.SignalingClientVideoSubscriptionConfiguration=ku.default;const xu=E(requireSimulcastContentShareTransceiverController());C.SimulcastContentShareTransceiverController=xu.default;const $o=E(requireSimulcastLayers());C.SimulcastLayers=$o.default;const _u=E(requireSimulcastTransceiverController());C.SimulcastTransceiverController=_u.default;const Au=E(requireSimulcastVideoStreamIndex());C.SimulcastVideoStreamIndex=Au.default;const Mu=E(requireSingleNodeAudioTransformDevice());C.SingleNodeAudioTransformDevice=Mu.default;const Iu=E(requireStreamMetricReport());C.StreamMetricReport=Iu.default;const Pu=E(requireSubscribeAndReceiveSubscribeAckTask());C.SubscribeAndReceiveSubscribeAckTask=Pu.default;const tl=E(requireTargetDisplaySize());C.TargetDisplaySize=tl.default;const Ou=E(requireTaskStatus());C.TaskStatus=Ou.default;const Du=E(requireTimeoutScheduler());C.TimeoutScheduler=Du.default;const Bu=E(requireTimeoutTask());C.TimeoutTask=Bu.default;const Vu=E(requireTranscript());C.Transcript=Vu.default;const Go=E(requireTranscriptAlternative());C.TranscriptAlternative=Go.default;const Nu=E(requireTranscriptEntity());C.TranscriptEntity=Nu.default;const Lu=E(requireTranscriptItem());C.TranscriptItem=Lu.default;const Fu=E(requireTranscriptItemType());C.TranscriptItemType=Fu.default;const il=E(requireTranscriptLanguageWithScore());C.TranscriptLanguageWithScore=il.default;const ju=E(requireTranscriptResult());C.TranscriptResult=ju.default;const qu=E(requireTranscriptionStatus());C.TranscriptionStatus=qu.default;const Uu=E(requireTranscriptionStatusType());C.TranscriptionStatusType=Uu.default;const Hu=E(require_TypeError());C.TypeError=Hu.default;const zu=E(requireUnusableAudioWarningConnectionHealthPolicy());C.UnusableAudioWarningConnectionHealthPolicy=zu.default;const $u=E(requireVersioning());C.Versioning=$u.default;const Gu=E(requireVideoAdaptiveProbePolicy());C.VideoAdaptiveProbePolicy=Gu.default;const Wu=E(requireVideoCodecCapability());C.VideoCodecCapability=Wu.default;const Ku=E(requireVideoEncodingConnectionHealthPolicyName());C.VideoEncodingConnectionHealthPolicyName=Ku.default;const Wo=E(requireVideoEncodingCpuConnectionHealthPolicy());C.VideoEncodingCpuConnectionHealthPolicy=Wo.default;const la=E(requireVideoEncodingFramerateConnectionHealthPolicy());C.VideoEncodingFramerateConnectionHealthPolicy=la.default;const Ju=E(requireVideoFxProcessor());C.VideoFxProcessor=Ju.default;const nl=E(requireVideoLogEvent());C.VideoLogEvent=nl.default;const rl=E(requireVideoOnlyTransceiverController());C.VideoOnlyTransceiverController=rl.default;const al=E(requireVideoPreference());C.VideoPreference=al.default;const ol=E(requireVideoPreferences());C.VideoPreferences=ol.default;const sl=E(requireVideoPriorityBasedPolicy());C.VideoPriorityBasedPolicy=sl.default;const Ir=E(requireVideoPriorityBasedPolicyConfig());C.VideoPriorityBasedPolicyConfig=Ir.default;const Xu=E(requireVideoQualityAdaptationPreference());C.VideoQualityAdaptationPreference=Xu.default;const Yu=E(requireVideoQualitySettings());C.VideoQualitySettings=Yu.default;const Zu=E(requireVideoSource());C.VideoSource=Zu.default;const ll=E(requireVideoStreamDescription());C.VideoStreamDescription=ll.default;const ul=E(requireVideoTileState());C.VideoTileState=ul.default;const ua=E(requireVoiceFocusDeviceTransformer());C.VoiceFocusDeviceTransformer=ua.default;const ca=E(requireVoiceFocusTransformDevice());C.VoiceFocusTransformDevice=ca.default;const Qu=E(requireWaitForAttendeePresenceTask());C.WaitForAttendeePresenceTask=Qu.default;const Ka=E(requireWebSocketReadyState());C.WebSocketReadyState=Ka.default;const cl=E(requireZLIBTextCompressor());C.ZLIBTextCompressor=cl.default;const dl=requireVideoPreferences();Object.defineProperty(C,"MutableVideoPreferences",{enumerable:!0,get:function(){return dl.MutableVideoPreferences}});const da=requireTypes$1();Object.defineProperty(C,"Some",{enumerable:!0,get:function(){return da.Some}}),Object.defineProperty(C,"None",{enumerable:!0,get:function(){return da.None}}),Object.defineProperty(C,"Maybe",{enumerable:!0,get:function(){return da.Maybe}});const Ko=requireAudioTransformDevice();Object.defineProperty(C,"isAudioTransformDevice",{enumerable:!0,get:function(){return Ko.isAudioTransformDevice}});const hl=requireDestroyable();Object.defineProperty(C,"isDestroyable",{enumerable:!0,get:function(){return hl.isDestroyable}});const fl=requireVideoTransformDevice();Object.defineProperty(C,"isVideoTransformDevice",{enumerable:!0,get:function(){return fl.isVideoTransformDevice}})}(build$2)),build$2}var buildExports=requireBuild();class BlockingQueue{constructor(){ce(this,"_promises"),ce(this,"_resolvers"),this._resolvers=[],this._promises=[]}_add(){this._promises.push(new Promise(E=>{this._resolvers.push(E)}))}enqueue(E){this._resolvers.length==0&&this._add(),this._resolvers.shift()(E)}dequeue(){return this._promises.length==0&&this._add(),this._promises.shift()}isEmpty(){return this._promises.length==0}isBlocked(){return this._resolvers.length!=0}get length(){return this._promises.length-this._resolvers.length}}const createDummyMediaStream=C=>{const E=C.createMediaStreamDestination(),w=C.createGain();w.gain.value=0,w.connect(E);const R=C.createOscillator();return R.frequency.value=440,R.connect(w),R.start(),E.stream},validateUrl=C=>C!=null&&C.endsWith("/")?C.substring(0,C.length-1):C;class VoiceChangerClient{constructor(E,w,R){ce(this,"ctx"),ce(this,"vfEnable",!1),ce(this,"vf",null),ce(this,"currentDevice",null),ce(this,"currentMediaStream",null),ce(this,"currentMediaStreamAudioSourceNode",null),ce(this,"inputGainNode",null),ce(this,"outputGainNode",null),ce(this,"monitorGainNode",null),ce(this,"vcInNode"),ce(this,"vcOutNode"),ce(this,"currentMediaStreamAudioDestinationNode",null),ce(this,"currentMediaStreamAudioDestinationMonitorNode",null),ce(this,"promiseForInitialize"),ce(this,"_isVoiceChanging",!1),ce(this,"clientSetting",DefaultClientSettng),ce(this,"sslCertified",[]),ce(this,"sem",new BlockingQueue),ce(this,"lock",async()=>await this.sem.dequeue()),ce(this,"unlock",M=>{this.sem.enqueue(M+1)}),ce(this,"isInitialized",async()=>(this.promiseForInitialize&&await this.promiseForInitialize,!0)),ce(this,"setup",async()=>{if(console.log(`Input Setup=> audio: ${this.clientSetting.voiceChangerClientSetting.audioInput}`),console.log(`Input Setup=> echo: ${this.clientSetting.voiceChangerClientSetting.echoCancel}, noise1: ${this.clientSetting.voiceChangerClientSetting.noiseSuppression}, noise2: ${this.clientSetting.voiceChangerClientSetting.noiseSuppression2}`),!this.vcInNode)throw console.warn("vc node is not initialized."),"vc node is not initialized.";if(this.currentMediaStream&&(this.currentMediaStream.getTracks().forEach(M=>{M.stop()}),this.currentMediaStream=null),typeof this.clientSetting.voiceChangerClientSetting.audioInput=="string")try{this.clientSetting.voiceChangerClientSetting.audioInput=="none"?(console.log("Input Setup=> dummy stream."),this.currentMediaStream=createDummyMediaStream(this.ctx)):this.currentMediaStream=await navigator.mediaDevices.getUserMedia({audio:{deviceId:this.clientSetting.voiceChangerClientSetting.audioInput,channelCount:1,sampleRate:this.clientSetting.voiceChangerClientSetting.sampleRate,sampleSize:16,autoGainControl:!1,echoCancellation:this.clientSetting.voiceChangerClientSetting.echoCancel,noiseSuppression:this.clientSetting.voiceChangerClientSetting.noiseSuppression}})}catch(M){throw console.warn(M),this.vcInNode.stop(),M}else this.currentMediaStream=this.clientSetting.voiceChangerClientSetting.audioInput;if(this.currentMediaStreamAudioSourceNode=this.ctx.createMediaStreamSource(this.currentMediaStream),this.inputGainNode=this.ctx.createGain(),this.inputGainNode.gain.value=this.clientSetting.voiceChangerClientSetting.inputGain,this.currentMediaStreamAudioSourceNode.connect(this.inputGainNode),this.currentDevice&&this.clientSetting.voiceChangerClientSetting.noiseSuppression2){this.currentDevice.chooseNewInnerDevice(this.currentMediaStream);const M=await this.currentDevice.createAudioNode(this.ctx);this.inputGainNode.connect(M.start),M.end.connect(this.vcInNode)}else this.inputGainNode.connect(this.vcInNode);this.vcInNode.setOutputNode(this.vcOutNode),console.log("Input Setup=> success")}),ce(this,"start",async()=>{await this.vcInNode.start(),this._isVoiceChanging=!0}),ce(this,"stop",async()=>{await this.vcInNode.stop(),this._isVoiceChanging=!1}),ce(this,"setServerUrl",(M,x=!1)=>{const S=validateUrl(M),T=`${location.protocol}//${location.host}`;S!=T&&S.length!=0&&location.protocol=="https:"&&this.sslCertified.includes(S)==!1&&x&&(window.confirm("MMVC Server is different from this page's origin. Open tab to open ssl connection. OK? (You can close the opened tab after ssl connection succeed.)")?(window.open(S,"_blank"),this.sslCertified.push(S)):alert("Your voice conversion may fail...")),this.vcInNode.updateSetting({...this.vcInNode.getSettings(),serverUrl:S})}),ce(this,"getClientSetting",()=>({voiceChangerClientSetting:{...this.clientSetting.voiceChangerClientSetting},workletNodeSetting:{...this.clientSetting.workletNodeSetting},workletSetting:{...this.clientSetting.workletSetting}})),ce(this,"updateClientSetting",async M=>{const x=await this.lock();let S=!1;(this.clientSetting.voiceChangerClientSetting.audioInput!=M.voiceChangerClientSetting.audioInput||this.clientSetting.voiceChangerClientSetting.echoCancel!=M.voiceChangerClientSetting.echoCancel||this.clientSetting.voiceChangerClientSetting.noiseSuppression!=M.voiceChangerClientSetting.noiseSuppression||this.clientSetting.voiceChangerClientSetting.noiseSuppression2!=M.voiceChangerClientSetting.noiseSuppression2||this.clientSetting.voiceChangerClientSetting.sampleRate!=M.voiceChangerClientSetting.sampleRate)&&(S=!0),this.clientSetting.voiceChangerClientSetting.inputGain!=M.voiceChangerClientSetting.inputGain&&this._setInputGain(M.voiceChangerClientSetting.inputGain),this.clientSetting.voiceChangerClientSetting.outputGain!=M.voiceChangerClientSetting.outputGain&&this._setOutputGain(M.voiceChangerClientSetting.outputGain),this.clientSetting.voiceChangerClientSetting.monitorGain!=M.voiceChangerClientSetting.monitorGain&&this._setMonitorGain(M.voiceChangerClientSetting.monitorGain),this.clientSetting={voiceChangerClientSetting:{...M.voiceChangerClientSetting},workletNodeSetting:{...M.workletNodeSetting},workletSetting:{...M.workletSetting}},S&&await this.setup(),this._configureWorklet(M.workletSetting),this._updateWorkletNodeSetting(M.workletNodeSetting),await this.unlock(x)}),ce(this,"_setInputGain",M=>{this.inputGainNode&&M&&(this.inputGainNode.gain.value=M)}),ce(this,"_setOutputGain",M=>{this.outputGainNode&&M&&(this.outputGainNode.gain.value=M)}),ce(this,"_setMonitorGain",M=>{this.monitorGainNode&&M&&(this.monitorGainNode.gain.value=M)}),ce(this,"_configureWorklet",M=>{this.vcInNode==null||this.vcOutNode==null||(this.vcInNode.configureWorklet(M),this.vcOutNode.configureWorklet(M))}),ce(this,"trancateBuffer",()=>{this.vcOutNode.trancateBuffer()}),ce(this,"_updateWorkletNodeSetting",M=>{this.vcInNode==null||this.vcOutNode==null||(this.clientSetting.workletNodeSetting=M,this.vcInNode.updateSetting(M),this.vcOutNode.updateSetting(M))}),ce(this,"setInternalAudioProcessCallback",M=>{this.vcInNode.setInternalAudioProcessCallback(M)}),ce(this,"startInputRecording",()=>{this.vcInNode.startInputRecording()}),ce(this,"stopInputRecording",()=>this.vcInNode.stopInputRecording()),ce(this,"startOutputRecording",()=>{this.vcOutNode.startOutputRecording()}),ce(this,"stopOutputRecording",()=>this.vcOutNode.stopOutputRecording()),ce(this,"stopSendData",()=>{this.vcInNode.stopSendData()}),ce(this,"startSendData",()=>{this.vcInNode.startSendData()}),ce(this,"getSocketId",()=>this.vcInNode.getSocketId()),this.sem.enqueue(0),this.ctx=E,this.vfEnable=w,this.promiseForInitialize=new Promise(async M=>{const x=URL.createObjectURL(new Blob([workerjs],{type:"text/javascript"}));try{this.vcInNode=new VoiceChangerWorkletNode(this.ctx,"IN",R)}catch{await this.ctx.audioWorklet.addModule(x),this.vcInNode=new VoiceChangerWorkletNode(this.ctx,"IN",R)}const S=new AudioContext({sampleRate:48e3});try{this.vcOutNode=new VoiceChangerWorkletNode(S,"OUT",R)}catch{await S.audioWorklet.addModule(x),this.vcOutNode=new VoiceChangerWorkletNode(S,"OUT",R)}if(this.currentMediaStreamAudioDestinationNode=S.createMediaStreamDestination(),this.outputGainNode=S.createGain(),this.outputGainNode.gain.value=this.clientSetting.voiceChangerClientSetting.outputGain,this.vcOutNode.connect(this.outputGainNode),this.outputGainNode.connect(this.currentMediaStreamAudioDestinationNode),this.currentMediaStreamAudioDestinationMonitorNode=S.createMediaStreamDestination(),this.monitorGainNode=S.createGain(),this.monitorGainNode.gain.value=this.clientSetting.voiceChangerClientSetting.monitorGain,this.vcOutNode.connect(this.monitorGainNode),this.monitorGainNode.connect(this.currentMediaStreamAudioDestinationMonitorNode),this.vfEnable){this.vf=await buildExports.VoiceFocusDeviceTransformer.create({variant:"c20"});const T=createDummyMediaStream(this.ctx);this.currentDevice=await this.vf.createTransformDevice(T)||null}M()})}get stream(){var E;return((E=this.currentMediaStreamAudioDestinationNode)==null?void 0:E.stream)||null}get monitorStream(){var E;return((E=this.currentMediaStreamAudioDestinationMonitorNode)==null?void 0:E.stream)||null}get isVoiceChanging(){return this._isVoiceChanging}}const useServerConfig=C=>{const E=reactExports.useRef(null),[w,R]=reactExports.useState(),[M,x]=reactExports.useState(),[S,T]=reactExports.useState([]),[_,D]=reactExports.useState([]),[Y,ee]=reactExports.useState([]);reactExports.useEffect(()=>{E.current=RestClient.getInstance(),E.current.getServerConfiguration(),ie(),ne(),re(),oe(),ae()},[]),reactExports.useEffect(()=>{E.current=RestClient.getInstance(),E.current.setEnableFlatPath(C.flatPath)},[C.flatPath]);const ie=async()=>{if(!E.current)return;const We=await E.current.getServerConfiguration();R(We)},ne=async()=>{if(!E.current)return;const We=await E.current.getServerGPUInfo();x(We)},re=async(We=!1)=>{if(!E.current)return;const He=await E.current.getServerModuleStatus(We);T(He)},oe=async()=>{if(!E.current)return;const We=await E.current.getServerSlotInfos();D(We)},ae=async()=>{if(!E.current)return;const We=await E.current.getVoiceCharacterSlotInfos();ee(We)},le=async We=>{try{await We()}catch(He){console.info("[RestClient] Error occurred:",He);const Je=He;if(Je.type==VOICE_CHANGER_CLIENT_EXCEPTION.ERR_HTTP_EXCEPTION){const Rt=`${Je.status}[${Je.statusText}]: ${Je.reason} ${Je.action}`;C.exceptionCallback(Rt)}else throw Je}},de=async We=>{await le(async()=>{await me(We)})},me=async We=>{E.current&&(await E.current.updateServerConfiguration(We),ie())};return{serverConfiguration:w,serverGpuInfo:M,serverModuleStatus:S,serverSlotInfos:_,serverVoiceCharacterSlotInfos:Y,reloadServerConfiguration:ie,reloadServerSlotInfos:oe,reloadServerModuleStatus:re,reloadVoiceCharacterSlotInfos:ae,updateServerConfiguration:de,uploadModelFile:async(We,He,Je,Rt)=>{var jt,hi;if(E.current){if(console.log("uploadModelFile1",We,He,Je),He==="seed-vc"){const Jt=(jt=Je.find(ri=>ri.kind==="checkpoint"))==null?void 0:jt.file,si=(hi=Je.find(ri=>ri.kind==="config"))==null?void 0:hi.file;if(!Jt||!si)throw new Error("checkpoint and config files are required");await E.current.uploadSeedVCModelFile(We,Jt,si,Rt)}else throw new Error("Not supported voice changer type");oe()}},updateServerSlotInfo:async We=>{E.current&&(await E.current.updateServerSlotInfo(We),oe())},deleteServerSlotInfo:async We=>{E.current&&(await E.current.deleteServerSlotInfo(We),oe())},uploadIconFile:async(We,He,Je)=>{E.current&&(await E.current.uploadIconFile(We,He,Je),oe())},moveModel:async(We,He)=>{if(!E.current)return;const Je={src:We,dst:He};await E.current.moveModel(Je),oe()},uploadVoiceCharacterFile:async(We,He,Je,Rt,jt)=>{var Jt,si;const hi=((Jt=Rt.find(ri=>ri.kind==="zipFile"))==null?void 0:Jt.file)||null;await((si=E.current)==null?void 0:si.uploadVoiceCharacterFile(We,He,Je,hi,jt)),ae()},updateVoiceCharacterSlotInfo:async We=>{E.current&&(await E.current.updateVoiceCharacterSlotInfo(We),ae())},deleteVoiceCharacterSlotInfo:async We=>{E.current&&(await E.current.deleteVoiceCharacterSlotInfo(We),ae())},uploadVoiceCharacterIconFile:async(We,He,Je)=>{E.current&&(await E.current.uploadVoiceCharacterIconFile(We,He,Je),ae())},moveVoiceCharacter:async(We,He)=>{if(!E.current)return;const Je={src:We,dst:He};await E.current.moveVoiceCharacter(Je),ae()},downloadVoiceCharacter:async We=>E.current?await E.current.downloadVoiceCharacter(We):null,addReferenceVoice:async(We,He,Je,Rt,jt)=>{E.current&&(await E.current.addReferenceVoice(We,He,Je,Rt,jt),ae())},updateReferenceVoice:async(We,He,Je)=>{E.current&&(await E.current.updateReferenceVoice(We,He,Je),ae())},deleteReferenceVoice:async(We,He)=>{E.current&&(await E.current.deleteReferenceVoice(We,He),ae())},getReferenceVoiceFile:async(We,He)=>E.current?await E.current.getReferenceVoiceFile(We,He):null,updateReferenceVoiceIconFile:async(We,He,Je,Rt)=>{E.current&&(await E.current.uploadReferenceVoiceIconFile(We,He,Je,Rt),ae())},convertVoiceFile:async We=>E.current?await E.current.convertVoiceFileToFile(We):null,initializeServer:async()=>{E.current&&(await E.current.initializeServer(),oe())}}};function r(C){var E,w,R="";if(typeof C=="string"||typeof C=="number")R+=C;else if(typeof C=="object")if(Array.isArray(C)){var M=C.length;for(E=0;E<M;E++)C[E]&&(w=r(C[E]))&&(R&&(R+=" "),R+=w)}else for(w in C)C[w]&&(R&&(R+=" "),R+=w);return R}function clsx(){for(var C,E,w=0,R="",M=arguments.length;w<M;w++)(C=arguments[w])&&(E=r(C))&&(R&&(R+=" "),R+=E);return R}function Mt(C){if(typeof document>"u")return;let E=document.head||document.getElementsByTagName("head")[0],w=document.createElement("style");w.type="text/css",E.firstChild?E.insertBefore(w,E.firstChild):E.appendChild(w),w.styleSheet?w.styleSheet.cssText=C:w.appendChild(document.createTextNode(C))}Mt(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var L=C=>typeof C=="number"&&!isNaN(C),N=C=>typeof C=="string",P=C=>typeof C=="function",mt=C=>N(C)||L(C),B=C=>N(C)||P(C)?C:null,pt=(C,E)=>C===!1||L(C)&&C>0?C:E,z=C=>reactExports.isValidElement(C)||N(C)||P(C)||L(C);function Z(C,E,w=300){let{scrollHeight:R,style:M}=C;requestAnimationFrame(()=>{M.minHeight="initial",M.height=R+"px",M.transition=`all ${w}ms`,requestAnimationFrame(()=>{M.height="0",M.padding="0",M.margin="0",setTimeout(E,w)})})}function $({enter:C,exit:E,appendPosition:w=!1,collapse:R=!0,collapseDuration:M=300}){return function({children:x,position:S,preventExitTransition:T,done:_,nodeRef:D,isIn:Y,playToast:ee}){let ie=w?`${C}--${S}`:C,ne=w?`${E}--${S}`:E,re=reactExports.useRef(0);return reactExports.useLayoutEffect(()=>{let oe=D.current,ae=ie.split(" "),le=de=>{de.target===D.current&&(ee(),oe.removeEventListener("animationend",le),oe.removeEventListener("animationcancel",le),re.current===0&&de.type!=="animationcancel"&&oe.classList.remove(...ae))};oe.classList.add(...ae),oe.addEventListener("animationend",le),oe.addEventListener("animationcancel",le)},[]),reactExports.useEffect(()=>{let oe=D.current,ae=()=>{oe.removeEventListener("animationend",ae),R?Z(oe,_,M):_()};Y||(T?ae():(re.current=1,oe.className+=` ${ne}`,oe.addEventListener("animationend",ae)))},[Y]),React.createElement(React.Fragment,null,x)}}function J(C,E){return{content:tt(C.content,C.props),containerId:C.props.containerId,id:C.props.toastId,theme:C.props.theme,type:C.props.type,data:C.props.data||{},isLoading:C.props.isLoading,icon:C.props.icon,reason:C.removalReason,status:E}}function tt(C,E,w=!1){return reactExports.isValidElement(C)&&!N(C.type)?reactExports.cloneElement(C,{closeToast:E.closeToast,toastProps:E,data:E.data,isPaused:w}):P(C)?C({closeToast:E.closeToast,toastProps:E,data:E.data,isPaused:w}):C}function yt({closeToast:C,theme:E,ariaLabel:w="close"}){return React.createElement("button",{className:`Toastify__close-button Toastify__close-button--${E}`,type:"button",onClick:R=>{R.stopPropagation(),C(!0)},"aria-label":w},React.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},React.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function gt({delay:C,isRunning:E,closeToast:w,type:R="default",hide:M,className:x,controlledProgress:S,progress:T,rtl:_,isIn:D,theme:Y}){let ee=M||S&&T===0,ie={animationDuration:`${C}ms`,animationPlayState:E?"running":"paused"};S&&(ie.transform=`scaleX(${T})`);let ne=clsx("Toastify__progress-bar",S?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${Y}`,`Toastify__progress-bar--${R}`,{"Toastify__progress-bar--rtl":_}),re=P(x)?x({rtl:_,type:R,defaultClassName:ne}):clsx(ne,x),oe={[S&&T>=1?"onTransitionEnd":"onAnimationEnd"]:S&&T<1?null:()=>{D&&w()}};return React.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":ee},React.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${Y} Toastify__progress-bar--${R}`}),React.createElement("div",{role:"progressbar","aria-hidden":ee?"true":"false","aria-label":"notification timer",className:re,style:ie,...oe}))}var Xt=1,at=()=>`${Xt++}`;function _t(C,E,w){let R=1,M=0,x=[],S=[],T=E,_=new Map,D=new Set,Y=de=>(D.add(de),()=>D.delete(de)),ee=()=>{S=Array.from(_.values()),D.forEach(de=>de())},ie=({containerId:de,toastId:me,updateId:fe})=>{let ge=de?de!==C:C!==1,he=_.has(me)&&fe==null;return ge||he},ne=(de,me)=>{_.forEach(fe=>{var ge;(me==null||me===fe.props.toastId)&&((ge=fe.toggle)==null||ge.call(fe,de))})},re=de=>{var me,fe;(fe=(me=de.props)==null?void 0:me.onClose)==null||fe.call(me,de.removalReason),de.isActive=!1},oe=de=>{if(de==null)_.forEach(re);else{let me=_.get(de);me&&re(me)}ee()},ae=()=>{M-=x.length,x=[]},le=de=>{var me,fe;let{toastId:ge,updateId:he}=de.props,ve=he==null;de.staleId&&_.delete(de.staleId),de.isActive=!0,_.set(ge,de),ee(),w(J(de,ve?"added":"updated")),ve&&((fe=(me=de.props).onOpen)==null||fe.call(me))};return{id:C,props:T,observe:Y,toggle:ne,removeToast:oe,toasts:_,clearQueue:ae,buildToast:(de,me)=>{if(ie(me))return;let{toastId:fe,updateId:ge,data:he,staleId:ve,delay:be}=me,Se=ge==null;Se&&M++;let Re={...T,style:T.toastStyle,key:R++,...Object.fromEntries(Object.entries(me).filter(([Me,Be])=>Be!=null)),toastId:fe,updateId:ge,data:he,isIn:!1,className:B(me.className||T.toastClassName),progressClassName:B(me.progressClassName||T.progressClassName),autoClose:me.isLoading?!1:pt(me.autoClose,T.autoClose),closeToast(Me){_.get(fe).removalReason=Me,oe(fe)},deleteToast(){let Me=_.get(fe);if(Me!=null){if(w(J(Me,"removed")),_.delete(fe),M--,M<0&&(M=0),x.length>0){le(x.shift());return}ee()}}};Re.closeButton=T.closeButton,me.closeButton===!1||z(me.closeButton)?Re.closeButton=me.closeButton:me.closeButton===!0&&(Re.closeButton=z(T.closeButton)?T.closeButton:!0);let Ae={content:de,props:Re,staleId:ve};T.limit&&T.limit>0&&M>T.limit&&Se?x.push(Ae):L(be)?setTimeout(()=>{le(Ae)},be):le(Ae)},setProps(de){T=de},setToggle:(de,me)=>{let fe=_.get(de);fe&&(fe.toggle=me)},isToastActive:de=>{var me;return(me=_.get(de))==null?void 0:me.isActive},getSnapshot:()=>S}}var I=new Map,F=[],st=new Set,Vt=C=>st.forEach(E=>E(C)),bt=()=>I.size>0;function Qt(){F.forEach(C=>nt(C.content,C.options)),F=[]}var vt=(C,{containerId:E})=>{var w;return(w=I.get(E||1))==null?void 0:w.toasts.get(C)};function X(C,E){var w;if(E)return!!((w=I.get(E))!=null&&w.isToastActive(C));let R=!1;return I.forEach(M=>{M.isToastActive(C)&&(R=!0)}),R}function ht(C){if(!bt()){F=F.filter(E=>C!=null&&E.options.toastId!==C);return}if(C==null||mt(C))I.forEach(E=>{E.removeToast(C)});else if(C&&("containerId"in C||"id"in C)){let E=I.get(C.containerId);E?E.removeToast(C.id):I.forEach(w=>{w.removeToast(C.id)})}}var Ct=(C={})=>{I.forEach(E=>{E.props.limit&&(!C.containerId||E.id===C.containerId)&&E.clearQueue()})};function nt(C,E){z(C)&&(bt()||F.push({content:C,options:E}),I.forEach(w=>{w.buildToast(C,E)}))}function xt(C){var E;(E=I.get(C.containerId||1))==null||E.setToggle(C.id,C.fn)}function rt(C,E){I.forEach(w=>{(E==null||!(E!=null&&E.containerId)||(E==null?void 0:E.containerId)===w.id)&&w.toggle(C,E==null?void 0:E.id)})}function Et(C){let E=C.containerId||1;return{subscribe(w){let R=_t(E,C,Vt);I.set(E,R);let M=R.observe(w);return Qt(),()=>{M(),I.delete(E)}},setProps(w){var R;(R=I.get(E))==null||R.setProps(w)},getSnapshot(){var w;return(w=I.get(E))==null?void 0:w.getSnapshot()}}}function Pt(C){return st.add(C),()=>{st.delete(C)}}function Wt(C){return C&&(N(C.toastId)||L(C.toastId))?C.toastId:at()}function U(C,E){return nt(C,E),E.toastId}function V(C,E){return{...E,type:E&&E.type||C,toastId:Wt(E)}}function Q(C){return(E,w)=>U(E,V(C,w))}function y(C,E){return U(C,V("default",E))}y.loading=(C,E)=>U(C,V("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...E}));function Gt(C,{pending:E,error:w,success:R},M){let x;E&&(x=N(E)?y.loading(E,M):y.loading(E.render,{...M,...E}));let S={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},T=(D,Y,ee)=>{if(Y==null){y.dismiss(x);return}let ie={type:D,...S,...M,data:ee},ne=N(Y)?{render:Y}:Y;return x?y.update(x,{...ie,...ne}):y(ne.render,{...ie,...ne}),ee},_=P(C)?C():C;return _.then(D=>T("success",R,D)).catch(D=>T("error",w,D)),_}y.promise=Gt;y.success=Q("success");y.info=Q("info");y.error=Q("error");y.warning=Q("warning");y.warn=y.warning;y.dark=(C,E)=>U(C,V("default",{theme:"dark",...E}));function qt(C){ht(C)}y.dismiss=qt;y.clearWaitingQueue=Ct;y.isActive=X;y.update=(C,E={})=>{let w=vt(C,E);if(w){let{props:R,content:M}=w,x={delay:100,...R,...E,toastId:E.toastId||C,updateId:at()};x.toastId!==C&&(x.staleId=C);let S=x.render||M;delete x.render,U(S,x)}};y.done=C=>{y.update(C,{progress:1})};y.onChange=Pt;y.play=C=>rt(!0,C);y.pause=C=>rt(!1,C);function It(C){var E;let{subscribe:w,getSnapshot:R,setProps:M}=reactExports.useRef(Et(C)).current;M(C);let x=(E=reactExports.useSyncExternalStore(w,R,R))==null?void 0:E.slice();function S(T){if(!x)return[];let _=new Map;return C.newestOnTop&&x.reverse(),x.forEach(D=>{let{position:Y}=D.props;_.has(Y)||_.set(Y,[]),_.get(Y).push(D)}),Array.from(_,D=>T(D[0],D[1]))}return{getToastToRender:S,isToastActive:X,count:x==null?void 0:x.length}}function At(C){let[E,w]=reactExports.useState(!1),[R,M]=reactExports.useState(!1),x=reactExports.useRef(null),S=reactExports.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:T,pauseOnHover:_,closeToast:D,onClick:Y,closeOnClick:ee}=C;xt({id:C.toastId,containerId:C.containerId,fn:w}),reactExports.useEffect(()=>{if(C.pauseOnFocusLoss)return ie(),()=>{ne()}},[C.pauseOnFocusLoss]);function ie(){document.hasFocus()||le(),window.addEventListener("focus",ae),window.addEventListener("blur",le)}function ne(){window.removeEventListener("focus",ae),window.removeEventListener("blur",le)}function re(ve){if(C.draggable===!0||C.draggable===ve.pointerType){de();let be=x.current;S.canCloseOnClick=!0,S.canDrag=!0,be.style.transition="none",C.draggableDirection==="x"?(S.start=ve.clientX,S.removalDistance=be.offsetWidth*(C.draggablePercent/100)):(S.start=ve.clientY,S.removalDistance=be.offsetHeight*(C.draggablePercent===80?C.draggablePercent*1.5:C.draggablePercent)/100)}}function oe(ve){let{top:be,bottom:Se,left:Re,right:Ae}=x.current.getBoundingClientRect();ve.nativeEvent.type!=="touchend"&&C.pauseOnHover&&ve.clientX>=Re&&ve.clientX<=Ae&&ve.clientY>=be&&ve.clientY<=Se?le():ae()}function ae(){w(!0)}function le(){w(!1)}function de(){S.didMove=!1,document.addEventListener("pointermove",fe),document.addEventListener("pointerup",ge)}function me(){document.removeEventListener("pointermove",fe),document.removeEventListener("pointerup",ge)}function fe(ve){let be=x.current;if(S.canDrag&&be){S.didMove=!0,E&&le(),C.draggableDirection==="x"?S.delta=ve.clientX-S.start:S.delta=ve.clientY-S.start,S.start!==ve.clientX&&(S.canCloseOnClick=!1);let Se=C.draggableDirection==="x"?`${S.delta}px, var(--y)`:`0, calc(${S.delta}px + var(--y))`;be.style.transform=`translate3d(${Se},0)`,be.style.opacity=`${1-Math.abs(S.delta/S.removalDistance)}`}}function ge(){me();let ve=x.current;if(S.canDrag&&S.didMove&&ve){if(S.canDrag=!1,Math.abs(S.delta)>S.removalDistance){M(!0),C.closeToast(!0),C.collapseAll();return}ve.style.transition="transform 0.2s, opacity 0.2s",ve.style.removeProperty("transform"),ve.style.removeProperty("opacity")}}let he={onPointerDown:re,onPointerUp:oe};return T&&_&&(he.onMouseEnter=le,C.stacked||(he.onMouseLeave=ae)),ee&&(he.onClick=ve=>{Y&&Y(ve),S.canCloseOnClick&&D(!0)}),{playToast:ae,pauseToast:le,isRunning:E,preventExitTransition:R,toastRef:x,eventHandlers:he}}var Ot=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,G=({theme:C,type:E,isLoading:w,...R})=>React.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:C==="colored"?"currentColor":`var(--toastify-icon-color-${E})`,...R});function ao(C){return React.createElement(G,{...C},React.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function so(C){return React.createElement(G,{...C},React.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function no(C){return React.createElement(G,{...C},React.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function ro(C){return React.createElement(G,{...C},React.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function io(){return React.createElement("div",{className:"Toastify__spinner"})}var W={info:so,warning:ao,success:no,error:ro,spinner:io},lo=C=>C in W;function Nt({theme:C,type:E,isLoading:w,icon:R}){let M=null,x={theme:C,type:E};return R===!1||(P(R)?M=R({...x,isLoading:w}):reactExports.isValidElement(R)?M=reactExports.cloneElement(R,x):w?M=W.spinner():lo(E)&&(M=W[E](x))),M}var wt=C=>{let{isRunning:E,preventExitTransition:w,toastRef:R,eventHandlers:M,playToast:x}=At(C),{closeButton:S,children:T,autoClose:_,onClick:D,type:Y,hideProgressBar:ee,closeToast:ie,transition:ne,position:re,className:oe,style:ae,progressClassName:le,updateId:de,role:me,progress:fe,rtl:ge,toastId:he,deleteToast:ve,isIn:be,isLoading:Se,closeOnClick:Re,theme:Ae,ariaLabel:Me}=C,Be=clsx("Toastify__toast",`Toastify__toast-theme--${Ae}`,`Toastify__toast--${Y}`,{"Toastify__toast--rtl":ge},{"Toastify__toast--close-on-click":Re}),Qe=P(oe)?oe({rtl:ge,position:re,type:Y,defaultClassName:Be}):clsx(Be,oe),Pe=Nt(C),je=!!fe||!_,Dt={closeToast:ie,type:Y,theme:Ae},Xe=null;return S===!1||(P(S)?Xe=S(Dt):reactExports.isValidElement(S)?Xe=reactExports.cloneElement(S,Dt):Xe=yt(Dt)),React.createElement(ne,{isIn:be,done:ve,position:re,preventExitTransition:w,nodeRef:R,playToast:x},React.createElement("div",{id:he,tabIndex:0,onClick:D,"data-in":be,className:Qe,...M,style:ae,ref:R,...be&&{role:me,"aria-label":Me}},Pe!=null&&React.createElement("div",{className:clsx("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!Se})},Pe),tt(T,C,!E),Xe,!C.customProgressBar&&React.createElement(gt,{...de&&!je?{key:`p-${de}`}:{},rtl:ge,theme:Ae,delay:_,isRunning:E,isIn:be,closeToast:ie,hide:ee,type:Y,className:le,controlledProgress:je,progress:fe||0})))},K=(C,E=!1)=>({enter:`Toastify--animate Toastify__${C}-enter`,exit:`Toastify--animate Toastify__${C}-exit`,appendPosition:E}),lt=$(K("bounce",!0)),_o={position:"top-right",transition:lt,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:C=>C.altKey&&C.code==="KeyT"};function Lt(C){let E={..._o,...C},w=C.stacked,[R,M]=reactExports.useState(!0),x=reactExports.useRef(null),{getToastToRender:S,isToastActive:T,count:_}=It(E),{className:D,style:Y,rtl:ee,containerId:ie,hotKeys:ne}=E;function re(ae){let le=clsx("Toastify__toast-container",`Toastify__toast-container--${ae}`,{"Toastify__toast-container--rtl":ee});return P(D)?D({position:ae,rtl:ee,defaultClassName:le}):clsx(le,B(D))}function oe(){w&&(M(!0),y.play())}return Ot(()=>{var ae;if(w){let le=x.current.querySelectorAll('[data-in="true"]'),de=12,me=(ae=E.position)==null?void 0:ae.includes("top"),fe=0,ge=0;Array.from(le).reverse().forEach((he,ve)=>{let be=he;be.classList.add("Toastify__toast--stacked"),ve>0&&(be.dataset.collapsed=`${R}`),be.dataset.pos||(be.dataset.pos=me?"top":"bot");let Se=fe*(R?.2:1)+(R?0:de*ve);be.style.setProperty("--y",`${me?Se:Se*-1}px`),be.style.setProperty("--g",`${de}`),be.style.setProperty("--s",`${1-(R?ge:0)}`),fe+=be.offsetHeight,ge+=.025})}},[R,_,w]),reactExports.useEffect(()=>{function ae(le){var de;let me=x.current;ne(le)&&((de=me.querySelector('[tabIndex="0"]'))==null||de.focus(),M(!1),y.pause()),le.key==="Escape"&&(document.activeElement===me||me!=null&&me.contains(document.activeElement))&&(M(!0),y.play())}return document.addEventListener("keydown",ae),()=>{document.removeEventListener("keydown",ae)}},[ne]),React.createElement("section",{ref:x,className:"Toastify",id:ie,onMouseEnter:()=>{w&&(M(!1),y.pause())},onMouseLeave:oe,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":E["aria-label"]},S((ae,le)=>{let de=le.length?{...Y}:{...Y,pointerEvents:"none"};return React.createElement("div",{tabIndex:-1,className:re(ae),"data-stacked":w,style:de,key:`c-${ae}`},le.map(({content:me,props:fe})=>React.createElement(wt,{...fe,stacked:w,collapseAll:oe,isIn:T(fe.toastId,fe.containerId),key:`t-${fe.key}`},me)))}))}const getGenerateGetPathFunc=(C,E)=>E?M=>C+"/get_proxy?path="+M:M=>C+M;console.log("[Window]",window);const colabServer=window.colab_server,colabServerPort=window.colab_server_port,runOnColab=colabServer==1;console.log("runOnColab",runOnColab);const AppRootContext=React.createContext(null),useAppRoot=()=>{const C=reactExports.useContext(AppRootContext);if(!C)throw new Error("useAppState must be used within AppStateProvider");return C},AppRootProvider=({children:C})=>{const E=reactExports.useMemo(()=>colabServerPort?`https://localhost:${colabServerPort}`:"",[]),w=reactExports.useMemo(()=>getGenerateGetPathFunc(E,runOnColab),[]),R=(ne,re)=>{y(re,{type:ne,position:"bottom-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})},[M,x]=reactExports.useState(!0),S=useAudioConfig({createAudioContextDelay:0}),T=useAppGuiSetting(),_=useServerConfig({exceptionCallback:ne=>{R("error",ne)},flatPath:T.edition=="colab"}),[D,Y]=reactExports.useState("App");reactExports.useEffect(()=>{const oe=new URL(window.location.href).searchParams.get("app_mode")||null;oe=="Test"?Y("Test"):oe=="LogViewer"?Y("LogViewer"):oe=="JsonViewer"?Y("JsonViewer"):Y("App")},[]);const ee=ne=>{const re=ne.reason;Logger$1.getLogger().error("Unhandled Rejection",re),Logger$1.getLogger().error("Unhandled Rejection","[Possible Cause 1]: Errors occur when other clients are running. This is because resources such as the database are treated exclusively."),ne.preventDefault()};reactExports.useEffect(()=>(window.addEventListener("unhandledrejection",ee),()=>{window.removeEventListener("unhandledrejection",ee)}),[M]);const ie={audioConfigState:S,guiSetting:T,serverConfigState:_,appMode:D,triggerToast:R,setUnhandledRejectionToastEnabled:x,generateGetPathFunc:w};return jsxRuntimeExports.jsx(AppRootContext.Provider,{value:ie,children:C})},DialogName={none:"none",startingNoticeDialog:"startingNoticeDialog",modelSlotManagerMainDialog:"modelSlotManagerMainDialog",modelSlotManagerFileUploaderDialog:"modelSlotManagerFileUploaderDialog",modelSlotManagerSamplesDialog:"modelSlotManagerSamplesDialog",modelSlotManagerEditorDialog:"modelSlotManagerEditorDialog",voiceCharacterManagerMainDialog:"voiceCharacterManagerMainDialog",voiceCharacterManagerFileUploaderDialog:"voiceCharacterManagerFileUploaderDialog",advancedSettingDialog:"advancedSettingDialog",exportToOnnxDialog:"exportToOnnxDialog",mergeLabDialog:"mergeLabDialog",aboutModelDialog:"aboutModelDialog",aboutVoiceDialog:"aboutVoiceDialog"},DialogName2={none:"none",textInputDialog:"textInputDialog",confirmDialog:"confirmDialog",waitDialog:"waitDialog",selectInputDialog:"selectInputDialog"},InferenceMode={file:"file",record:"record",near_realtime:"near_realtime"},InferenceModeLabel_i18nKey={file:"inference_mode_select_area_mode_file",record:"inference_mode_select_area_mode_record",near_realtime:"inference_mode_select_area_mode_near_realtime"},GuiStateContext=React.createContext(null),useGuiState=()=>{const C=reactExports.useContext(GuiStateContext);if(!C)throw new Error("useGuiState must be used within GuiStateProvider");return C},GuiStateProvider=({children:C})=>{const[E,w]=reactExports.useState(DialogName.none),[R,M]=reactExports.useState(DialogName2.none),[x,S]=reactExports.useState(null),[T,_]=reactExports.useState(InferenceMode.file),[D,Y]=reactExports.useState(null),[ee,ie]=reactExports.useState(null),[ne,re]=reactExports.useState(null);useAppRoot(),reactExports.useEffect(()=>{new URL(location.href).searchParams.get("first")},[]);const oe={dialogName:E,setDialogName:w,dialog2Name:R,setDialog2Name:M,dialog2Props:x,setDialog2Props:S,inferenceMode:T,setInferenceMode:_,inputAudioFile:D,setInputAudioFile:Y,inputAudioBlob:ee,setInputAudioBlob:ie,outputAudioFile:ne,setOutputAudioFile:re};return jsxRuntimeExports.jsx(GuiStateContext.Provider,{value:oe,children:C})};var dialogContainer="lgq6a72",dialogContainerShow="lgq6a73",dialog2ContainerShow="lgq6a77",dialogFrame="lgq6a78",dialogTitle="lgq6a79",dialogFixedSizeContent="lgq6a7a",modelSlotContainer="lgq6a7b",modelSlot="lgq6a7c",modelSlotDetailArea="lgq6a7d",modelSlotIconPointable="lgq6a7e",modelSlotIcon="lgq6a7f",modelSlotDetailRow="lgq6a7g",modelSlotDetailRowLabel="lgq6a7h",modelSlotDetailRowValuePointable="lgq6a7i",modelSlotDetailRowValue="lgq6a7j",modelSlotDetailRowValueSmall="lgq6a7k",modelSlotButtonsArea="lgq6a7m",modelSlotButton="lgq6a7n",closeButtonRow="lgq6a7o",closeButton="lgq6a7p",instructions="lgq6a7r",textInputArea="lgq6a7t",textInputAreaLabel="lgq6a7u",textInputAreaInput="lgq6a7v",selectInputArea="lgq6a7w",selectInputAreaLabel="lgq6a7x",selectInputAreaInput="lgq6a7y",uploadStatusArea="lgq6a7z",fileInputArea="lgq6a710",fileInputAreaLabel="lgq6a711",fileInputAreaValue="lgq6a712",fileInputAreaButton="lgq6a713",dialogNotice="lgq6a71q",dialogNoticeLinkArea="lgq6a71r",dialogDonateLinkSpan="lgq6a71s",dialogDonateLinkSpanImg="lgq6a71t";const warn=(C,E,w,R)=>{var x,S,T,_;const M=[w,{code:E,...R||{}}];if((S=(x=C==null?void 0:C.services)==null?void 0:x.logger)!=null&&S.forward)return C.services.logger.forward(M,"warn","react-i18next::",!0);isString$1(M[0])&&(M[0]=`react-i18next:: ${M[0]}`),(_=(T=C==null?void 0:C.services)==null?void 0:T.logger)!=null&&_.warn?C.services.logger.warn(...M):console!=null&&console.warn&&console.warn(...M)},alreadyWarned={},warnOnce=(C,E,w,R)=>{isString$1(w)&&alreadyWarned[w]||(isString$1(w)&&(alreadyWarned[w]=new Date),warn(C,E,w,R))},loadedClb=(C,E)=>()=>{if(C.isInitialized)E();else{const w=()=>{setTimeout(()=>{C.off("initialized",w)},0),E()};C.on("initialized",w)}},loadNamespaces=(C,E,w)=>{C.loadNamespaces(E,loadedClb(C,w))},loadLanguages=(C,E,w,R)=>{if(isString$1(w)&&(w=[w]),C.options.preload&&C.options.preload.indexOf(E)>-1)return loadNamespaces(C,w,R);w.forEach(M=>{C.options.ns.indexOf(M)<0&&C.options.ns.push(M)}),C.loadLanguages(E,loadedClb(C,R))},hasLoadedNamespace=(C,E,w={})=>!E.languages||!E.languages.length?(warnOnce(E,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:E.languages}),!0):E.hasLoadedNamespace(C,{lng:w.lng,precheck:(R,M)=>{var x;if(((x=w.bindI18n)==null?void 0:x.indexOf("languageChanging"))>-1&&R.services.backendConnector.backend&&R.isLanguageChangingTo&&!M(R.isLanguageChangingTo,C))return!1}}),isString$1=C=>typeof C=="string",isObject=C=>typeof C=="object"&&C!==null,matchHtmlEntity=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,htmlEntities={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},unescapeHtmlEntity=C=>htmlEntities[C],unescape=C=>C.replace(matchHtmlEntity,unescapeHtmlEntity);let defaultOptions={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape};const setDefaults=(C={})=>{defaultOptions={...defaultOptions,...C}},getDefaults$2=()=>defaultOptions;let i18nInstance;const setI18n=C=>{i18nInstance=C},getI18n=()=>i18nInstance,initReactI18next={type:"3rdParty",init(C){setDefaults(C.options.react),setI18n(C)}},I18nContext=reactExports.createContext();class ReportNamespaces{constructor(){this.usedNamespaces={}}addUsedNamespaces(E){E.forEach(w=>{this.usedNamespaces[w]||(this.usedNamespaces[w]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const usePrevious=(C,E)=>{const w=reactExports.useRef();return reactExports.useEffect(()=>{w.current=C},[C,E]),w.current},alwaysNewT=(C,E,w,R)=>C.getFixedT(E,w,R),useMemoizedT=(C,E,w,R)=>reactExports.useCallback(alwaysNewT(C,E,w,R),[C,E,w,R]),useTranslation=(C,E={})=>{var fe,ge,he,ve;const{i18n:w}=E,{i18n:R,defaultNS:M}=reactExports.useContext(I18nContext)||{},x=w||R||getI18n();if(x&&!x.reportNamespaces&&(x.reportNamespaces=new ReportNamespaces),!x){warnOnce(x,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const be=(Re,Ae)=>isString$1(Ae)?Ae:isObject(Ae)&&isString$1(Ae.defaultValue)?Ae.defaultValue:Array.isArray(Re)?Re[Re.length-1]:Re,Se=[be,{},!1];return Se.t=be,Se.i18n={},Se.ready=!1,Se}(fe=x.options.react)!=null&&fe.wait&&warnOnce(x,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const S={...getDefaults$2(),...x.options.react,...E},{useSuspense:T,keyPrefix:_}=S;let D=M||((ge=x.options)==null?void 0:ge.defaultNS);D=isString$1(D)?[D]:D||["translation"],(ve=(he=x.reportNamespaces).addUsedNamespaces)==null||ve.call(he,D);const Y=(x.isInitialized||x.initializedStoreOnce)&&D.every(be=>hasLoadedNamespace(be,x,S)),ee=useMemoizedT(x,E.lng||null,S.nsMode==="fallback"?D:D[0],_),ie=()=>ee,ne=()=>alwaysNewT(x,E.lng||null,S.nsMode==="fallback"?D:D[0],_),[re,oe]=reactExports.useState(ie);let ae=D.join();E.lng&&(ae=`${E.lng}${ae}`);const le=usePrevious(ae),de=reactExports.useRef(!0);reactExports.useEffect(()=>{const{bindI18n:be,bindI18nStore:Se}=S;de.current=!0,!Y&&!T&&(E.lng?loadLanguages(x,E.lng,D,()=>{de.current&&oe(ne)}):loadNamespaces(x,D,()=>{de.current&&oe(ne)})),Y&&le&&le!==ae&&de.current&&oe(ne);const Re=()=>{de.current&&oe(ne)};return be&&(x==null||x.on(be,Re)),Se&&(x==null||x.store.on(Se,Re)),()=>{de.current=!1,x&&(be==null||be.split(" ").forEach(Ae=>x.off(Ae,Re))),Se&&x&&Se.split(" ").forEach(Ae=>x.store.off(Ae,Re))}},[x,ae]),reactExports.useEffect(()=>{de.current&&Y&&oe(ie)},[x,_,Y]);const me=[re,x,Y];if(me.t=re,me.i18n=x,me.ready=Y,Y||!Y&&!T)return me;throw new Promise(be=>{E.lng?loadLanguages(x,E.lng,D,()=>be()):loadNamespaces(x,D,()=>be())})},checkExtention=(C,E)=>{const w=C.split(".").pop();return w?E.includes(w):!1},trimfileName=(C,E)=>{const w=C.replace(/^.*[\\\/]/,"");return w.length>E?w.substring(0,E)+"...":w};var headerArea="d9seq10",titleArea="d9seq11",title="d9seq12",titleVersion="d9seq13",iconArea="d9seq14",iconGroup="d9seq15",tooltip="d9seq16",tooltipText="d9seq17",tooltipText100px="d9seq18",tooltipTextThin="d9seq19",tooltipTextLower="d9seq1a";const IconArea$1=C=>{const{serverConfigState:E,triggerToast:w,generateGetPathFunc:R}=useAppRoot(),{t:M}=useTranslation(),x=async()=>{if(!C.iconEditable)return;const D=await fileSelector();if(checkExtention(D.name,["png","jpg","jpeg","gif"])==!1){w("error",M("model_slot_manager_main_change_icon_ext_error"));return}await E.uploadIconFile(C.slotIndex,D,(Y,ee)=>{})};let S;C.iconUrl==null?S="/assets/icons/noimage.png":(S=C.iconUrl||"/assets/icons/noimage.png",S=C.iconUrl!=null?"models/"+C.slotIndex+"/"+C.iconUrl.split(/[\/\\]/).pop():"./assets/icons/human.png"),S=R(S);const T=C.tooltip?tooltip:"",_=C.tooltip?modelSlotIconPointable:modelSlotIcon;return jsxRuntimeExports.jsxs("div",{className:T,children:[jsxRuntimeExports.jsx("img",{src:S,className:_,onClick:()=>{x()}}),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipTextThin} ${tooltipTextLower}`,children:M("model_slot_manager_main_change_icon")})]})},NameRow$1=C=>{const{t:E}=useTranslation(),{setDialog2Name:w,setDialog2Props:R}=useGuiState(),{serverConfigState:M}=useAppRoot(),x=async()=>{if(C.slotInfo.vc_type==null)return;const Y=await new Promise(ee=>{R({title:E("model_slot_name_input_dialog_title"),instruction:E("model_slot_name_input_dialog_instruction"),defaultValue:C.slotInfo.name,resolve:ee,options:null}),w("textInputDialog")});Y&&(Logger$1.getLogger().info("input text:",Y),C.slotInfo.name=Y,await M.updateServerSlotInfo(C.slotInfo))},S=C.slotInfo.name.length>0?`${modelSlotDetailRowValuePointable} ${tooltip}`:modelSlotDetailRowValue,T=C.slotInfo.name.length>0?C.slotInfo.name:"blank",_=C.slotInfo.terms_of_use_url.length>0?jsxRuntimeExports.jsxs("a",{href:C.slotInfo.terms_of_use_url,target:"_blank",rel:"noopener noreferrer",className:modelSlotDetailRowValueSmall,children:["[",E("model_slot_manager_main_terms_of_use"),"]"]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRow,children:[jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRowLabel,children:["[",C.slotInfo.slot_index,"]"]}),jsxRuntimeExports.jsxs("div",{className:S,onClick:()=>{x()},children:[T,jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipTextThin}`,children:E("model_slot_manager_main_rename")})]}),jsxRuntimeExports.jsx("div",{className:"",children:_})]})},FileRow$1=C=>{const{t:E}=useTranslation(),w=M=>{if(M.length==0)return;const x="models/"+C.slotIndex+"/"+M;Logger$1.getLogger().info("downloadpath:",x);const S=document.createElement("a");S.href=x,S.download=M.replace(/^.*[\\\/]/,""),S.click(),S.remove()},R=C.filePath.length>0?`${modelSlotDetailRowValuePointable} ${tooltip}`:modelSlotDetailRowValue;return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRow,children:[jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRowLabel,children:[C.title,":"]}),jsxRuntimeExports.jsxs("div",{className:R,onClick:()=>{C.filePath!=null&&w(C.filePath)},children:[trimfileName(C.filePath??"",20),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipTextThin}`,children:E("model_slot_manager_main_download")})]})]},`${C.title}`)},InfoRow$1=C=>{const{t:E}=useTranslation();return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRow,children:[jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRowLabel,children:[E("model_slot_manager_main_info")," "]}),jsxRuntimeExports.jsx("div",{className:modelSlotDetailRowValue,children:C.info}),jsxRuntimeExports.jsx("div",{className:""})]})},BlankDetailArea$1=C=>{const{t:E}=useTranslation(),w=C.slotInfo;return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailArea,children:[jsxRuntimeExports.jsx(NameRow$1,{slotInfo:{...w}}),jsxRuntimeExports.jsx(FileRow$1,{slotIndex:w.slot_index,title:"model",filePath:""}),jsxRuntimeExports.jsx(InfoRow$1,{info:E("model_slot_manager_main_blank_message")})]})},SeedVCDetailArea$1=C=>{const E=C.slotInfo;return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailArea,children:[jsxRuntimeExports.jsx(NameRow$1,{slotInfo:{...E}}),jsxRuntimeExports.jsx(FileRow$1,{title:"semantic",slotIndex:E.slot_index,filePath:E.seed_vc_model_file||"default"}),jsxRuntimeExports.jsx(FileRow$1,{title:"synthesize",slotIndex:E.slot_index,filePath:E.seed_vc_config_file||"default"})]})},BrokenDetailArea$1=C=>{const{t:E}=useTranslation();return jsxRuntimeExports.jsx("div",{className:modelSlotDetailArea,children:jsxRuntimeExports.jsx(InfoRow$1,{info:E("model_slot_manager_main_broken_message")})})},CloseButtonRow$4=()=>{const{setDialogName:C}=useGuiState(),{t:E}=useTranslation();return jsxRuntimeExports.jsx("div",{className:closeButtonRow,children:jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C("none")},children:E("dialog_close")})})},ModelSlotManagerMainDialog=C=>{const{serverConfigState:E}=useAppRoot(),{t:w}=useTranslation(),{setDialog2Props:R,setDialog2Name:M}=useGuiState();return reactExports.useMemo(()=>{if(!E.serverSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const S=async D=>{await new Promise(ie=>{R({title:w("model_slot_delete_confirm_dialog_title"),instruction:`${w("model_slot_delete_confirm_dialog_instruction")} slotIndex:${D}`,defaultValue:"",resolve:ie,options:null}),M("confirmDialog")})==!0&&E.deleteServerSlotInfo(D)},T=async D=>{if(!E.serverSlotInfos)return;const ee=await new Promise(ie=>{if(!E.serverSlotInfos)return;const ne=E.serverSlotInfos.filter(re=>re.slot_index<MAX_SLOT_INDEX).map(re=>({label:`${re.slot_index}${re.vc_type==null?"":"[used]"}`,value:re.slot_index}));R({title:w("model_slot_move_confirm_dialog_title"),instruction:`${w("model_slot_move_confirm_dialog_instruction")}`,defaultValue:"",resolve:ie,options:ne}),M("selectInputDialog")});if(ee!=null){const ie=Number(ee),ne=E.serverSlotInfos.find(re=>re.slot_index==ie);ne!=null&&ne.vc_type!=null&&await E.deleteServerSlotInfo(ie),E.moveModel(D,ie)}},_=E.serverSlotInfos.filter(D=>D.slot_index<MAX_SLOT_INDEX).map((D,Y)=>{let ee=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});D.vc_type=="seed-vc"?ee=jsxRuntimeExports.jsx(SeedVCDetailArea$1,{slotInfo:D}):D.vc_type=="BROKEN"?ee=jsxRuntimeExports.jsx(BrokenDetailArea$1,{slotInfo:D}):ee=jsxRuntimeExports.jsx(BlankDetailArea$1,{slotInfo:D});let ie=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});D.vc_type==null&&(ie=jsxRuntimeExports.jsx("div",{className:modelSlotButton,onClick:()=>{C.openFileUploadDialog(D.slot_index)},children:w("model_slot_manager_main_upload")}));let ne=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});D.vc_type!=null&&(ne=jsxRuntimeExports.jsx("div",{className:modelSlotButton,onClick:()=>{S(D.slot_index)},children:w("model_slot_manager_main_delete")}));let re=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});return D.vc_type!=null&&(re=jsxRuntimeExports.jsx("div",{className:modelSlotButton,onClick:()=>{T(D.slot_index)},children:w("model_slot_manager_main_move")})),jsxRuntimeExports.jsxs("div",{className:modelSlot,children:[jsxRuntimeExports.jsx(IconArea$1,{slotIndex:D.slot_index,iconUrl:D.icon_file,tooltip:D.vc_type!=null,iconEditable:D.vc_type!=null}),ee,jsxRuntimeExports.jsxs("div",{className:modelSlotButtonsArea,children:[ie,re,ne]})]},Y)});return jsxRuntimeExports.jsxs("div",{className:dialogFrame,children:[jsxRuntimeExports.jsx("div",{className:dialogTitle,children:w("model_slot_manager_main_title")}),jsxRuntimeExports.jsxs("div",{className:dialogFixedSizeContent,children:[jsxRuntimeExports.jsx("div",{className:modelSlotContainer,children:_}),jsxRuntimeExports.jsx(CloseButtonRow$4,{})]})]})},[E.serverSlotInfos])},CloseButtonRow$3=C=>{const{t:E}=useTranslation();return jsxRuntimeExports.jsxs("div",{className:closeButtonRow,children:[jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C.isUploading||C.uploadClicked()},children:C.isUploading?E("dialog_uploading"):E("dialog_upload")}),jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C.backClicked()},children:E("dialog_back")})]})},SeedVCFileChooser=C=>{const{t:E}=useTranslation(),{triggerToast:w}=useAppRoot(),[R,M]=reactExports.useState(!1),[x,S]=reactExports.useState(!1),T=reactExports.useMemo(()=>{const Y=C.uploadFiles.find(ee=>ee.kind==="checkpoint")||null;return jsxRuntimeExports.jsxs("div",{className:fileInputArea,children:[jsxRuntimeExports.jsx("div",{className:fileInputAreaLabel,children:"checkpoint: "}),jsxRuntimeExports.jsx("div",{className:fileInputAreaValue,children:R?E("model_slot_manager_fileupload_file_selecting"):(Y==null?void 0:Y.file.name)||""}),jsxRuntimeExports.jsx("div",{className:fileInputAreaButton,onClick:async()=>{M(!0),await D("checkpoint"),M(!1)},children:E("model_slot_manager_fileupload_file_select")})]})},[C.uploadFiles,C.setUploadFile,R]),_=reactExports.useMemo(()=>{const Y=C.uploadFiles.find(ee=>ee.kind==="config")||null;return jsxRuntimeExports.jsxs("div",{className:fileInputArea,children:[jsxRuntimeExports.jsx("div",{className:fileInputAreaLabel,children:"config: "}),jsxRuntimeExports.jsx("div",{className:fileInputAreaValue,children:x?E("model_slot_manager_fileupload_file_selecting"):(Y==null?void 0:Y.file.name)||""}),jsxRuntimeExports.jsx("div",{className:fileInputAreaButton,onClick:async()=>{S(!0),await D("config"),S(!1)},children:E("model_slot_manager_fileupload_file_select")})]})},[C.uploadFiles,C.setUploadFile,x]),D=async Y=>{let ee=null;try{ee=await fileSelector("")}catch(ie){console.log(ie)}if(ee!=null){if(Y=="checkpoint"){if(checkExtention(ee.name,["pth"])==!1){w("error",E("model_slot_manager_fileupload_file_select_seed_vc_model_error"));return}C.setUploadFile({kind:Y,file:ee})}else if(Y=="config"){if(checkExtention(ee.name,["yml"])==!1){w("error",E("model_slot_manager_fileupload_file_select_seed_vc_config_error"));return}C.setUploadFile({kind:Y,file:ee})}}};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[T,_]})},ModelSlotManagerFileUploadDialog=C=>{const{t:E}=useTranslation(),{serverConfigState:w,triggerToast:R}=useAppRoot(),{setDialogName:M}=useGuiState(),[x,S]=reactExports.useState("seed-vc"),[T,_]=reactExports.useState([]),[D,Y]=reactExports.useState(0),ee=reactExports.useMemo(()=>jsxRuntimeExports.jsx("select",{defaultValue:x,onChange:le=>{S(le.target.value)},children:VCTypes.map(le=>jsxRuntimeExports.jsx("option",{value:le,children:le},le))}),[x]),ie=le=>{const de=T.filter(me=>me.kind!=le.kind);de.push(le),_(de)},ne=()=>{_([])},re=async()=>{if(x=="seed-vc"){Y(0);const le=T.find(me=>me.kind==="checkpoint"),de=T.find(me=>me.kind==="config");try{const me=[];le&&me.push(le),de&&me.push(de),await w.uploadModelFile(C.slotIndex,x,me,(fe,ge)=>{Logger$1.getLogger().info("progress",fe,ge),Y(Math.floor(fe-1))})}catch(me){R("error",`upload failed: ${me.detail||""}`),Logger$1.getLogger().error(`upload failed: ${me.detail||""}`)}M("modelSlotManagerMainDialog"),Y(100),Y(0)}},oe=()=>{ne(),M("modelSlotManagerMainDialog")};let ae=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});return x=="seed-vc"&&(ae=jsxRuntimeExports.jsx(SeedVCFileChooser,{setUploadFile:ie,uploadFiles:T})),jsxRuntimeExports.jsxs("div",{className:dialogFrame,children:[jsxRuntimeExports.jsx("div",{className:dialogTitle,children:E("model_slot_manager_fileupload_title")}),jsxRuntimeExports.jsx("div",{className:instructions,children:E("model_slot_manager_fileupload_instruction")}),jsxRuntimeExports.jsxs("div",{className:dialogFixedSizeContent,children:[jsxRuntimeExports.jsxs("div",{className:selectInputArea,children:[jsxRuntimeExports.jsx("div",{className:selectInputAreaLabel,children:"TTS Type: "}),jsxRuntimeExports.jsx("div",{className:selectInputAreaInput,children:ee})]}),ae,jsxRuntimeExports.jsx("div",{className:uploadStatusArea,children:D>0?D+"%":" "})]}),jsxRuntimeExports.jsx(CloseButtonRow$3,{uploadClicked:re,backClicked:oe,isUploading:D>0})]})},isDesktopApp=()=>navigator.userAgent.indexOf("Electron")>=0,CloseButtonRow$2=C=>{const{t:E}=useTranslation();return jsxRuntimeExports.jsx("div",{className:closeButtonRow,children:jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C.closeClicked()},children:E("dialog_advanced_setting_button_close")})})},StartingNoticeDialog=C=>{const{t:E}=useTranslation(),{generateGetPathFunc:w}=useAppRoot(),{setDialogName:R}=useGuiState(),M=()=>{R("none")},x=reactExports.useMemo(()=>{const T=w("/assets/icons/buymeacoffee.png");return isDesktopApp()?jsxRuntimeExports.jsxs("span",{className:dialogDonateLinkSpan,onClick:()=>{window.electronAPI.openBrowser("https://www.buymeacoffee.com/wokad")},children:[jsxRuntimeExports.jsx("img",{className:dialogDonateLinkSpanImg,src:T})," ",E("dialog_starting_notice_coffee_icon_message")]}):jsxRuntimeExports.jsxs("a",{className:dialogDonateLinkSpan,href:"https://www.buymeacoffee.com/wokad",target:"_blank",rel:"noopener noreferrer",children:[jsxRuntimeExports.jsx("img",{className:dialogDonateLinkSpanImg,src:T})," ",E("dialog_starting_notice_coffee_icon_message")]})},[]);return reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{className:dialogFrame,children:[jsxRuntimeExports.jsx("div",{className:dialogTitle,children:E("dialog_starting_notice_title")}),jsxRuntimeExports.jsx("div",{className:instructions,children:E("dialog_starting_notice_instruction")}),jsxRuntimeExports.jsxs("div",{className:dialogFixedSizeContent,children:[jsxRuntimeExports.jsx("div",{className:dialogNotice,children:E("dialog_starting_notice_notice1")}),jsxRuntimeExports.jsx("div",{className:dialogNoticeLinkArea,children:x})]}),jsxRuntimeExports.jsx(CloseButtonRow$2,{closeClicked:M})]}),[])},IconArea=C=>{const{serverConfigState:E,triggerToast:w,generateGetPathFunc:R}=useAppRoot(),{t:M}=useTranslation(),x=async()=>{if(!C.iconEditable)return;const D=await fileSelector();if(checkExtention(D.name,["png","jpg","jpeg","gif"])==!1){w("error",M("voice_character_slot_manager_main_change_icon_ext_error"));return}await E.uploadVoiceCharacterIconFile(C.slotIndex,D,(Y,ee)=>{})};let S;C.iconUrl==null?S="/assets/icons/noimage.png":(S=C.iconUrl||"/assets/icons/noimage.png",S=C.iconUrl!=null?"voice_characters/"+C.slotIndex+"/"+C.iconUrl.split(/[\/\\]/).pop():"./assets/icons/human.png"),S=R(S);const T=C.tooltip?tooltip:"",_=C.tooltip?modelSlotIconPointable:modelSlotIcon;return jsxRuntimeExports.jsxs("div",{className:T,children:[jsxRuntimeExports.jsx("img",{src:S,className:_,onClick:()=>{x()}}),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipTextThin} ${tooltipTextLower}`,children:M("voice_character_slot_manager_main_change_icon")})]})},NameRow=C=>{const{t:E}=useTranslation(),{serverConfigState:w}=useAppRoot(),{setDialog2Name:R,setDialog2Props:M}=useGuiState(),x=async()=>{if(C.voiceCharacter.vc_type==null)return;const Y=await new Promise(ee=>{M({title:E("voice_character_slot_name_input_dialog_title"),instruction:E("voice_character_slot_name_input_dialog_instruction"),defaultValue:C.voiceCharacter.name,resolve:ee,options:null}),R("textInputDialog")});Y&&(Logger$1.getLogger().info("input text:",Y),C.voiceCharacter.name=Y,await w.updateVoiceCharacterSlotInfo(C.voiceCharacter))},S=C.voiceCharacter.name.length>0?`${modelSlotDetailRowValuePointable} ${tooltip}`:modelSlotDetailRowValue,T=C.voiceCharacter.name.length>0?C.voiceCharacter.name:"blank",_=C.voiceCharacter.terms_of_use_url.length>1?jsxRuntimeExports.jsxs("a",{href:C.voiceCharacter.terms_of_use_url,target:"_blank",rel:"noopener noreferrer",className:modelSlotDetailRowValueSmall,children:["[",E("voice_character_slot_manager_main_terms_of_use"),"]"]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRow,children:[jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRowLabel,children:["[",C.voiceCharacter.slot_index,"]"]}),jsxRuntimeExports.jsxs("div",{className:S,onClick:()=>{x()},children:[T,jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipTextThin}`,children:E("voice_character_slot_manager_main_rename")})]}),jsxRuntimeExports.jsx("div",{className:"",children:_})]})},FileRow=C=>{const{t:E}=useTranslation(),w=M=>{if(M.length==0)return;const x="model_dir/"+C.slotIndex+"/"+M;Logger$1.getLogger().info("downloadpath:",x);const S=document.createElement("a");S.href=x,S.download=M.replace(/^.*[\\\/]/,""),S.click(),S.remove()},R=C.filePath.length>0?`${modelSlotDetailRowValuePointable} ${tooltip}`:modelSlotDetailRowValue;return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRow,children:[jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRowLabel,children:[C.title,":"]}),jsxRuntimeExports.jsxs("div",{className:R,onClick:()=>{C.filePath!=null&&w(C.filePath)},children:[trimfileName(C.filePath??"",20),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipTextThin}`,children:E("voice_character_slot_manager_main_download")})]})]},`${C.title}`)},InfoRow=C=>{const{t:E}=useTranslation();return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRow,children:[jsxRuntimeExports.jsxs("div",{className:modelSlotDetailRowLabel,children:[E("voice_character_slot_manager_main_info")," "]}),jsxRuntimeExports.jsx("div",{className:modelSlotDetailRowValue,children:C.info}),jsxRuntimeExports.jsx("div",{className:""})]})},BlankDetailArea=C=>{const{t:E}=useTranslation(),w=C.voiceCharacter;return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailArea,children:[jsxRuntimeExports.jsx(NameRow,{voiceCharacter:{...w}}),jsxRuntimeExports.jsx(FileRow,{slotIndex:w.slot_index,title:"model",filePath:""}),jsxRuntimeExports.jsx(InfoRow,{info:E("voice_character_slot_manager_main_blank_message")})]})},SeedVCDetailArea=C=>{const E=C.voiceCharacter;return jsxRuntimeExports.jsxs("div",{className:modelSlotDetailArea,children:[jsxRuntimeExports.jsx(NameRow,{voiceCharacter:{...E}}),jsxRuntimeExports.jsx(InfoRow,{info:`voice files: ${E.reference_voices.length}`})]})},BrokenDetailArea=C=>{const{t:E}=useTranslation();return jsxRuntimeExports.jsx("div",{className:modelSlotDetailArea,children:jsxRuntimeExports.jsx(InfoRow,{info:E("voice_character_slot_manager_main_broken_message")})})},CloseButtonRow$1=()=>{const{setDialogName:C}=useGuiState(),{t:E}=useTranslation();return jsxRuntimeExports.jsx("div",{className:closeButtonRow,children:jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C("none")},children:E("dialog_close")})})},VoiceCharacterSlotManagerMainDialog=C=>{const{serverConfigState:E,triggerToast:w}=useAppRoot(),{t:R}=useTranslation(),{setDialog2Props:M,setDialog2Name:x}=useGuiState();return reactExports.useMemo(()=>{if(!E.serverVoiceCharacterSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const T=async ee=>{await new Promise(re=>{M({title:R("voice_character_slot_delete_confirm_dialog_title"),instruction:`${R("voice_character_slot_delete_confirm_dialog_instruction")} slotIndex:${ee}`,defaultValue:"",resolve:re,options:null}),x("confirmDialog")})==!0&&E.deleteVoiceCharacterSlotInfo(ee)},_=async ee=>{if(!E.serverVoiceCharacterSlotInfos)return;const ne=await new Promise(re=>{if(!E.serverVoiceCharacterSlotInfos)return;const oe=E.serverVoiceCharacterSlotInfos.filter(ae=>ae.slot_index<MAX_VOICE_CHARACTER_SLOT_INDEX).map(ae=>({label:`${ae.slot_index}${ae.vc_type==null?"":"[used]"}`,value:ae.slot_index}));M({title:R("voice_character_slot_move_confirm_dialog_title"),instruction:`${R("voice_character_slot_move_confirm_dialog_instruction")}`,defaultValue:"",resolve:re,options:oe}),x("selectInputDialog")});if(ne!=null){const re=Number(ne),oe=E.serverVoiceCharacterSlotInfos.find(ae=>ae.slot_index==re);oe!=null&&oe.vc_type!=null&&await E.deleteVoiceCharacterSlotInfo(re),E.moveVoiceCharacter(ee,re)}},D=async ee=>{if(!E.serverVoiceCharacterSlotInfos){w("error",R("reference_voice_area_download_error"));return}const ie=E.serverVoiceCharacterSlotInfos.find(ae=>ae.slot_index==ee);if(!ie){w("error",R("reference_voice_area_download_error"));return}const ne=await E.downloadVoiceCharacter(ee);if(!ne){w("error",R("reference_voice_area_download_error"));return}const re=document.createElement("a"),oe=URL.createObjectURL(ne);re.href=oe,re.download=`voice_character_${ie.name}.zip`,document.body.appendChild(re),re.click(),document.body.removeChild(re),URL.revokeObjectURL(oe)},Y=E.serverVoiceCharacterSlotInfos.filter(ee=>ee.slot_index<MAX_VOICE_CHARACTER_SLOT_INDEX).map((ee,ie)=>{let ne=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});ee.vc_type=="seed-vc"?ne=jsxRuntimeExports.jsx(SeedVCDetailArea,{voiceCharacter:ee}):ee.vc_type=="BROKEN"?ne=jsxRuntimeExports.jsx(BrokenDetailArea,{voiceCharacter:ee}):ne=jsxRuntimeExports.jsx(BlankDetailArea,{voiceCharacter:ee});let re=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});ee.vc_type==null&&(re=jsxRuntimeExports.jsx("div",{className:modelSlotButton,onClick:()=>{C.openFileUploadDialog(ee.slot_index)},children:R("voice_character_slot_manager_main_upload")}));let oe=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});ee.vc_type!=null&&(oe=jsxRuntimeExports.jsx("div",{className:modelSlotButton,onClick:()=>{T(ee.slot_index)},children:R("voice_character_slot_manager_main_delete")}));let ae=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});ee.vc_type!=null&&(ae=jsxRuntimeExports.jsx("div",{className:modelSlotButton,onClick:()=>{_(ee.slot_index)},children:R("voice_character_slot_manager_main_move")}));let le=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});return ee.vc_type!=null&&(le=jsxRuntimeExports.jsx("div",{className:modelSlotButton,onClick:async()=>{M({title:R("reference_voice_area_download_waiting_dialog_title"),instruction:`${R("reference_voice_area_download_waiting_dialog_instruction")}`,defaultValue:"",resolve:()=>{},options:null}),x("waitDialog"),await D(ee.slot_index),x("none")},children:R("voice_character_slot_manager_main_download")})),jsxRuntimeExports.jsxs("div",{className:modelSlot,children:[jsxRuntimeExports.jsx(IconArea,{slotIndex:ee.slot_index,iconUrl:ee.icon_file,tooltip:ee.vc_type!=null,iconEditable:ee.vc_type!=null}),ne,jsxRuntimeExports.jsxs("div",{className:modelSlotButtonsArea,children:[re,oe,ae,le]})]},ie)});return jsxRuntimeExports.jsxs("div",{className:dialogFrame,children:[jsxRuntimeExports.jsx("div",{className:dialogTitle,children:R("voice_character_slot_manager_main_title")}),jsxRuntimeExports.jsxs("div",{className:dialogFixedSizeContent,children:[jsxRuntimeExports.jsx("div",{className:modelSlotContainer,children:Y}),jsxRuntimeExports.jsx(CloseButtonRow$1,{})]})]})},[E.serverVoiceCharacterSlotInfos])},CloseButtonRow=C=>{const{t:E}=useTranslation();return jsxRuntimeExports.jsxs("div",{className:closeButtonRow,children:[jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C.isUploading||C.uploadClicked()},children:C.isUploading?E("dialog_uploading"):E("dialog_upload")}),jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C.backClicked()},children:E("dialog_back")})]})},VoiceCharacterFileChooser=C=>{const{t:E}=useTranslation(),{triggerToast:w}=useAppRoot(),[R,M]=reactExports.useState(!1),x=reactExports.useMemo(()=>{const T=C.uploadFiles.find(_=>_.kind==="zipFile")||null;return jsxRuntimeExports.jsxs("div",{className:fileInputArea,children:[jsxRuntimeExports.jsx("div",{className:fileInputAreaLabel,children:"zip: "}),jsxRuntimeExports.jsx("div",{className:fileInputAreaValue,children:R?E("voice_character_slot_manager_fileupload_file_selecting"):(T==null?void 0:T.file.name)||""}),jsxRuntimeExports.jsx("div",{className:fileInputAreaButton,onClick:async()=>{M(!0),await S("zipFile"),M(!1)},children:E("voice_character_slot_manager_fileupload_file_select")})]})},[C.uploadFiles,C.setUploadFile,R]),S=async T=>{let _=null;try{_=await fileSelector("")}catch(D){console.log(D)}if(_!=null){if(checkExtention(_.name,["zip"])==!1){w("error",E("voice_character_slot_manager_fileupload_name_input_error"));return}C.setUploadFile({kind:T,file:_})}};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:x})},VoiceCharacterSlotManagerFileUploadDialog=C=>{const{t:E}=useTranslation(),{serverConfigState:w,triggerToast:R}=useAppRoot(),{setDialogName:M}=useGuiState(),[x,S]=reactExports.useState("seed-vc"),[T,_]=reactExports.useState([]),[D,Y]=reactExports.useState(0),ee=reactExports.useMemo(()=>jsxRuntimeExports.jsx("select",{defaultValue:x,onChange:le=>{S(le.target.value)},children:VCTypes.map(le=>jsxRuntimeExports.jsx("option",{value:le,children:le},le))}),[x]),ie=le=>{const de=T.filter(me=>me.kind!=le.kind);de.push(le),_(de)},ne=()=>{_([])},re=async()=>{const de=document.getElementById("voice-character-slot-manager-fileUpload-dialog-name-input-text").value;if(de==""){R("error",E("voice_character_slot_manager_fileupload_name_input_error"));return}if(x=="seed-vc"){Y(0);const me=T.find(fe=>fe.kind==="zipFile");try{const fe=[];me&&fe.push(me),await w.uploadVoiceCharacterFile(C.slotIndex,x,de,fe,(ge,he)=>{Logger$1.getLogger().info("progress",ge,he),Y(Math.floor(ge-1))})}catch(fe){R("error",`upload failed: ${fe.detail||""}`),Logger$1.getLogger().error(`upload failed: ${fe.detail||""}`)}M("voiceCharacterManagerMainDialog"),Y(100),Y(0)}},oe=()=>{ne(),M("voiceCharacterManagerMainDialog")};let ae=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});return x=="seed-vc"&&(ae=jsxRuntimeExports.jsx(VoiceCharacterFileChooser,{setUploadFile:ie,uploadFiles:T})),jsxRuntimeExports.jsxs("div",{className:dialogFrame,children:[jsxRuntimeExports.jsx("div",{className:dialogTitle,children:E("voice_character_slot_manager_fileupload_title")}),jsxRuntimeExports.jsx("div",{className:instructions,children:E("voice_character_slot_manager_fileupload_instruction")}),jsxRuntimeExports.jsxs("div",{className:dialogFixedSizeContent,children:[jsxRuntimeExports.jsxs("div",{className:selectInputArea,children:[jsxRuntimeExports.jsx("div",{className:selectInputAreaLabel,children:"TTS Type: "}),jsxRuntimeExports.jsx("div",{className:selectInputAreaInput,children:ee})]}),jsxRuntimeExports.jsxs("div",{className:textInputArea,children:[jsxRuntimeExports.jsxs("div",{className:textInputAreaLabel,children:[E("voice_character_slot_manager_fileupload_name_input_label"),":"]}),jsxRuntimeExports.jsx("div",{className:textInputAreaInput,children:jsxRuntimeExports.jsx("input",{id:"voice-character-slot-manager-fileUpload-dialog-name-input-text",type:"text"})})]}),ae,jsxRuntimeExports.jsx("div",{className:uploadStatusArea,children:D>0?D+"%":" "})]}),jsxRuntimeExports.jsx(CloseButtonRow,{uploadClicked:re,backClicked:oe,isUploading:D>0})]})},Dialogs=()=>{const C=useGuiState(),[E,w]=reactExports.useState(0),R=_=>{w(_),C.setDialogName("modelSlotManagerFileUploaderDialog")},M=_=>{w(_),C.setDialogName("modelSlotManagerSamplesDialog")},x=_=>{w(_),C.setDialogName("voiceCharacterManagerFileUploaderDialog")},S=reactExports.useMemo(()=>{if(C.dialogName==="none")return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(C.dialogName==="startingNoticeDialog")return jsxRuntimeExports.jsx(StartingNoticeDialog,{});if(C.dialogName==="modelSlotManagerMainDialog")return jsxRuntimeExports.jsx(ModelSlotManagerMainDialog,{openFileUploadDialog:R,openSampleDialog:M});if(C.dialogName==="modelSlotManagerFileUploaderDialog")return jsxRuntimeExports.jsx(ModelSlotManagerFileUploadDialog,{slotIndex:E});if(C.dialogName==="voiceCharacterManagerMainDialog")return jsxRuntimeExports.jsx(VoiceCharacterSlotManagerMainDialog,{openFileUploadDialog:x});if(C.dialogName==="voiceCharacterManagerFileUploaderDialog")return jsxRuntimeExports.jsx(VoiceCharacterSlotManagerFileUploadDialog,{slotIndex:E})},[C.dialogName]),T=jsxRuntimeExports.jsx("div",{id:"dialog-container",className:dialogContainer,children:S});return reactExports.useEffect(()=>{const _=document.getElementById("dialog-container");_&&(C.dialogName==="none"?_.classList.remove(`${dialogContainerShow}`):_.classList.add(`${dialogContainerShow}`))},[C.dialogName]),T},ButtonsRow$2=C=>{const{t:E}=useTranslation(),{setDialog2Name:w,setDialog2Props:R}=useGuiState();return jsxRuntimeExports.jsxs("div",{className:closeButtonRow,children:[jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{const M=document.getElementById("text-input-dialog-text");C.resolve(M.value),w("none"),R(null)},children:E("dialog_ok")}),jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C.resolve(null),w("none"),R(null)},children:E("dialog_close")})]})},TextInputDialog=()=>{const{serverConfigState:C,triggerToast:E}=useAppRoot(),{dialog2Props:w}=useGuiState();if(w==null){E("error","dialog2Props is null");return}return reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{className:dialogFrame,children:[jsxRuntimeExports.jsx("div",{className:dialogTitle,children:w.title}),jsxRuntimeExports.jsx("div",{className:instructions,children:w.instruction}),jsxRuntimeExports.jsxs("div",{className:textInputArea,children:[jsxRuntimeExports.jsx("div",{className:textInputAreaLabel,children:"input: "}),jsxRuntimeExports.jsx("div",{className:textInputAreaInput,children:jsxRuntimeExports.jsx("input",{id:"text-input-dialog-text",type:"text",defaultValue:w.defaultValue})})]}),jsxRuntimeExports.jsx(ButtonsRow$2,{resolve:w.resolve})]}),[C.serverSlotInfos])},ButtonsRow$1=C=>{const{t:E}=useTranslation(),{setDialog2Name:w,setDialog2Props:R}=useGuiState();return jsxRuntimeExports.jsxs("div",{className:closeButtonRow,children:[jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C.resolve(!0),w("none"),R(null)},children:E("dialog_ok")}),jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C.resolve(!1),w("none"),R(null)},children:E("dialog_close")})]})},ConfirmDialog=()=>{const{serverConfigState:C,triggerToast:E}=useAppRoot(),{dialog2Props:w}=useGuiState();if(w==null){E("error","dialog2Props is null");return}return reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{className:dialogFrame,children:[jsxRuntimeExports.jsx("div",{className:dialogTitle,children:w.title}),jsxRuntimeExports.jsx("div",{className:instructions,children:w.instruction}),jsxRuntimeExports.jsx(ButtonsRow$1,{resolve:w.resolve})]}),[C.serverSlotInfos])},WaitDialog=()=>{const{serverConfigState:C,triggerToast:E}=useAppRoot(),{dialog2Props:w}=useGuiState();if(w==null){E("error","dialog2Props is null");return}return reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{className:dialogFrame,children:[jsxRuntimeExports.jsx("div",{className:dialogTitle,children:w.title}),jsxRuntimeExports.jsx("div",{className:instructions,children:w.instruction})]}),[C.serverSlotInfos])},ButtonsRow=C=>{const{t:E}=useTranslation(),{setDialog2Name:w,setDialog2Props:R}=useGuiState();return jsxRuntimeExports.jsxs("div",{className:closeButtonRow,children:[jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{const M=document.getElementById("select-input-dialog-select");C.resolve(M.value),w("none"),R(null)},children:E("dialog_ok")}),jsxRuntimeExports.jsx("div",{className:closeButton,onClick:()=>{C.resolve(null),w("none"),R(null)},children:E("dialog_close")})]})},SelectInputDialog=()=>{const{serverConfigState:C,triggerToast:E}=useAppRoot(),{dialog2Props:w}=useGuiState(),{t:R}=useTranslation();if(w==null){E("error","dialog2Props is null");return}if(w.options==null){E("error","dialog2Props options is null");return}return reactExports.useMemo(()=>{var x;return jsxRuntimeExports.jsxs("div",{className:dialogFrame,children:[jsxRuntimeExports.jsx("div",{className:dialogTitle,children:w.title}),jsxRuntimeExports.jsx("div",{className:instructions,children:w.instruction}),jsxRuntimeExports.jsxs("div",{className:textInputArea,children:[jsxRuntimeExports.jsxs("div",{className:textInputAreaLabel,children:[R("model_slot_move_confirm_dialog_item_name"),":"]}),jsxRuntimeExports.jsx("div",{className:textInputAreaInput,children:jsxRuntimeExports.jsx("select",{id:"select-input-dialog-select",children:(x=w.options)==null?void 0:x.map((S,T)=>jsxRuntimeExports.jsx("option",{value:S.value,children:S.label},T))})})]}),jsxRuntimeExports.jsx(ButtonsRow,{resolve:w.resolve})]})},[C.serverSlotInfos])},Dialogs2=()=>{const C=useGuiState(),E=reactExports.useMemo(()=>{if(C.dialog2Name==="none")return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(C.dialog2Name==="textInputDialog")return jsxRuntimeExports.jsx(TextInputDialog,{});if(C.dialog2Name==="confirmDialog")return jsxRuntimeExports.jsx(ConfirmDialog,{});if(C.dialog2Name==="waitDialog")return jsxRuntimeExports.jsx(WaitDialog,{});if(C.dialog2Name==="selectInputDialog")return jsxRuntimeExports.jsx(SelectInputDialog,{});jsxRuntimeExports.Fragment,C.dialog2Name},[C.dialog2Name]),w=jsxRuntimeExports.jsx("div",{id:"dialog2-container",className:dialogContainer,children:E});return reactExports.useEffect(()=>{const R=document.getElementById("dialog2-container");R&&(C.dialog2Name==="none"?R.classList.remove(`${dialog2ContainerShow}`):R.classList.add(`${dialog2ContainerShow}`))},[C.dialog2Name]),w},useVoiceChangerClient=C=>{var Ji;const E=reactExports.useRef(null),[w,R]=reactExports.useState(!1),[M,x]=reactExports.useState(null),[S,T]=reactExports.useState(!1),[_,D]=reactExports.useState(null),[Y,ee]=reactExports.useState(null),[ie,ne]=reactExports.useState(null),[re,oe]=reactExports.useState(null),[ae,le]=reactExports.useState(null),[de,me]=reactExports.useState(null),[fe,ge]=reactExports.useState(!1),[he,ve]=reactExports.useState(!1),[be,Se]=reactExports.useState(null),[Re,Ae]=reactExports.useState(!1),[Me,Be]=reactExports.useState(0),Qe=()=>{Be(Bt=>Bt+1)},[Pe,je]=reactExports.useState(null),[Dt,Xe]=reactExports.useState(!1),[zt,xe]=reactExports.useState(),[$e,We]=reactExports.useState(),[He,Je]=reactExports.useState(),[Rt,jt]=reactExports.useState(null);reactExports.useEffect(()=>{if(!w)return;(async()=>{if(!E.current)throw new Error("voiceChangerClient is not initialized.");await initDB();const it=E.current.getClientSetting(),ti=await getItem("audioInput")||"none",Ee=await getItem("audioInputGain")||1,ct=await getItem("audioOutputGain")||1,dt=await getItem("audioMonitorGain")||1,St=await getItem("enableEchoCancellation")||!1,ft=await getItem("enableNoiseSuppression")||!1,Ie=await getItem("enableNoiseSuppression2")||!1,Ye=await getItem("Protocol")||"rest",Ce=await getItem("pathThroughConfirmationSkip")||!1,Ne=await getItem("outputBufferFactor")||1,Le={voiceChangerClientSetting:{...it.voiceChangerClientSetting,audioInput:ti,echoCancel:St,noiseSuppression:ft,noiseSuppression2:Ie,inputGain:Ee,outputGain:ct,monitorGain:dt,passThroughConfirmationSkip:Ce},workletNodeSetting:{...it.workletNodeSetting,enableFlatPath:C.enableFlatPath,workOnColab:C.workOnColab,protocol:Ye},workletSetting:{...it.workletSetting,outputBufferFactor:Ne}};je(Le),Xe(!0);const ai=await getItem("audioOutput")||"none";xe(ai);const et=await getItem("audioMonitor")||"none";We(et);const Kt=await getItem("audioIOAnalyzer")||"none";Je(Kt)})()},[w]),reactExports.useEffect(()=>{Pe&&Pe.voiceChangerClientSetting&&Pe.workletSetting&&(typeof Pe.voiceChangerClientSetting.audioInput=="string"&&setItem("audioInput",Pe.voiceChangerClientSetting.audioInput),setItem("audioInputGain",Pe.voiceChangerClientSetting.inputGain),setItem("audioOutputGain",Pe.voiceChangerClientSetting.outputGain),setItem("audioMonitorGain",Pe.voiceChangerClientSetting.monitorGain),setItem("enableEchoCancellation",Pe.voiceChangerClientSetting.echoCancel),setItem("enableNoiseSuppression",Pe.voiceChangerClientSetting.noiseSuppression),setItem("enableNoiseSuppression2",Pe.voiceChangerClientSetting.noiseSuppression2),setItem("Protocol",Pe.workletNodeSetting.protocol),setItem("pathThroughConfirmationSkip",Pe.voiceChangerClientSetting.passThroughConfirmationSkip),setItem("outputBufferFactor",Pe.workletSetting.outputBufferFactor))},[Pe]),reactExports.useEffect(()=>{zt&&setItem("audioOutput",zt)},[zt]),reactExports.useEffect(()=>{$e&&setItem("audioMonitor",$e)},[$e]),reactExports.useEffect(()=>{He&&setItem("audioIOAnalyzer",He)},[He]);const hi=async()=>{clearStore()},Jt=Bt=>{!E.current||!w||Pe&&(Pe.voiceChangerClientSetting.audioInput=Bt,je(it=>it?{...it,voiceChangerClientSetting:{...it.voiceChangerClientSetting,audioInput:Bt}}:null))},si=Bt=>{!E.current||!w||Pe&&(Pe.voiceChangerClientSetting.inputGain=Bt,je(it=>it?{...it,voiceChangerClientSetting:{...it.voiceChangerClientSetting,inputGain:Bt}}:null))},ri=Bt=>{!E.current||!w||Pe&&(Pe.voiceChangerClientSetting.outputGain=Bt,je(it=>it?{...it,voiceChangerClientSetting:{...it.voiceChangerClientSetting,outputGain:Bt}}:null))},ni=Bt=>{!E.current||!w||Pe&&(Pe.voiceChangerClientSetting.monitorGain=Bt,je(it=>it?{...it,voiceChangerClientSetting:{...it.voiceChangerClientSetting,monitorGain:Bt}}:null))},Pi=Bt=>{!E.current||!w||Pe&&(Pe.voiceChangerClientSetting.echoCancel=Bt,je(it=>it?{...it,voiceChangerClientSetting:{...it.voiceChangerClientSetting,echoCancel:Bt}}:null))},Ci=Bt=>{!E.current||!w||Pe&&(Pe.voiceChangerClientSetting.noiseSuppression=Bt,je(it=>it?{...it,voiceChangerClientSetting:{...it.voiceChangerClientSetting,noiseSuppression:Bt}}:null))},qi=Bt=>{!E.current||!w||Pe&&(Pe.voiceChangerClientSetting.noiseSuppression2=Bt,je(it=>it?{...it,voiceChangerClientSetting:{...it.voiceChangerClientSetting,noiseSuppression2:Bt}}:null))},vi=Bt=>{!E.current||!w||Pe&&(Pe.workletNodeSetting.protocol=Bt,je(it=>it?{...it,workletNodeSetting:{...it.workletNodeSetting,protocol:Bt}}:null))},Ki=Bt=>{!E.current||!w||Pe&&(Pe.voiceChangerClientSetting.passThroughConfirmationSkip=Bt,je(it=>it?{...it,voiceChangerClientSetting:{...it.voiceChangerClientSetting,passThroughConfirmationSkip:Bt}}:null))},Vi=Bt=>{!E.current||!w||Pe&&(Pe.workletSetting.outputBufferFactor=Bt,je(it=>it?{...it,workletSetting:{...it.workletSetting,outputBufferFactor:Bt}}:null))},zi=Bt=>{!E.current||!w||Pe&&(Pe.workletNodeSetting.sendingChunkSec=Bt,je(it=>it?{...it,workletNodeSetting:{...it.workletNodeSetting,sendingChunkSec:Bt}}:null))},xi=Bt=>{!E.current||!w||Pe&&(Pe.workletNodeSetting.sendingChunkAsBulk=Bt,je(it=>it?{...it,workletNodeSetting:{...it.workletNodeSetting,sendingChunkAsBulk:Bt}}:null))},Di=Bt=>{E.current=new VoiceChangerClient(Bt,!0,{notifyPerformanceData:ti=>{jt(ti)},notifyException:(ti,Ee)=>{x(ti)}}),(async()=>{if(!E.current)return;const ti=await E.current.isInitialized();R(ti)})()},bi=async()=>{E.current&&T(!0)},mi=async()=>{E.current&&T(!1)},Oi=()=>{E.current&&E.current.trancateBuffer()};return reactExports.useEffect(()=>{E.current&&(S?E.current.start():E.current.stop())},[S]),reactExports.useEffect(()=>{!E.current||!w||!Pe||!Pe.voiceChangerClientSetting.audioInput||E.current.updateClientSetting(Pe)},[E.current,Pe==null?void 0:Pe.voiceChangerClientSetting.audioInput,w]),reactExports.useEffect(()=>{(async()=>{if(!E.current||!w||!Pe||!Pe.voiceChangerClientSetting.audioInput)return;const it=Pe.voiceChangerClientSetting.audioInput;Pe.voiceChangerClientSetting.audioInput="none",await E.current.updateClientSetting(Pe),Pe.voiceChangerClientSetting.audioInput=it,await E.current.updateClientSetting(Pe)})()},[Me]),reactExports.useEffect(()=>{!E.current||!w||Pe&&E.current.updateClientSetting(Pe)},[E.current,Pe,w]),reactExports.useEffect(()=>{(async()=>{if(!zt)return;if(!E.current||!w){console.warn("[voiceChangerClient] vcc is not ready for audio output.");return}if(!_){console.warn("[voiceChangerClient] auidoOutputElementId not set for audio output.");return}const it=document.getElementById(_);if(!it){console.warn("[voiceChangerClient] audio element not found for audio output.");return}if(zt=="none"){console.warn("[voiceChangerClient] audioOutputDevice not set for audio output."),it.volume=0;return}if(!(await navigator.mediaDevices.enumerateDevices()).filter(dt=>dt.kind=="audiooutput").some(dt=>dt.deviceId==zt)){console.warn(`[voiceChangerClient] audioOutputDevice ${zt} not found.`);return}it.srcObject=null,it.srcObject=E.current.stream;try{await it.setSinkId(zt)}catch(dt){console.log("setSinkId is not supported?",dt)}it.volume=1,it.paused&&await it.play()})()},[_,zt,(Ji=E.current)==null?void 0:Ji.stream,w,Me]),reactExports.useEffect(()=>{(async()=>{if(!$e)return;if(!E.current||!w){console.warn("[voiceChangerClient] is not ready for audio monitor.");return}if(!Y){console.warn("[voiceChangerClient] audioMonitorElementId not set for audio monitor.");return}const it=document.getElementById(Y);if(!it){console.warn("[voiceChangerClient] audio element not found for audio monitor.");return}if($e=="none"){console.warn("[voiceChangerClient] audioOutputDevice not set for audio monitor."),it.volume=0;return}if(!(await navigator.mediaDevices.enumerateDevices()).filter(dt=>dt.kind=="audiooutput").some(dt=>dt.deviceId==$e)){console.warn(`[voiceChangerClient] audioOutputDevice ${$e} not found.`);return}it.srcObject=null,it.srcObject=E.current.monitorStream;try{await it.setSinkId($e)}catch(dt){console.log("setSinkId is not supported?",dt)}it.volume=1,it.paused&&it.play()})()},[Y,$e,w,Me]),reactExports.useEffect(()=>{(async()=>{if(!E.current||!w){console.warn("[voiceChangerClient] is not ready for audio IO Analyzer.");return}if(!ie||!re){console.warn("[voiceChangerClient] auidoIOAnalyzerInputElementId or auidoIOAnalyzerOutputElementId not set for IO Analyzer.");return}if(He=="none"){console.warn("[voiceChangerClient] audioOutputDevice not set for audio IO Analyzer.");return}const it=document.getElementById(ie),ti=document.getElementById(re);if(!He){console.warn("[voiceChangerClient] audio element not found for audio IO Analyzer.");return}try{await it.setSinkId(He),await ti.setSinkId(He)}catch(Ee){console.log("setSinkId is not supported?",Ee)}it.volume=1,ti.volume=1,it.paused&&it.play(),ti.paused&&ti.play()})()},[ie,re,He,w]),reactExports.useEffect(()=>{if(!(!E.current||!w))if(fe==!0)E.current.startOutputRecording();else{const Bt=E.current.stopOutputRecording();Bt.length>0&&downloadAsWav(Bt)}},[fe,w]),reactExports.useEffect(()=>{if(!(!E.current||!w))if(he==!0)console.log("recording started..."),E.current.startInputRecording();else{console.log("recording end...");const Bt=E.current.stopInputRecording();if(Bt.length>0){const it=generateAudioBlob(Bt);Se(it)}}},[he,w]),reactExports.useEffect(()=>{!E.current||!w||(Re==!0?(console.log("Send Data is stopped"),E.current.stopSendData()):(console.log("Send Data is started"),E.current.startSendData()))},[Re]),{voiceChangerClientInitialized:w,isClientSettingLoaded:Dt,exceptionCode:M,isStarted:S,audioInput:(Pe==null?void 0:Pe.voiceChangerClientSetting.audioInput)||"none",audioOutput:zt||"none",audioMonitor:$e||"none",audioIOAnalyzer:He||"none",audioInputGain:(Pe==null?void 0:Pe.voiceChangerClientSetting.inputGain)||1,audioOutputGain:(Pe==null?void 0:Pe.voiceChangerClientSetting.outputGain)||1,audioMonitorGain:(Pe==null?void 0:Pe.voiceChangerClientSetting.monitorGain)||1,enableEchoCancellation:(Pe==null?void 0:Pe.voiceChangerClientSetting.echoCancel)||!1,enableNoiseSuppression:(Pe==null?void 0:Pe.voiceChangerClientSetting.noiseSuppression)||!1,enableNoiseSuppression2:(Pe==null?void 0:Pe.voiceChangerClientSetting.noiseSuppression2)||!1,protocol:(Pe==null?void 0:Pe.workletNodeSetting.protocol)||"rest",pathThroughConfirmationSkip:(Pe==null?void 0:Pe.voiceChangerClientSetting.passThroughConfirmationSkip)||!1,outputBufferFactor:(Pe==null?void 0:Pe.workletSetting.outputBufferFactor)||5,sendingChunkSec:(Pe==null?void 0:Pe.workletNodeSetting.sendingChunkSec)||0,sendingChunkAsBulk:(Pe==null?void 0:Pe.workletNodeSetting.sendingChunkAsBulk)||!1,recordingStarted:fe,inputRecordingStarted:he,sendDataStopped:Re,audioIOAnalyzerInputWav:ae,audioIOAnalyzerOutputWav:de,performanceData:Rt,inputRecordBlob:be,setAudioContext:Di,start:bi,stop:mi,trancateOutputBuffer:Oi,setAudioInput:Jt,setAudioOutput:xe,setAudioMonitor:We,setAudioIOAnalyzer:Je,setAudioInputGain:si,setAudioOutputGain:ri,setAudioMonitorGain:ni,setEnableEchoCancellation:Pi,setEnableNoiseSuppression:Ci,setEnableNoiseSuppression2:qi,setAudioOutputElementId:D,setAudioMonitorElementId:ee,setAudioIOAnalyzerInputElementId:ne,setAudioIOAnalyzerOutputElementId:oe,setRecordingStarted:ge,setInputRecordingStarted:ve,setSendDataStopped:Ae,setAudioIOAnalyzerInputWav:le,setAudioIOAnalyzerOutputWav:me,setProtocol:vi,setPathThroughConfirmationSkip:Ki,setOutputBufferFactor:Vi,clearDb:hi,incrementModeChangedCounter:Qe,setSendingChunkSec:zi,setSendingChunkAsBulk:xi}},AppStateContext=React.createContext(null),useAppState=()=>{const C=reactExports.useContext(AppStateContext);if(!C)throw new Error("useAppState must be used within AppStateProvider");return C},AppStateProvider=({children:C})=>{const[E,w]=reactExports.useState("light"),{audioConfigState:R}=useAppRoot(),[M,x]=reactExports.useState("view"),S=useVoiceChangerClient({enableFlatPath:!1,workOnColab:!1,outputBufferFactor:void 0}),[T,_]=reactExports.useState(!1);reactExports.useEffect(()=>{R.audioContext&&S.setAudioContext(R.audioContext)},[R.audioContext]);const D={displayColorMode:E,voiceChangerClientState:S,serverAudioDeviceReloaded:T,referenceVoiceMode:M,setDisplayColorMode:w,setServerAudioDeviceReloaded:_,setReferenceVoiceMode:x};return jsxRuntimeExports.jsx(AppStateContext.Provider,{value:D,children:C})};var lightTheme="_3rusi1e",darkTheme="_3rusi1f",spacer_h10px="_3rusi1g",errorBoundaryContainer="kh7f00",errorBoundaryTitle="kh7f01",errorBoundaryName="kh7f02",errorBoundaryMessage="kh7f03",errorBoundaryInfo="kh7f04",loggerDiv="_1vmnwpr0",loggerControlArea="_1vmnwpr1",loggerArea="_1vmnwpr2",logLine="_1vmnwpr3",decoratedWordRed="_1vmnwpr4",decoratedWordBlue="_1vmnwpr5",decoratedWordGreen="_1vmnwpr6",configSubAreaRow="_1sb5tml4",configSubAreaRowTitle5="_1sb5tml6",configSubAreaRowField14="_1sb5tmlb",configSubAreaInputMediaContainer="_1sb5tmlq",configSubAreaInputMedia="_1sb5tmlr",configSubAreaInputMediaFileSelectIcon="_1sb5tmls",configSubAreaInputMediaCaptureButton="_1sb5tmlt",configSubAreaInputMediaCaptureButtonActive="_1sb5tmlu",configSubAreaInputMediaEchoButton="_1sb5tmlv",configSubAreaInputMediaEchoButtonActive="_1sb5tmlw";function toPrimitive(C,E){if(typeof C!="object"||!C)return C;var w=C[Symbol.toPrimitive];if(w!==void 0){var R=w.call(C,E||"default");if(typeof R!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(C)}function toPropertyKey(C){var E=toPrimitive(C,"string");return typeof E=="symbol"?E:String(E)}function _defineProperty$3(C,E,w){return E=toPropertyKey(E),E in C?Object.defineProperty(C,E,{value:w,enumerable:!0,configurable:!0,writable:!0}):C[E]=w,C}function ownKeys$3(C,E){var w=Object.keys(C);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(C);E&&(R=R.filter(function(M){return Object.getOwnPropertyDescriptor(C,M).enumerable})),w.push.apply(w,R)}return w}function _objectSpread2(C){for(var E=1;E<arguments.length;E++){var w=arguments[E]!=null?arguments[E]:{};E%2?ownKeys$3(Object(w),!0).forEach(function(R){_defineProperty$3(C,R,w[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(w)):ownKeys$3(Object(w)).forEach(function(R){Object.defineProperty(C,R,Object.getOwnPropertyDescriptor(w,R))})}return C}function mapValues(C,E){var w={};for(var R in C)w[R]=E(C[R],R);return w}var shouldApplyCompound=(C,E,w)=>{for(var R of Object.keys(C)){var M;if(C[R]!==((M=E[R])!==null&&M!==void 0?M:w[R]))return!1}return!0},createRuntimeFn=C=>{var E=w=>{var R=C.defaultClassName,M=_objectSpread2(_objectSpread2({},C.defaultVariants),w);for(var x in M){var S,T=(S=M[x])!==null&&S!==void 0?S:C.defaultVariants[x];if(T!=null){var _=T;typeof _=="boolean"&&(_=_===!0?"true":"false");var D=C.variantClassNames[x][_];D&&(R+=" "+D)}}for(var[Y,ee]of C.compoundVariants)shouldApplyCompound(Y,M,C.defaultVariants)&&(R+=" "+ee);return R};return E.variants=()=>Object.keys(C.variantClassNames),E.classNames={get base(){return C.defaultClassName.split(" ")[0]},get variants(){return mapValues(C.variantClassNames,w=>mapValues(w,R=>R.split(" ")[0]))}},E},BasicButton=createRuntimeFn({defaultClassName:"mswwbu0",variantClassNames:{active:{true:"mswwbu1",false:"mswwbu2"},width:{small:"mswwbu3",medium:"mswwbu4",large:"mswwbu5",xlarge:"mswwbu6",xxlarge:"mswwbu7"}},defaultVariants:{active:!1,width:"medium"},compoundVariants:[]}),Emotion={anger:{background:"#ffdede"},disgust:{background:"#bee0ec"},fear:{background:"#f2e9ff"},happy:{background:"#f4ff00"},sad:{background:"#e2e9f7"},surprise:{background:"#f1e687"},other:{background:"#aeaaaa"},none:{background:"#ffffff"}},EmotionButton=createRuntimeFn({defaultClassName:"ktcfqv0",variantClassNames:{emotion:{anger:"ktcfqv1",disgust:"ktcfqv2",fear:"ktcfqv3",happy:"ktcfqv4",sad:"ktcfqv5",surprise:"ktcfqv6",other:"ktcfqv7",none:"ktcfqv8"}},defaultVariants:{},compoundVariants:[]}),EmotionBlockButton=createRuntimeFn({defaultClassName:"ktcfqv9",variantClassNames:{emotion:{anger:"ktcfqva",disgust:"ktcfqvb",fear:"ktcfqvc",happy:"ktcfqvd",sad:"ktcfqve",surprise:"ktcfqvf",other:"ktcfqvg",none:"ktcfqvh"},selected:{true:"ktcfqvi",false:"ktcfqvj"}},defaultVariants:{},compoundVariants:[]}),headerButtonThema="raetwzh",normalButtonThema="raetwzi",modelSlotButtonThema="raetwzj",HeaderIcon=createRuntimeFn({defaultClassName:"_1bfvgv40",variantClassNames:{},defaultVariants:{},compoundVariants:[]}),BasicInput=createRuntimeFn({defaultClassName:"_2tyweh0",variantClassNames:{},defaultVariants:{},compoundVariants:[]});createRuntimeFn({defaultClassName:"d140gw0",variantClassNames:{paddingLeft:{"0rem":"d140gw1","1rem":"d140gw2","2rem":"d140gw3"},width:{small:"d140gw4",medium:"d140gw5",large:"d140gw6","x-large":"d140gw7"}},defaultVariants:{paddingLeft:"0rem",width:"medium"},compoundVariants:[]});var BasicLabel=createRuntimeFn({defaultClassName:"ramu4z0",variantClassNames:{paddingLeft:{"0rem":"ramu4z1","1rem":"ramu4z2","2rem":"ramu4z3"},width:{small:"ramu4z4",medium:"ramu4z5",large:"ramu4z6","x-large":"ramu4z7"}},defaultVariants:{paddingLeft:"0rem",width:"medium"},compoundVariants:[]});createRuntimeFn({defaultClassName:"xv7yxm0",variantClassNames:{paddingLeft:{"0rem":"xv7yxm1","1rem":"xv7yxm2","2rem":"xv7yxm3"},width:{small:"xv7yxm4",medium:"xv7yxm5",large:"xv7yxm6","x-large":"xv7yxm7"}},defaultVariants:{paddingLeft:"0rem",width:"x-large"},compoundVariants:[]});var BasicAudio=createRuntimeFn({defaultClassName:"ytj2dt0",variantClassNames:{},defaultVariants:{},compoundVariants:[]}),modelSlotArea="_1ccjv300",modelSlotPane="_1ccjv301",modelSlotTitle="_1ccjv302",modelSlotArea2="_1ccjv303",modelSlotTilesContainer="_1ccjv304",buttons="_1ccjv305",buttonGroup="_1ccjv306",button="_1ccjv307",buttonActive="_1ccjv308",modelSlotTileContainer="_1ccjv309",modelSlotTileContainerSelected="_1ccjv30a",modelSlotTileIconDiv="_1ccjv30b",modelSlotTileIcon="_1ccjv30c",modelSlotTileIconNoEntry="_1ccjv30d",modelSlotTileDscription="_1ccjv30e",modelSlotTileVctype="_1ccjv30f",inferenceModeSelectArea="_1ps0m120",inferenceModeSelectAreaControl="_1ps0m121",inferenceModeSelectAreaField="_1ps0m122",inferenceArea="cepqni0",inferenceAreaInputArea="cepqni1",inferenceAreaOutputArea="cepqni2",inferenceAreaControl="cepqni3",inferenceAreaControlRight="cepqni4",inferenceAreaOptionContainer="cepqni5",inferenceAreaInputAudioPlayer="cepqni7",inferenceAreaOutputAudioPlayer="cepqni8",inferenceAreaFileDropArea="cepqni9",inferenceAreaFileDropAreaDrag="cepqnia";const HeaderArea=C=>{var de;const{t:E,i18n:w}=useTranslation(),{guiSetting:R,serverConfigState:M,generateGetPathFunc:x}=useAppRoot(),{setDialog2Name:S,setDialog2Props:T}=useGuiState(),{displayColorMode:_,setDisplayColorMode:D}=useAppState(),Y=reactExports.useMemo(()=>{const me=x("/assets/icons/github.svg");return isDesktopApp()?jsxRuntimeExports.jsxs("span",{className:tooltip,onClick:()=>{window.electronAPI.openBrowser("https://github.com/w-okada/voice-changer")},children:[jsxRuntimeExports.jsx("img",{src:me,className:HeaderIcon()}),jsxRuntimeExports.jsx("div",{className:tooltipText,children:E("header_github")})]}):jsxRuntimeExports.jsxs("a",{className:tooltip,href:"https://github.com/w-okada/voice-changer",target:"_blank",rel:"noopener noreferrer",children:[jsxRuntimeExports.jsx("img",{src:me,className:HeaderIcon()}),jsxRuntimeExports.jsx("div",{className:tooltipText,children:E("header_github")})]})},[w.language]),ee=reactExports.useMemo(()=>{const me=x("/assets/icons/help-circle.svg");return isDesktopApp()?jsxRuntimeExports.jsxs("span",{className:tooltip,onClick:()=>{window.electronAPI.openBrowser("https://github.com/w-okada/voice-changer/blob/master/tutorials/tutorial_rvc_ja_latest.md")},children:[jsxRuntimeExports.jsx("img",{src:me,className:HeaderIcon()}),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipText100px}`,children:E("header_manual")})]}):jsxRuntimeExports.jsxs("a",{className:tooltip,href:"https://github.com/w-okada/voice-changer/blob/master/tutorials/tutorial_rvc_ja_latest.md",target:"_blank",rel:"noopener noreferrer",children:[jsxRuntimeExports.jsx("img",{src:me,className:HeaderIcon()}),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipText100px}`,children:E("header_manual")})]})},[w.language]),ie=reactExports.useMemo(()=>{const me=x("/assets/icons/monitor.svg");return isDesktopApp()?jsxRuntimeExports.jsxs("span",{className:tooltip,onClick:()=>{window.electronAPI.openBrowser("https://w-okada.github.io/screen-recorder-ts/")},children:[jsxRuntimeExports.jsx("img",{src:me,className:HeaderIcon()}),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipText100px}`,children:E("header_screen_recorder")})]}):jsxRuntimeExports.jsxs("a",{className:tooltip,href:"https://w-okada.github.io/screen-recorder-ts/",target:"_blank",rel:"noopener noreferrer",children:[jsxRuntimeExports.jsx("img",{src:me,className:HeaderIcon()}),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipText100px}`,children:E("header_screen_recorder")})]})},[w.language]),ne=reactExports.useMemo(()=>{const me=x("/assets/icons/buymeacoffee.png");return isDesktopApp()?jsxRuntimeExports.jsxs("span",{className:tooltip,onClick:()=>{window.electronAPI.openBrowser("https://www.buymeacoffee.com/wokad")},children:[jsxRuntimeExports.jsx("img",{src:me,className:HeaderIcon()}),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipText100px}`,children:E("header_support")})]}):jsxRuntimeExports.jsxs("a",{className:tooltip,href:"https://www.buymeacoffee.com/wokad",target:"_blank",rel:"noopener noreferrer",children:[jsxRuntimeExports.jsx("img",{src:me,className:HeaderIcon()}),jsxRuntimeExports.jsx("div",{className:`${tooltipText} ${tooltipText100px}`,children:E("header_support")})]})},[w.language]),re=reactExports.useMemo(()=>{if(!R.setting)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:" "});const me=R.setting.lang;return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("span",{children:[E("header_language"),":"]}),jsxRuntimeExports.jsx("select",{defaultValue:w.language,onChange:fe=>{Logger$1.getLogger().info("change lang",fe.target.value,w.language),w.changeLanguage(fe.target.value),location.reload()},className:BasicInput(),children:me.map(fe=>jsxRuntimeExports.jsx("option",{value:fe,children:fe},fe))})]})},[w.language,(de=R.setting)==null?void 0:de.lang]),oe=reactExports.useMemo(()=>{const me=async()=>{let fe=!1;await new Promise(ve=>{T({title:E("header_initialize_confirm_dialog_title"),instruction:`${E("header_initialize_confirm_dialog_instruction")}`,defaultValue:"",resolve:ve,options:null}),S("confirmDialog")})==!0?fe=!0:fe=!1,fe&&await M.initializeServer()};return jsxRuntimeExports.jsx("button",{className:`${BasicButton()} ${headerButtonThema}`,onClick:me,children:E("header_initialize")})},[w.language,_]),ae=reactExports.useMemo(()=>jsxRuntimeExports.jsx("button",{className:`${BasicButton()} ${headerButtonThema}`,onClick:()=>{D(_=="light"?"dark":"light")},children:_=="light"?E("header_to_dark_label"):E("header_to_light_label")}),[_]);return reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{className:headerArea,children:[jsxRuntimeExports.jsxs("div",{className:titleArea,children:[jsxRuntimeExports.jsx("span",{className:title,children:"VCClient for seed vc"}),jsxRuntimeExports.jsx("span",{}),jsxRuntimeExports.jsx("span",{className:titleVersion,children:R.version}),jsxRuntimeExports.jsx("span",{className:titleVersion,children:R.edition})]}),jsxRuntimeExports.jsxs("div",{className:iconArea,children:[jsxRuntimeExports.jsxs("span",{className:iconGroup,children:[Y,ee,ie,ne]}),jsxRuntimeExports.jsx("span",{className:iconGroup,children:re}),jsxRuntimeExports.jsxs("span",{className:iconGroup,children:[oe,ae]})]})]}),[R.version,R.edition,w.language,ae])};var DefaultContext={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},IconContext=React.createContext&&React.createContext(DefaultContext),_excluded=["attr","size","title"];function _objectWithoutProperties(C,E){if(C==null)return{};var w=_objectWithoutPropertiesLoose(C,E),R,M;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(C);for(M=0;M<x.length;M++)R=x[M],!(E.indexOf(R)>=0)&&Object.prototype.propertyIsEnumerable.call(C,R)&&(w[R]=C[R])}return w}function _objectWithoutPropertiesLoose(C,E){if(C==null)return{};var w={};for(var R in C)if(Object.prototype.hasOwnProperty.call(C,R)){if(E.indexOf(R)>=0)continue;w[R]=C[R]}return w}function _extends(){return _extends=Object.assign?Object.assign.bind():function(C){for(var E=1;E<arguments.length;E++){var w=arguments[E];for(var R in w)Object.prototype.hasOwnProperty.call(w,R)&&(C[R]=w[R])}return C},_extends.apply(this,arguments)}function ownKeys$2(C,E){var w=Object.keys(C);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(C);E&&(R=R.filter(function(M){return Object.getOwnPropertyDescriptor(C,M).enumerable})),w.push.apply(w,R)}return w}function _objectSpread$2(C){for(var E=1;E<arguments.length;E++){var w=arguments[E]!=null?arguments[E]:{};E%2?ownKeys$2(Object(w),!0).forEach(function(R){_defineProperty$2(C,R,w[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(w)):ownKeys$2(Object(w)).forEach(function(R){Object.defineProperty(C,R,Object.getOwnPropertyDescriptor(w,R))})}return C}function _defineProperty$2(C,E,w){return E=_toPropertyKey$2(E),E in C?Object.defineProperty(C,E,{value:w,enumerable:!0,configurable:!0,writable:!0}):C[E]=w,C}function _toPropertyKey$2(C){var E=_toPrimitive$2(C,"string");return typeof E=="symbol"?E:E+""}function _toPrimitive$2(C,E){if(typeof C!="object"||!C)return C;var w=C[Symbol.toPrimitive];if(w!==void 0){var R=w.call(C,E||"default");if(typeof R!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(C)}function Tree2Element(C){return C&&C.map((E,w)=>React.createElement(E.tag,_objectSpread$2({key:w},E.attr),Tree2Element(E.child)))}function GenIcon(C){return E=>React.createElement(IconBase,_extends({attr:_objectSpread$2({},C.attr)},E),Tree2Element(C.child))}function IconBase(C){var E=w=>{var{attr:R,size:M,title:x}=C,S=_objectWithoutProperties(C,_excluded),T=M||w.size||"1em",_;return w.className&&(_=w.className),C.className&&(_=(_?_+" ":"")+C.className),React.createElement("svg",_extends({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},w.attr,R,S,{className:_,style:_objectSpread$2(_objectSpread$2({color:C.color||w.color},w.style),C.style),height:T,width:T,xmlns:"http://www.w3.org/2000/svg"}),x&&React.createElement("title",null,x),C.children)};return IconContext!==void 0?React.createElement(IconContext.Consumer,null,w=>E(w)):E(DefaultContext)}function FaSortAlphaDown(C){return GenIcon({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M176 352h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.36 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm240-64H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 446.37V464a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 321.63V304a16 16 0 0 0-16-16zm31.06-85.38l-59.27-160A16 16 0 0 0 372.72 32h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 224h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 224H432a16 16 0 0 0 15.06-21.38zM335.61 144L352 96l16.39 48z"},child:[]}]})(C)}function FaSortNumericDown(C){return GenIcon({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M304 96h16v64h-16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h96a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-16V48a16 16 0 0 0-16-16h-48a16 16 0 0 0-14.29 8.83l-16 32A16 16 0 0 0 304 96zm26.15 162.91a79 79 0 0 0-55 54.17c-14.25 51.05 21.21 97.77 68.85 102.53a84.07 84.07 0 0 1-20.85 12.91c-7.57 3.4-10.8 12.47-8.18 20.34l9.9 20c2.87 8.63 12.53 13.49 20.9 9.91 58-24.76 86.25-61.61 86.25-132V336c-.02-51.21-48.4-91.34-101.85-77.09zM352 356a20 20 0 1 1 20-20 20 20 0 0 1-20 20zm-176-4h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.36 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352z"},child:[]}]})(C)}const ModelSlotArea=C=>{const{serverConfigState:E,generateGetPathFunc:w}=useAppRoot(),R=useGuiState(),{t:M}=useTranslation(),[x,S]=reactExports.useState("slot"),T=reactExports.useMemo(()=>E.serverSlotInfos?(x=="slot"?E.serverSlotInfos:E.serverSlotInfos.slice().sort((Y,ee)=>Y.name.localeCompare(ee.name))).map((Y,ee)=>{var le;if(Y.vc_type==null)return null;const ie=Y.slot_index==((le=E.serverConfiguration)==null?void 0:le.current_slot_index)?`${modelSlotTileContainer} ${modelSlotTileContainerSelected}`:modelSlotTileContainer,ne=Y.name.length>8?Y.name.substring(0,7)+"...":Y.name;let re=Y.icon_file!=null?"models/"+Y.slot_index+"/"+Y.icon_file.split(/[\/\\]/).pop():"./assets/icons/human.png";re=w(re);const oe=Y.icon_file!=null?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("img",{className:modelSlotTileIcon,src:re,alt:Y.name}),jsxRuntimeExports.jsx("div",{className:modelSlotTileVctype,children:Y.vc_type})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:modelSlotTileIconNoEntry,children:"no image"}),jsxRuntimeExports.jsx("div",{className:modelSlotTileVctype,children:Y.vc_type})]}),ae=async()=>{E.serverConfiguration!=null&&(E.serverConfiguration.current_slot_index=Y.slot_index,E.updateServerConfiguration(E.serverConfiguration))};return jsxRuntimeExports.jsxs("div",{className:ie,onClick:ae,children:[jsxRuntimeExports.jsx("div",{className:modelSlotTileIconDiv,children:oe}),jsxRuntimeExports.jsx("div",{className:modelSlotTileDscription,children:ne})]},ee)}).filter(Y=>Y!=null):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),[E.serverSlotInfos,E.serverConfiguration,x]);return reactExports.useMemo(()=>{const D=()=>{R.setDialogName(DialogName.modelSlotManagerMainDialog)};return jsxRuntimeExports.jsxs("div",{className:modelSlotArea,children:[jsxRuntimeExports.jsx("div",{className:modelSlotTitle,children:"Model"}),jsxRuntimeExports.jsxs("div",{className:modelSlotPane,children:[jsxRuntimeExports.jsx("div",{className:modelSlotTilesContainer,children:T}),jsxRuntimeExports.jsxs("div",{className:buttons,children:[jsxRuntimeExports.jsxs("div",{className:buttonGroup,children:[jsxRuntimeExports.jsx("div",{className:`${BasicButton({width:"small",active:x=="slot"})} ${modelSlotButtonThema}`,onClick:()=>{S("slot")},children:jsxRuntimeExports.jsx(FaSortNumericDown,{})}),jsxRuntimeExports.jsx("div",{className:`${BasicButton({width:"small",active:x=="name"})} ${modelSlotButtonThema}`,onClick:()=>{S("name")},children:jsxRuntimeExports.jsx(FaSortAlphaDown,{})})]}),jsxRuntimeExports.jsx("div",{className:buttonGroup,children:jsxRuntimeExports.jsx("div",{className:`${BasicButton({width:"small"})} ${modelSlotButtonThema}`,onClick:D,children:M("model_slot_edit")})})]})]})]})},[T,x])};var characterArea="voco480",portraitArea="voco481",portraitAreaChangable="voco482",portraitContainer="voco483",portrait="voco484",portraitAreaTermsOfUse="voco487",portraitAreaAboutModelAndVoice="voco488",portraitAreaAboutModelAndVoicePopupLink="voco489",characterAreaControlArea="voco48a",characterAreaControl="voco48b",characterAreaControlField="voco48d",characterAreaControlFieldFullWidth="voco48e",characterAreaText="voco48h";const VoiceCharacterPortrait=()=>{var M,x,S,T;const{serverConfigState:C,generateGetPathFunc:E}=useAppRoot(),w=reactExports.useMemo(()=>!C.serverConfiguration||C.serverConfiguration.current_reference_voice_indexes[C.serverConfiguration.current_voice_charcter_slot_index]==null?-1:C.serverConfiguration.current_reference_voice_indexes[C.serverConfiguration.current_voice_charcter_slot_index],[(M=C.serverConfiguration)==null?void 0:M.current_reference_voice_indexes,(x=C.serverConfiguration)==null?void 0:x.current_voice_charcter_slot_index]);return reactExports.useMemo(()=>{if(!C.serverConfiguration)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(!C.serverVoiceCharacterSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const _=C.serverVoiceCharacterSlotInfos[C.serverConfiguration.current_voice_charcter_slot_index];if(!_)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});let D="";if(w<0)D=_.icon_file!=null?"voice_characters/"+_.slot_index+"/"+_.icon_file.split(/[\/\\]/).pop():"./assets/icons/human.png";else{const ee=w,ie=_.reference_voices.find(ne=>ne.slot_index==ee);ie?ie.icon_file?D="voice_characters/"+_.slot_index+"/"+ie.icon_file.split(/[\/\\]/).pop():D=_.icon_file!=null?"voice_characters/"+_.slot_index+"/"+_.icon_file.split(/[\/\\]/).pop():"./assets/icons/human.png":D=_.icon_file!=null?"voice_characters/"+_.slot_index+"/"+_.icon_file.split(/[\/\\]/).pop():"./assets/icons/human.png"}return D=E(D),jsxRuntimeExports.jsx("img",{className:portrait,src:D,alt:_.name})},[C.serverConfiguration,(S=C.serverConfiguration)==null?void 0:S.current_slot_index,(T=C.serverConfiguration)==null?void 0:T.current_voice_charcter_slot_index,C.serverVoiceCharacterSlotInfos,w])},CharacterAreaPortrait=()=>{var D,Y,ee,ie;const{serverConfigState:C}=useAppRoot(),{referenceVoiceMode:E}=useAppState(),{setDialogName:w}=useGuiState(),{t:R}=useTranslation(),M=reactExports.useMemo(()=>!C.serverConfiguration||C.serverConfiguration.current_reference_voice_indexes[C.serverConfiguration.current_voice_charcter_slot_index]==null?-1:C.serverConfiguration.current_reference_voice_indexes[C.serverConfiguration.current_voice_charcter_slot_index],[(D=C.serverConfiguration)==null?void 0:D.current_reference_voice_indexes,(Y=C.serverConfiguration)==null?void 0:Y.current_voice_charcter_slot_index]),x=reactExports.useMemo(()=>{if(!C.serverConfiguration||!C.serverVoiceCharacterSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(C.serverConfiguration.current_voice_charcter_slot_index<0)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const ne=C.serverVoiceCharacterSlotInfos[C.serverConfiguration.current_voice_charcter_slot_index];return ne==null?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}):ne.terms_of_use_url==null?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}):jsxRuntimeExports.jsx("div",{className:portraitAreaTermsOfUse,children:jsxRuntimeExports.jsxs("a",{href:ne.terms_of_use_url,target:"_blank",rel:"noopener noreferrer",className:"portrait-area-terms-of-use-link",children:["[",R("character_area_portrait_terms_of_use"),"]"]})})},[C.serverConfiguration,C.serverVoiceCharacterSlotInfos,(ee=C.serverConfiguration)==null?void 0:ee.current_voice_charcter_slot_index]),S=reactExports.useMemo(()=>{if(!C.serverConfiguration||!C.serverVoiceCharacterSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(C.serverConfiguration.current_voice_charcter_slot_index<0)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const ne=C.serverVoiceCharacterSlotInfos[C.serverConfiguration.current_voice_charcter_slot_index];return ne==null?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}):ne.description==null&&ne.credit==null?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}):jsxRuntimeExports.jsx("div",{className:portraitAreaAboutModelAndVoice,children:jsxRuntimeExports.jsxs("div",{className:portraitAreaAboutModelAndVoicePopupLink,onClick:()=>{w("aboutModelDialog")},children:["[",R("character_area_portrait_about_model"),"]"]})})},[C.serverConfiguration,C.serverVoiceCharacterSlotInfos,(ie=C.serverConfiguration)==null?void 0:ie.current_voice_charcter_slot_index]),T=()=>{if(E=="view")return;if(!C.serverConfiguration||!C.serverVoiceCharacterSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(C.serverConfiguration.current_voice_charcter_slot_index<0)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(C.serverVoiceCharacterSlotInfos[C.serverConfiguration.current_voice_charcter_slot_index]==null)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const re=C.serverConfiguration.current_voice_charcter_slot_index,oe=M,ae=document.createElement("input");ae.type="file",ae.accept="image/*",ae.style.display="none",document.body.appendChild(ae),ae.click(),ae.onchange=async()=>{if(!ae.files)return;const le=ae.files[0];le&&C.updateReferenceVoiceIconFile(re,oe,le,()=>{}),document.body.removeChild(ae)}};return reactExports.useMemo(()=>{const ne=E=="view"?portraitArea:portraitAreaChangable;return jsxRuntimeExports.jsx("div",{className:ne,children:jsxRuntimeExports.jsxs("div",{className:portraitContainer,onClick:()=>{T()},children:[jsxRuntimeExports.jsx(VoiceCharacterPortrait,{}),x,S]})})},[x,S,E])},CharacterAreaControlName=()=>{var R;const{serverConfigState:C}=useAppRoot(),{t:E}=useTranslation();return reactExports.useMemo(()=>{var S,T;if(((S=C.serverConfiguration)==null?void 0:S.current_voice_charcter_slot_index)==null)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(!C.serverVoiceCharacterSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const M=C.serverVoiceCharacterSlotInfos[(T=C.serverConfiguration)==null?void 0:T.current_voice_charcter_slot_index];if(M==null)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});let x=M.name;return jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsxs("div",{className:BasicLabel(),children:[E("character_area_control_name"),":"]}),jsxRuntimeExports.jsx("div",{className:characterAreaControlField,children:jsxRuntimeExports.jsx("div",{className:characterAreaText,children:x})})]})},[C.serverVoiceCharacterSlotInfos,(R=C.serverConfiguration)==null?void 0:R.current_voice_charcter_slot_index])},ReferenceVoiceSelector=()=>{var S,T,_;const{serverConfigState:C,triggerToast:E}=useAppRoot(),{t:w}=useTranslation(),{referenceVoiceMode:R}=useAppState(),M=reactExports.useMemo(()=>!C.serverConfiguration||C.serverConfiguration.current_reference_voice_indexes[C.serverConfiguration.current_voice_charcter_slot_index]==null?-1:C.serverConfiguration.current_reference_voice_indexes[C.serverConfiguration.current_voice_charcter_slot_index],[(S=C.serverConfiguration)==null?void 0:S.current_reference_voice_indexes,(T=C.serverConfiguration)==null?void 0:T.current_voice_charcter_slot_index]);return reactExports.useMemo(()=>{var de,me;if(((de=C.serverConfiguration)==null?void 0:de.current_voice_charcter_slot_index)==null)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(!C.serverVoiceCharacterSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const D=C.serverVoiceCharacterSlotInfos[(me=C.serverConfiguration)==null?void 0:me.current_voice_charcter_slot_index];if(D==null)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const Y=25,ee=4,ie=14,ne=5,re=(ie+ne)*Y,oe=(fe,ge)=>{if(C.serverConfiguration&&M!=fe){C.serverConfiguration.current_reference_voice_indexes[C.serverConfiguration.current_voice_charcter_slot_index]=fe;for(let he=0;he<C.serverConfiguration.current_reference_voice_indexes.length;he++)C.serverConfiguration.current_reference_voice_indexes[he]==null&&(C.serverConfiguration.current_reference_voice_indexes[he]=-1);C.updateServerConfiguration(C.serverConfiguration)}},ae=Array.from({length:ee},(fe,ge)=>Array.from({length:Y},(he,ve)=>{const be=ge*Y+ve,Se=be==M,Re=D.reference_voices.filter(Me=>Me.slot_index==be);let Ae="none";return Re.length==1&&(Re[0].voice_type in Emotion?Ae=Re[0].voice_type:Ae="other"),jsxRuntimeExports.jsx("button",{className:EmotionBlockButton({emotion:Ae,selected:Se}),onClick:Me=>{if(R=="edit"){E("error",w("reference_voice_area_select_voice_error_in_edit_mode"));return}oe(be,Me.ctrlKey)}},be)})).map((fe,ge)=>jsxRuntimeExports.jsx("div",{style:{width:re,display:"flex",gap:"3px",padding:`${ne}px`},children:fe},ge)),le=BasicVoiceType.map((fe,ge)=>jsxRuntimeExports.jsx("button",{className:EmotionButton({emotion:fe}),onClick:()=>{},children:fe},fe));return jsxRuntimeExports.jsxs("div",{style:{display:"flex"},children:[jsxRuntimeExports.jsx("div",{style:{width:re,display:"flex",flexDirection:"column"},children:ae}),jsxRuntimeExports.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:le})]})},[C.serverVoiceCharacterSlotInfos,M,(_=C.serverConfiguration)==null?void 0:_.current_voice_charcter_slot_index,R])},ReferenceVoiceArea=()=>{var _,D,Y;const{serverConfigState:C,triggerToast:E}=useAppRoot(),{t:w}=useTranslation(),{referenceVoiceMode:R,setReferenceVoiceMode:M}=useAppState(),x=reactExports.useMemo(()=>!C.serverConfiguration||C.serverConfiguration.current_reference_voice_indexes[C.serverConfiguration.current_voice_charcter_slot_index]==null?-1:C.serverConfiguration.current_reference_voice_indexes[C.serverConfiguration.current_voice_charcter_slot_index],[(_=C.serverConfiguration)==null?void 0:_.current_reference_voice_indexes,(D=C.serverConfiguration)==null?void 0:D.current_voice_charcter_slot_index]),S=ee=>{var re,oe;if(((re=C.serverConfiguration)==null?void 0:re.current_voice_charcter_slot_index)==null||!C.serverVoiceCharacterSlotInfos||C.serverVoiceCharacterSlotInfos[(oe=C.serverConfiguration)==null?void 0:oe.current_voice_charcter_slot_index]==null)return;if(ee.length!=1){E("error",w("error_file_num_not_1"));return}const ne=ee[0];C.addReferenceVoice(C.serverConfiguration.current_voice_charcter_slot_index,x,"misc",ne,(ae,le)=>{console.log("progress",ae,le)})};return reactExports.useEffect(()=>{const ee=document.getElementById("reference-voice-area-audio-drop-area"),ie=document.getElementById("reference-voice-area-audio-file-elem");if(!ee||!ie)return;const ne=de=>{de.preventDefault(),ee.style.borderColor="#ffc062"},re=()=>{ee.style.borderColor="#2fcd93"},oe=de=>{var fe;de.preventDefault(),ee.style.borderColor="#2fcd93";const me=[...((fe=de.dataTransfer)==null?void 0:fe.files)||[]];S(me)},ae=()=>{console.log("clicked"),ie.click()},le=de=>{const fe=[...de.target.files??[]];S(fe)};return ee.addEventListener("dragover",ne),ee.addEventListener("dragleave",re),ee.addEventListener("drop",oe),ee.addEventListener("click",ae),ie.addEventListener("change",le),()=>{ee.removeEventListener("dragover",ne),ee.removeEventListener("dragleave",re),ee.removeEventListener("drop",oe),ee.removeEventListener("click",ae),ie.removeEventListener("change",le)}},[S]),reactExports.useMemo(()=>{var Ae;if(((Ae=C.serverConfiguration)==null?void 0:Ae.current_voice_charcter_slot_index)==null)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(!C.serverVoiceCharacterSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const ee=C.serverVoiceCharacterSlotInfos[C.serverConfiguration.current_voice_charcter_slot_index];if(ee==null)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const ie=C.serverConfiguration.current_voice_charcter_slot_index,ne=x,re=ee.reference_voices.filter(Me=>Me.slot_index==ne);if(re.length>1)throw new Error(`multiple voices are registered in one index, ${re.length}`);if(re.length==0)return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{id:"reference-voice-area-audio-drop-area",style:{border:"5px solid #2fcd93",padding:"1rem",borderRadius:"10px"},children:jsxRuntimeExports.jsx("p",{children:w("reference_voice_area_fileupload_area_text")})}),jsxRuntimeExports.jsx("input",{type:"file",hidden:!0,id:"reference-voice-area-audio-file-elem"})]});C.getReferenceVoiceFile(ie,ne).then(Me=>{var Qe;let Be;Me!=null?Be=URL.createObjectURL(Me):Be="",(Qe=document.getElementById("reference-audio-audio"))==null||Qe.setAttribute("src",Be)});const oe=re[0].text,ae=re[0].voice_type,le=re[0].language,de=jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsxs("div",{className:BasicLabel(),children:[w("reference_voice_area_audio"),":"]}),jsxRuntimeExports.jsx("div",{className:characterAreaControlField,children:jsxRuntimeExports.jsx("audio",{controls:!0,id:"reference-audio-audio",className:BasicAudio()})})]}),me=jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsxs("div",{className:BasicLabel(),children:[w("reference_voice_area_text"),":"]}),jsxRuntimeExports.jsx("div",{className:characterAreaControlFieldFullWidth,children:oe})]}),fe=jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsxs("div",{className:BasicLabel(),children:[w("reference_voice_area_text"),":"]}),jsxRuntimeExports.jsx("div",{className:characterAreaControlFieldFullWidth,children:jsxRuntimeExports.jsx("input",{className:BasicInput(),id:"reference-voice-area-text-input",type:"text",defaultValue:oe})})]}),ge=jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsxs("div",{className:BasicLabel(),children:[w("reference_voice_area_category"),":"]}),jsxRuntimeExports.jsx("div",{className:characterAreaControlField,children:ae})]}),he=jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsxs("div",{className:BasicLabel(),children:[w("reference_voice_area_category"),":"]}),jsxRuntimeExports.jsx("div",{className:characterAreaControlField,children:jsxRuntimeExports.jsx("select",{defaultValue:ae,id:"reference-voice-area-category-select",className:BasicInput(),children:BasicVoiceType.map(Me=>jsxRuntimeExports.jsx("option",{value:Me,children:Me},Me))})})]}),ve=jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsxs("div",{className:BasicLabel(),children:[w("reference_voice_area_language"),":"]}),jsxRuntimeExports.jsx("div",{className:characterAreaControlField,children:le})]}),be=jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsxs("div",{className:BasicLabel(),children:[w("reference_voice_area_language"),":"]}),jsxRuntimeExports.jsx("div",{className:characterAreaControlField,children:jsxRuntimeExports.jsx("select",{defaultValue:le,id:"reference-voice-area-language-select",className:BasicInput(),children:LanguageType.map(Me=>jsxRuntimeExports.jsx("option",{value:Me,children:Me},Me))})})]}),Se=jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsx("button",{onClick:()=>{M("edit")},className:`${BasicButton()} ${normalButtonThema}`,children:w("reference_voice_area_edit_button")}),jsxRuntimeExports.jsx("button",{onClick:()=>{C.deleteReferenceVoice(ie,ne)},className:`${BasicButton()} ${normalButtonThema}`,children:w("reference_voice_area_delete_button")})]}),Re=jsxRuntimeExports.jsxs("div",{className:characterAreaControl,children:[jsxRuntimeExports.jsx("button",{onClick:()=>{const Me=re[0],Be=document.getElementById("reference-voice-area-text-input"),Qe=document.getElementById("reference-voice-area-category-select"),Pe=document.getElementById("reference-voice-area-language-select");Me.text=Be.value,Me.voice_type=Qe.value,Me.language=Pe.value,C.updateReferenceVoice(ie,ne,Me),M("view")},className:`${BasicButton()} ${normalButtonThema}`,children:w("reference_voice_area_save_button")}),jsxRuntimeExports.jsx("div",{onClick:()=>{M("view")},className:`${BasicButton()} ${normalButtonThema}`,children:w("reference_voice_area_cancel_button")})]});return R=="view"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[de,me,ge,ve,Se]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[de,fe,he,be,Re]})},[C.serverVoiceCharacterSlotInfos,x,(Y=C.serverConfiguration)==null?void 0:Y.current_voice_charcter_slot_index,R])},CharacterAreaControl=()=>reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{className:characterAreaControlArea,children:[jsxRuntimeExports.jsx(CharacterAreaControlName,{}),jsxRuntimeExports.jsx(ReferenceVoiceSelector,{}),jsxRuntimeExports.jsx(ReferenceVoiceArea,{})]}),[]),CharacterArea=()=>reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{className:characterArea,children:[jsxRuntimeExports.jsx(CharacterAreaPortrait,{}),jsxRuntimeExports.jsx(CharacterAreaControl,{})]}),[]),VoiceCharacterSlotArea=C=>{var ee;const{serverConfigState:E,triggerToast:w,generateGetPathFunc:R}=useAppRoot(),{referenceVoiceMode:M}=useAppState(),x=useGuiState(),{t:S}=useTranslation(),[T,_]=reactExports.useState("slot"),D=reactExports.useMemo(()=>E.serverVoiceCharacterSlotInfos?(T=="slot"?E.serverVoiceCharacterSlotInfos.slice().sort((ne,re)=>ne.slot_index-re.slot_index):E.serverVoiceCharacterSlotInfos.slice().sort((ne,re)=>ne.name.localeCompare(re.name))).map((ne,re)=>{var fe;if(ne.vc_type==null)return null;const oe=ne.slot_index==((fe=E.serverConfiguration)==null?void 0:fe.current_voice_charcter_slot_index)?`${modelSlotTileContainer} ${modelSlotTileContainerSelected}`:modelSlotTileContainer,ae=ne.name.length>8?ne.name.substring(0,7)+"...":ne.name;let le=ne.icon_file!=null?"voice_characters/"+ne.slot_index+"/"+ne.icon_file.split(/[\/\\]/).pop():"./assets/icons/human.png";le=R(le);const de=ne.icon_file!=null?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("img",{className:modelSlotTileIcon,src:le,alt:ne.name})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:modelSlotTileIconNoEntry,children:"no image"})}),me=async()=>{if(M=="edit"){w("error",S("reference_voice_area_select_voice_error_in_edit_mode"));return}if(!E.serverConfiguration){w("error",S("----1"));return}E.serverConfiguration.current_voice_charcter_slot_index=ne.slot_index,E.updateServerConfiguration(E.serverConfiguration)};return jsxRuntimeExports.jsxs("div",{className:oe,onClick:me,children:[jsxRuntimeExports.jsx("div",{className:modelSlotTileIconDiv,children:de}),jsxRuntimeExports.jsx("div",{className:modelSlotTileDscription,children:ae})]},re)}).filter(ne=>ne!=null):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),[E.serverVoiceCharacterSlotInfos,(ee=E.serverConfiguration)==null?void 0:ee.current_voice_charcter_slot_index,T,M]);return reactExports.useMemo(()=>{const ie=()=>{console.log("onModelSlotEditClicked"),x.setDialogName(DialogName.voiceCharacterManagerMainDialog)},ne=T=="slot"?`${button} ${buttonActive}`:`${button}`,re=T=="name"?`${button} ${buttonActive}`:`${button}`;return jsxRuntimeExports.jsxs("div",{className:modelSlotArea2,children:[jsxRuntimeExports.jsx("div",{className:modelSlotTitle,children:"Voice Character"}),jsxRuntimeExports.jsxs("div",{className:modelSlotPane,children:[jsxRuntimeExports.jsx("div",{className:modelSlotTilesContainer,children:D}),jsxRuntimeExports.jsxs("div",{className:buttons,children:[jsxRuntimeExports.jsxs("div",{className:buttonGroup,children:[jsxRuntimeExports.jsx("div",{className:ne,onClick:()=>{_("slot")},children:jsxRuntimeExports.jsx(FaSortNumericDown,{})}),jsxRuntimeExports.jsx("div",{className:re,onClick:()=>{_("name")},children:jsxRuntimeExports.jsx(FaSortAlphaDown,{})})]}),jsxRuntimeExports.jsx("div",{className:buttonGroup,children:jsxRuntimeExports.jsx("div",{className:button,onClick:ie,children:S("voice_character_slot_edit")})})]})]})]})},[D,T])},InferenceModeSelectArea=()=>{const{t:C}=useTranslation(),{setInferenceMode:E,inferenceMode:w}=useGuiState();return reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{className:inferenceModeSelectArea,children:[jsxRuntimeExports.jsx("div",{className:inferenceModeSelectAreaControl,children:jsxRuntimeExports.jsxs("div",{className:BasicLabel(),children:[C("inference_mode_select_area_mode_select"),":"]})}),jsxRuntimeExports.jsx("div",{className:inferenceModeSelectAreaField,children:jsxRuntimeExports.jsx("select",{onChange:M=>{const x=M.target.value;E(x)},value:w,children:Object.keys(InferenceMode).map(M=>{const x=InferenceModeLabel_i18nKey[M];return jsxRuntimeExports.jsx("option",{value:M,children:C(x)},M)})})})]}),[w])},FileDropArea=C=>{const{t:E}=useTranslation(),w=reactExports.useMemo(()=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{id:"inference-area-audio-drop-area",className:inferenceAreaFileDropArea,children:jsxRuntimeExports.jsx("p",{children:E("inference_area_fileupload_area_text")})}),jsxRuntimeExports.jsx("input",{type:"file",hidden:!0,id:"inference-area-audio-file-elem"})]}),[]),R=M=>{C.setSelectedFile(M[0])};return reactExports.useEffect(()=>{const M=document.getElementById("inference-area-audio-drop-area"),x=document.getElementById("inference-area-audio-file-elem");if(!M||!x)return;const S=ee=>{ee.preventDefault(),M.classList.add(inferenceAreaFileDropAreaDrag)},T=()=>{M.classList.remove(inferenceAreaFileDropAreaDrag)},_=ee=>{var ne;ee.preventDefault(),M.classList.remove(inferenceAreaFileDropAreaDrag);const ie=[...((ne=ee.dataTransfer)==null?void 0:ne.files)||[]];R(ie)},D=()=>{console.log("clicked"),x.click()},Y=ee=>{const ne=[...ee.target.files??[]];R(ne)};return M.addEventListener("dragover",S),M.addEventListener("dragleave",T),M.addEventListener("drop",_),M.addEventListener("click",D),x.addEventListener("change",Y),()=>{M.removeEventListener("dragover",S),M.removeEventListener("dragleave",T),M.removeEventListener("drop",_),M.removeEventListener("click",D),x.removeEventListener("change",Y)}},[R]),w},InferenceOptionsArea=()=>{var R;const{t:C}=useTranslation(),{serverConfigState:E}=useAppRoot();return reactExports.useMemo(()=>{if(!E.serverConfiguration)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(!E.serverSlotInfos)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const M=E.serverSlotInfos.find(S=>S.slot_index==E.serverConfiguration.current_slot_index);if(!M)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});const x=M;return jsxRuntimeExports.jsxs("div",{className:inferenceAreaOptionContainer,children:[jsxRuntimeExports.jsxs("div",{className:inferenceAreaControl,children:[jsxRuntimeExports.jsx("div",{className:BasicLabel(),children:jsxRuntimeExports.jsx("p",{children:C("inference_area_option_speed")})}),jsxRuntimeExports.jsx("input",{type:"range",min:.1,max:2,step:.1,value:x.length_adjust,onChange:S=>{x.length_adjust=parseFloat(S.target.value),E.updateServerSlotInfo(x)}}),jsxRuntimeExports.jsx("p",{children:x.length_adjust})]}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaControl,children:[jsxRuntimeExports.jsx("div",{className:BasicLabel(),children:jsxRuntimeExports.jsx("p",{children:C("inference_area_option_pitch")})}),jsxRuntimeExports.jsx("input",{type:"range",min:-24,max:24,step:1,value:x.semi_tone_shift,onChange:S=>{x.semi_tone_shift=parseInt(S.target.value),E.updateServerSlotInfo(x)}}),jsxRuntimeExports.jsx("p",{children:x.semi_tone_shift})]}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaControl,children:[jsxRuntimeExports.jsx("div",{className:BasicLabel(),children:jsxRuntimeExports.jsx("p",{children:C("inference_area_option_diffusion_steps")})}),jsxRuntimeExports.jsx("input",{type:"range",min:1,max:100,step:1,value:x.diffusion_steps,onChange:S=>{x.diffusion_steps=parseInt(S.target.value),E.updateServerSlotInfo(x)}}),jsxRuntimeExports.jsx("p",{children:x.diffusion_steps})]}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaControl,children:[jsxRuntimeExports.jsx("div",{className:BasicLabel(),children:jsxRuntimeExports.jsx("p",{children:C("inference_area_option_inference_cfg_rate")})}),jsxRuntimeExports.jsx("input",{type:"range",min:0,max:1,step:.1,value:x.inference_cfg_rate,onChange:S=>{x.inference_cfg_rate=parseFloat(S.target.value),E.updateServerSlotInfo(x)}}),jsxRuntimeExports.jsx("p",{children:x.inference_cfg_rate})]}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaControl,children:[jsxRuntimeExports.jsx("div",{className:BasicLabel(),children:jsxRuntimeExports.jsx("p",{children:C("inference_area_option_auto_f0_adjust")})}),jsxRuntimeExports.jsx("input",{type:"checkbox",checked:x.auto_f0_adjust,onChange:S=>{x.auto_f0_adjust=S.target.checked,E.updateServerSlotInfo(x)}}),jsxRuntimeExports.jsx("p",{children:x.auto_f0_adjust?C("enabled"):C("disabled")})]})]})},[E.serverConfiguration,(R=E.serverConfiguration)==null?void 0:R.current_slot_index,E.serverSlotInfos])},AUDIO_ELEMENT_FOR_INPUT_MEDIA="AUDIO_ELEMENT_FOR_INPUT_MEDIA",AUDIO_ELEMENT_FOR_INPUT_MEDIA_ECHOBACK="AUDIO_ELEMENT_FOR_INPUT_MEDIA_ECHOBACK",InputType={deviceId:"deviceId",file:"file",capture:"capture"},BrowserAudioDeviceAreaDeviceSelect=C=>{const{serverConfigState:E,audioConfigState:w}=useAppRoot(),{voiceChangerClientState:R}=useAppState(),{t:M}=useTranslation(),[x,S]=reactExports.useState(InputType.deviceId),T=reactExports.useMemo(()=>{const Y=ne=>{C.setDeviceId(ne.target.value)},ee=ne=>{C.setDeviceId(ne.target.value)},ie=ne=>{C.setDeviceId(ne.target.value)};if(C.type=="Input"){const ne=w.audioInputs.map(oe=>jsxRuntimeExports.jsx("option",{value:oe.deviceId,children:oe.label},oe.deviceId));C.enableFileInput==!0&&ne.push(jsxRuntimeExports.jsx("option",{value:"file",children:"file"},"file")),C.enableCaptureInput==!0&&ne.push(jsxRuntimeExports.jsx("option",{value:"capture",children:"system(only win)"},"capture"));let re;return x=="file"?re="file":x=="capture"?re="capture":typeof R.audioInput=="string"?re=R.audioInput:re="none",jsxRuntimeExports.jsx("select",{value:re,onChange:oe=>{oe.target.value!="file"&&oe.target.value!="capture"?(S(InputType.deviceId),Y(oe)):oe.target.value=="file"?S(InputType.file):oe.target.value=="capture"&&S(InputType.capture)},children:ne})}else if(C.type=="Output"){const ne=w.audioOutputs.map(re=>jsxRuntimeExports.jsx("option",{value:re.deviceId,children:re.label},re.deviceId));return jsxRuntimeExports.jsx("select",{value:C.currentDeviceId,onChange:re=>{ee(re)},children:ne})}else if(C.type=="Monitor"){const ne=w.audioOutputs.map(re=>jsxRuntimeExports.jsx("option",{value:re.deviceId,children:re.label},re.deviceId));return jsxRuntimeExports.jsx("select",{value:C.currentDeviceId,onChange:re=>{ie(re)},children:ne})}else return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})},[x,w.audioInputs,w.audioOutputs,R.audioInput,R.audioOutput,R.audioMonitor,C.currentDeviceId]),_=reactExports.useMemo(()=>{if(C.type=="Input")return M("config_area_audio_device_input");if(C.type=="Output")return M("config_area_audio_device_output");if(C.type=="Monitor")return M("config_area_audio_device_monitor")},[]);return reactExports.useMemo(()=>E?jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[jsxRuntimeExports.jsxs("div",{className:configSubAreaRow,children:[jsxRuntimeExports.jsxs("div",{className:`${configSubAreaRowTitle5}`,children:[_,":"]}),jsxRuntimeExports.jsx("div",{className:configSubAreaRowField14,children:T})]}),x=="file"&&jsxRuntimeExports.jsx(FileSelectRow,{ctx:w.audioContext,setMediaStream:C.setMediaStream}),x=="capture"&&jsxRuntimeExports.jsx("div",{className:configSubAreaRow,children:jsxRuntimeExports.jsx("div",{className:configSubAreaInputMediaContainer,children:jsxRuntimeExports.jsx(CaptureScreenButton,{setMediaStream:C.setMediaStream})})}),x=="deviceId"&&C.onStartClicked&&jsxRuntimeExports.jsx("div",{className:configSubAreaRow,children:jsxRuntimeExports.jsx("div",{className:configSubAreaInputMediaContainer,children:jsxRuntimeExports.jsx(StartButton,{onStartClicked:C.onStartClicked})})})]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),[T,E,x])},StartButton=C=>{const[E,w]=reactExports.useState(!1);return reactExports.useMemo(()=>{const M=async()=>{C.onStartClicked(!E),w(!E)},x=E?configSubAreaInputMediaCaptureButtonActive:configSubAreaInputMediaCaptureButton;return jsxRuntimeExports.jsx("div",{className:x,onClick:()=>{M()},children:"record"})},[E])},FileSelectRow=C=>{const E=reactExports.useRef(null),[w,R]=reactExports.useState(!1),{voiceChangerClientState:M}=useAppState();return reactExports.useEffect(()=>{(async()=>{const T=document.getElementById(AUDIO_ELEMENT_FOR_INPUT_MEDIA_ECHOBACK);if(T!=null)if(w?T.volume=1:T.volume=0,M.audioOutput!="none")try{await T.setSinkId(M.audioOutput)}catch(_){console.log("setSinkId is not supported?",_)}else T.volume=0})()},[w,M.audioOutput]),reactExports.useMemo(()=>{const S=async()=>{if(!C.ctx)return;const D=await fileSelectorAsDataURL(),Y=document.getElementById(AUDIO_ELEMENT_FOR_INPUT_MEDIA);Y.pause(),Y.srcObject=null,Y.src=D,await Y.play(),E.current||(E.current=C.ctx.createMediaElementSource(Y)),E.current.mediaElement!=Y&&(E.current=C.ctx.createMediaElementSource(Y));const ee=C.ctx.createMediaStreamDestination();E.current.connect(ee),C.setMediaStream(ee.stream);const ie=document.getElementById(AUDIO_ELEMENT_FOR_INPUT_MEDIA_ECHOBACK);ie.srcObject=ee.stream,ie.play(),ie.volume=0},T=()=>{R(!w)},_=w?configSubAreaInputMediaEchoButtonActive:configSubAreaInputMediaEchoButton;return jsxRuntimeExports.jsx("div",{className:configSubAreaRow,children:jsxRuntimeExports.jsxs("div",{className:configSubAreaInputMediaContainer,children:[jsxRuntimeExports.jsx("audio",{id:AUDIO_ELEMENT_FOR_INPUT_MEDIA,controls:!0,controlsList:"nodownload noplaybackrate",className:configSubAreaInputMedia}),jsxRuntimeExports.jsx("audio",{id:AUDIO_ELEMENT_FOR_INPUT_MEDIA_ECHOBACK,controls:!0,hidden:!0}),jsxRuntimeExports.jsx("img",{className:configSubAreaInputMediaFileSelectIcon,src:"./assets/icons/folder.svg",onClick:S}),jsxRuntimeExports.jsx("div",{className:_,onClick:()=>{T()},children:"echo"})]})})},[w])},CaptureScreenButton=C=>{const E=reactExports.useRef(null),[w,R]=reactExports.useState(!1);return reactExports.useMemo(()=>{const x=async()=>{if(E.current&&(E.current.getTracks().forEach(T=>{T.stop()}),E.current=null),w==!0){R(!1),C.setMediaStream(null);return}try{if(isDesktopApp()){const T={audio:{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop"}}};E.current=await navigator.mediaDevices.getUserMedia(T)}else E.current=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0})}catch(T){Logger$1.getLogger().info(T);return}if(!E.current){console.error("Capture failed, no media stream.");return}if(E.current.getAudioTracks().length==0){E.current.getTracks().forEach(T=>{T.stop()}),E.current=null,console.error("Capture failed, no audio track.");return}try{C.setMediaStream(E.current)}catch(T){console.error(T)}R(!0)},S=w?configSubAreaInputMediaCaptureButtonActive:configSubAreaInputMediaCaptureButton;return jsxRuntimeExports.jsx("div",{className:S,onClick:()=>{x()},children:"capture"})},[w])},FileInferenceArea=()=>{const{inferenceMode:C,setInputAudioFile:E,inputAudioFile:w,setOutputAudioFile:R,outputAudioFile:M}=useGuiState(),{serverConfigState:x,triggerToast:S}=useAppRoot(),{t:T}=useTranslation(),{setDialog2Name:_,setDialog2Props:D}=useGuiState(),[Y,ee]=reactExports.useState(""),[ie,ne]=reactExports.useState("");return reactExports.useEffect(()=>{if(Y){const oe=document.getElementById("inference-area-output-audio-player");Y=="none"?oe.volume=0:(oe.volume=1,oe.setSinkId(Y))}},[Y]),reactExports.useEffect(()=>{if(ie){const oe=document.getElementById("inference-area-monitor-audio-player");Y=="none"?oe.volume=0:(oe.volume=1,oe.setSinkId(ie))}},[ie]),reactExports.useEffect(()=>{const oe=document.getElementById("inference-area-input-audio-player");oe&&w&&(oe.src=URL.createObjectURL(w))},[w]),reactExports.useEffect(()=>{const oe=document.getElementById("inference-area-output-audio-player"),ae=document.getElementById("inference-area-monitor-audio-player");!oe||!ae||M&&(oe.src=URL.createObjectURL(M),ae.src=URL.createObjectURL(M))},[M]),reactExports.useMemo(()=>{const oe=de=>{E(de)},ae=async()=>{if(!w){S("error",T("error_no_audio_file_selected"));return}const de=await x.convertVoiceFile(w);if(!de){S("error",T("error_failed_to_convert_audio_file"));return}const me=new File([de],"converted.wav",{type:"audio/wav"});R(me)},le=()=>{if(!M)return;const de=document.createElement("a"),me=URL.createObjectURL(M);de.href=me,de.download="output.wav",document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(me)};return jsxRuntimeExports.jsxs("div",{className:inferenceArea,children:[jsxRuntimeExports.jsxs("div",{className:inferenceAreaInputArea,children:[jsxRuntimeExports.jsx("div",{className:inferenceAreaControl,children:jsxRuntimeExports.jsx(FileDropArea,{setSelectedFile:de=>{oe(de)}})}),jsxRuntimeExports.jsx("div",{className:inferenceAreaControl,children:jsxRuntimeExports.jsx("audio",{controls:!0,id:"inference-area-input-audio-player",className:inferenceAreaInputAudioPlayer})}),jsxRuntimeExports.jsx("div",{className:inferenceAreaControlRight,children:jsxRuntimeExports.jsx("div",{className:`${BasicButton({width:"large"})} ${normalButtonThema}`,onClick:async()=>{D({title:T("wait_dialog_title_generating"),instruction:`${T("wait_dialog_instruction_generating")}`,defaultValue:"",resolve:()=>{},options:null}),_("waitDialog"),await ae(),_("none")},children:T("inference_area_button_convert")})}),jsxRuntimeExports.jsx(InferenceOptionsArea,{})]}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaOutputArea,children:[jsxRuntimeExports.jsxs("div",{className:inferenceAreaOptionContainer,children:[jsxRuntimeExports.jsx(BrowserAudioDeviceAreaDeviceSelect,{type:"Output",currentDeviceId:Y,setDeviceId:de=>{ee(de)}}),jsxRuntimeExports.jsx("audio",{controls:!0,id:"inference-area-output-audio-player",className:inferenceAreaOutputAudioPlayer})]}),jsxRuntimeExports.jsx("div",{className:inferenceAreaControl}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaOptionContainer,children:[jsxRuntimeExports.jsx(BrowserAudioDeviceAreaDeviceSelect,{type:"Monitor",currentDeviceId:ie,setDeviceId:de=>{ne(de)}}),jsxRuntimeExports.jsx("audio",{controls:!0,id:"inference-area-monitor-audio-player",className:inferenceAreaOutputAudioPlayer})]}),jsxRuntimeExports.jsx("div",{className:inferenceAreaControlRight,children:jsxRuntimeExports.jsx("div",{className:`${BasicButton({width:"large"})} ${normalButtonThema}`,onClick:le,children:T("inference_area_button_download")})})]})]})},[C,w,M,Y,ie])},RecordInferenceArea=()=>{const{inferenceMode:C,setOutputAudioFile:E,outputAudioFile:w}=useGuiState(),{serverConfigState:R,triggerToast:M}=useAppRoot(),{voiceChangerClientState:x}=useAppState(),{t:S}=useTranslation(),{setDialog2Name:T,setDialog2Props:_}=useGuiState(),[D,Y]=reactExports.useState(""),[ee,ie]=reactExports.useState("");return reactExports.useEffect(()=>{console.log("Recording inference area initialized. stop client to sending data."),x.setSendDataStopped(!0)},[]),reactExports.useEffect(()=>{if(D){const re=document.getElementById("inference-area-output-audio-player");D=="none"?re.volume=0:(re.volume=1,re.setSinkId(D))}},[D]),reactExports.useEffect(()=>{if(ee){const re=document.getElementById("inference-area-monitor-audio-player");D=="none"?re.volume=0:(re.volume=1,re.setSinkId(ee))}},[ee]),reactExports.useEffect(()=>{const re=document.getElementById("inference-area-input-audio-player");re&&x.inputRecordBlob&&(console.log("inputAudioBlob",x.inputRecordBlob),re.src=URL.createObjectURL(x.inputRecordBlob))},[x.inputRecordBlob]),reactExports.useEffect(()=>{const re=document.getElementById("inference-area-output-audio-player"),oe=document.getElementById("inference-area-monitor-audio-player");!re||!oe||w&&(re.src=URL.createObjectURL(w),oe.src=URL.createObjectURL(w))},[w]),reactExports.useMemo(()=>{const re=async()=>{if(!x.inputRecordBlob){M("error",S("error_no_audio_file_selected"));return}let le;if(x.inputRecordBlob){const me=new File([x.inputRecordBlob],"input.wav",{type:"audio/wav"});if(le=await R.convertVoiceFile(me),!le){M("error",S("error_failed_to_convert_audio_file"));return}}if(!le){M("error",S("error_failed_to_convert_audio_file"));return}const de=new File([le],"converted.wav",{type:"audio/wav"});E(de)},oe=()=>{if(!w)return;const le=document.createElement("a"),de=URL.createObjectURL(w);le.href=de,le.download="output.wav",document.body.appendChild(le),le.click(),document.body.removeChild(le),URL.revokeObjectURL(de)};let ae;return typeof x.audioInput=="string"?ae=x.audioInput:ae="none",jsxRuntimeExports.jsxs("div",{className:inferenceArea,children:[jsxRuntimeExports.jsxs("div",{className:inferenceAreaInputArea,children:[jsxRuntimeExports.jsx("div",{className:inferenceAreaControl,children:jsxRuntimeExports.jsx(BrowserAudioDeviceAreaDeviceSelect,{type:"Input",currentDeviceId:ae,enableCaptureInput:!0,enableFileInput:!1,setDeviceId:le=>{x.setAudioInput(le)},setMediaStream:le=>{(async()=>{if(!le){x.stop(),x.setInputRecordingStarted(!1);return}x.setAudioInput(le),x.setInputRecordingStarted(!0),x.start()})()},onStartClicked:le=>{le?(x.start(),x.setInputRecordingStarted(!0),x.start()):(x.stop(),x.setInputRecordingStarted(!1))}})}),jsxRuntimeExports.jsx("div",{className:inferenceAreaControl,children:jsxRuntimeExports.jsx("audio",{controls:!0,id:"inference-area-input-audio-player",controlsList:"nodownload noplaybackrate",className:inferenceAreaInputAudioPlayer})}),jsxRuntimeExports.jsx("div",{className:inferenceAreaControlRight,children:jsxRuntimeExports.jsx("div",{className:`${BasicButton({width:"large"})} ${normalButtonThema}`,onClick:async()=>{_({title:S("wait_dialog_title_generating"),instruction:`${S("wait_dialog_instruction_generating")}`,defaultValue:"",resolve:()=>{},options:null}),T("waitDialog"),await re(),T("none")},children:S("inference_area_button_convert")})}),jsxRuntimeExports.jsx(InferenceOptionsArea,{})]}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaOutputArea,children:[jsxRuntimeExports.jsxs("div",{className:inferenceAreaOptionContainer,children:[jsxRuntimeExports.jsx(BrowserAudioDeviceAreaDeviceSelect,{type:"Output",currentDeviceId:D,setDeviceId:le=>{Y(le)}}),jsxRuntimeExports.jsx("audio",{controls:!0,id:"inference-area-output-audio-player",className:inferenceAreaOutputAudioPlayer})]}),jsxRuntimeExports.jsx("div",{className:inferenceAreaControl}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaOptionContainer,children:[jsxRuntimeExports.jsx(BrowserAudioDeviceAreaDeviceSelect,{type:"Monitor",currentDeviceId:ee,setDeviceId:le=>{ie(le)}}),jsxRuntimeExports.jsx("audio",{controls:!0,id:"inference-area-monitor-audio-player",className:inferenceAreaOutputAudioPlayer})]}),jsxRuntimeExports.jsx("div",{className:inferenceAreaControlRight,children:jsxRuntimeExports.jsx("div",{className:`${BasicButton({width:"large"})} ${normalButtonThema}`,onClick:oe,children:S("inference_area_button_download")})})]})]})},[C,w,D,ee,x.inputRecordBlob])},NearRealtimeInferenceArea=()=>{const{inferenceMode:C,inputAudioFile:E,outputAudioFile:w}=useGuiState(),{voiceChangerClientState:R}=useAppState(),{t:M}=useTranslation();return reactExports.useEffect(()=>{console.log("Near realtime inference area initialized. start client to sending data."),R.setSendDataStopped(!1)},[]),reactExports.useEffect(()=>{const S=document.getElementById("inference-area-input-audio-player");S&&E&&(S.src=URL.createObjectURL(E))},[E]),reactExports.useEffect(()=>{const S=document.getElementById("inference-area-output-audio-player"),T=document.getElementById("inference-area-monitor-audio-player");!S||!T||w&&(S.src=URL.createObjectURL(w),T.src=URL.createObjectURL(w))},[w]),reactExports.useMemo(()=>{let S;return typeof R.audioInput=="string"?S=R.audioInput:S="none",jsxRuntimeExports.jsxs("div",{className:inferenceArea,children:[jsxRuntimeExports.jsxs("div",{className:inferenceAreaInputArea,children:[jsxRuntimeExports.jsx("div",{className:inferenceAreaControl,children:jsxRuntimeExports.jsx(BrowserAudioDeviceAreaDeviceSelect,{type:"Input",currentDeviceId:S,enableCaptureInput:!0,enableFileInput:!0,setDeviceId:T=>{R.setAudioInput(T),R.setEnableNoiseSuppression(!0),R.setEnableEchoCancellation(!0),R.setEnableNoiseSuppression2(!0)},setMediaStream:T=>{T?R.setAudioInput(T):R.setAudioInput("none")}})}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaControlRight,children:[jsxRuntimeExports.jsx("div",{className:`${BasicButton({active:R.isStarted==!0})} ${normalButtonThema}`,onClick:async()=>{R.isStarted==!1&&R.start()},children:M("inference_area_button_start")}),jsxRuntimeExports.jsx("div",{className:`${BasicButton({active:R.isStarted==!1})} ${normalButtonThema}`,onClick:async()=>{R.isStarted==!0&&R.stop()},children:M("inference_area_button_stop")})]}),jsxRuntimeExports.jsx(InferenceOptionsArea,{})]}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaOutputArea,children:[jsxRuntimeExports.jsxs("div",{className:inferenceAreaOptionContainer,children:[jsxRuntimeExports.jsx(BrowserAudioDeviceAreaDeviceSelect,{type:"Output",currentDeviceId:R.audioOutput,setDeviceId:T=>{R.setAudioOutput(T),R.setAudioOutputElementId("inference-area-output-audio-player-near-realtime")}}),jsxRuntimeExports.jsx("audio",{controls:!0,id:"inference-area-output-audio-player-near-realtime",className:inferenceAreaOutputAudioPlayer})]}),jsxRuntimeExports.jsx("div",{className:inferenceAreaControl}),jsxRuntimeExports.jsxs("div",{className:inferenceAreaOptionContainer,children:[jsxRuntimeExports.jsx(BrowserAudioDeviceAreaDeviceSelect,{type:"Monitor",currentDeviceId:R.audioMonitor,setDeviceId:T=>{R.setAudioMonitor(T),R.setAudioMonitorElementId("inference-area-monitor-audio-player-near-realtime")}}),jsxRuntimeExports.jsx("audio",{controls:!0,id:"inference-area-monitor-audio-player-near-realtime",className:inferenceAreaOutputAudioPlayer})]})]})]})},[C,E,w,R.audioOutput,R.audioMonitor,R.inputRecordBlob,R.isStarted])},InferenceArea=()=>{const{inferenceMode:C}=useGuiState();return reactExports.useMemo(()=>C==="file"?jsxRuntimeExports.jsx(FileInferenceArea,{}):C==="record"?jsxRuntimeExports.jsx(RecordInferenceArea,{}):C==="near_realtime"?jsxRuntimeExports.jsx(NearRealtimeInferenceArea,{}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:"unknown"}),[C])},Demo=()=>{const{displayColorMode:C}=useAppState();return reactExports.useEffect(()=>{const E=C=="light"?lightTheme:darkTheme;document.body.className=E},[C]),jsxRuntimeExports.jsxs(GuiStateProvider,{children:[jsxRuntimeExports.jsx(Dialogs2,{}),jsxRuntimeExports.jsx(Dialogs,{}),jsxRuntimeExports.jsx(HeaderArea,{}),jsxRuntimeExports.jsx(ModelSlotArea,{}),jsxRuntimeExports.jsx("div",{className:spacer_h10px}),jsxRuntimeExports.jsx(VoiceCharacterSlotArea,{}),jsxRuntimeExports.jsx(CharacterArea,{}),jsxRuntimeExports.jsx(InferenceModeSelectArea,{}),jsxRuntimeExports.jsx(InferenceArea,{})]})},ErrorBoundaryContext=reactExports.createContext(null),initialState={didCatch:!1,error:null};class ErrorBoundary extends reactExports.Component{constructor(E){super(E),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=initialState}static getDerivedStateFromError(E){return{didCatch:!0,error:E}}resetErrorBoundary(){const{error:E}=this.state;if(E!==null){for(var w,R,M=arguments.length,x=new Array(M),S=0;S<M;S++)x[S]=arguments[S];(w=(R=this.props).onReset)===null||w===void 0||w.call(R,{args:x,reason:"imperative-api"}),this.setState(initialState)}}componentDidCatch(E,w){var R,M;(R=(M=this.props).onError)===null||R===void 0||R.call(M,E,w)}componentDidUpdate(E,w){const{didCatch:R}=this.state,{resetKeys:M}=this.props;if(R&&w.error!==null&&hasArrayChanged(E.resetKeys,M)){var x,S;(x=(S=this.props).onReset)===null||x===void 0||x.call(S,{next:M,prev:E.resetKeys,reason:"keys"}),this.setState(initialState)}}render(){const{children:E,fallbackRender:w,FallbackComponent:R,fallback:M}=this.props,{didCatch:x,error:S}=this.state;let T=E;if(x){const _={error:S,resetErrorBoundary:this.resetErrorBoundary};if(typeof w=="function")T=w(_);else if(R)T=reactExports.createElement(R,_);else if(M!==void 0)T=M;else throw S}return reactExports.createElement(ErrorBoundaryContext.Provider,{value:{didCatch:x,error:S,resetErrorBoundary:this.resetErrorBoundary}},T)}}function hasArrayChanged(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return C.length!==E.length||C.some((w,R)=>!Object.is(w,E[R]))}const isString=C=>typeof C=="string",defer=()=>{let C,E;const w=new Promise((R,M)=>{C=R,E=M});return w.resolve=C,w.reject=E,w},makeString=C=>C==null?"":""+C,copy=(C,E,w)=>{C.forEach(R=>{E[R]&&(w[R]=E[R])})},lastOfPathSeparatorRegExp=/###/g,cleanKey=C=>C&&C.indexOf("###")>-1?C.replace(lastOfPathSeparatorRegExp,"."):C,canNotTraverseDeeper=C=>!C||isString(C),getLastOfPath=(C,E,w)=>{const R=isString(E)?E.split("."):E;let M=0;for(;M<R.length-1;){if(canNotTraverseDeeper(C))return{};const x=cleanKey(R[M]);!C[x]&&w&&(C[x]=new w),Object.prototype.hasOwnProperty.call(C,x)?C=C[x]:C={},++M}return canNotTraverseDeeper(C)?{}:{obj:C,k:cleanKey(R[M])}},setPath=(C,E,w)=>{const{obj:R,k:M}=getLastOfPath(C,E,Object);if(R!==void 0||E.length===1){R[M]=w;return}let x=E[E.length-1],S=E.slice(0,E.length-1),T=getLastOfPath(C,S,Object);for(;T.obj===void 0&&S.length;)x=`${S[S.length-1]}.${x}`,S=S.slice(0,S.length-1),T=getLastOfPath(C,S,Object),T!=null&&T.obj&&typeof T.obj[`${T.k}.${x}`]<"u"&&(T.obj=void 0);T.obj[`${T.k}.${x}`]=w},pushPath=(C,E,w,R)=>{const{obj:M,k:x}=getLastOfPath(C,E,Object);M[x]=M[x]||[],M[x].push(w)},getPath=(C,E)=>{const{obj:w,k:R}=getLastOfPath(C,E);if(w&&Object.prototype.hasOwnProperty.call(w,R))return w[R]},getPathWithDefaults=(C,E,w)=>{const R=getPath(C,w);return R!==void 0?R:getPath(E,w)},deepExtend=(C,E,w)=>{for(const R in E)R!=="__proto__"&&R!=="constructor"&&(R in C?isString(C[R])||C[R]instanceof String||isString(E[R])||E[R]instanceof String?w&&(C[R]=E[R]):deepExtend(C[R],E[R],w):C[R]=E[R]);return C},regexEscape=C=>C.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const escape=C=>isString(C)?C.replace(/[&<>"'\/]/g,E=>_entityMap[E]):C;class RegExpCache{constructor(E){this.capacity=E,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(E){const w=this.regExpMap.get(E);if(w!==void 0)return w;const R=new RegExp(E);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(E,R),this.regExpQueue.push(E),R}}const chars=[" ",",","?","!",";"],looksLikeObjectPathRegExpCache=new RegExpCache(20),looksLikeObjectPath=(C,E,w)=>{E=E||"",w=w||"";const R=chars.filter(S=>E.indexOf(S)<0&&w.indexOf(S)<0);if(R.length===0)return!0;const M=looksLikeObjectPathRegExpCache.getRegExp(`(${R.map(S=>S==="?"?"\\?":S).join("|")})`);let x=!M.test(C);if(!x){const S=C.indexOf(w);S>0&&!M.test(C.substring(0,S))&&(x=!0)}return x},deepFind=function(C,E){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!C)return;if(C[E])return Object.prototype.hasOwnProperty.call(C,E)?C[E]:void 0;const R=E.split(w);let M=C;for(let x=0;x<R.length;){if(!M||typeof M!="object")return;let S,T="";for(let _=x;_<R.length;++_)if(_!==x&&(T+=w),T+=R[_],S=M[T],S!==void 0){if(["string","number","boolean"].indexOf(typeof S)>-1&&_<R.length-1)continue;x+=_-x+1;break}M=S}return M},getCleanedCode=C=>C==null?void 0:C.replace("_","-"),consoleLogger={type:"logger",log(C){this.output("log",C)},warn(C){this.output("warn",C)},error(C){this.output("error",C)},output(C,E){var w,R;(R=(w=console==null?void 0:console[C])==null?void 0:w.apply)==null||R.call(w,console,E)}};class Logger{constructor(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(E,w)}init(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=w.prefix||"i18next:",this.logger=E||consoleLogger,this.options=w,this.debug=w.debug}log(){for(var E=arguments.length,w=new Array(E),R=0;R<E;R++)w[R]=arguments[R];return this.forward(w,"log","",!0)}warn(){for(var E=arguments.length,w=new Array(E),R=0;R<E;R++)w[R]=arguments[R];return this.forward(w,"warn","",!0)}error(){for(var E=arguments.length,w=new Array(E),R=0;R<E;R++)w[R]=arguments[R];return this.forward(w,"error","")}deprecate(){for(var E=arguments.length,w=new Array(E),R=0;R<E;R++)w[R]=arguments[R];return this.forward(w,"warn","WARNING DEPRECATED: ",!0)}forward(E,w,R,M){return M&&!this.debug?null:(isString(E[0])&&(E[0]=`${R}${this.prefix} ${E[0]}`),this.logger[w](E))}create(E){return new Logger(this.logger,{prefix:`${this.prefix}:${E}:`,...this.options})}clone(E){return E=E||this.options,E.prefix=E.prefix||this.prefix,new Logger(this.logger,E)}}var baseLogger=new Logger;class EventEmitter{constructor(){this.observers={}}on(E,w){return E.split(" ").forEach(R=>{this.observers[R]||(this.observers[R]=new Map);const M=this.observers[R].get(w)||0;this.observers[R].set(w,M+1)}),this}off(E,w){if(this.observers[E]){if(!w){delete this.observers[E];return}this.observers[E].delete(w)}}emit(E){for(var w=arguments.length,R=new Array(w>1?w-1:0),M=1;M<w;M++)R[M-1]=arguments[M];this.observers[E]&&Array.from(this.observers[E].entries()).forEach(S=>{let[T,_]=S;for(let D=0;D<_;D++)T(...R)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(S=>{let[T,_]=S;for(let D=0;D<_;D++)T.apply(T,[E,...R])})}}class ResourceStore extends EventEmitter{constructor(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=E||{},this.options=w,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(E){this.options.ns.indexOf(E)<0&&this.options.ns.push(E)}removeNamespaces(E){const w=this.options.ns.indexOf(E);w>-1&&this.options.ns.splice(w,1)}getResource(E,w,R){var D,Y;let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const x=M.keySeparator!==void 0?M.keySeparator:this.options.keySeparator,S=M.ignoreJSONStructure!==void 0?M.ignoreJSONStructure:this.options.ignoreJSONStructure;let T;E.indexOf(".")>-1?T=E.split("."):(T=[E,w],R&&(Array.isArray(R)?T.push(...R):isString(R)&&x?T.push(...R.split(x)):T.push(R)));const _=getPath(this.data,T);return!_&&!w&&!R&&E.indexOf(".")>-1&&(E=T[0],w=T[1],R=T.slice(2).join(".")),_||!S||!isString(R)?_:deepFind((Y=(D=this.data)==null?void 0:D[E])==null?void 0:Y[w],R,x)}addResource(E,w,R,M){let x=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const S=x.keySeparator!==void 0?x.keySeparator:this.options.keySeparator;let T=[E,w];R&&(T=T.concat(S?R.split(S):R)),E.indexOf(".")>-1&&(T=E.split("."),M=w,w=T[1]),this.addNamespaces(w),setPath(this.data,T,M),x.silent||this.emit("added",E,w,R,M)}addResources(E,w,R){let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const x in R)(isString(R[x])||Array.isArray(R[x]))&&this.addResource(E,w,x,R[x],{silent:!0});M.silent||this.emit("added",E,w,R)}addResourceBundle(E,w,R,M,x){let S=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},T=[E,w];E.indexOf(".")>-1&&(T=E.split("."),M=R,R=w,w=T[1]),this.addNamespaces(w);let _=getPath(this.data,T)||{};S.skipCopy||(R=JSON.parse(JSON.stringify(R))),M?deepExtend(_,R,x):_={..._,...R},setPath(this.data,T,_),S.silent||this.emit("added",E,w,R)}removeResourceBundle(E,w){this.hasResourceBundle(E,w)&&delete this.data[E][w],this.removeNamespaces(w),this.emit("removed",E,w)}hasResourceBundle(E,w){return this.getResource(E,w)!==void 0}getResourceBundle(E,w){return w||(w=this.options.defaultNS),this.getResource(E,w)}getDataByLanguage(E){return this.data[E]}hasLanguageSomeTranslations(E){const w=this.getDataByLanguage(E);return!!(w&&Object.keys(w)||[]).find(M=>w[M]&&Object.keys(w[M]).length>0)}toJSON(){return this.data}}var postProcessor={processors:{},addPostProcessor(C){this.processors[C.name]=C},handle(C,E,w,R,M){return C.forEach(x=>{var S;E=((S=this.processors[x])==null?void 0:S.process(E,w,R,M))??E}),E}};const checkedLoadedFor={},shouldHandleAsObject=C=>!isString(C)&&typeof C!="boolean"&&typeof C!="number";class Translator extends EventEmitter{constructor(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],E,this),this.options=w,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=baseLogger.create("translator")}changeLanguage(E){E&&(this.language=E)}exists(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(E==null)return!1;const R=this.resolve(E,w);return(R==null?void 0:R.res)!==void 0}extractFromKey(E,w){let R=w.nsSeparator!==void 0?w.nsSeparator:this.options.nsSeparator;R===void 0&&(R=":");const M=w.keySeparator!==void 0?w.keySeparator:this.options.keySeparator;let x=w.ns||this.options.defaultNS||[];const S=R&&E.indexOf(R)>-1,T=!this.options.userDefinedKeySeparator&&!w.keySeparator&&!this.options.userDefinedNsSeparator&&!w.nsSeparator&&!looksLikeObjectPath(E,R,M);if(S&&!T){const _=E.match(this.interpolator.nestingRegexp);if(_&&_.length>0)return{key:E,namespaces:isString(x)?[x]:x};const D=E.split(R);(R!==M||R===M&&this.options.ns.indexOf(D[0])>-1)&&(x=D.shift()),E=D.join(M)}return{key:E,namespaces:isString(x)?[x]:x}}translate(E,w,R){if(typeof w!="object"&&this.options.overloadTranslationOptionHandler&&(w=this.options.overloadTranslationOptionHandler(arguments)),typeof w=="object"&&(w={...w}),w||(w={}),E==null)return"";Array.isArray(E)||(E=[String(E)]);const M=w.returnDetails!==void 0?w.returnDetails:this.options.returnDetails,x=w.keySeparator!==void 0?w.keySeparator:this.options.keySeparator,{key:S,namespaces:T}=this.extractFromKey(E[E.length-1],w),_=T[T.length-1],D=w.lng||this.language,Y=w.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((D==null?void 0:D.toLowerCase())==="cimode"){if(Y){const Ae=w.nsSeparator||this.options.nsSeparator;return M?{res:`${_}${Ae}${S}`,usedKey:S,exactUsedKey:S,usedLng:D,usedNS:_,usedParams:this.getUsedParamsDetails(w)}:`${_}${Ae}${S}`}return M?{res:S,usedKey:S,exactUsedKey:S,usedLng:D,usedNS:_,usedParams:this.getUsedParamsDetails(w)}:S}const ee=this.resolve(E,w);let ie=ee==null?void 0:ee.res;const ne=(ee==null?void 0:ee.usedKey)||S,re=(ee==null?void 0:ee.exactUsedKey)||S,oe=["[object Number]","[object Function]","[object RegExp]"],ae=w.joinArrays!==void 0?w.joinArrays:this.options.joinArrays,le=!this.i18nFormat||this.i18nFormat.handleAsObject,de=w.count!==void 0&&!isString(w.count),me=Translator.hasDefaultValue(w),fe=de?this.pluralResolver.getSuffix(D,w.count,w):"",ge=w.ordinal&&de?this.pluralResolver.getSuffix(D,w.count,{ordinal:!1}):"",he=de&&!w.ordinal&&w.count===0,ve=he&&w[`defaultValue${this.options.pluralSeparator}zero`]||w[`defaultValue${fe}`]||w[`defaultValue${ge}`]||w.defaultValue;let be=ie;le&&!ie&&me&&(be=ve);const Se=shouldHandleAsObject(be),Re=Object.prototype.toString.apply(be);if(le&&be&&Se&&oe.indexOf(Re)<0&&!(isString(ae)&&Array.isArray(be))){if(!w.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const Ae=this.options.returnedObjectHandler?this.options.returnedObjectHandler(ne,be,{...w,ns:T}):`key '${S} (${this.language})' returned an object instead of string.`;return M?(ee.res=Ae,ee.usedParams=this.getUsedParamsDetails(w),ee):Ae}if(x){const Ae=Array.isArray(be),Me=Ae?[]:{},Be=Ae?re:ne;for(const Qe in be)if(Object.prototype.hasOwnProperty.call(be,Qe)){const Pe=`${Be}${x}${Qe}`;me&&!ie?Me[Qe]=this.translate(Pe,{...w,defaultValue:shouldHandleAsObject(ve)?ve[Qe]:void 0,joinArrays:!1,ns:T}):Me[Qe]=this.translate(Pe,{...w,joinArrays:!1,ns:T}),Me[Qe]===Pe&&(Me[Qe]=be[Qe])}ie=Me}}else if(le&&isString(ae)&&Array.isArray(ie))ie=ie.join(ae),ie&&(ie=this.extendTranslation(ie,E,w,R));else{let Ae=!1,Me=!1;!this.isValidLookup(ie)&&me&&(Ae=!0,ie=ve),this.isValidLookup(ie)||(Me=!0,ie=S);const Qe=(w.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&Me?void 0:ie,Pe=me&&ve!==ie&&this.options.updateMissing;if(Me||Ae||Pe){if(this.logger.log(Pe?"updateKey":"missingKey",D,_,S,Pe?ve:ie),x){const zt=this.resolve(S,{...w,keySeparator:!1});zt&&zt.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let je=[];const Dt=this.languageUtils.getFallbackCodes(this.options.fallbackLng,w.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Dt&&Dt[0])for(let zt=0;zt<Dt.length;zt++)je.push(Dt[zt]);else this.options.saveMissingTo==="all"?je=this.languageUtils.toResolveHierarchy(w.lng||this.language):je.push(w.lng||this.language);const Xe=(zt,xe,$e)=>{var He;const We=me&&$e!==ie?$e:Qe;this.options.missingKeyHandler?this.options.missingKeyHandler(zt,_,xe,We,Pe,w):(He=this.backendConnector)!=null&&He.saveMissing&&this.backendConnector.saveMissing(zt,_,xe,We,Pe,w),this.emit("missingKey",zt,_,xe,ie)};this.options.saveMissing&&(this.options.saveMissingPlurals&&de?je.forEach(zt=>{const xe=this.pluralResolver.getSuffixes(zt,w);he&&w[`defaultValue${this.options.pluralSeparator}zero`]&&xe.indexOf(`${this.options.pluralSeparator}zero`)<0&&xe.push(`${this.options.pluralSeparator}zero`),xe.forEach($e=>{Xe([zt],S+$e,w[`defaultValue${$e}`]||ve)})}):Xe(je,S,ve))}ie=this.extendTranslation(ie,E,w,ee,R),Me&&ie===S&&this.options.appendNamespaceToMissingKey&&(ie=`${_}:${S}`),(Me||Ae)&&this.options.parseMissingKeyHandler&&(ie=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${_}:${S}`:S,Ae?ie:void 0))}return M?(ee.res=ie,ee.usedParams=this.getUsedParamsDetails(w),ee):ie}extendTranslation(E,w,R,M,x){var D,Y;var S=this;if((D=this.i18nFormat)!=null&&D.parse)E=this.i18nFormat.parse(E,{...this.options.interpolation.defaultVariables,...R},R.lng||this.language||M.usedLng,M.usedNS,M.usedKey,{resolved:M});else if(!R.skipInterpolation){R.interpolation&&this.interpolator.init({...R,interpolation:{...this.options.interpolation,...R.interpolation}});const ee=isString(E)&&(((Y=R==null?void 0:R.interpolation)==null?void 0:Y.skipOnVariables)!==void 0?R.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let ie;if(ee){const re=E.match(this.interpolator.nestingRegexp);ie=re&&re.length}let ne=R.replace&&!isString(R.replace)?R.replace:R;if(this.options.interpolation.defaultVariables&&(ne={...this.options.interpolation.defaultVariables,...ne}),E=this.interpolator.interpolate(E,ne,R.lng||this.language||M.usedLng,R),ee){const re=E.match(this.interpolator.nestingRegexp),oe=re&&re.length;ie<oe&&(R.nest=!1)}!R.lng&&M&&M.res&&(R.lng=this.language||M.usedLng),R.nest!==!1&&(E=this.interpolator.nest(E,function(){for(var re=arguments.length,oe=new Array(re),ae=0;ae<re;ae++)oe[ae]=arguments[ae];return(x==null?void 0:x[0])===oe[0]&&!R.context?(S.logger.warn(`It seems you are nesting recursively key: ${oe[0]} in key: ${w[0]}`),null):S.translate(...oe,w)},R)),R.interpolation&&this.interpolator.reset()}const T=R.postProcess||this.options.postProcess,_=isString(T)?[T]:T;return E!=null&&(_!=null&&_.length)&&R.applyPostProcessor!==!1&&(E=postProcessor.handle(_,E,w,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...M,usedParams:this.getUsedParamsDetails(R)},...R}:R,this)),E}resolve(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R,M,x,S,T;return isString(E)&&(E=[E]),E.forEach(_=>{if(this.isValidLookup(R))return;const D=this.extractFromKey(_,w),Y=D.key;M=Y;let ee=D.namespaces;this.options.fallbackNS&&(ee=ee.concat(this.options.fallbackNS));const ie=w.count!==void 0&&!isString(w.count),ne=ie&&!w.ordinal&&w.count===0,re=w.context!==void 0&&(isString(w.context)||typeof w.context=="number")&&w.context!=="",oe=w.lngs?w.lngs:this.languageUtils.toResolveHierarchy(w.lng||this.language,w.fallbackLng);ee.forEach(ae=>{var le,de;this.isValidLookup(R)||(T=ae,!checkedLoadedFor[`${oe[0]}-${ae}`]&&((le=this.utils)!=null&&le.hasLoadedNamespace)&&!((de=this.utils)!=null&&de.hasLoadedNamespace(T))&&(checkedLoadedFor[`${oe[0]}-${ae}`]=!0,this.logger.warn(`key "${M}" for languages "${oe.join(", ")}" won't get resolved as namespace "${T}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),oe.forEach(me=>{var he;if(this.isValidLookup(R))return;S=me;const fe=[Y];if((he=this.i18nFormat)!=null&&he.addLookupKeys)this.i18nFormat.addLookupKeys(fe,Y,me,ae,w);else{let ve;ie&&(ve=this.pluralResolver.getSuffix(me,w.count,w));const be=`${this.options.pluralSeparator}zero`,Se=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(ie&&(fe.push(Y+ve),w.ordinal&&ve.indexOf(Se)===0&&fe.push(Y+ve.replace(Se,this.options.pluralSeparator)),ne&&fe.push(Y+be)),re){const Re=`${Y}${this.options.contextSeparator}${w.context}`;fe.push(Re),ie&&(fe.push(Re+ve),w.ordinal&&ve.indexOf(Se)===0&&fe.push(Re+ve.replace(Se,this.options.pluralSeparator)),ne&&fe.push(Re+be))}}let ge;for(;ge=fe.pop();)this.isValidLookup(R)||(x=ge,R=this.getResource(me,ae,ge,w))}))})}),{res:R,usedKey:M,exactUsedKey:x,usedLng:S,usedNS:T}}isValidLookup(E){return E!==void 0&&!(!this.options.returnNull&&E===null)&&!(!this.options.returnEmptyString&&E==="")}getResource(E,w,R){var x;let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(x=this.i18nFormat)!=null&&x.getResource?this.i18nFormat.getResource(E,w,R,M):this.resourceStore.getResource(E,w,R,M)}getUsedParamsDetails(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const w=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],R=E.replace&&!isString(E.replace);let M=R?E.replace:E;if(R&&typeof E.count<"u"&&(M.count=E.count),this.options.interpolation.defaultVariables&&(M={...this.options.interpolation.defaultVariables,...M}),!R){M={...M};for(const x of w)delete M[x]}return M}static hasDefaultValue(E){const w="defaultValue";for(const R in E)if(Object.prototype.hasOwnProperty.call(E,R)&&w===R.substring(0,w.length)&&E[R]!==void 0)return!0;return!1}}class LanguageUtil{constructor(E){this.options=E,this.supportedLngs=this.options.supportedLngs||!1,this.logger=baseLogger.create("languageUtils")}getScriptPartFromCode(E){if(E=getCleanedCode(E),!E||E.indexOf("-")<0)return null;const w=E.split("-");return w.length===2||(w.pop(),w[w.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(w.join("-"))}getLanguagePartFromCode(E){if(E=getCleanedCode(E),!E||E.indexOf("-")<0)return E;const w=E.split("-");return this.formatLanguageCode(w[0])}formatLanguageCode(E){if(isString(E)&&E.indexOf("-")>-1){let w;try{w=Intl.getCanonicalLocales(E)[0]}catch{}return w&&this.options.lowerCaseLng&&(w=w.toLowerCase()),w||(this.options.lowerCaseLng?E.toLowerCase():E)}return this.options.cleanCode||this.options.lowerCaseLng?E.toLowerCase():E}isSupportedCode(E){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(E=this.getLanguagePartFromCode(E)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(E)>-1}getBestMatchFromCodes(E){if(!E)return null;let w;return E.forEach(R=>{if(w)return;const M=this.formatLanguageCode(R);(!this.options.supportedLngs||this.isSupportedCode(M))&&(w=M)}),!w&&this.options.supportedLngs&&E.forEach(R=>{if(w)return;const M=this.getLanguagePartFromCode(R);if(this.isSupportedCode(M))return w=M;w=this.options.supportedLngs.find(x=>{if(x===M)return x;if(!(x.indexOf("-")<0&&M.indexOf("-")<0)&&(x.indexOf("-")>0&&M.indexOf("-")<0&&x.substring(0,x.indexOf("-"))===M||x.indexOf(M)===0&&M.length>1))return x})}),w||(w=this.getFallbackCodes(this.options.fallbackLng)[0]),w}getFallbackCodes(E,w){if(!E)return[];if(typeof E=="function"&&(E=E(w)),isString(E)&&(E=[E]),Array.isArray(E))return E;if(!w)return E.default||[];let R=E[w];return R||(R=E[this.getScriptPartFromCode(w)]),R||(R=E[this.formatLanguageCode(w)]),R||(R=E[this.getLanguagePartFromCode(w)]),R||(R=E.default),R||[]}toResolveHierarchy(E,w){const R=this.getFallbackCodes(w||this.options.fallbackLng||[],E),M=[],x=S=>{S&&(this.isSupportedCode(S)?M.push(S):this.logger.warn(`rejecting language code not found in supportedLngs: ${S}`))};return isString(E)&&(E.indexOf("-")>-1||E.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&x(this.formatLanguageCode(E)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&x(this.getScriptPartFromCode(E)),this.options.load!=="currentOnly"&&x(this.getLanguagePartFromCode(E))):isString(E)&&x(this.formatLanguageCode(E)),R.forEach(S=>{M.indexOf(S)<0&&x(this.formatLanguageCode(S))}),M}}const suffixesOrder={zero:0,one:1,two:2,few:3,many:4,other:5},dummyRule={select:C=>C===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class PluralResolver{constructor(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=E,this.options=w,this.logger=baseLogger.create("pluralResolver"),this.pluralRulesCache={}}addRule(E,w){this.rules[E]=w}clearCache(){this.pluralRulesCache={}}getRule(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const R=getCleanedCode(E==="dev"?"en":E),M=w.ordinal?"ordinal":"cardinal",x=JSON.stringify({cleanedCode:R,type:M});if(x in this.pluralRulesCache)return this.pluralRulesCache[x];let S;try{S=new Intl.PluralRules(R,{type:M})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),dummyRule;if(!E.match(/-|_/))return dummyRule;const _=this.languageUtils.getLanguagePartFromCode(E);S=this.getRule(_,w)}return this.pluralRulesCache[x]=S,S}needsPlural(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=this.getRule(E,w);return R||(R=this.getRule("dev",w)),(R==null?void 0:R.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(E,w){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(E,R).map(M=>`${w}${M}`)}getSuffixes(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=this.getRule(E,w);return R||(R=this.getRule("dev",w)),R?R.resolvedOptions().pluralCategories.sort((M,x)=>suffixesOrder[M]-suffixesOrder[x]).map(M=>`${this.options.prepend}${w.ordinal?`ordinal${this.options.prepend}`:""}${M}`):[]}getSuffix(E,w){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const M=this.getRule(E,R);return M?`${this.options.prepend}${R.ordinal?`ordinal${this.options.prepend}`:""}${M.select(w)}`:(this.logger.warn(`no plural rule found for: ${E}`),this.getSuffix("dev",w,R))}}const deepFindWithDefaults=function(C,E,w){let R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,x=getPathWithDefaults(C,E,w);return!x&&M&&isString(w)&&(x=deepFind(C,w,R),x===void 0&&(x=deepFind(E,w,R))),x},regexSafe=C=>C.replace(/\$/g,"$$$$");class Interpolator{constructor(){var w;let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("interpolator"),this.options=E,this.format=((w=E==null?void 0:E.interpolation)==null?void 0:w.format)||(R=>R),this.init(E)}init(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};E.interpolation||(E.interpolation={escapeValue:!0});const{escape:w,escapeValue:R,useRawValueToEscape:M,prefix:x,prefixEscaped:S,suffix:T,suffixEscaped:_,formatSeparator:D,unescapeSuffix:Y,unescapePrefix:ee,nestingPrefix:ie,nestingPrefixEscaped:ne,nestingSuffix:re,nestingSuffixEscaped:oe,nestingOptionsSeparator:ae,maxReplaces:le,alwaysFormat:de}=E.interpolation;this.escape=w!==void 0?w:escape,this.escapeValue=R!==void 0?R:!0,this.useRawValueToEscape=M!==void 0?M:!1,this.prefix=x?regexEscape(x):S||"{{",this.suffix=T?regexEscape(T):_||"}}",this.formatSeparator=D||",",this.unescapePrefix=Y?"":ee||"-",this.unescapeSuffix=this.unescapePrefix?"":Y||"",this.nestingPrefix=ie?regexEscape(ie):ne||regexEscape("$t("),this.nestingSuffix=re?regexEscape(re):oe||regexEscape(")"),this.nestingOptionsSeparator=ae||",",this.maxReplaces=le||1e3,this.alwaysFormat=de!==void 0?de:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const E=(w,R)=>(w==null?void 0:w.source)===R?(w.lastIndex=0,w):new RegExp(R,"g");this.regexp=E(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=E(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=E(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(E,w,R,M){var ne;let x,S,T;const _=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},D=re=>{if(re.indexOf(this.formatSeparator)<0){const de=deepFindWithDefaults(w,_,re,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(de,void 0,R,{...M,...w,interpolationkey:re}):de}const oe=re.split(this.formatSeparator),ae=oe.shift().trim(),le=oe.join(this.formatSeparator).trim();return this.format(deepFindWithDefaults(w,_,ae,this.options.keySeparator,this.options.ignoreJSONStructure),le,R,{...M,...w,interpolationkey:ae})};this.resetRegExp();const Y=(M==null?void 0:M.missingInterpolationHandler)||this.options.missingInterpolationHandler,ee=((ne=M==null?void 0:M.interpolation)==null?void 0:ne.skipOnVariables)!==void 0?M.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:re=>regexSafe(re)},{regex:this.regexp,safeValue:re=>this.escapeValue?regexSafe(this.escape(re)):regexSafe(re)}].forEach(re=>{for(T=0;x=re.regex.exec(E);){const oe=x[1].trim();if(S=D(oe),S===void 0)if(typeof Y=="function"){const le=Y(E,x,M);S=isString(le)?le:""}else if(M&&Object.prototype.hasOwnProperty.call(M,oe))S="";else if(ee){S=x[0];continue}else this.logger.warn(`missed to pass in variable ${oe} for interpolating ${E}`),S="";else!isString(S)&&!this.useRawValueToEscape&&(S=makeString(S));const ae=re.safeValue(S);if(E=E.replace(x[0],ae),ee?(re.regex.lastIndex+=S.length,re.regex.lastIndex-=x[0].length):re.regex.lastIndex=0,T++,T>=this.maxReplaces)break}}),E}nest(E,w){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},M,x,S;const T=(_,D)=>{const Y=this.nestingOptionsSeparator;if(_.indexOf(Y)<0)return _;const ee=_.split(new RegExp(`${Y}[ ]*{`));let ie=`{${ee[1]}`;_=ee[0],ie=this.interpolate(ie,S);const ne=ie.match(/'/g),re=ie.match(/"/g);(((ne==null?void 0:ne.length)??0)%2===0&&!re||re.length%2!==0)&&(ie=ie.replace(/'/g,'"'));try{S=JSON.parse(ie),D&&(S={...D,...S})}catch(oe){return this.logger.warn(`failed parsing options string in nesting for key ${_}`,oe),`${_}${Y}${ie}`}return S.defaultValue&&S.defaultValue.indexOf(this.prefix)>-1&&delete S.defaultValue,_};for(;M=this.nestingRegexp.exec(E);){let _=[];S={...R},S=S.replace&&!isString(S.replace)?S.replace:S,S.applyPostProcessor=!1,delete S.defaultValue;let D=!1;if(M[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(M[1])){const Y=M[1].split(this.formatSeparator).map(ee=>ee.trim());M[1]=Y.shift(),_=Y,D=!0}if(x=w(T.call(this,M[1].trim(),S),S),x&&M[0]===E&&!isString(x))return x;isString(x)||(x=makeString(x)),x||(this.logger.warn(`missed to resolve ${M[1]} for nesting ${E}`),x=""),D&&(x=_.reduce((Y,ee)=>this.format(Y,ee,R.lng,{...R,interpolationkey:M[1].trim()}),x.trim())),E=E.replace(M[0],x),this.regexp.lastIndex=0}return E}}const parseFormatStr=C=>{let E=C.toLowerCase().trim();const w={};if(C.indexOf("(")>-1){const R=C.split("(");E=R[0].toLowerCase().trim();const M=R[1].substring(0,R[1].length-1);E==="currency"&&M.indexOf(":")<0?w.currency||(w.currency=M.trim()):E==="relativetime"&&M.indexOf(":")<0?w.range||(w.range=M.trim()):M.split(";").forEach(S=>{if(S){const[T,..._]=S.split(":"),D=_.join(":").trim().replace(/^'+|'+$/g,""),Y=T.trim();w[Y]||(w[Y]=D),D==="false"&&(w[Y]=!1),D==="true"&&(w[Y]=!0),isNaN(D)||(w[Y]=parseInt(D,10))}})}return{formatName:E,formatOptions:w}},createCachedFormatter=C=>{const E={};return(w,R,M)=>{let x=M;M&&M.interpolationkey&&M.formatParams&&M.formatParams[M.interpolationkey]&&M[M.interpolationkey]&&(x={...x,[M.interpolationkey]:void 0});const S=R+JSON.stringify(x);let T=E[S];return T||(T=C(getCleanedCode(R),M),E[S]=T),T(w)}};class Formatter{constructor(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("formatter"),this.options=E,this.formats={number:createCachedFormatter((w,R)=>{const M=new Intl.NumberFormat(w,{...R});return x=>M.format(x)}),currency:createCachedFormatter((w,R)=>{const M=new Intl.NumberFormat(w,{...R,style:"currency"});return x=>M.format(x)}),datetime:createCachedFormatter((w,R)=>{const M=new Intl.DateTimeFormat(w,{...R});return x=>M.format(x)}),relativetime:createCachedFormatter((w,R)=>{const M=new Intl.RelativeTimeFormat(w,{...R});return x=>M.format(x,R.range||"day")}),list:createCachedFormatter((w,R)=>{const M=new Intl.ListFormat(w,{...R});return x=>M.format(x)})},this.init(E)}init(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=w.interpolation.formatSeparator||","}add(E,w){this.formats[E.toLowerCase().trim()]=w}addCached(E,w){this.formats[E.toLowerCase().trim()]=createCachedFormatter(w)}format(E,w,R){let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const x=w.split(this.formatSeparator);if(x.length>1&&x[0].indexOf("(")>1&&x[0].indexOf(")")<0&&x.find(T=>T.indexOf(")")>-1)){const T=x.findIndex(_=>_.indexOf(")")>-1);x[0]=[x[0],...x.splice(1,T)].join(this.formatSeparator)}return x.reduce((T,_)=>{var ee;const{formatName:D,formatOptions:Y}=parseFormatStr(_);if(this.formats[D]){let ie=T;try{const ne=((ee=M==null?void 0:M.formatParams)==null?void 0:ee[M.interpolationkey])||{},re=ne.locale||ne.lng||M.locale||M.lng||R;ie=this.formats[D](T,re,{...Y,...M,...ne})}catch(ne){this.logger.warn(ne)}return ie}else this.logger.warn(`there was no format function for ${D}`);return T},E)}}const removePending=(C,E)=>{C.pending[E]!==void 0&&(delete C.pending[E],C.pendingCount--)};class Connector extends EventEmitter{constructor(E,w,R){var x,S;let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=E,this.store=w,this.services=R,this.languageUtils=R.languageUtils,this.options=M,this.logger=baseLogger.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=M.maxParallelReads||10,this.readingCalls=0,this.maxRetries=M.maxRetries>=0?M.maxRetries:5,this.retryTimeout=M.retryTimeout>=1?M.retryTimeout:350,this.state={},this.queue=[],(S=(x=this.backend)==null?void 0:x.init)==null||S.call(x,R,M.backend,M)}queueLoad(E,w,R,M){const x={},S={},T={},_={};return E.forEach(D=>{let Y=!0;w.forEach(ee=>{const ie=`${D}|${ee}`;!R.reload&&this.store.hasResourceBundle(D,ee)?this.state[ie]=2:this.state[ie]<0||(this.state[ie]===1?S[ie]===void 0&&(S[ie]=!0):(this.state[ie]=1,Y=!1,S[ie]===void 0&&(S[ie]=!0),x[ie]===void 0&&(x[ie]=!0),_[ee]===void 0&&(_[ee]=!0)))}),Y||(T[D]=!0)}),(Object.keys(x).length||Object.keys(S).length)&&this.queue.push({pending:S,pendingCount:Object.keys(S).length,loaded:{},errors:[],callback:M}),{toLoad:Object.keys(x),pending:Object.keys(S),toLoadLanguages:Object.keys(T),toLoadNamespaces:Object.keys(_)}}loaded(E,w,R){const M=E.split("|"),x=M[0],S=M[1];w&&this.emit("failedLoading",x,S,w),!w&&R&&this.store.addResourceBundle(x,S,R,void 0,void 0,{skipCopy:!0}),this.state[E]=w?-1:2,w&&R&&(this.state[E]=0);const T={};this.queue.forEach(_=>{pushPath(_.loaded,[x],S),removePending(_,E),w&&_.errors.push(w),_.pendingCount===0&&!_.done&&(Object.keys(_.loaded).forEach(D=>{T[D]||(T[D]={});const Y=_.loaded[D];Y.length&&Y.forEach(ee=>{T[D][ee]===void 0&&(T[D][ee]=!0)})}),_.done=!0,_.errors.length?_.callback(_.errors):_.callback())}),this.emit("loaded",T),this.queue=this.queue.filter(_=>!_.done)}read(E,w,R){let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,x=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,S=arguments.length>5?arguments[5]:void 0;if(!E.length)return S(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:E,ns:w,fcName:R,tried:M,wait:x,callback:S});return}this.readingCalls++;const T=(D,Y)=>{if(this.readingCalls--,this.waitingReads.length>0){const ee=this.waitingReads.shift();this.read(ee.lng,ee.ns,ee.fcName,ee.tried,ee.wait,ee.callback)}if(D&&Y&&M<this.maxRetries){setTimeout(()=>{this.read.call(this,E,w,R,M+1,x*2,S)},x);return}S(D,Y)},_=this.backend[R].bind(this.backend);if(_.length===2){try{const D=_(E,w);D&&typeof D.then=="function"?D.then(Y=>T(null,Y)).catch(T):T(null,D)}catch(D){T(D)}return}return _(E,w,T)}prepareLoading(E,w){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},M=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),M&&M();isString(E)&&(E=this.languageUtils.toResolveHierarchy(E)),isString(w)&&(w=[w]);const x=this.queueLoad(E,w,R,M);if(!x.toLoad.length)return x.pending.length||M(),null;x.toLoad.forEach(S=>{this.loadOne(S)})}load(E,w,R){this.prepareLoading(E,w,{},R)}reload(E,w,R){this.prepareLoading(E,w,{reload:!0},R)}loadOne(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const R=E.split("|"),M=R[0],x=R[1];this.read(M,x,"read",void 0,void 0,(S,T)=>{S&&this.logger.warn(`${w}loading namespace ${x} for language ${M} failed`,S),!S&&T&&this.logger.log(`${w}loaded namespace ${x} for language ${M}`,T),this.loaded(E,S,T)})}saveMissing(E,w,R,M,x){var _,D,Y,ee,ie;let S=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},T=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((D=(_=this.services)==null?void 0:_.utils)!=null&&D.hasLoadedNamespace&&!((ee=(Y=this.services)==null?void 0:Y.utils)!=null&&ee.hasLoadedNamespace(w))){this.logger.warn(`did not save key "${R}" as the namespace "${w}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(R==null||R==="")){if((ie=this.backend)!=null&&ie.create){const ne={...S,isUpdate:x},re=this.backend.create.bind(this.backend);if(re.length<6)try{let oe;re.length===5?oe=re(E,w,R,M,ne):oe=re(E,w,R,M),oe&&typeof oe.then=="function"?oe.then(ae=>T(null,ae)).catch(T):T(null,oe)}catch(oe){T(oe)}else re(E,w,R,M,T,ne)}!E||!E[0]||this.store.addResource(E[0],w,R,M)}}}const get=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:C=>{let E={};if(typeof C[1]=="object"&&(E=C[1]),isString(C[1])&&(E.defaultValue=C[1]),isString(C[2])&&(E.tDescription=C[2]),typeof C[2]=="object"||typeof C[3]=="object"){const w=C[3]||C[2];Object.keys(w).forEach(R=>{E[R]=w[R]})}return E},interpolation:{escapeValue:!0,format:C=>C,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),transformOptions=C=>{var E,w;return isString(C.ns)&&(C.ns=[C.ns]),isString(C.fallbackLng)&&(C.fallbackLng=[C.fallbackLng]),isString(C.fallbackNS)&&(C.fallbackNS=[C.fallbackNS]),((w=(E=C.supportedLngs)==null?void 0:E.indexOf)==null?void 0:w.call(E,"cimode"))<0&&(C.supportedLngs=C.supportedLngs.concat(["cimode"])),typeof C.initImmediate=="boolean"&&(C.initAsync=C.initImmediate),C},noop=()=>{},bindMemberFunctions=C=>{Object.getOwnPropertyNames(Object.getPrototypeOf(C)).forEach(w=>{typeof C[w]=="function"&&(C[w]=C[w].bind(C))})};class I18n extends EventEmitter{constructor(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=arguments.length>1?arguments[1]:void 0;if(super(),this.options=transformOptions(E),this.services={},this.logger=baseLogger,this.modules={external:[]},bindMemberFunctions(this),w&&!this.isInitialized&&!E.isClone){if(!this.options.initAsync)return this.init(E,w),this;setTimeout(()=>{this.init(E,w)},0)}}init(){var E=this;let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},R=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof w=="function"&&(R=w,w={}),w.defaultNS==null&&w.ns&&(isString(w.ns)?w.defaultNS=w.ns:w.ns.indexOf("translation")<0&&(w.defaultNS=w.ns[0]));const M=get();this.options={...M,...this.options,...transformOptions(w)},this.options.interpolation={...M.interpolation,...this.options.interpolation},w.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=w.keySeparator),w.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=w.nsSeparator);const x=Y=>Y?typeof Y=="function"?new Y:Y:null;if(!this.options.isClone){this.modules.logger?baseLogger.init(x(this.modules.logger),this.options):baseLogger.init(null,this.options);let Y;this.modules.formatter?Y=this.modules.formatter:Y=Formatter;const ee=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);const ie=this.services;ie.logger=baseLogger,ie.resourceStore=this.store,ie.languageUtils=ee,ie.pluralResolver=new PluralResolver(ee,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),Y&&(!this.options.interpolation.format||this.options.interpolation.format===M.interpolation.format)&&(ie.formatter=x(Y),ie.formatter.init(ie,this.options),this.options.interpolation.format=ie.formatter.format.bind(ie.formatter)),ie.interpolator=new Interpolator(this.options),ie.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},ie.backendConnector=new Connector(x(this.modules.backend),ie.resourceStore,ie,this.options),ie.backendConnector.on("*",function(ne){for(var re=arguments.length,oe=new Array(re>1?re-1:0),ae=1;ae<re;ae++)oe[ae-1]=arguments[ae];E.emit(ne,...oe)}),this.modules.languageDetector&&(ie.languageDetector=x(this.modules.languageDetector),ie.languageDetector.init&&ie.languageDetector.init(ie,this.options.detection,this.options)),this.modules.i18nFormat&&(ie.i18nFormat=x(this.modules.i18nFormat),ie.i18nFormat.init&&ie.i18nFormat.init(this)),this.translator=new Translator(this.services,this.options),this.translator.on("*",function(ne){for(var re=arguments.length,oe=new Array(re>1?re-1:0),ae=1;ae<re;ae++)oe[ae-1]=arguments[ae];E.emit(ne,...oe)}),this.modules.external.forEach(ne=>{ne.init&&ne.init(this)})}if(this.format=this.options.interpolation.format,R||(R=noop),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const Y=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);Y.length>0&&Y[0]!=="dev"&&(this.options.lng=Y[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(Y=>{this[Y]=function(){return E.store[Y](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(Y=>{this[Y]=function(){return E.store[Y](...arguments),E}});const _=defer(),D=()=>{const Y=(ee,ie)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),_.resolve(ie),R(ee,ie)};if(this.languages&&!this.isInitialized)return Y(null,this.t.bind(this));this.changeLanguage(this.options.lng,Y)};return this.options.resources||!this.options.initAsync?D():setTimeout(D,0),_}loadResources(E){var x,S;let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop;const M=isString(E)?E:this.language;if(typeof E=="function"&&(R=E),!this.options.resources||this.options.partialBundledLanguages){if((M==null?void 0:M.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return R();const T=[],_=D=>{if(!D||D==="cimode")return;this.services.languageUtils.toResolveHierarchy(D).forEach(ee=>{ee!=="cimode"&&T.indexOf(ee)<0&&T.push(ee)})};M?_(M):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(Y=>_(Y)),(S=(x=this.options.preload)==null?void 0:x.forEach)==null||S.call(x,D=>_(D)),this.services.backendConnector.load(T,this.options.ns,D=>{!D&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),R(D)})}else R(null)}reloadResources(E,w,R){const M=defer();return typeof E=="function"&&(R=E,E=void 0),typeof w=="function"&&(R=w,w=void 0),E||(E=this.languages),w||(w=this.options.ns),R||(R=noop),this.services.backendConnector.reload(E,w,x=>{M.resolve(),R(x)}),M}use(E){if(!E)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!E.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return E.type==="backend"&&(this.modules.backend=E),(E.type==="logger"||E.log&&E.warn&&E.error)&&(this.modules.logger=E),E.type==="languageDetector"&&(this.modules.languageDetector=E),E.type==="i18nFormat"&&(this.modules.i18nFormat=E),E.type==="postProcessor"&&postProcessor.addPostProcessor(E),E.type==="formatter"&&(this.modules.formatter=E),E.type==="3rdParty"&&this.modules.external.push(E),this}setResolvedLanguage(E){if(!(!E||!this.languages)&&!(["cimode","dev"].indexOf(E)>-1))for(let w=0;w<this.languages.length;w++){const R=this.languages[w];if(!(["cimode","dev"].indexOf(R)>-1)&&this.store.hasLanguageSomeTranslations(R)){this.resolvedLanguage=R;break}}}changeLanguage(E,w){var R=this;this.isLanguageChangingTo=E;const M=defer();this.emit("languageChanging",E);const x=_=>{this.language=_,this.languages=this.services.languageUtils.toResolveHierarchy(_),this.resolvedLanguage=void 0,this.setResolvedLanguage(_)},S=(_,D)=>{D?(x(D),this.translator.changeLanguage(D),this.isLanguageChangingTo=void 0,this.emit("languageChanged",D),this.logger.log("languageChanged",D)):this.isLanguageChangingTo=void 0,M.resolve(function(){return R.t(...arguments)}),w&&w(_,function(){return R.t(...arguments)})},T=_=>{var Y,ee;!E&&!_&&this.services.languageDetector&&(_=[]);const D=isString(_)?_:this.services.languageUtils.getBestMatchFromCodes(_);D&&(this.language||x(D),this.translator.language||this.translator.changeLanguage(D),(ee=(Y=this.services.languageDetector)==null?void 0:Y.cacheUserLanguage)==null||ee.call(Y,D)),this.loadResources(D,ie=>{S(ie,D)})};return!E&&this.services.languageDetector&&!this.services.languageDetector.async?T(this.services.languageDetector.detect()):!E&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(T):this.services.languageDetector.detect(T):T(E),M}getFixedT(E,w,R){var M=this;const x=function(S,T){let _;if(typeof T!="object"){for(var D=arguments.length,Y=new Array(D>2?D-2:0),ee=2;ee<D;ee++)Y[ee-2]=arguments[ee];_=M.options.overloadTranslationOptionHandler([S,T].concat(Y))}else _={...T};_.lng=_.lng||x.lng,_.lngs=_.lngs||x.lngs,_.ns=_.ns||x.ns,_.keyPrefix!==""&&(_.keyPrefix=_.keyPrefix||R||x.keyPrefix);const ie=M.options.keySeparator||".";let ne;return _.keyPrefix&&Array.isArray(S)?ne=S.map(re=>`${_.keyPrefix}${ie}${re}`):ne=_.keyPrefix?`${_.keyPrefix}${ie}${S}`:S,M.t(ne,_)};return isString(E)?x.lng=E:x.lngs=E,x.ns=w,x.keyPrefix=R,x}t(){var M;for(var E=arguments.length,w=new Array(E),R=0;R<E;R++)w[R]=arguments[R];return(M=this.translator)==null?void 0:M.translate(...w)}exists(){var M;for(var E=arguments.length,w=new Array(E),R=0;R<E;R++)w[R]=arguments[R];return(M=this.translator)==null?void 0:M.exists(...w)}setDefaultNamespace(E){this.options.defaultNS=E}hasLoadedNamespace(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const R=w.lng||this.resolvedLanguage||this.languages[0],M=this.options?this.options.fallbackLng:!1,x=this.languages[this.languages.length-1];if(R.toLowerCase()==="cimode")return!0;const S=(T,_)=>{const D=this.services.backendConnector.state[`${T}|${_}`];return D===-1||D===0||D===2};if(w.precheck){const T=w.precheck(this,S);if(T!==void 0)return T}return!!(this.hasResourceBundle(R,E)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||S(R,E)&&(!M||S(x,E)))}loadNamespaces(E,w){const R=defer();return this.options.ns?(isString(E)&&(E=[E]),E.forEach(M=>{this.options.ns.indexOf(M)<0&&this.options.ns.push(M)}),this.loadResources(M=>{R.resolve(),w&&w(M)}),R):(w&&w(),Promise.resolve())}loadLanguages(E,w){const R=defer();isString(E)&&(E=[E]);const M=this.options.preload||[],x=E.filter(S=>M.indexOf(S)<0&&this.services.languageUtils.isSupportedCode(S));return x.length?(this.options.preload=M.concat(x),this.loadResources(S=>{R.resolve(),w&&w(S)}),R):(w&&w(),Promise.resolve())}dir(E){var M,x;if(E||(E=this.resolvedLanguage||(((M=this.languages)==null?void 0:M.length)>0?this.languages[0]:this.language)),!E)return"rtl";const w=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],R=((x=this.services)==null?void 0:x.languageUtils)||new LanguageUtil(get());return w.indexOf(R.getLanguagePartFromCode(E))>-1||E.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=arguments.length>1?arguments[1]:void 0;return new I18n(E,w)}cloneInstance(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop;const R=E.forkResourceStore;R&&delete E.forkResourceStore;const M={...this.options,...E,isClone:!0},x=new I18n(M);if((E.debug!==void 0||E.prefix!==void 0)&&(x.logger=x.logger.clone(E)),["store","services","language"].forEach(T=>{x[T]=this[T]}),x.services={...this.services},x.services.utils={hasLoadedNamespace:x.hasLoadedNamespace.bind(x)},R){const T=Object.keys(this.store.data).reduce((_,D)=>(_[D]={...this.store.data[D]},Object.keys(_[D]).reduce((Y,ee)=>(Y[ee]={..._[D][ee]},Y),{})),{});x.store=new ResourceStore(T,M),x.services.resourceStore=x.store}return x.translator=new Translator(x.services,M),x.translator.on("*",function(T){for(var _=arguments.length,D=new Array(_>1?_-1:0),Y=1;Y<_;Y++)D[Y-1]=arguments[Y];x.emit(T,...D)}),x.init(M,w),x.translator.options=M,x.translator.backendConnector.services.utils={hasLoadedNamespace:x.hasLoadedNamespace.bind(x)},x}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const instance=I18n.createInstance();instance.createInstance=I18n.createInstance;instance.createInstance;instance.dir;instance.init;instance.loadResources;instance.reloadResources;instance.use;instance.changeLanguage;instance.getFixedT;instance.t;instance.exists;instance.setDefaultNamespace;instance.hasLoadedNamespace;instance.loadNamespaces;instance.loadLanguages;const{slice,forEach}=[];function defaults(C){return forEach.call(slice.call(arguments,1),E=>{if(E)for(const w in E)C[w]===void 0&&(C[w]=E[w])}),C}const fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,serializeCookie=function(C,E){const R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},M=encodeURIComponent(E);let x=`${C}=${M}`;if(R.maxAge>0){const S=R.maxAge-0;if(Number.isNaN(S))throw new Error("maxAge should be a Number");x+=`; Max-Age=${Math.floor(S)}`}if(R.domain){if(!fieldContentRegExp.test(R.domain))throw new TypeError("option domain is invalid");x+=`; Domain=${R.domain}`}if(R.path){if(!fieldContentRegExp.test(R.path))throw new TypeError("option path is invalid");x+=`; Path=${R.path}`}if(R.expires){if(typeof R.expires.toUTCString!="function")throw new TypeError("option expires is invalid");x+=`; Expires=${R.expires.toUTCString()}`}if(R.httpOnly&&(x+="; HttpOnly"),R.secure&&(x+="; Secure"),R.sameSite)switch(typeof R.sameSite=="string"?R.sameSite.toLowerCase():R.sameSite){case!0:x+="; SameSite=Strict";break;case"lax":x+="; SameSite=Lax";break;case"strict":x+="; SameSite=Strict";break;case"none":x+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return x},cookie={create(C,E,w,R){let M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};w&&(M.expires=new Date,M.expires.setTime(M.expires.getTime()+w*60*1e3)),R&&(M.domain=R),document.cookie=serializeCookie(C,encodeURIComponent(E),M)},read(C){const E=`${C}=`,w=document.cookie.split(";");for(let R=0;R<w.length;R++){let M=w[R];for(;M.charAt(0)===" ";)M=M.substring(1,M.length);if(M.indexOf(E)===0)return M.substring(E.length,M.length)}return null},remove(C){this.create(C,"",-1)}};var cookie$1={name:"cookie",lookup(C){let{lookupCookie:E}=C;if(E&&typeof document<"u")return cookie.read(E)||void 0},cacheUserLanguage(C,E){let{lookupCookie:w,cookieMinutes:R,cookieDomain:M,cookieOptions:x}=E;w&&typeof document<"u"&&cookie.create(w,C,R,M,x)}},querystring={name:"querystring",lookup(C){var R;let{lookupQuerystring:E}=C,w;if(typeof window<"u"){let{search:M}=window.location;!window.location.search&&((R=window.location.hash)==null?void 0:R.indexOf("?"))>-1&&(M=window.location.hash.substring(window.location.hash.indexOf("?")));const S=M.substring(1).split("&");for(let T=0;T<S.length;T++){const _=S[T].indexOf("=");_>0&&S[T].substring(0,_)===E&&(w=S[T].substring(_+1))}}return w}};let hasLocalStorageSupport=null;const localStorageAvailable=()=>{if(hasLocalStorageSupport!==null)return hasLocalStorageSupport;try{hasLocalStorageSupport=window!=="undefined"&&window.localStorage!==null;const C="i18next.translate.boo";window.localStorage.setItem(C,"foo"),window.localStorage.removeItem(C)}catch{hasLocalStorageSupport=!1}return hasLocalStorageSupport};var localStorage={name:"localStorage",lookup(C){let{lookupLocalStorage:E}=C;if(E&&localStorageAvailable())return window.localStorage.getItem(E)||void 0},cacheUserLanguage(C,E){let{lookupLocalStorage:w}=E;w&&localStorageAvailable()&&window.localStorage.setItem(w,C)}};let hasSessionStorageSupport=null;const sessionStorageAvailable=()=>{if(hasSessionStorageSupport!==null)return hasSessionStorageSupport;try{hasSessionStorageSupport=window!=="undefined"&&window.sessionStorage!==null;const C="i18next.translate.boo";window.sessionStorage.setItem(C,"foo"),window.sessionStorage.removeItem(C)}catch{hasSessionStorageSupport=!1}return hasSessionStorageSupport};var sessionStorage={name:"sessionStorage",lookup(C){let{lookupSessionStorage:E}=C;if(E&&sessionStorageAvailable())return window.sessionStorage.getItem(E)||void 0},cacheUserLanguage(C,E){let{lookupSessionStorage:w}=E;w&&sessionStorageAvailable()&&window.sessionStorage.setItem(w,C)}},navigator$1={name:"navigator",lookup(C){const E=[];if(typeof navigator<"u"){const{languages:w,userLanguage:R,language:M}=navigator;if(w)for(let x=0;x<w.length;x++)E.push(w[x]);R&&E.push(R),M&&E.push(M)}return E.length>0?E:void 0}},htmlTag={name:"htmlTag",lookup(C){let{htmlTag:E}=C,w;const R=E||(typeof document<"u"?document.documentElement:null);return R&&typeof R.getAttribute=="function"&&(w=R.getAttribute("lang")),w}},path={name:"path",lookup(C){var M;let{lookupFromPathIndex:E}=C;if(typeof window>"u")return;const w=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(w)?(M=w[typeof E=="number"?E:0])==null?void 0:M.replace("/",""):void 0}},subdomain={name:"subdomain",lookup(C){var M,x;let{lookupFromSubdomainIndex:E}=C;const w=typeof E=="number"?E+1:1,R=typeof window<"u"&&((x=(M=window.location)==null?void 0:M.hostname)==null?void 0:x.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(R)return R[w]}};let canCookies=!1;try{document.cookie,canCookies=!0}catch(C){}const order=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];canCookies||order.splice(1,1);const getDefaults$1=()=>({order,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:C=>C});class Browser{constructor(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(E,w)}init(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=E,this.options=defaults(w,this.options||{},getDefaults$1()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=M=>M.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=R,this.addDetector(cookie$1),this.addDetector(querystring),this.addDetector(localStorage),this.addDetector(sessionStorage),this.addDetector(navigator$1),this.addDetector(htmlTag),this.addDetector(path),this.addDetector(subdomain)}addDetector(E){return this.detectors[E.name]=E,this}detect(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,w=[];return E.forEach(R=>{if(this.detectors[R]){let M=this.detectors[R].lookup(this.options);M&&typeof M=="string"&&(M=[M]),M&&(w=w.concat(M))}}),w=w.map(R=>this.options.convertDetectedLanguage(R)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?w:w.length>0?w[0]:null}cacheUserLanguage(E){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;w&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(E)>-1||w.forEach(R=>{this.detectors[R]&&this.detectors[R].cacheUserLanguage(E,this.options)}))}}Browser.type="languageDetector";function _typeof$2(C){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},_typeof$2(C)}function hasXMLHttpRequest(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":_typeof$2(XMLHttpRequest))==="object"}function isPromise(C){return!!C&&typeof C.then=="function"}function makePromise(C){return isPromise(C)?C:Promise.resolve(C)}const scriptRel="modulepreload",assetsURL=function(C){return"/"+C},seen={},__vitePreload=function C(E,w,R){let M=Promise.resolve();if(w&&w.length>0){document.getElementsByTagName("link");const S=document.querySelector("meta[property=csp-nonce]"),T=(S==null?void 0:S.nonce)||(S==null?void 0:S.getAttribute("nonce"));M=Promise.allSettled(w.map(_=>{if(_=assetsURL(_),_ in seen)return;seen[_]=!0;const D=_.endsWith(".css"),Y=D?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${Y}`))return;const ee=document.createElement("link");if(ee.rel=D?"stylesheet":scriptRel,D||(ee.as="script"),ee.crossOrigin="",ee.href=_,T&&ee.setAttribute("nonce",T),document.head.appendChild(ee),D)return new Promise((ie,ne)=>{ee.addEventListener("load",ie),ee.addEventListener("error",()=>ne(new Error(`Unable to preload CSS for ${_}`)))})}))}function x(S){const T=new Event("vite:preloadError",{cancelable:!0});if(T.payload=S,window.dispatchEvent(T),!T.defaultPrevented)throw S}return M.then(S=>{for(const T of S||[])T.status==="rejected"&&x(T.reason);return E().catch(x)})};function ownKeys$1(C,E){var w=Object.keys(C);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(C);E&&(R=R.filter(function(M){return Object.getOwnPropertyDescriptor(C,M).enumerable})),w.push.apply(w,R)}return w}function _objectSpread$1(C){for(var E=1;E<arguments.length;E++){var w=arguments[E]!=null?arguments[E]:{};E%2?ownKeys$1(Object(w),!0).forEach(function(R){_defineProperty$1(C,R,w[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(w)):ownKeys$1(Object(w)).forEach(function(R){Object.defineProperty(C,R,Object.getOwnPropertyDescriptor(w,R))})}return C}function _defineProperty$1(C,E,w){return(E=_toPropertyKey$1(E))in C?Object.defineProperty(C,E,{value:w,enumerable:!0,configurable:!0,writable:!0}):C[E]=w,C}function _toPropertyKey$1(C){var E=_toPrimitive$1(C,"string");return _typeof$1(E)=="symbol"?E:E+""}function _toPrimitive$1(C,E){if(_typeof$1(C)!="object"||!C)return C;var w=C[Symbol.toPrimitive];if(w!==void 0){var R=w.call(C,E||"default");if(_typeof$1(R)!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(C)}function _typeof$1(C){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},_typeof$1(C)}var fetchApi=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?fetchApi=global.fetch:typeof window<"u"&&window.fetch&&(fetchApi=window.fetch);var XmlHttpRequestApi;hasXMLHttpRequest()&&(typeof global<"u"&&global.XMLHttpRequest?XmlHttpRequestApi=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(XmlHttpRequestApi=window.XMLHttpRequest));var ActiveXObjectApi;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?ActiveXObjectApi=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(ActiveXObjectApi=window.ActiveXObject));typeof fetchApi!="function"&&(fetchApi=void 0);if(!fetchApi&&!XmlHttpRequestApi&&!ActiveXObjectApi)try{__vitePreload(()=>import("./browser-ponyfill-9vflgRxD.js").then(C=>C.b),[]).then(function(C){fetchApi=C.default}).catch(function(){})}catch{}var addQueryString=function C(E,w){if(w&&_typeof$1(w)==="object"){var R="";for(var M in w)R+="&"+encodeURIComponent(M)+"="+encodeURIComponent(w[M]);if(!R)return E;E=E+(E.indexOf("?")!==-1?"&":"?")+R.slice(1)}return E},fetchIt=function C(E,w,R,M){var x=function(_){if(!_.ok)return R(_.statusText||"Error",{status:_.status});_.text().then(function(D){R(null,{status:_.status,data:D})}).catch(R)};if(M){var S=M(E,w);if(S instanceof Promise){S.then(x).catch(R);return}}typeof fetch=="function"?fetch(E,w).then(x).catch(R):fetchApi(E,w).then(x).catch(R)},omitFetchOptions=!1,requestWithFetch=function C(E,w,R,M){E.queryStringParams&&(w=addQueryString(w,E.queryStringParams));var x=_objectSpread$1({},typeof E.customHeaders=="function"?E.customHeaders():E.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(x["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),R&&(x["Content-Type"]="application/json");var S=typeof E.requestOptions=="function"?E.requestOptions(R):E.requestOptions,T=_objectSpread$1({method:R?"POST":"GET",body:R?E.stringify(R):void 0,headers:x},omitFetchOptions?{}:S),_=typeof E.alternateFetch=="function"&&E.alternateFetch.length>=1?E.alternateFetch:void 0;try{fetchIt(w,T,M,_)}catch(D){if(!S||Object.keys(S).length===0||!D.message||D.message.indexOf("not implemented")<0)return M(D);try{Object.keys(S).forEach(function(Y){delete T[Y]}),fetchIt(w,T,M,_),omitFetchOptions=!0}catch(Y){M(Y)}}},requestWithXmlHttpRequest=function C(E,w,R,M){R&&_typeof$1(R)==="object"&&(R=addQueryString("",R).slice(1)),E.queryStringParams&&(w=addQueryString(w,E.queryStringParams));try{var x=XmlHttpRequestApi?new XmlHttpRequestApi:new ActiveXObjectApi("MSXML2.XMLHTTP.3.0");x.open(R?"POST":"GET",w,1),E.crossDomain||x.setRequestHeader("X-Requested-With","XMLHttpRequest"),x.withCredentials=!!E.withCredentials,R&&x.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),x.overrideMimeType&&x.overrideMimeType("application/json");var S=E.customHeaders;if(S=typeof S=="function"?S():S,S)for(var T in S)x.setRequestHeader(T,S[T]);x.onreadystatechange=function(){x.readyState>3&&M(x.status>=400?x.statusText:null,{status:x.status,data:x.responseText})},x.send(R)}catch(_){console&&console.log(_)}},request=function C(E,w,R,M){if(typeof R=="function"&&(M=R,R=void 0),M=M||function(){},fetchApi&&w.indexOf("file:")!==0)return requestWithFetch(E,w,R,M);if(hasXMLHttpRequest()||typeof ActiveXObject=="function")return requestWithXmlHttpRequest(E,w,R,M);M(new Error("No fetch and no xhr implementation found!"))};function _typeof(C){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},_typeof(C)}function ownKeys(C,E){var w=Object.keys(C);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(C);E&&(R=R.filter(function(M){return Object.getOwnPropertyDescriptor(C,M).enumerable})),w.push.apply(w,R)}return w}function _objectSpread(C){for(var E=1;E<arguments.length;E++){var w=arguments[E]!=null?arguments[E]:{};E%2?ownKeys(Object(w),!0).forEach(function(R){_defineProperty(C,R,w[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(w)):ownKeys(Object(w)).forEach(function(R){Object.defineProperty(C,R,Object.getOwnPropertyDescriptor(w,R))})}return C}function _classCallCheck(C,E){if(!(C instanceof E))throw new TypeError("Cannot call a class as a function")}function _defineProperties(C,E){for(var w=0;w<E.length;w++){var R=E[w];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(C,_toPropertyKey(R.key),R)}}function _createClass(C,E,w){return E&&_defineProperties(C.prototype,E),Object.defineProperty(C,"prototype",{writable:!1}),C}function _defineProperty(C,E,w){return(E=_toPropertyKey(E))in C?Object.defineProperty(C,E,{value:w,enumerable:!0,configurable:!0,writable:!0}):C[E]=w,C}function _toPropertyKey(C){var E=_toPrimitive(C,"string");return _typeof(E)=="symbol"?E:E+""}function _toPrimitive(C,E){if(_typeof(C)!="object"||!C)return C;var w=C[Symbol.toPrimitive];if(w!==void 0){var R=w.call(C,E||"default");if(_typeof(R)!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(C)}var getDefaults=function C(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(w){return JSON.parse(w)},stringify:JSON.stringify,parsePayload:function(w,R,M){return _defineProperty({},R,M||"")},parseLoadPayload:function(w,R){},request,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},Backend=function(){function C(E){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};_classCallCheck(this,C),this.services=E,this.options=w,this.allOptions=R,this.type="backend",this.init(E,w,R)}return _createClass(C,[{key:"init",value:function(w){var R=this,M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=w,this.options=_objectSpread(_objectSpread(_objectSpread({},getDefaults()),this.options||{}),M),this.allOptions=x,this.services&&this.options.reloadInterval){var S=setInterval(function(){return R.reload()},this.options.reloadInterval);_typeof(S)==="object"&&typeof S.unref=="function"&&S.unref()}}},{key:"readMulti",value:function(w,R,M){this._readAny(w,w,R,R,M)}},{key:"read",value:function(w,R,M){this._readAny([w],w,[R],R,M)}},{key:"_readAny",value:function(w,R,M,x,S){var T=this,_=this.options.loadPath;typeof this.options.loadPath=="function"&&(_=this.options.loadPath(w,M)),_=makePromise(_),_.then(function(D){if(!D)return S(null,{});var Y=T.services.interpolator.interpolate(D,{lng:w.join("+"),ns:M.join("+")});T.loadUrl(Y,S,R,x)})}},{key:"loadUrl",value:function(w,R,M,x){var S=this,T=typeof M=="string"?[M]:M,_=typeof x=="string"?[x]:x,D=this.options.parseLoadPayload(T,_);this.options.request(this.options,w,D,function(Y,ee){if(ee&&(ee.status>=500&&ee.status<600||!ee.status))return R("failed loading "+w+"; status code: "+ee.status,!0);if(ee&&ee.status>=400&&ee.status<500)return R("failed loading "+w+"; status code: "+ee.status,!1);if(!ee&&Y&&Y.message){var ie=Y.message.toLowerCase(),ne=["failed","fetch","network","load"].find(function(ae){return ie.indexOf(ae)>-1});if(ne)return R("failed loading "+w+": "+Y.message,!0)}if(Y)return R(Y,!1);var re,oe;try{typeof ee.data=="string"?re=S.options.parse(ee.data,M,x):re=ee.data}catch{oe="failed parsing "+w+" to json"}if(oe)return R(oe,!1);R(null,re)})}},{key:"create",value:function(w,R,M,x,S){var T=this;if(this.options.addPath){typeof w=="string"&&(w=[w]);var _=this.options.parsePayload(R,M,x),D=0,Y=[],ee=[];w.forEach(function(ie){var ne=T.options.addPath;typeof T.options.addPath=="function"&&(ne=T.options.addPath(ie,R));var re=T.services.interpolator.interpolate(ne,{lng:ie,ns:R});T.options.request(T.options,re,_,function(oe,ae){D+=1,Y.push(oe),ee.push(ae),D===w.length&&typeof S=="function"&&S(Y,ee)})})}}},{key:"reload",value:function(){var w=this,R=this.services,M=R.backendConnector,x=R.languageUtils,S=R.logger,T=M.language;if(!(T&&T.toLowerCase()==="cimode")){var _=[],D=function(ee){var ie=x.toResolveHierarchy(ee);ie.forEach(function(ne){_.indexOf(ne)<0&&_.push(ne)})};D(T),this.allOptions.preload&&this.allOptions.preload.forEach(function(Y){return D(Y)}),_.forEach(function(Y){w.allOptions.ns.forEach(function(ee){M.read(Y,ee,"read",null,null,function(ie,ne){ie&&S.warn("loading namespace ".concat(ee," for language ").concat(Y," failed"),ie),!ie&&ne&&S.log("loaded namespace ".concat(ee," for language ").concat(Y),ne),M.loaded("".concat(Y,"|").concat(ee),ie,ne)})})})}}}])}();Backend.type="backend";instance.use(Backend).use(Browser).use(initReactI18next).init({backend:{loadPath:"/assets/i18n/{{lng}}/{{ns}}.json"},fallbackLng:"en",interpolation:{escapeValue:!1}});const LogViewer=()=>{const{setUnhandledRejectionToastEnabled:C}=useAppRoot(),[E,w]=reactExports.useState(!0),R=reactExports.useRef(E),M=D=>{R.current=D,w(D)},[x,S]=reactExports.useState(),T=reactExports.useRef(null);reactExports.useEffect(()=>{C(!1)},[]),reactExports.useEffect(()=>{const D=Y=>{Y.ctrlKey&&Y.key==="r"&&(Y.preventDefault(),M(!R.current))};return window.addEventListener("keydown",D),()=>{window.removeEventListener("keydown",D)}},[]),reactExports.useEffect(()=>{let D;const Y=()=>{R.current?fetch("/vcclient.log").then(ee=>ee.text()).then(ee=>S(ee)):Logger$1.getLogger().info("skip fetch"),D=window.setTimeout(Y,1e3)};return Y(),()=>window.clearTimeout(D)},[]);const _=reactExports.useMemo(()=>{if(!x)return jsxRuntimeExports.jsx("div",{children:"loading..."});const D=["ERROR"],Y=["WARNING"],ee=["GPU[cuda]"],ie=D.concat(Y).concat(ee),ne=ae=>ae.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),re=ie.map(ne);return x.split(`
`).map((ae,le)=>{const de=ae.split(new RegExp(`(${re.join("|")})`));return jsxRuntimeExports.jsx("div",{className:logLine,children:de.map((me,fe)=>D.includes(me)?jsxRuntimeExports.jsx("span",{className:decoratedWordRed,children:me},fe):Y.includes(me)?jsxRuntimeExports.jsx("span",{className:decoratedWordBlue,children:me},fe):ee.includes(me)?jsxRuntimeExports.jsx("span",{className:decoratedWordGreen,children:me},fe):jsxRuntimeExports.jsx("span",{children:me},fe))},le)})},[x]);return reactExports.useEffect(()=>{x&&T.current&&T.current.scrollIntoView({behavior:"smooth"})},[x]),jsxRuntimeExports.jsxs("div",{className:loggerDiv,children:[jsxRuntimeExports.jsx("div",{className:loggerControlArea,children:jsxRuntimeExports.jsxs("div",{className:`${BasicButton({width:"xlarge",active:E})}  ${normalButtonThema}`,onClick:()=>{Logger$1.getLogger().info(`${E} -> ${!E}`),M(!E)},children:["Autoload(Ctrl + r):",E?"ON":"OFF"]})}),jsxRuntimeExports.jsxs("div",{className:loggerArea,children:[_,jsxRuntimeExports.jsx("div",{ref:T})]})]})},JsonViewer=C=>jsxRuntimeExports.jsxs("div",{children:["JsonViewer ",C.url]}),container=document.getElementById("root"),root=clientExports.createRoot(container),App=()=>{const{appMode:C}=useAppRoot();if(C==="LogViewer")return jsxRuntimeExports.jsx(LogViewer,{});if(C==="JsonViewer"){const R=new URL(window.location.href).searchParams.get("url")||"";return jsxRuntimeExports.jsx(JsonViewer,{url:R})}else return jsxRuntimeExports.jsx(AppStateProvider,{children:jsxRuntimeExports.jsx(Demo,{})})},AppStateWrapper=()=>{const{guiSetting:C}=useAppRoot();return C.guiSettingLoaded?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(App,{}),jsxRuntimeExports.jsx(Lt,{})]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:"loading..."})},Root=()=>{const[C,E]=reactExports.useState(),{t:w}=useTranslation(),R=reactExports.useMemo(()=>{var _;const x=(C==null?void 0:C.error.name)||"no error name",S=(C==null?void 0:C.error.message)||"no error message",T=(((_=C==null?void 0:C.errorInfo)==null?void 0:_.componentStack)||"no error stack").split(`
`);return jsxRuntimeExports.jsxs("div",{className:errorBoundaryContainer,children:[jsxRuntimeExports.jsx("div",{className:errorBoundaryTitle,children:w("error_boundary_title")}),jsxRuntimeExports.jsxs("div",{className:errorBoundaryName,children:[w("error_boundary_name"),":",x]}),jsxRuntimeExports.jsxs("div",{className:errorBoundaryMessage,children:[w("error_boundary_message"),":",S]}),jsxRuntimeExports.jsx("div",{className:errorBoundaryInfo,children:T.map((D,Y)=>jsxRuntimeExports.jsx("div",{children:D},Y))})]})},[C]),M=(x,S)=>{E({error:x,errorInfo:S})};return jsxRuntimeExports.jsx(ErrorBoundary,{fallback:R,onError:M,children:jsxRuntimeExports.jsx(AppRootProvider,{children:jsxRuntimeExports.jsx(AppStateWrapper,{})})})};root.render(jsxRuntimeExports.jsx(Root,{}));export{commonjsGlobal$1 as c,getDefaultExportFromCjs as g};
